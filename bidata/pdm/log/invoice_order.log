
20181122141514开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181122141514

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order
 where left(a.sys_time,10) >= '1900-01-01'
;

20181122141635开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181122141635

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
;
SQL结束执行时间：20181122141636
SQL开始执行时间：20181122141636

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181122141636
SQL开始执行时间：20181122141636
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002'
;
SQL结束执行时间：20181122141636
SQL开始执行时间：20181122141636
delete from pdm.invoice_order_pre where cinvcode = 'QT0004'
;
SQL结束执行时间：20181122141636
SQL开始执行时间：20181122141636

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181122141837
SQL开始执行时间：20181122141837


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,autoid
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181122141837

20181122163104开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181122163104

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
;
SQL结束执行时间：20181122163105
SQL开始执行时间：20181122163105

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181122163105
SQL开始执行时间：20181122163105
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002'
;
SQL结束执行时间：20181122163105
SQL开始执行时间：20181122163105
delete from pdm.invoice_order_pre where cinvcode = 'QT0004'
;
SQL结束执行时间：20181122163105
SQL开始执行时间：20181122163105

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181122163311
SQL开始执行时间：20181122163311


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,autoid
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181122163311

20181122171525开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181122171525

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
;
SQL结束执行时间：20181122171526
SQL开始执行时间：20181122171526

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181122171526
SQL开始执行时间：20181122171526
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT0004'
;
SQL结束执行时间：20181122171526
SQL开始执行时间：20181122171526

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181122171730
SQL开始执行时间：20181122171730


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,autoid
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181122171730

20181123105705开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181123105705

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
;
SQL结束执行时间：20181123105706
SQL开始执行时间：20181123105706

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181123105706
SQL开始执行时间：20181123105706
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181123105706
SQL开始执行时间：20181123105706

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181123105909
SQL开始执行时间：20181123105909


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,autoid
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181123105909

20181123111156开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181123111156

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181123111157
SQL开始执行时间：20181123111157

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181123111157
SQL开始执行时间：20181123111157
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181123111157
SQL开始执行时间：20181123111157

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181123111401
SQL开始执行时间：20181123111401


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,autoid
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181123111401

20181123114711开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181123114711

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181123114711
SQL开始执行时间：20181123114711

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181123114712
SQL开始执行时间：20181123114712
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181123114712
SQL开始执行时间：20181123114712

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181123114712
SQL开始执行时间：20181123114712


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,autoid
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181123114712

20181126145235开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181126145235

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126145236
SQL开始执行时间：20181126145236

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126145236
SQL开始执行时间：20181126145236
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126145236
SQL开始执行时间：20181126145236

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126145236
SQL开始执行时间：20181126145236


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126145237

20181126150056开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181126150056

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126150057
SQL开始执行时间：20181126150057

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126150057
SQL开始执行时间：20181126150057
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126150057
SQL开始执行时间：20181126150057

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126150057
SQL开始执行时间：20181126150057


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126150057

20181126150254开始执行2018-11-25数据加载日志:
SQL开始执行时间：20181126150254

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '2018-11-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126150255
SQL开始执行时间：20181126150255

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126150255
SQL开始执行时间：20181126150255
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126150255
SQL开始执行时间：20181126150255

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126150515
SQL开始执行时间：20181126150515


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126150515

20181126150552开始执行2018-11-25数据加载日志:
SQL开始执行时间：20181126150552

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '2018-11-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126150553
SQL开始执行时间：20181126150553

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126150553
SQL开始执行时间：20181126150553
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126150553
SQL开始执行时间：20181126150553

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126150814
SQL开始执行时间：20181126150814


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126150814

20181126150853开始执行2018-11-25数据加载日志:
SQL开始执行时间：20181126150853

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '2018-11-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126150854
SQL开始执行时间：20181126150854

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126150854
SQL开始执行时间：20181126150854
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126150854
SQL开始执行时间：20181126150854

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126151118
SQL开始执行时间：20181126151118


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126151118

20181126151206开始执行2018-11-25数据加载日志:
SQL开始执行时间：20181126151206

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '2018-11-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126151207
SQL开始执行时间：20181126151207

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126151207
SQL开始执行时间：20181126151207
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126151207
SQL开始执行时间：20181126151207

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126151427
SQL开始执行时间：20181126151427


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126151427

20181126151445开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181126151445

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126151446
SQL开始执行时间：20181126151446

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126151446
SQL开始执行时间：20181126151446
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126151446
SQL开始执行时间：20181126151446

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126151707
SQL开始执行时间：20181126151707


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126151707

20181126160037开始执行2018-11-25数据加载日志:
SQL开始执行时间：20181126160037

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '2018-11-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126160038
SQL开始执行时间：20181126160038

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126160038
SQL开始执行时间：20181126160038
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126160038
SQL开始执行时间：20181126160038

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126160300
SQL开始执行时间：20181126160300


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126160300

20181126174515开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181126174515

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181126174516
SQL开始执行时间：20181126174516

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181126174516
SQL开始执行时间：20181126174516
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181126174516
SQL开始执行时间：20181126174516

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181126174516
SQL开始执行时间：20181126174516


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181126174517

20181127010042开始执行2018-11-26数据加载日志:
SQL开始执行时间：20181127010042

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) >= '2018-11-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20181127010043
SQL开始执行时间：20181127010043

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181127010043
SQL开始执行时间：20181127010043
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181127010043
SQL开始执行时间：20181127010043

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181127010304
SQL开始执行时间：20181127010304


insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181127010305

20181127093732开始执行2018-11-26数据加载日志:
SQL开始执行时间：20181127093732

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '2018-11-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20181127093732
SQL开始执行时间：20181127093732

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181127093732
SQL开始执行时间：20181127093732
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181127093732
SQL开始执行时间：20181127093732

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181127093735
SQL开始执行时间：20181127093735

insert into pdm.invoice_order
select db
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,ccuscode
      ,ccusname
      ,true_ccuscode
      ,true_ccusname
      ,finnal_ccusname
      ,true_finnal_ccuscode
      ,true_finnal_ccusname1
      ,true_finnal_ccusname2
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181127093735

20181127100146开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181127100146

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181127100147
SQL开始执行时间：20181127100147

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181127100147
SQL开始执行时间：20181127100147
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181127100147
SQL开始执行时间：20181127100147

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181127100147
SQL开始执行时间：20181127100147

insert into pdm.invoice_order
select db
      ,case when db = 'UFDATA_111_2018' then '博圣' 
            when db = 'UFDATA_118_2018' then '卓恩'
            when db = 'UFDATA_123_2018' then '恩允'
            when db = 'UFDATA_168_2018' then '贝生'
            when db = 'UFDATA_169_2018' then '云鼎'
            when db = 'UFDATA_222_2018' then '宝莱'
            when db = 'UFDATA_333_2018' then '宁波贝生'
            when db = 'UFDATA_588_2018' then '湖北奥博特'
            when db = 'UFDATA_666_2018' then '启代'
            when db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,true_ccuscode as ccuscode
      ,true_ccusname as ccusname
      ,true_finnal_ccuscode as finnal_ccuscode
      ,true_finnal_ccusname2 as finnal_ccusname
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;

20181127100309开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181127100309

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181127100310
SQL开始执行时间：20181127100310

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181127100310
SQL开始执行时间：20181127100310
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181127100310
SQL开始执行时间：20181127100310

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181127100310
SQL开始执行时间：20181127100310

insert into pdm.invoice_order
select db
      ,case when db = 'UFDATA_111_2018' then '博圣' 
            when db = 'UFDATA_118_2018' then '卓恩'
            when db = 'UFDATA_123_2018' then '恩允'
            when db = 'UFDATA_168_2018' then '贝生'
            when db = 'UFDATA_169_2018' then '云鼎'
            when db = 'UFDATA_222_2018' then '宝莱'
            when db = 'UFDATA_333_2018' then '宁波贝生'
            when db = 'UFDATA_588_2018' then '湖北奥博特'
            when db = 'UFDATA_666_2018' then '启代'
            when db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,true_ccuscode as ccuscode
      ,true_ccusname as ccusname
      ,true_finnal_ccuscode as finnal_ccuscode
      ,true_finnal_ccusname2 as finnal_ccusname
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,child_sbvid
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181127100311

20181127100611开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181127100611

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181127100612
SQL开始执行时间：20181127100612

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181127100612
SQL开始执行时间：20181127100612
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181127100612
SQL开始执行时间：20181127100612

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181127100612
SQL开始执行时间：20181127100612

insert into pdm.invoice_order
select db
      ,case when db = 'UFDATA_111_2018' then '博圣' 
            when db = 'UFDATA_118_2018' then '卓恩'
            when db = 'UFDATA_123_2018' then '恩允'
            when db = 'UFDATA_168_2018' then '贝生'
            when db = 'UFDATA_169_2018' then '云鼎'
            when db = 'UFDATA_222_2018' then '宝莱'
            when db = 'UFDATA_333_2018' then '宁波贝生'
            when db = 'UFDATA_588_2018' then '湖北奥博特'
            when db = 'UFDATA_666_2018' then '启代'
            when db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,true_ccuscode as ccuscode
      ,true_ccusname as ccusname
      ,true_finnal_ccuscode as finnal_ccuscode
      ,true_finnal_ccusname2 as finnal_ccusname
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181127100613

20181128010042开始执行2018-11-27数据加载日志:
SQL开始执行时间：20181128010042

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '2018-11-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20181128010042
SQL开始执行时间：20181128010042

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181128010042
SQL开始执行时间：20181128010042
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181128010042
SQL开始执行时间：20181128010042

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181128010043
SQL开始执行时间：20181128010043

insert into pdm.invoice_order
select db
      ,case when db = 'UFDATA_111_2018' then '博圣' 
            when db = 'UFDATA_118_2018' then '卓恩'
            when db = 'UFDATA_123_2018' then '恩允'
            when db = 'UFDATA_168_2018' then '贝生'
            when db = 'UFDATA_169_2018' then '云鼎'
            when db = 'UFDATA_222_2018' then '宝莱'
            when db = 'UFDATA_333_2018' then '宁波贝生'
            when db = 'UFDATA_588_2018' then '湖北奥博特'
            when db = 'UFDATA_666_2018' then '启代'
            when db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,true_ccuscode as ccuscode
      ,true_ccusname as ccusname
      ,true_finnal_ccuscode as finnal_ccuscode
      ,true_finnal_ccusname2 as finnal_ccusname
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181128010043

20181129010038开始执行2018-11-28数据加载日志:
SQL开始执行时间：20181129010038

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '2018-11-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129010038
SQL开始执行时间：20181129010038

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129010038
SQL开始执行时间：20181129010038
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181129010038
SQL开始执行时间：20181129010038

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181129010040
SQL开始执行时间：20181129010040

insert into pdm.invoice_order
select db
      ,case when db = 'UFDATA_111_2018' then '博圣' 
            when db = 'UFDATA_118_2018' then '卓恩'
            when db = 'UFDATA_123_2018' then '恩允'
            when db = 'UFDATA_168_2018' then '贝生'
            when db = 'UFDATA_169_2018' then '云鼎'
            when db = 'UFDATA_222_2018' then '宝莱'
            when db = 'UFDATA_333_2018' then '宁波贝生'
            when db = 'UFDATA_588_2018' then '湖北奥博特'
            when db = 'UFDATA_666_2018' then '启代'
            when db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,true_ccuscode as ccuscode
      ,true_ccusname as ccusname
      ,true_finnal_ccuscode as finnal_ccuscode
      ,true_finnal_ccusname2 as finnal_ccusname
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181129010040

20181129151127开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181129151127

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129151130
SQL开始执行时间：20181129151130

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129151130
SQL开始执行时间：20181129151130
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181129151130
SQL开始执行时间：20181129151130

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181129151130
SQL开始执行时间：20181129151130

insert into pdm.invoice_order
select db
      ,case when db = 'UFDATA_111_2018' then '博圣' 
            when db = 'UFDATA_118_2018' then '卓恩'
            when db = 'UFDATA_123_2018' then '恩允'
            when db = 'UFDATA_168_2018' then '贝生'
            when db = 'UFDATA_169_2018' then '云鼎'
            when db = 'UFDATA_222_2018' then '宝莱'
            when db = 'UFDATA_333_2018' then '宁波贝生'
            when db = 'UFDATA_588_2018' then '湖北奥博特'
            when db = 'UFDATA_666_2018' then '启代'
            when db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,true_ccuscode as ccuscode
      ,true_ccusname as ccusname
      ,true_finnal_ccuscode as finnal_ccuscode
      ,true_finnal_ccusname2 as finnal_ccusname
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181129151131

20181130010038开始执行2018-11-29数据加载日志:
SQL开始执行时间：20181130010038

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '2018-11-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20181130010039
SQL开始执行时间：20181130010039

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181130010039
SQL开始执行时间：20181130010039
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181130010039
SQL开始执行时间：20181130010039

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181130010041
SQL开始执行时间：20181130010041

insert into pdm.invoice_order
select db
      ,case when db = 'UFDATA_111_2018' then '博圣' 
            when db = 'UFDATA_118_2018' then '卓恩'
            when db = 'UFDATA_123_2018' then '恩允'
            when db = 'UFDATA_168_2018' then '贝生'
            when db = 'UFDATA_169_2018' then '云鼎'
            when db = 'UFDATA_222_2018' then '宝莱'
            when db = 'UFDATA_333_2018' then '宁波贝生'
            when db = 'UFDATA_588_2018' then '湖北奥博特'
            when db = 'UFDATA_666_2018' then '启代'
            when db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,true_ccuscode as ccuscode
      ,true_ccusname as ccusname
      ,true_finnal_ccuscode as finnal_ccuscode
      ,true_finnal_ccusname2 as finnal_ccusname
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181130010041

20181201010039开始执行2018-11-30数据加载日志:
SQL开始执行时间：20181201010039

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '2018-11-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20181201010039
SQL开始执行时间：20181201010039

delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181201010039
SQL开始执行时间：20181201010039
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181201010039
SQL开始执行时间：20181201010039

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181201010045
SQL开始执行时间：20181201010045

insert into pdm.invoice_order
select db
      ,case when db = 'UFDATA_111_2018' then '博圣' 
            when db = 'UFDATA_118_2018' then '卓恩'
            when db = 'UFDATA_123_2018' then '恩允'
            when db = 'UFDATA_168_2018' then '贝生'
            when db = 'UFDATA_169_2018' then '云鼎'
            when db = 'UFDATA_222_2018' then '宝莱'
            when db = 'UFDATA_333_2018' then '宁波贝生'
            when db = 'UFDATA_588_2018' then '湖北奥博特'
            when db = 'UFDATA_666_2018' then '启代'
            when db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,sbvid
      ,csbvcode
      ,csocode
      ,ddate
      ,true_ccuscode as ccuscode
      ,true_ccusname as ccusname
      ,true_finnal_ccuscode as finnal_ccuscode
      ,true_finnal_ccusname2 as finnal_ccusname
      ,cstcode
      ,cmaker
      ,cverifier
      ,cmodifier
      ,dcreatesystime
      ,dmodifysystime
      ,cdepcode
      ,cpersoncode
      ,ccusperson
      ,ccuspersoncode
      ,cvouchtype
      ,cdlcode
      ,cdefine2
      ,cdefine3
      ,autoid
      ,isaleoutid
      ,cbdlcode
      ,isosid
      ,idlsid
      ,cdefine22
      ,cinvcode
      ,cinvname
      ,bi_cinvcode
      ,bi_cinvname
      ,iquantity
      ,itaxunitprice
      ,itax
      ,isum
      ,itaxrate
      ,citemcode
      ,citem_class
      ,citemname
      ,citem_cname
      ,localtimestamp()
  from pdm.invoice_order_pre
;
SQL结束执行时间：20181201010045

20181204010040开始执行2018-12-03数据加载日志:
SQL开始执行时间：20181204010040

create temporary table pdm.invoice_order_pre as 
select *
  from edw.invoice_order a
 where left(a.sys_time,10) > '2018-12-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20181204010040
SQL开始执行时间：20181204010040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181204010040
SQL开始执行时间：20181204010040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181204010040
SQL开始执行时间：20181204010040

delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181204010044
SQL开始执行时间：20181204010044

insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,e.item_code
      ,case when f.item_code is null then '请核查'
            else f.plan_class end
      ,case when f.item_code is null then '请核查'
            else f.key_project end
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,item_code,business_class from edw.map_inventory group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select ccuscode,item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,item_code) f
    on e.item_code = f.item_code

;
SQL结束执行时间：20181204010044

20181204144429开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181204144429

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181204144430
SQL开始执行时间：20181204144430
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181204144430
SQL开始执行时间：20181204144430
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181204144430
SQL开始执行时间：20181204144430

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181204144430
SQL开始执行时间：20181204144430


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181204144430
SQL开始执行时间：20181204144430

drop table if exists pdm.invoice_order_item
;
SQL结束执行时间：20181204144430
SQL开始执行时间：20181204144430
create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181204144430
SQL开始执行时间：20181204144430


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,e.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.invoice_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181204144452

20181204154748开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181204154748

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181204154749
SQL开始执行时间：20181204154749
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181204154749
SQL开始执行时间：20181204154749
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181204154749
SQL开始执行时间：20181204154749

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181204154749
SQL开始执行时间：20181204154749


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181204154749
SQL开始执行时间：20181204154749

drop table if exists pdm.invoice_order_item
;
SQL结束执行时间：20181204154749
SQL开始执行时间：20181204154749
create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181204154749
SQL开始执行时间：20181204154749


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,e.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.invoice_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;

20181204154901开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181204154901

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181204154902
SQL开始执行时间：20181204154902
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181204154902
SQL开始执行时间：20181204154902
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181204154902
SQL开始执行时间：20181204154902

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181204154902
SQL开始执行时间：20181204154902


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181204154902
SQL开始执行时间：20181204154902

drop table if exists pdm.invoice_order_item
;
SQL结束执行时间：20181204154902
SQL开始执行时间：20181204154902
create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181204154902
SQL开始执行时间：20181204154902


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,e.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.invoice_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181204154924

20181205010040开始执行2018-12-04数据加载日志:
SQL开始执行时间：20181205010040

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20181205010040
SQL开始执行时间：20181205010040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181205010040
SQL开始执行时间：20181205010040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181205010040
SQL开始执行时间：20181205010040

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181205010040
SQL开始执行时间：20181205010040


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181205010042
SQL开始执行时间：20181205010042

drop table if exists pdm.invoice_order_item
;
SQL结束执行时间：20181205010042
SQL开始执行时间：20181205010042
create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181205010042
SQL开始执行时间：20181205010042


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when e.bi_cinvcode is not null and e.item_code is not null  then e.item_code
            else '请核查' end
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.invoice_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181205010042

20181205104717开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181205104717

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181205104718
SQL开始执行时间：20181205104718
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181205104718
SQL开始执行时间：20181205104718
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181205104718
SQL开始执行时间：20181205104718

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181205104718
SQL开始执行时间：20181205104718


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181205104718
SQL开始执行时间：20181205104718

drop table if exists pdm.invoice_order_item
;
SQL结束执行时间：20181205104718
SQL开始执行时间：20181205104718
create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181205104718
SQL开始执行时间：20181205104718


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when e.bi_cinvcode is not null and e.item_code is not null  then e.item_code
            else '请核查' end
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.invoice_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181205104740

20181206010039开始执行2018-12-05数据加载日志:
SQL开始执行时间：20181206010039

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206010040
SQL开始执行时间：20181206010040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206010040
SQL开始执行时间：20181206010040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206010040
SQL开始执行时间：20181206010040

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206010040
SQL开始执行时间：20181206010040


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206010041
SQL开始执行时间：20181206010041

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206010042
SQL开始执行时间：20181206010042


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.invoice_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206010042

20181206093643开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206093643

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;

20181206094707开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206094707

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206094708
SQL开始执行时间：20181206094708
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206094708
SQL开始执行时间：20181206094708
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206094708
SQL开始执行时间：20181206094708

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206094708
SQL开始执行时间：20181206094708


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206094708
SQL开始执行时间：20181206094708

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206094709
SQL开始执行时间：20181206094709


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.invoice_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;

20181206094859开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206094859

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206094900
SQL开始执行时间：20181206094900
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206094900
SQL开始执行时间：20181206094900
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206094900
SQL开始执行时间：20181206094900

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206094900
SQL开始执行时间：20181206094900


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206094900
SQL开始执行时间：20181206094900

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206094900
SQL开始执行时间：20181206094900


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20181206094933开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206094933

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206094934
SQL开始执行时间：20181206094934
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206094935
SQL开始执行时间：20181206094935
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206094935
SQL开始执行时间：20181206094935

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206094935
SQL开始执行时间：20181206094935


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206094935
SQL开始执行时间：20181206094935

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206094935
SQL开始执行时间：20181206094935


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206094936

20181206133005开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206133005

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206133006
SQL开始执行时间：20181206133006
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206133006
SQL开始执行时间：20181206133006
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206133006
SQL开始执行时间：20181206133006

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206133006
SQL开始执行时间：20181206133006


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206133006
SQL开始执行时间：20181206133006

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206133007
SQL开始执行时间：20181206133007


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206133008

20181206153700开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206153700

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206153701
SQL开始执行时间：20181206153701
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206153701
SQL开始执行时间：20181206153701
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206153701
SQL开始执行时间：20181206153701

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206153701
SQL开始执行时间：20181206153701


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206153701
SQL开始执行时间：20181206153701

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206153701
SQL开始执行时间：20181206153701


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206153702

20181206155020开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206155020

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206155020
SQL开始执行时间：20181206155020
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206155020
SQL开始执行时间：20181206155020
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206155020
SQL开始执行时间：20181206155020

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206155020
SQL开始执行时间：20181206155020


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206155020
SQL开始执行时间：20181206155020

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206155021
SQL开始执行时间：20181206155021


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206155021

20181206175743开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206175743

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206175744
SQL开始执行时间：20181206175744
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206175744
SQL开始执行时间：20181206175744
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206175744
SQL开始执行时间：20181206175744

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206175744
SQL开始执行时间：20181206175744


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206175744
SQL开始执行时间：20181206175744

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206175745
SQL开始执行时间：20181206175745


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206175746

20181206180704开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206180704

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206180705
SQL开始执行时间：20181206180705
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206180705
SQL开始执行时间：20181206180705
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206180705
SQL开始执行时间：20181206180705

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206180705
SQL开始执行时间：20181206180705


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206180705
SQL开始执行时间：20181206180705

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206180706
SQL开始执行时间：20181206180706


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206180707

20181206202313开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206202313

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206202314
SQL开始执行时间：20181206202314
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206202314
SQL开始执行时间：20181206202314
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181206202314
SQL开始执行时间：20181206202314

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181206202314
SQL开始执行时间：20181206202314


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181206202547
SQL开始执行时间：20181206202547

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206202547
SQL开始执行时间：20181206202547


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206202548

20181207010041开始执行2018-12-06数据加载日志:
SQL开始执行时间：20181207010041

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20181207010041
SQL开始执行时间：20181207010041
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181207010041
SQL开始执行时间：20181207010041
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181207010041
SQL开始执行时间：20181207010041

delete from pdm.invoice_order_pre where ccustype = '关联公司'
;
SQL结束执行时间：20181207010041
SQL开始执行时间：20181207010041


delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181207010044
SQL开始执行时间：20181207010044

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181207010044
SQL开始执行时间：20181207010044


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181207010044

20181208010039开始执行2018-12-07数据加载日志:
SQL开始执行时间：20181208010039

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20181208010039
SQL开始执行时间：20181208010039
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181208010039
SQL开始执行时间：20181208010039
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181208010039
SQL开始执行时间：20181208010039



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181208010042
SQL开始执行时间：20181208010042

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181208010042
SQL开始执行时间：20181208010042


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181208010042

20181209010038开始执行2018-12-08数据加载日志:
SQL开始执行时间：20181209010038

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20181209010038
SQL开始执行时间：20181209010038
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181209010038
SQL开始执行时间：20181209010038
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181209010038
SQL开始执行时间：20181209010038



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181209010038
SQL开始执行时间：20181209010038

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181209010038
SQL开始执行时间：20181209010038


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181209010038

20181210010036开始执行2018-12-09数据加载日志:
SQL开始执行时间：20181210010036

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20181210010036
SQL开始执行时间：20181210010036
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181210010036
SQL开始执行时间：20181210010036
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181210010036
SQL开始执行时间：20181210010036



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181210010036
SQL开始执行时间：20181210010036

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181210010036
SQL开始执行时间：20181210010036


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181210010036

20181211010043开始执行2018-12-10数据加载日志:
SQL开始执行时间：20181211010043

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20181211010043
SQL开始执行时间：20181211010043
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181211010043
SQL开始执行时间：20181211010043
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181211010043
SQL开始执行时间：20181211010043



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181211010045
SQL开始执行时间：20181211010045

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181211010046
SQL开始执行时间：20181211010046


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181211010046

20181212010037开始执行2018-12-11数据加载日志:
SQL开始执行时间：20181212010037

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20181212010038
SQL开始执行时间：20181212010038
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181212010038
SQL开始执行时间：20181212010038
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181212010038
SQL开始执行时间：20181212010038



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181212010039
SQL开始执行时间：20181212010039

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181212010039
SQL开始执行时间：20181212010039


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181212010039

20181213010039开始执行2018-12-12数据加载日志:
SQL开始执行时间：20181213010039

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20181213010039
SQL开始执行时间：20181213010039
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181213010039
SQL开始执行时间：20181213010039
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181213010039
SQL开始执行时间：20181213010039



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181213010041
SQL开始执行时间：20181213010041

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181213010041
SQL开始执行时间：20181213010041


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181213010041

20181214010038开始执行2018-12-13数据加载日志:
SQL开始执行时间：20181214010038

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20181214010038
SQL开始执行时间：20181214010038
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181214010038
SQL开始执行时间：20181214010038
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181214010038
SQL开始执行时间：20181214010038



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181214010040
SQL开始执行时间：20181214010040

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181214010041
SQL开始执行时间：20181214010041


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181214010041

20181215010040开始执行2018-12-14数据加载日志:
SQL开始执行时间：20181215010040

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20181215010040
SQL开始执行时间：20181215010040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181215010040
SQL开始执行时间：20181215010040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181215010040
SQL开始执行时间：20181215010040



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181215010045
SQL开始执行时间：20181215010045

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181215010045
SQL开始执行时间：20181215010045


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181215010045

20181216010040开始执行2018-12-15数据加载日志:
SQL开始执行时间：20181216010040

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20181216010040
SQL开始执行时间：20181216010040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181216010040
SQL开始执行时间：20181216010040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181216010040
SQL开始执行时间：20181216010040



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181216010040
SQL开始执行时间：20181216010040

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181216010041
SQL开始执行时间：20181216010041


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181216010041

20181217010040开始执行2018-12-16数据加载日志:
SQL开始执行时间：20181217010040

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20181217010040
SQL开始执行时间：20181217010040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181217010040
SQL开始执行时间：20181217010040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181217010040
SQL开始执行时间：20181217010040



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181217010040
SQL开始执行时间：20181217010040

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181217010040
SQL开始执行时间：20181217010040


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181217010040

20181218010043开始执行2018-12-17数据加载日志:
SQL开始执行时间：20181218010043

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20181218010043
SQL开始执行时间：20181218010043
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181218010043
SQL开始执行时间：20181218010043
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181218010043
SQL开始执行时间：20181218010043



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181218010047
SQL开始执行时间：20181218010047

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181218010048
SQL开始执行时间：20181218010048


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181218010048

20181219010041开始执行2018-12-18数据加载日志:
SQL开始执行时间：20181219010041

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219010042
SQL开始执行时间：20181219010042
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219010042
SQL开始执行时间：20181219010042
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181219010042
SQL开始执行时间：20181219010042



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181219010045
SQL开始执行时间：20181219010045

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219010045
SQL开始执行时间：20181219010045


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219010045

20181219110840开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181219110840

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219110842
SQL开始执行时间：20181219110842
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219110842
SQL开始执行时间：20181219110842
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181219110842
SQL开始执行时间：20181219110842



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181219110842
SQL开始执行时间：20181219110842

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219110842
SQL开始执行时间：20181219110842


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219110844

20181219181109开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181219181109

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219181109
SQL开始执行时间：20181219181109
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219181109
SQL开始执行时间：20181219181109
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181219181109
SQL开始执行时间：20181219181109



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181219181110
SQL开始执行时间：20181219181110

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219181110
SQL开始执行时间：20181219181110


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219181110

20181219181421开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181219181421

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219181422
SQL开始执行时间：20181219181422
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219181423
SQL开始执行时间：20181219181423
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181219181423
SQL开始执行时间：20181219181423



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181219181423
SQL开始执行时间：20181219181423

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219181423
SQL开始执行时间：20181219181423


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219181425

20181220010051开始执行2018-12-19数据加载日志:
SQL开始执行时间：20181220010051

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20181220010052
SQL开始执行时间：20181220010052
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181220010052
SQL开始执行时间：20181220010052
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181220010052
SQL开始执行时间：20181220010052



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181220010056
SQL开始执行时间：20181220010056

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181220010056
SQL开始执行时间：20181220010056


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181220010057

20181221010046开始执行2018-12-20数据加载日志:
SQL开始执行时间：20181221010046

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20181221010046
SQL开始执行时间：20181221010046
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181221010046
SQL开始执行时间：20181221010046
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181221010046
SQL开始执行时间：20181221010046



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181221010049
SQL开始执行时间：20181221010049

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181221010049
SQL开始执行时间：20181221010049


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181221010049

20181221153812开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181221153812

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181221153814
SQL开始执行时间：20181221153814
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181221153814
SQL开始执行时间：20181221153814
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181221153814
SQL开始执行时间：20181221153814



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181221153814
SQL开始执行时间：20181221153814

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181221153814
SQL开始执行时间：20181221153814


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181221153817

20181222010043开始执行2018-12-21数据加载日志:
SQL开始执行时间：20181222010043

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20181222010043
SQL开始执行时间：20181222010043
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181222010043
SQL开始执行时间：20181222010043
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181222010043
SQL开始执行时间：20181222010043



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181222010045
SQL开始执行时间：20181222010045

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181222010045
SQL开始执行时间：20181222010045


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181222010045

20181223010038开始执行2018-12-22数据加载日志:
SQL开始执行时间：20181223010038

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20181223010038
SQL开始执行时间：20181223010038
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181223010038
SQL开始执行时间：20181223010038
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181223010038
SQL开始执行时间：20181223010038



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181223010038
SQL开始执行时间：20181223010038

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181223010039
SQL开始执行时间：20181223010039


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181223010039

20181224010038开始执行2018-12-23数据加载日志:
SQL开始执行时间：20181224010038

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20181224010038
SQL开始执行时间：20181224010038
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181224010038
SQL开始执行时间：20181224010038
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181224010038
SQL开始执行时间：20181224010038



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181224010038
SQL开始执行时间：20181224010038

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181224010039
SQL开始执行时间：20181224010039


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181224010039

20181224100714开始执行2018-12-21数据加载日志:
SQL开始执行时间：20181224100714

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20181224100714
SQL开始执行时间：20181224100714
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181224100714
SQL开始执行时间：20181224100714
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181224100714
SQL开始执行时间：20181224100714



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181224100716
SQL开始执行时间：20181224100716

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181224100717
SQL开始执行时间：20181224100717


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181224100717

20181225010100开始执行2018-12-24数据加载日志:
SQL开始执行时间：20181225010100

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225010100
SQL开始执行时间：20181225010100
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225010100
SQL开始执行时间：20181225010100
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181225010100
SQL开始执行时间：20181225010100



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181225010108
SQL开始执行时间：20181225010108

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225010108
SQL开始执行时间：20181225010108


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225010108

20181225105224开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181225105224

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225105225
SQL开始执行时间：20181225105225
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225105226
SQL开始执行时间：20181225105226
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181225105226
SQL开始执行时间：20181225105226



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181225105226
SQL开始执行时间：20181225105226

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225105226
SQL开始执行时间：20181225105226


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225105228

20181225202627开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181225202627

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225202628
SQL开始执行时间：20181225202628
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225202628
SQL开始执行时间：20181225202628
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181225202628
SQL开始执行时间：20181225202628



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181225202628
SQL开始执行时间：20181225202628

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225202628
SQL开始执行时间：20181225202628


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225202630

20181226010043开始执行2018-12-25数据加载日志:
SQL开始执行时间：20181226010043

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226010043
SQL开始执行时间：20181226010043
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226010043
SQL开始执行时间：20181226010043
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181226010043
SQL开始执行时间：20181226010043



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181226010046
SQL开始执行时间：20181226010046

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226010047
SQL开始执行时间：20181226010047


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181226010047

20181226102250开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181226102250

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226102251
SQL开始执行时间：20181226102251
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226102251
SQL开始执行时间：20181226102251
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181226102251
SQL开始执行时间：20181226102251



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181226102251
SQL开始执行时间：20181226102251

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226102251
SQL开始执行时间：20181226102251


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181226102254

20181226142307开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181226142307

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226142309
SQL开始执行时间：20181226142309
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226142309
SQL开始执行时间：20181226142309
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181226142309
SQL开始执行时间：20181226142309



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181226142309
SQL开始执行时间：20181226142309

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226142310
SQL开始执行时间：20181226142310


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181226142311

20181227010051开始执行2018-12-26数据加载日志:
SQL开始执行时间：20181227010051

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20181227010051
SQL开始执行时间：20181227010051
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181227010051
SQL开始执行时间：20181227010051
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181227010051
SQL开始执行时间：20181227010051



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181227010055
SQL开始执行时间：20181227010055

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181227010055
SQL开始执行时间：20181227010055


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181227010055

20181227094544开始执行2018-12-26数据加载日志:
SQL开始执行时间：20181227094544

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20181227094545
SQL开始执行时间：20181227094545
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181227094545
SQL开始执行时间：20181227094545
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181227094545
SQL开始执行时间：20181227094545



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181227094549
SQL开始执行时间：20181227094549

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181227094549
SQL开始执行时间：20181227094549


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181227094549

20181227220038开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181227220038

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181227220039
SQL开始执行时间：20181227220039
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181227220039
SQL开始执行时间：20181227220039
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181227220039
SQL开始执行时间：20181227220039



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181227220039
SQL开始执行时间：20181227220039

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181227220039
SQL开始执行时间：20181227220039


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181227220041

20181228010048开始执行2018-12-27数据加载日志:
SQL开始执行时间：20181228010048

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20181228010048
SQL开始执行时间：20181228010048
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181228010048
SQL开始执行时间：20181228010048
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181228010048
SQL开始执行时间：20181228010048



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181228010052
SQL开始执行时间：20181228010052

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181228010053
SQL开始执行时间：20181228010053


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181228010053

20181229010045开始执行2018-12-28数据加载日志:
SQL开始执行时间：20181229010045

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181229010045
SQL开始执行时间：20181229010045
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181229010045
SQL开始执行时间：20181229010045
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181229010045
SQL开始执行时间：20181229010045



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181229010049
SQL开始执行时间：20181229010049

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181229010049
SQL开始执行时间：20181229010049


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181229010050

20181229100449开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181229100449

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181229100450
SQL开始执行时间：20181229100450
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181229100451
SQL开始执行时间：20181229100451
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181229100451
SQL开始执行时间：20181229100451



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181229100451
SQL开始执行时间：20181229100451

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181229100451
SQL开始执行时间：20181229100451


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181229100453

20181229162126开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181229162126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181229162127
SQL开始执行时间：20181229162127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181229162127
SQL开始执行时间：20181229162127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20181229162127
SQL开始执行时间：20181229162127



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20181229162127
SQL开始执行时间：20181229162127

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181229162128
SQL开始执行时间：20181229162128


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181229162129

20190102103424开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190102103424

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190102103424
SQL开始执行时间：20190102103424
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190102103424
SQL开始执行时间：20190102103424
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190102103424
SQL开始执行时间：20190102103424



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190102103424
SQL开始执行时间：20190102103424

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190102103424
SQL开始执行时间：20190102103424


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190102103424

20190102103754开始执行2018-12-30数据加载日志:
SQL开始执行时间：20190102103754

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190102103754
SQL开始执行时间：20190102103754
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190102103754
SQL开始执行时间：20190102103754
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190102103754
SQL开始执行时间：20190102103754



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190102103759
SQL开始执行时间：20190102103759

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190102103800
SQL开始执行时间：20190102103800


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190102103800

20190103010042开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190103010042

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190103010042
SQL开始执行时间：20190103010042
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190103010042
SQL开始执行时间：20190103010042
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190103010042
SQL开始执行时间：20190103010042



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190103010044
SQL开始执行时间：20190103010044

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190103010044
SQL开始执行时间：20190103010044


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190103010044

20190103095935开始执行2018-12-29数据加载日志:
SQL开始执行时间：20190103095935

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190103095935
SQL开始执行时间：20190103095935
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190103095935
SQL开始执行时间：20190103095935
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190103095935
SQL开始执行时间：20190103095935



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190103095944
SQL开始执行时间：20190103095944

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190103095944
SQL开始执行时间：20190103095944


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190103095944

20190104010040开始执行2019-01-03数据加载日志:
SQL开始执行时间：20190104010040

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190104010040
SQL开始执行时间：20190104010040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190104010040
SQL开始执行时间：20190104010040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190104010040
SQL开始执行时间：20190104010040



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190104010041
SQL开始执行时间：20190104010041

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190104010042
SQL开始执行时间：20190104010042


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190104010042

20190104093120开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190104093120

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190104093121
SQL开始执行时间：20190104093121
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190104093121
SQL开始执行时间：20190104093121
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190104093121
SQL开始执行时间：20190104093121



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190104093129
SQL开始执行时间：20190104093129

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190104093130
SQL开始执行时间：20190104093130


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190104093130

20190104093840开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190104093840

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190104093841
SQL开始执行时间：20190104093841
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190104093841
SQL开始执行时间：20190104093841
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190104093841
SQL开始执行时间：20190104093841



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190104093850
SQL开始执行时间：20190104093850

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190104093850
SQL开始执行时间：20190104093850


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190104093850

20190105010044开始执行2019-01-04数据加载日志:
SQL开始执行时间：20190105010044

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190105010044
SQL开始执行时间：20190105010044
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190105010044
SQL开始执行时间：20190105010044
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190105010044
SQL开始执行时间：20190105010044



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190105010047
SQL开始执行时间：20190105010047

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190105010047
SQL开始执行时间：20190105010047


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190105010047

20190105101240开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190105101240

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190105101241
SQL开始执行时间：20190105101241
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190105101241
SQL开始执行时间：20190105101241
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190105101242
SQL开始执行时间：20190105101242



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190105101242
SQL开始执行时间：20190105101242

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190105101242
SQL开始执行时间：20190105101242


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190105101244

20190106010042开始执行2019-01-05数据加载日志:
SQL开始执行时间：20190106010042

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190106010042
SQL开始执行时间：20190106010042
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190106010042
SQL开始执行时间：20190106010042
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190106010042
SQL开始执行时间：20190106010042



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190106010042
SQL开始执行时间：20190106010042

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190106010042
SQL开始执行时间：20190106010042


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190106010042

20190107010041开始执行2019-01-06数据加载日志:
SQL开始执行时间：20190107010041

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190107010041
SQL开始执行时间：20190107010041
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190107010041
SQL开始执行时间：20190107010041
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190107010041
SQL开始执行时间：20190107010041



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190107010041
SQL开始执行时间：20190107010041

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190107010041
SQL开始执行时间：20190107010041


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190107010041

20190108010046开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190108010046

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190108010047
SQL开始执行时间：20190108010047
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190108010047
SQL开始执行时间：20190108010047
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190108010047
SQL开始执行时间：20190108010047



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190108010049
SQL开始执行时间：20190108010049

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190108010049
SQL开始执行时间：20190108010049


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190108010049

20190109010044开始执行2019-01-08数据加载日志:
SQL开始执行时间：20190109010044

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190109010044
SQL开始执行时间：20190109010044
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190109010044
SQL开始执行时间：20190109010044
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190109010044
SQL开始执行时间：20190109010044



delete from pdm.invoice_order where sbvid in (select sbvid from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190109010047
SQL开始执行时间：20190109010047

create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190109010047
SQL开始执行时间：20190109010047


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190109010047

20190109090304开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190109090304

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190109090305
SQL开始执行时间：20190109090305
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190109090305
SQL开始执行时间：20190109090305
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190109090305
SQL开始执行时间：20190109090305



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190109090305
SQL开始执行时间：20190109090305


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190109090305
SQL开始执行时间：20190109090305


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190109090307

20190109090827开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190109090827

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190109090828
SQL开始执行时间：20190109090828
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190109090828
SQL开始执行时间：20190109090828
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190109090828
SQL开始执行时间：20190109090828



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190109090833
SQL开始执行时间：20190109090833


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190109090834
SQL开始执行时间：20190109090834


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190109090834

20190110010045开始执行2019-01-09数据加载日志:
SQL开始执行时间：20190110010045

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190110010045
SQL开始执行时间：20190110010045
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190110010045
SQL开始执行时间：20190110010045
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190110010045
SQL开始执行时间：20190110010045



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190110010048
SQL开始执行时间：20190110010048


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190110010048
SQL开始执行时间：20190110010048


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190110010048

20190111010041开始执行2019-01-10数据加载日志:
SQL开始执行时间：20190111010041

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190111010041
SQL开始执行时间：20190111010041
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190111010041
SQL开始执行时间：20190111010041
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190111010041
SQL开始执行时间：20190111010041



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190111010043
SQL开始执行时间：20190111010043


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190111010043
SQL开始执行时间：20190111010043


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190111010043

20190111125823开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190111125823

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190111125824
SQL开始执行时间：20190111125824
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190111125824
SQL开始执行时间：20190111125824
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190111125824
SQL开始执行时间：20190111125824



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190111125824
SQL开始执行时间：20190111125824


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190111125825
SQL开始执行时间：20190111125825


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190111125827

20190112010045开始执行2019-01-11数据加载日志:
SQL开始执行时间：20190112010045

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190112010045
SQL开始执行时间：20190112010045
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190112010045
SQL开始执行时间：20190112010045
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190112010045
SQL开始执行时间：20190112010045



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190112010046
SQL开始执行时间：20190112010046


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190112010046
SQL开始执行时间：20190112010046


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190112010046

20190113010042开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190113010042

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190113010042
SQL开始执行时间：20190113010042
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190113010042
SQL开始执行时间：20190113010042
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190113010042
SQL开始执行时间：20190113010042



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190113010042
SQL开始执行时间：20190113010042


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190113010042
SQL开始执行时间：20190113010042


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190113010042

20190114010040开始执行2019-01-13数据加载日志:
SQL开始执行时间：20190114010040

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190114010040
SQL开始执行时间：20190114010040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190114010040
SQL开始执行时间：20190114010040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190114010040
SQL开始执行时间：20190114010040



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190114010040
SQL开始执行时间：20190114010040


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190114010041
SQL开始执行时间：20190114010041


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190114010041

20190114165225开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190114165225

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190114165225
SQL开始执行时间：20190114165225
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190114165225
SQL开始执行时间：20190114165225
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190114165225
SQL开始执行时间：20190114165225



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190114165225
SQL开始执行时间：20190114165225


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190114165225
SQL开始执行时间：20190114165225


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190114165225

20190115010043开始执行2019-01-14数据加载日志:
SQL开始执行时间：20190115010043

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115010043
SQL开始执行时间：20190115010043
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115010043
SQL开始执行时间：20190115010043
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190115010043
SQL开始执行时间：20190115010043



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190115010045
SQL开始执行时间：20190115010045


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115010046
SQL开始执行时间：20190115010046


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190115010046

20190115085900开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190115085900

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115085900
SQL开始执行时间：20190115085900
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115085900
SQL开始执行时间：20190115085900
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190115085900
SQL开始执行时间：20190115085900



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190115085903
SQL开始执行时间：20190115085903


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115085903
SQL开始执行时间：20190115085903


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190115085903

20190115090348开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190115090348

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115090349
SQL开始执行时间：20190115090349
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115090349
SQL开始执行时间：20190115090349
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190115090349
SQL开始执行时间：20190115090349



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190115090351
SQL开始执行时间：20190115090351


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115090351
SQL开始执行时间：20190115090351


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190115090352

20190115093040开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190115093040

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115093040
SQL开始执行时间：20190115093040
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115093040
SQL开始执行时间：20190115093040
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190115093040
SQL开始执行时间：20190115093040



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190115093043
SQL开始执行时间：20190115093043


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115093043
SQL开始执行时间：20190115093043


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190115093043

20190116010051开始执行2019-01-15数据加载日志:
SQL开始执行时间：20190116010051

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190116010051
SQL开始执行时间：20190116010051
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190116010051
SQL开始执行时间：20190116010051
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190116010051
SQL开始执行时间：20190116010051



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190116010057
SQL开始执行时间：20190116010057


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190116010057
SQL开始执行时间：20190116010057


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190116010057

20190117010043开始执行2019-01-16数据加载日志:
SQL开始执行时间：20190117010043

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117010043
SQL开始执行时间：20190117010043
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117010043
SQL开始执行时间：20190117010043
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190117010043
SQL开始执行时间：20190117010043



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190117010046
SQL开始执行时间：20190117010046


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190117010046
SQL开始执行时间：20190117010046


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190117010046

20190117092656开始执行2019-01-16数据加载日志:
SQL开始执行时间：20190117092656

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117092656
SQL开始执行时间：20190117092656
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117092656
SQL开始执行时间：20190117092656
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190117092656
SQL开始执行时间：20190117092656



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190117092658
SQL开始执行时间：20190117092658


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190117092659
SQL开始执行时间：20190117092659


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190117092659

20190117173727开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190117173727

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117173729
SQL开始执行时间：20190117173729
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117173729
SQL开始执行时间：20190117173729
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190117173729
SQL开始执行时间：20190117173729



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190117173729
SQL开始执行时间：20190117173729


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190117173729
SQL开始执行时间：20190117173729


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190117175601开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190117175601

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117175602
SQL开始执行时间：20190117175602
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117175602
SQL开始执行时间：20190117175602
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190117175602
SQL开始执行时间：20190117175602



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190117175603
SQL开始执行时间：20190117175603


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190117175603
SQL开始执行时间：20190117175603


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190117175606

20190117192013开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190117192013

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117192014
SQL开始执行时间：20190117192014
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117192014
SQL开始执行时间：20190117192014
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190117192014
SQL开始执行时间：20190117192014



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190117192015
SQL开始执行时间：20190117192015


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190117192015
SQL开始执行时间：20190117192015


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190117192017

20190118010044开始执行2019-01-17数据加载日志:
SQL开始执行时间：20190118010044

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118010044
SQL开始执行时间：20190118010044
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118010044
SQL开始执行时间：20190118010044
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190118010044
SQL开始执行时间：20190118010044



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190118010047
SQL开始执行时间：20190118010047


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118010048
SQL开始执行时间：20190118010048


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190118010048

20190118104649开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118104649

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118104650
SQL开始执行时间：20190118104650
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118104651
SQL开始执行时间：20190118104651
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190118104651
SQL开始执行时间：20190118104651



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190118104651
SQL开始执行时间：20190118104651


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118104651
SQL开始执行时间：20190118104651


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190118104656

20190118105130开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118105130

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118105131
SQL开始执行时间：20190118105131
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118105132
SQL开始执行时间：20190118105132
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190118105132
SQL开始执行时间：20190118105132



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190118105132
SQL开始执行时间：20190118105132


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118105132
SQL开始执行时间：20190118105132


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190118105133

20190118105754开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118105754

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118105755
SQL开始执行时间：20190118105755
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118105755
SQL开始执行时间：20190118105755
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190118105755
SQL开始执行时间：20190118105755



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190118105755
SQL开始执行时间：20190118105755


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118105755
SQL开始执行时间：20190118105755


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190118105757

20190118113223开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118113223

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118113224
SQL开始执行时间：20190118113224
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118113224
SQL开始执行时间：20190118113224
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190118113224
SQL开始执行时间：20190118113224



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190118113224
SQL开始执行时间：20190118113224


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118113225
SQL开始执行时间：20190118113225


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190118113226

20190118130216开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118130216

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118130218
SQL开始执行时间：20190118130218
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118130218
SQL开始执行时间：20190118130218
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190118130218
SQL开始执行时间：20190118130218



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190118130218
SQL开始执行时间：20190118130218


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118130218
SQL开始执行时间：20190118130218


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190118130220

20190122165529开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122165529

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122165530
SQL开始执行时间：20190122165530
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122165530
SQL开始执行时间：20190122165530
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190122165530
SQL开始执行时间：20190122165530



delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190122165609
SQL开始执行时间：20190122165609


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122165610
SQL开始执行时间：20190122165610


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190122170325开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122170325

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122170325
SQL开始执行时间：20190122170325
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122170325
SQL开始执行时间：20190122170325
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190122170325
SQL开始执行时间：20190122170325



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190122170518
SQL开始执行时间：20190122170518


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122170518
SQL开始执行时间：20190122170518


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190122172153开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122172153

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122172154
SQL开始执行时间：20190122172154
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122172154
SQL开始执行时间：20190122172154
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190122172154
SQL开始执行时间：20190122172154



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190122172357
SQL开始执行时间：20190122172357


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122172357
SQL开始执行时间：20190122172357


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190122172357

20190123010045开始执行2019-01-22数据加载日志:
SQL开始执行时间：20190123010045

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190123010045
SQL开始执行时间：20190123010045
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190123010045
SQL开始执行时间：20190123010045
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190123010045
SQL开始执行时间：20190123010045



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190123010052
SQL开始执行时间：20190123010052


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190123010052
SQL开始执行时间：20190123010052


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190123010052

20190123153503开始执行2019-01-17数据加载日志:
SQL开始执行时间：20190123153503

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190123153504
SQL开始执行时间：20190123153504
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190123153504
SQL开始执行时间：20190123153504
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190123153504
SQL开始执行时间：20190123153504



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190123160248
SQL开始执行时间：20190123160248


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190123160249
SQL开始执行时间：20190123160249


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190123160250

20190124010047开始执行2019-01-23数据加载日志:
SQL开始执行时间：20190124010047

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190124010047
SQL开始执行时间：20190124010047
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190124010047
SQL开始执行时间：20190124010047
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190124010047
SQL开始执行时间：20190124010047



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190124010053
SQL开始执行时间：20190124010053


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190124010053
SQL开始执行时间：20190124010053


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190124010054

20190125132837开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190125132837

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125132839
SQL开始执行时间：20190125132839
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125132839
SQL开始执行时间：20190125132839
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190125132839
SQL开始执行时间：20190125132839



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;

20190125133507开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190125133507

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125133509
SQL开始执行时间：20190125133509
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125133509
SQL开始执行时间：20190125133509
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190125133509
SQL开始执行时间：20190125133509



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190125133509
SQL开始执行时间：20190125133509


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190125133509
SQL开始执行时间：20190125133509


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190125144622开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190125144622

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125144623
SQL开始执行时间：20190125144623
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125144624
SQL开始执行时间：20190125144624
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190125144624
SQL开始执行时间：20190125144624



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;

20190125150252开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190125150252

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125150253
SQL开始执行时间：20190125150253
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125150253
SQL开始执行时间：20190125150253
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190125150253
SQL开始执行时间：20190125150253



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190125150253
SQL开始执行时间：20190125150253


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190125150254
SQL开始执行时间：20190125150254


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190125150526开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190125150526

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125150528
SQL开始执行时间：20190125150528
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125150528
SQL开始执行时间：20190125150528
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190125150528
SQL开始执行时间：20190125150528



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190125150528
SQL开始执行时间：20190125150528


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190125150528
SQL开始执行时间：20190125150528


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190125150708开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190125150708

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125150709
SQL开始执行时间：20190125150709
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125150709
SQL开始执行时间：20190125150709
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190125150709
SQL开始执行时间：20190125150709



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190125150709
SQL开始执行时间：20190125150709


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190125150710
SQL开始执行时间：20190125150710


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190125150711

20190125151120开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190125151120

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125151122
SQL开始执行时间：20190125151122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125151122
SQL开始执行时间：20190125151122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190125151122
SQL开始执行时间：20190125151122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190125151122
SQL开始执行时间：20190125151122


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190125151122
SQL开始执行时间：20190125151122


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190125151123

20190126010035开始执行2019-01-25数据加载日志:
SQL开始执行时间：20190126010035

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190126010036
SQL开始执行时间：20190126010036
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190126010036
SQL开始执行时间：20190126010036
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190126010036
SQL开始执行时间：20190126010036



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190126010038
SQL开始执行时间：20190126010038


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190126010038
SQL开始执行时间：20190126010038


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190126010038

20190127010034开始执行2019-01-26数据加载日志:
SQL开始执行时间：20190127010034

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190127010034
SQL开始执行时间：20190127010034
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190127010034
SQL开始执行时间：20190127010034
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190127010034
SQL开始执行时间：20190127010034



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190127010034
SQL开始执行时间：20190127010034


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190127010034
SQL开始执行时间：20190127010034


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190127010034

20190128010031开始执行2019-01-27数据加载日志:
SQL开始执行时间：20190128010031

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190128010031
SQL开始执行时间：20190128010031
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190128010031
SQL开始执行时间：20190128010031
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190128010031
SQL开始执行时间：20190128010031



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190128010031
SQL开始执行时间：20190128010031


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190128010031
SQL开始执行时间：20190128010031


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190128010031

20190128133654开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190128133654

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190128133654
SQL开始执行时间：20190128133654
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190128133654
SQL开始执行时间：20190128133654
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190128133654
SQL开始执行时间：20190128133654



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190128133805
SQL开始执行时间：20190128133805


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190128133805
SQL开始执行时间：20190128133805


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190128133806

20190128134602开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190128134602

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190128134603
SQL开始执行时间：20190128134603
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190128134604
SQL开始执行时间：20190128134604
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190128134604
SQL开始执行时间：20190128134604



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190128134604
SQL开始执行时间：20190128134604


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190128134604
SQL开始执行时间：20190128134604


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190128134605

20190129010035开始执行2019-01-28数据加载日志:
SQL开始执行时间：20190129010035

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129010035
SQL开始执行时间：20190129010035
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129010035
SQL开始执行时间：20190129010035
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190129010035
SQL开始执行时间：20190129010035



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190129010041
SQL开始执行时间：20190129010041


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190129010041
SQL开始执行时间：20190129010041


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190129010041

20190129094252开始执行2019-01-29数据加载日志:
SQL开始执行时间：20190129094252

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129094252
SQL开始执行时间：20190129094252
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129094252
SQL开始执行时间：20190129094252
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190129094252
SQL开始执行时间：20190129094252



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190129094253
SQL开始执行时间：20190129094253


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190129094253
SQL开始执行时间：20190129094253


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190129094253
SQL开始执行时间：20190129094253

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190129094255

20190129094426开始执行2019-01-28数据加载日志:
SQL开始执行时间：20190129094426

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129094426
SQL开始执行时间：20190129094426
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129094426
SQL开始执行时间：20190129094426
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190129094426
SQL开始执行时间：20190129094426



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190129094456
SQL开始执行时间：20190129094456


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190129094457
SQL开始执行时间：20190129094457


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190129094457
SQL开始执行时间：20190129094457

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190129094458

20190129114002开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190129114002

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129114004
SQL开始执行时间：20190129114004
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129114004
SQL开始执行时间：20190129114004
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190129114004
SQL开始执行时间：20190129114004



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;

20190130010708开始执行2019-01-29数据加载日志:
SQL开始执行时间：20190130010708

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190130010708
SQL开始执行时间：20190130010708
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190130010708
SQL开始执行时间：20190130010708
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190130010708
SQL开始执行时间：20190130010708



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190130010719
SQL开始执行时间：20190130010719


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190130010720
SQL开始执行时间：20190130010720


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190130010720
SQL开始执行时间：20190130010720

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190130010722

20190131010735开始执行2019-01-30数据加载日志:
SQL开始执行时间：20190131010735

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190131010735
SQL开始执行时间：20190131010735
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190131010735
SQL开始执行时间：20190131010735
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190131010735
SQL开始执行时间：20190131010735



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190131010746
SQL开始执行时间：20190131010746


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190131010746
SQL开始执行时间：20190131010746


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190131010746
SQL开始执行时间：20190131010746

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190131010748

20190201010708开始执行2019-01-31数据加载日志:
SQL开始执行时间：20190201010708

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190201010708
SQL开始执行时间：20190201010708
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190201010708
SQL开始执行时间：20190201010708
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190201010708
SQL开始执行时间：20190201010708



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190201010710
SQL开始执行时间：20190201010710


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190201010710
SQL开始执行时间：20190201010710


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190201010710
SQL开始执行时间：20190201010710

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190201010712

20190202010720开始执行2019-02-01数据加载日志:
SQL开始执行时间：20190202010720

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190202010720
SQL开始执行时间：20190202010720
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190202010720
SQL开始执行时间：20190202010720
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190202010720
SQL开始执行时间：20190202010720



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190202010722
SQL开始执行时间：20190202010722


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190202010722
SQL开始执行时间：20190202010722


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190202010722
SQL开始执行时间：20190202010722

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190202010724

20190203010714开始执行2019-02-02数据加载日志:
SQL开始执行时间：20190203010714

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190203010715
SQL开始执行时间：20190203010715
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190203010715
SQL开始执行时间：20190203010715
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190203010715
SQL开始执行时间：20190203010715



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190203010717
SQL开始执行时间：20190203010717


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190203010717
SQL开始执行时间：20190203010717


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190203010717
SQL开始执行时间：20190203010717

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190203010719

20190204010711开始执行2019-02-03数据加载日志:
SQL开始执行时间：20190204010711

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190204010711
SQL开始执行时间：20190204010711
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190204010711
SQL开始执行时间：20190204010711
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190204010711
SQL开始执行时间：20190204010711



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190204010712
SQL开始执行时间：20190204010712


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190204010712
SQL开始执行时间：20190204010712


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190204010712
SQL开始执行时间：20190204010712

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190204010715

20190205010708开始执行2019-02-04数据加载日志:
SQL开始执行时间：20190205010708

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190205010708
SQL开始执行时间：20190205010708
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190205010708
SQL开始执行时间：20190205010708
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190205010708
SQL开始执行时间：20190205010708



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190205010709
SQL开始执行时间：20190205010709


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190205010709
SQL开始执行时间：20190205010709


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190205010709
SQL开始执行时间：20190205010709

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190205010711

20190206010715开始执行2019-02-05数据加载日志:
SQL开始执行时间：20190206010715

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190206010715
SQL开始执行时间：20190206010715
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190206010715
SQL开始执行时间：20190206010715
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190206010715
SQL开始执行时间：20190206010715



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190206010717
SQL开始执行时间：20190206010717


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190206010717
SQL开始执行时间：20190206010717


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190206010717
SQL开始执行时间：20190206010717

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190206010719

20190207010718开始执行2019-02-06数据加载日志:
SQL开始执行时间：20190207010718

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190207010718
SQL开始执行时间：20190207010718
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190207010718
SQL开始执行时间：20190207010718
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190207010718
SQL开始执行时间：20190207010718



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190207010720
SQL开始执行时间：20190207010720


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190207010720
SQL开始执行时间：20190207010720


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190207010720
SQL开始执行时间：20190207010720

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190207010722

20190208010715开始执行2019-02-07数据加载日志:
SQL开始执行时间：20190208010715

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190208010715
SQL开始执行时间：20190208010715
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190208010715
SQL开始执行时间：20190208010715
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190208010715
SQL开始执行时间：20190208010715



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190208010716
SQL开始执行时间：20190208010716


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190208010716
SQL开始执行时间：20190208010716


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190208010716
SQL开始执行时间：20190208010716

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190208010719

20190209010716开始执行2019-02-08数据加载日志:
SQL开始执行时间：20190209010716

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190209010717
SQL开始执行时间：20190209010717
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190209010717
SQL开始执行时间：20190209010717
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190209010717
SQL开始执行时间：20190209010717



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190209010718
SQL开始执行时间：20190209010718


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190209010718
SQL开始执行时间：20190209010718


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190209010718
SQL开始执行时间：20190209010718

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190209010720

20190210010711开始执行2019-02-09数据加载日志:
SQL开始执行时间：20190210010711

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190210010711
SQL开始执行时间：20190210010711
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190210010711
SQL开始执行时间：20190210010711
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190210010711
SQL开始执行时间：20190210010711



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190210010712
SQL开始执行时间：20190210010712


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190210010713
SQL开始执行时间：20190210010713


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190210010713
SQL开始执行时间：20190210010713

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190210010715

20190211010707开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190211010707

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190211010707
SQL开始执行时间：20190211010707
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190211010707
SQL开始执行时间：20190211010707
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190211010707
SQL开始执行时间：20190211010707



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190211010708
SQL开始执行时间：20190211010708


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190211010709
SQL开始执行时间：20190211010709


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190211010709
SQL开始执行时间：20190211010709

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190211010711

20190211110218开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190211110218

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190211110218
SQL开始执行时间：20190211110218
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190211110218
SQL开始执行时间：20190211110218
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190211110218
SQL开始执行时间：20190211110218



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190211110351
SQL开始执行时间：20190211110351


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190211110352
SQL开始执行时间：20190211110352


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190211110352
SQL开始执行时间：20190211110352

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190211110354

20190211112232开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190211112232

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190211112232
SQL开始执行时间：20190211112232
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190211112232
SQL开始执行时间：20190211112232
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190211112232
SQL开始执行时间：20190211112232



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190211112405
SQL开始执行时间：20190211112405


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190211112405
SQL开始执行时间：20190211112405


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190211112406
SQL开始执行时间：20190211112406

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190211112408

20190212010714开始执行2019-02-11数据加载日志:
SQL开始执行时间：20190212010714

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190212010714
SQL开始执行时间：20190212010714
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190212010714
SQL开始执行时间：20190212010714
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190212010714
SQL开始执行时间：20190212010714



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190212010723
SQL开始执行时间：20190212010723


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190212010723
SQL开始执行时间：20190212010723


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190212010723
SQL开始执行时间：20190212010723

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190212010725

20190213010726开始执行2019-02-12数据加载日志:
SQL开始执行时间：20190213010726

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190213010726
SQL开始执行时间：20190213010726
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190213010726
SQL开始执行时间：20190213010726
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190213010726
SQL开始执行时间：20190213010726



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190213010742
SQL开始执行时间：20190213010742


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190213010743
SQL开始执行时间：20190213010743


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190213110948开始执行2019-02-12数据加载日志:
SQL开始执行时间：20190213110948

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190213110948
SQL开始执行时间：20190213110948
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190213110948
SQL开始执行时间：20190213110948
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190213110948
SQL开始执行时间：20190213110948



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190213111004
SQL开始执行时间：20190213111004


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190213111004
SQL开始执行时间：20190213111004


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190213111004
SQL开始执行时间：20190213111004

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190213111015

20190214010729开始执行2019-02-13数据加载日志:
SQL开始执行时间：20190214010729

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190214010729
SQL开始执行时间：20190214010729
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190214010729
SQL开始执行时间：20190214010729
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190214010729
SQL开始执行时间：20190214010729



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190214010735
SQL开始执行时间：20190214010735


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190214010735
SQL开始执行时间：20190214010735


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190214010736
SQL开始执行时间：20190214010736

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190214010746

20190215010724开始执行2019-02-14数据加载日志:
SQL开始执行时间：20190215010724

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190215010724
SQL开始执行时间：20190215010724
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190215010724
SQL开始执行时间：20190215010724
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190215010724
SQL开始执行时间：20190215010724



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190215010733
SQL开始执行时间：20190215010733


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190215010734
SQL开始执行时间：20190215010734


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190215010734
SQL开始执行时间：20190215010734

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190215010744

20190215175858开始执行2019-02-14数据加载日志:
SQL开始执行时间：20190215175858

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190215175858
SQL开始执行时间：20190215175858
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190215175858
SQL开始执行时间：20190215175858
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190215175858
SQL开始执行时间：20190215175858



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190215175914
SQL开始执行时间：20190215175914


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190215175915
SQL开始执行时间：20190215175915


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190215175915
SQL开始执行时间：20190215175915

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190215175925

20190216010743开始执行2019-02-15数据加载日志:
SQL开始执行时间：20190216010743

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190216010743
SQL开始执行时间：20190216010743
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190216010743
SQL开始执行时间：20190216010743
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190216010743
SQL开始执行时间：20190216010743



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190216010750
SQL开始执行时间：20190216010750


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190216010751
SQL开始执行时间：20190216010751


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190216010751
SQL开始执行时间：20190216010751

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190216010802

20190217010720开始执行2019-02-16数据加载日志:
SQL开始执行时间：20190217010720

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190217010720
SQL开始执行时间：20190217010720
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190217010720
SQL开始执行时间：20190217010720
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190217010720
SQL开始执行时间：20190217010720



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190217010724
SQL开始执行时间：20190217010724


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190217010724
SQL开始执行时间：20190217010724


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190217010724
SQL开始执行时间：20190217010724

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190217010735

20190218010736开始执行2019-02-17数据加载日志:
SQL开始执行时间：20190218010736

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190218010736
SQL开始执行时间：20190218010736
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190218010736
SQL开始执行时间：20190218010736
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190218010736
SQL开始执行时间：20190218010736



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190218010739
SQL开始执行时间：20190218010739


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190218010740
SQL开始执行时间：20190218010740


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190218010740
SQL开始执行时间：20190218010740

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190218010751

20190219010742开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190219010742

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190219010742
SQL开始执行时间：20190219010742
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190219010742
SQL开始执行时间：20190219010742
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190219010742
SQL开始执行时间：20190219010742



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190219010801
SQL开始执行时间：20190219010801


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190219010801
SQL开始执行时间：20190219010801


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190219010801
SQL开始执行时间：20190219010801

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190219010812

20190219110412开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190219110412

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190219110412
SQL开始执行时间：20190219110412
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190219110412
SQL开始执行时间：20190219110412
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190219110412
SQL开始执行时间：20190219110412



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190219110629
SQL开始执行时间：20190219110629


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190219110629
SQL开始执行时间：20190219110629


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190219110800开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190219110800

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190219110800
SQL开始执行时间：20190219110800
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190219110800
SQL开始执行时间：20190219110800
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190219110800
SQL开始执行时间：20190219110800



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190219111017
SQL开始执行时间：20190219111017


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190219111017
SQL开始执行时间：20190219111017


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190219111017
SQL开始执行时间：20190219111017

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190219111029

20190220010739开始执行2019-02-19数据加载日志:
SQL开始执行时间：20190220010739

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220010739
SQL开始执行时间：20190220010739
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220010739
SQL开始执行时间：20190220010739
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190220010739
SQL开始执行时间：20190220010739



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190220010801
SQL开始执行时间：20190220010801


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190220010801
SQL开始执行时间：20190220010801


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190220010801
SQL开始执行时间：20190220010801

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190220010813

20190220101002开始执行2019-02-20数据加载日志:
SQL开始执行时间：20190220101002

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220101002
SQL开始执行时间：20190220101002
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220101002
SQL开始执行时间：20190220101002
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190220101002
SQL开始执行时间：20190220101002



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190220101002
SQL开始执行时间：20190220101002


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190220101002
SQL开始执行时间：20190220101002


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190220101002
SQL开始执行时间：20190220101002

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190220101014

20190220101348开始执行2019-02-20数据加载日志:
SQL开始执行时间：20190220101348

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220101348
SQL开始执行时间：20190220101348
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220101348
SQL开始执行时间：20190220101348
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190220101348
SQL开始执行时间：20190220101348



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190220101348
SQL开始执行时间：20190220101348


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190220101348
SQL开始执行时间：20190220101348


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190220101348
SQL开始执行时间：20190220101348

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190220101400

20190220101441开始执行2019-02-19数据加载日志:
SQL开始执行时间：20190220101441

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220101441
SQL开始执行时间：20190220101441
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220101441
SQL开始执行时间：20190220101441
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190220101441
SQL开始执行时间：20190220101441



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190220101503
SQL开始执行时间：20190220101503


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190220101503
SQL开始执行时间：20190220101503


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190220101503
SQL开始执行时间：20190220101503

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190220101514

20190220101627开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190220101627

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220101627
SQL开始执行时间：20190220101627
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220101627
SQL开始执行时间：20190220101627
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190220101627
SQL开始执行时间：20190220101627



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190220101858
SQL开始执行时间：20190220101858


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190220101858
SQL开始执行时间：20190220101858


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190220101858
SQL开始执行时间：20190220101858

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190220101909

20190221010745开始执行2019-02-20数据加载日志:
SQL开始执行时间：20190221010745

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190221010745
SQL开始执行时间：20190221010745
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190221010745
SQL开始执行时间：20190221010745
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190221010745
SQL开始执行时间：20190221010745



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190221010801
SQL开始执行时间：20190221010801


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190221010802
SQL开始执行时间：20190221010802


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190221010802
SQL开始执行时间：20190221010802

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190221010816

20190222010749开始执行2019-02-21数据加载日志:
SQL开始执行时间：20190222010749

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190222010749
SQL开始执行时间：20190222010749
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190222010749
SQL开始执行时间：20190222010749
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190222010749
SQL开始执行时间：20190222010749



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190222010801
SQL开始执行时间：20190222010801


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190222010801
SQL开始执行时间：20190222010801


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190222010802
SQL开始执行时间：20190222010802

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190222010815

20190223010745开始执行2019-02-22数据加载日志:
SQL开始执行时间：20190223010745

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190223010745
SQL开始执行时间：20190223010745
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190223010745
SQL开始执行时间：20190223010745
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190223010745
SQL开始执行时间：20190223010745



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190223010758
SQL开始执行时间：20190223010758


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190223010758
SQL开始执行时间：20190223010758


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190223010758
SQL开始执行时间：20190223010758

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190223010812

20190224010739开始执行2019-02-23数据加载日志:
SQL开始执行时间：20190224010739

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190224010739
SQL开始执行时间：20190224010739
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190224010739
SQL开始执行时间：20190224010739
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190224010739
SQL开始执行时间：20190224010739



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190224010744
SQL开始执行时间：20190224010744


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190224010744
SQL开始执行时间：20190224010744


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190224010744
SQL开始执行时间：20190224010744

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190224010758

20190225010747开始执行2019-02-24数据加载日志:
SQL开始执行时间：20190225010747

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190225010747
SQL开始执行时间：20190225010747
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190225010747
SQL开始执行时间：20190225010747
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190225010747
SQL开始执行时间：20190225010747



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190225010751
SQL开始执行时间：20190225010751


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190225010752
SQL开始执行时间：20190225010752


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190225010752
SQL开始执行时间：20190225010752

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190225010806

20190226010803开始执行2019-02-25数据加载日志:
SQL开始执行时间：20190226010803

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190226010803
SQL开始执行时间：20190226010803
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190226010803
SQL开始执行时间：20190226010803
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190226010803
SQL开始执行时间：20190226010803



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190226010819
SQL开始执行时间：20190226010819


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190226010819
SQL开始执行时间：20190226010819


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190226010820
SQL开始执行时间：20190226010820

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190226010831

20190227010829开始执行2019-02-26数据加载日志:
SQL开始执行时间：20190227010829

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190227010830
SQL开始执行时间：20190227010830
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190227010830
SQL开始执行时间：20190227010830
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190227010830
SQL开始执行时间：20190227010830



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190227010902
SQL开始执行时间：20190227010902


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190227010902
SQL开始执行时间：20190227010902


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190227010902
SQL开始执行时间：20190227010902

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190227010916

20190228010758开始执行2019-02-27数据加载日志:
SQL开始执行时间：20190228010758

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190228010759
SQL开始执行时间：20190228010759
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190228010759
SQL开始执行时间：20190228010759
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190228010759
SQL开始执行时间：20190228010759



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190228010816
SQL开始执行时间：20190228010816


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190228010816
SQL开始执行时间：20190228010816


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190228010816
SQL开始执行时间：20190228010816

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190228010831

20190301010817开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301010817

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301010817
SQL开始执行时间：20190301010817
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301010817
SQL开始执行时间：20190301010817
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190301010817
SQL开始执行时间：20190301010817



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190301010847
SQL开始执行时间：20190301010847


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301010847
SQL开始执行时间：20190301010847


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190301090321开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301090321

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;

20190301091303开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301091303

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301091303
SQL开始执行时间：20190301091303
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301091303
SQL开始执行时间：20190301091303
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190301091303
SQL开始执行时间：20190301091303



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190301091515
SQL开始执行时间：20190301091515


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301091515
SQL开始执行时间：20190301091515


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190301091856开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301091856

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301091857
SQL开始执行时间：20190301091857
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301091857
SQL开始执行时间：20190301091857
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190301091857
SQL开始执行时间：20190301091857



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190301092108
SQL开始执行时间：20190301092108


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301092108
SQL开始执行时间：20190301092108


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190301093859开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301093859

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301093900
SQL开始执行时间：20190301093900
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301093900
SQL开始执行时间：20190301093900
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190301093900
SQL开始执行时间：20190301093900



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190301094110
SQL开始执行时间：20190301094110


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301094111
SQL开始执行时间：20190301094111


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190301094111
SQL开始执行时间：20190301094111

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190301094126

20190301112551开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301112551

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301112552
SQL开始执行时间：20190301112552
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301112553
SQL开始执行时间：20190301112553
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190301112553
SQL开始执行时间：20190301112553



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190301112553
SQL开始执行时间：20190301112553


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301112553
SQL开始执行时间：20190301112553


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190301112555
SQL开始执行时间：20190301112555

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190301112600

20190301112829开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301112829

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301112831
SQL开始执行时间：20190301112831
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301112831
SQL开始执行时间：20190301112831
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190301112831
SQL开始执行时间：20190301112831



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190301112831
SQL开始执行时间：20190301112831


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301112831
SQL开始执行时间：20190301112831


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190301112832
SQL开始执行时间：20190301112832

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190301112838

20190302010806开始执行2019-03-01数据加载日志:
SQL开始执行时间：20190302010806

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190302010806
SQL开始执行时间：20190302010806
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190302010806
SQL开始执行时间：20190302010806
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190302010806
SQL开始执行时间：20190302010806



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190302010817
SQL开始执行时间：20190302010817


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190302010817
SQL开始执行时间：20190302010817


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190302010817
SQL开始执行时间：20190302010817

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190302010832

20190303010808开始执行2019-03-02数据加载日志:
SQL开始执行时间：20190303010808

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190303010808
SQL开始执行时间：20190303010808
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190303010808
SQL开始执行时间：20190303010808
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190303010808
SQL开始执行时间：20190303010808



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190303010813
SQL开始执行时间：20190303010813


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190303010814
SQL开始执行时间：20190303010814


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190303010814
SQL开始执行时间：20190303010814

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190303010828

20190304010803开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190304010803

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190304010803
SQL开始执行时间：20190304010803
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190304010803
SQL开始执行时间：20190304010803
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190304010803
SQL开始执行时间：20190304010803



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190304010809
SQL开始执行时间：20190304010809


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190304010809
SQL开始执行时间：20190304010809


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190304010809
SQL开始执行时间：20190304010809

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190304010824

20190304161344开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190304161344

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190304161344
SQL开始执行时间：20190304161344
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190304161344
SQL开始执行时间：20190304161344
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190304161344
SQL开始执行时间：20190304161344



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190304161354
SQL开始执行时间：20190304161354


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190304161355
SQL开始执行时间：20190304161355


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190304161355
SQL开始执行时间：20190304161355

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190304161410

20190305010821开始执行2019-03-04数据加载日志:
SQL开始执行时间：20190305010821

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190305010821
SQL开始执行时间：20190305010821
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190305010821
SQL开始执行时间：20190305010821
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190305010821
SQL开始执行时间：20190305010821



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190305010833
SQL开始执行时间：20190305010833


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190305010834
SQL开始执行时间：20190305010834


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190305010834
SQL开始执行时间：20190305010834

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190305010849

20190306010815开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190306010815

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190306010816
SQL开始执行时间：20190306010816
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190306010816
SQL开始执行时间：20190306010816
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190306010816
SQL开始执行时间：20190306010816



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190306010844
SQL开始执行时间：20190306010844


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190306010844
SQL开始执行时间：20190306010844


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190306010844
SQL开始执行时间：20190306010844

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190306010911

20190306180232开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190306180232

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190306180232
SQL开始执行时间：20190306180232
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190306180232
SQL开始执行时间：20190306180232
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190306180232
SQL开始执行时间：20190306180232



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190306180718
SQL开始执行时间：20190306180718


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190306180718
SQL开始执行时间：20190306180718


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190306180718
SQL开始执行时间：20190306180718

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190306180746

20190307010827开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190307010827

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190307010827
SQL开始执行时间：20190307010827
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190307010827
SQL开始执行时间：20190307010827
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190307010827
SQL开始执行时间：20190307010827



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190307010847
SQL开始执行时间：20190307010847


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190307010847
SQL开始执行时间：20190307010847


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190307010847
SQL开始执行时间：20190307010847

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190307010916

20190307172818开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190307172818

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190307172818
SQL开始执行时间：20190307172818
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190307172818
SQL开始执行时间：20190307172818
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190307172818
SQL开始执行时间：20190307172818



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190307173307
SQL开始执行时间：20190307173307


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190307173307
SQL开始执行时间：20190307173307


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190307173308
SQL开始执行时间：20190307173308

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190307173336

20190308010828开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308010828

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190308010828
SQL开始执行时间：20190308010828
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190308010828
SQL开始执行时间：20190308010828
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190308010828
SQL开始执行时间：20190308010828



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190308010851
SQL开始执行时间：20190308010851


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190308010851
SQL开始执行时间：20190308010851


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190308010851
SQL开始执行时间：20190308010851

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190308010920

20190308170837开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308170837

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190308170837
SQL开始执行时间：20190308170837
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190308170837
SQL开始执行时间：20190308170837
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190308170837
SQL开始执行时间：20190308170837



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190308170909
SQL开始执行时间：20190308170909


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190308170909
SQL开始执行时间：20190308170909


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190308170909
SQL开始执行时间：20190308170909

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190308170940

20190309010838开始执行2019-03-08数据加载日志:
SQL开始执行时间：20190309010838

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190309010838
SQL开始执行时间：20190309010838
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190309010838
SQL开始执行时间：20190309010838
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190309010838
SQL开始执行时间：20190309010838



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190309010858
SQL开始执行时间：20190309010858


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190309010859
SQL开始执行时间：20190309010859


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190309010859
SQL开始执行时间：20190309010859

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190309010927

20190309170832开始执行2019-03-08数据加载日志:
SQL开始执行时间：20190309170832

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190309170832
SQL开始执行时间：20190309170832
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190309170832
SQL开始执行时间：20190309170832
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190309170832
SQL开始执行时间：20190309170832



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190309170852
SQL开始执行时间：20190309170852


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190309170853
SQL开始执行时间：20190309170853


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190309170853
SQL开始执行时间：20190309170853

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190309170921

20190310010836开始执行2019-03-09数据加载日志:
SQL开始执行时间：20190310010836

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190310010837
SQL开始执行时间：20190310010837
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190310010837
SQL开始执行时间：20190310010837
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190310010837
SQL开始执行时间：20190310010837



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190310010849
SQL开始执行时间：20190310010849


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190310010849
SQL开始执行时间：20190310010849


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190310010849
SQL开始执行时间：20190310010849

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190310010918

20190310170825开始执行2019-03-09数据加载日志:
SQL开始执行时间：20190310170825

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190310170825
SQL开始执行时间：20190310170825
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190310170825
SQL开始执行时间：20190310170825
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190310170825
SQL开始执行时间：20190310170825



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190310170838
SQL开始执行时间：20190310170838


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190310170838
SQL开始执行时间：20190310170838


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190310170838
SQL开始执行时间：20190310170838

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190310170907

20190311010833开始执行2019-03-10数据加载日志:
SQL开始执行时间：20190311010833

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190311010833
SQL开始执行时间：20190311010833
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190311010833
SQL开始执行时间：20190311010833
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190311010833
SQL开始执行时间：20190311010833



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190311010846
SQL开始执行时间：20190311010846


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190311010846
SQL开始执行时间：20190311010846


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190311010846
SQL开始执行时间：20190311010846

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190311010914

20190311170842开始执行2019-03-10数据加载日志:
SQL开始执行时间：20190311170842

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190311170843
SQL开始执行时间：20190311170843
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190311170843
SQL开始执行时间：20190311170843
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190311170843
SQL开始执行时间：20190311170843



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190311170913
SQL开始执行时间：20190311170913


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190311170914
SQL开始执行时间：20190311170914


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190311170914
SQL开始执行时间：20190311170914

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190311170943

20190312010852开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312010852

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190312010852
SQL开始执行时间：20190312010852
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190312010852
SQL开始执行时间：20190312010852
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190312010852
SQL开始执行时间：20190312010852



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190312010923
SQL开始执行时间：20190312010923


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190312010924
SQL开始执行时间：20190312010924


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190312010924
SQL开始执行时间：20190312010924

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190312010952

20190312092155开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312092155

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190312092155
SQL开始执行时间：20190312092155
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190312092155
SQL开始执行时间：20190312092155
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190312092155
SQL开始执行时间：20190312092155



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190312092234
SQL开始执行时间：20190312092234


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190312092234
SQL开始执行时间：20190312092234


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190312092234
SQL开始执行时间：20190312092234

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190312092303

20190312170904开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312170904

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190312170905
SQL开始执行时间：20190312170905
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190312170905
SQL开始执行时间：20190312170905
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190312170905
SQL开始执行时间：20190312170905



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190312170955
SQL开始执行时间：20190312170955


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190312170955
SQL开始执行时间：20190312170955


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190312170956
SQL开始执行时间：20190312170956

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190312171024

20190313010847开始执行2019-03-12数据加载日志:
SQL开始执行时间：20190313010847

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190313010847
SQL开始执行时间：20190313010847
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190313010847
SQL开始执行时间：20190313010847
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190313010847
SQL开始执行时间：20190313010847



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190313010918
SQL开始执行时间：20190313010918


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190313010918
SQL开始执行时间：20190313010918


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190313010919
SQL开始执行时间：20190313010919

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190313010948

20190313170858开始执行2019-03-12数据加载日志:
SQL开始执行时间：20190313170858

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190313170858
SQL开始执行时间：20190313170858
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190313170858
SQL开始执行时间：20190313170858
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190313170858
SQL开始执行时间：20190313170858



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190313170937
SQL开始执行时间：20190313170937


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190313170937
SQL开始执行时间：20190313170937


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190313170937
SQL开始执行时间：20190313170937

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190313171006

20190314010854开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314010854

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314010854
SQL开始执行时间：20190314010854
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314010854
SQL开始执行时间：20190314010854
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190314010854
SQL开始执行时间：20190314010854



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190314010919
SQL开始执行时间：20190314010919


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190314010920
SQL开始执行时间：20190314010920


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190314010920
SQL开始执行时间：20190314010920

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190314010949

20190314182859开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314182859

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314182859
SQL开始执行时间：20190314182859
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314182859
SQL开始执行时间：20190314182859
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190314182859
SQL开始执行时间：20190314182859



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190314182912
SQL开始执行时间：20190314182912


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190314182913
SQL开始执行时间：20190314182913


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190314183141开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314183141

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314183141
SQL开始执行时间：20190314183141
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314183141
SQL开始执行时间：20190314183141
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190314183141
SQL开始执行时间：20190314183141



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190314183155
SQL开始执行时间：20190314183155


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190314183155
SQL开始执行时间：20190314183155


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190314183254开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314183254

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314183255
SQL开始执行时间：20190314183255
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314183255
SQL开始执行时间：20190314183255
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190314183255
SQL开始执行时间：20190314183255



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190314183308
SQL开始执行时间：20190314183308


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;

20190314183349开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314183349

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314183350
SQL开始执行时间：20190314183350
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314183350
SQL开始执行时间：20190314183350
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190314183350
SQL开始执行时间：20190314183350



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190314183403
SQL开始执行时间：20190314183403


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190314183403
SQL开始执行时间：20190314183403


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190314183403
SQL开始执行时间：20190314183403

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190314183433

20190315010846开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315010846

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190315010846
SQL开始执行时间：20190315010846
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190315010846
SQL开始执行时间：20190315010846
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190315010846
SQL开始执行时间：20190315010846



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190315010908
SQL开始执行时间：20190315010908


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190315010908
SQL开始执行时间：20190315010908


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190315010908
SQL开始执行时间：20190315010908

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190315010938

20190315112250开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315112250

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190315112250
SQL开始执行时间：20190315112250
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190315112250
SQL开始执行时间：20190315112250
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190315112250
SQL开始执行时间：20190315112250



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190315112844
SQL开始执行时间：20190315112844


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190315112845
SQL开始执行时间：20190315112845


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190315112845
SQL开始执行时间：20190315112845

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190315112915

20190315170902开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315170902

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190315170903
SQL开始执行时间：20190315170903
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190315170903
SQL开始执行时间：20190315170903
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190315170903
SQL开始执行时间：20190315170903



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190315171500
SQL开始执行时间：20190315171500


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190315171501
SQL开始执行时间：20190315171501


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190315171501
SQL开始执行时间：20190315171501

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190315171531

20190316010900开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316010900

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190316010900
SQL开始执行时间：20190316010900
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190316010900
SQL开始执行时间：20190316010900
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190316010900
SQL开始执行时间：20190316010900



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190316010926
SQL开始执行时间：20190316010926


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190316010926
SQL开始执行时间：20190316010926


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190316010926
SQL开始执行时间：20190316010926

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190316010956

20190316170909开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316170909

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190316170909
SQL开始执行时间：20190316170909
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190316170909
SQL开始执行时间：20190316170909
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190316170909
SQL开始执行时间：20190316170909



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190316170935
SQL开始执行时间：20190316170935


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190316170936
SQL开始执行时间：20190316170936


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190316170936
SQL开始执行时间：20190316170936

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190316171005

20190317010840开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317010840

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190317010840
SQL开始执行时间：20190317010840
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190317010840
SQL开始执行时间：20190317010840
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190317010840
SQL开始执行时间：20190317010840



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190317010853
SQL开始执行时间：20190317010853


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190317010853
SQL开始执行时间：20190317010853


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190317010854
SQL开始执行时间：20190317010854

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190317010923

20190317170851开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317170851

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190317170851
SQL开始执行时间：20190317170851
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190317170851
SQL开始执行时间：20190317170851
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190317170851
SQL开始执行时间：20190317170851



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190317170904
SQL开始执行时间：20190317170904


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190317170905
SQL开始执行时间：20190317170905


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190317170905
SQL开始执行时间：20190317170905

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190317170934

20190318010843开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318010843

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190318010843
SQL开始执行时间：20190318010843
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190318010843
SQL开始执行时间：20190318010843
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190318010843
SQL开始执行时间：20190318010843



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190318010856
SQL开始执行时间：20190318010856


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190318010857
SQL开始执行时间：20190318010857


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190318010857
SQL开始执行时间：20190318010857

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190318010926

20190318100844开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318100844

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190318100844
SQL开始执行时间：20190318100844
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190318100844
SQL开始执行时间：20190318100844
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190318100844
SQL开始执行时间：20190318100844



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190318100910
SQL开始执行时间：20190318100910


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190318100910
SQL开始执行时间：20190318100910


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190318100911
SQL开始执行时间：20190318100911

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190318100940

20190318170851开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318170851

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190318170851
SQL开始执行时间：20190318170851
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190318170851
SQL开始执行时间：20190318170851
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190318170851
SQL开始执行时间：20190318170851



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190318170924
SQL开始执行时间：20190318170924


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190318170924
SQL开始执行时间：20190318170924


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190318170924
SQL开始执行时间：20190318170924

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190318170953

20190319010850开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319010850

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190319010850
SQL开始执行时间：20190319010850
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190319010850
SQL开始执行时间：20190319010850
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190319010850
SQL开始执行时间：20190319010850



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190319010911
SQL开始执行时间：20190319010911


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190319010911
SQL开始执行时间：20190319010911


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190319010912
SQL开始执行时间：20190319010912

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190319010941

20190319113605开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190319113605

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190319113606
SQL开始执行时间：20190319113606
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190319113607
SQL开始执行时间：20190319113607
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190319113607
SQL开始执行时间：20190319113607



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190319113607
SQL开始执行时间：20190319113607


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190319113607
SQL开始执行时间：20190319113607


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190319113608
SQL开始执行时间：20190319113608

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190319113619

20190319170051开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319170051

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190319170052
SQL开始执行时间：20190319170052
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190319170052
SQL开始执行时间：20190319170052
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190319170052
SQL开始执行时间：20190319170052



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190319170119
SQL开始执行时间：20190319170119


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190319170119
SQL开始执行时间：20190319170119


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190319170119
SQL开始执行时间：20190319170119

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190319170149

20190320010854开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320010854

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190320010855
SQL开始执行时间：20190320010855
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190320010855
SQL开始执行时间：20190320010855
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190320010855
SQL开始执行时间：20190320010855



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190320010919
SQL开始执行时间：20190320010919


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190320010919
SQL开始执行时间：20190320010919


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190320010919
SQL开始执行时间：20190320010919

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190320010949

20190320170904开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320170904

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190320170904
SQL开始执行时间：20190320170904
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190320170904
SQL开始执行时间：20190320170904
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190320170904
SQL开始执行时间：20190320170904



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190320170939
SQL开始执行时间：20190320170939


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190320170939
SQL开始执行时间：20190320170939


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190320170940
SQL开始执行时间：20190320170940

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190320171009

20190321010906开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321010906

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190321010906
SQL开始执行时间：20190321010906
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190321010906
SQL开始执行时间：20190321010906
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190321010906
SQL开始执行时间：20190321010906



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190321010934
SQL开始执行时间：20190321010934


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190321010934
SQL开始执行时间：20190321010934


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190321010934
SQL开始执行时间：20190321010934

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190321011003

20190321170912开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321170912

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190321170912
SQL开始执行时间：20190321170912
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190321170912
SQL开始执行时间：20190321170912
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190321170912
SQL开始执行时间：20190321170912



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190321170948
SQL开始执行时间：20190321170948


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190321170948
SQL开始执行时间：20190321170948


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190321170949
SQL开始执行时间：20190321170949

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190321171019

20190322010904开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322010904

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190322010904
SQL开始执行时间：20190322010904
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190322010904
SQL开始执行时间：20190322010904
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190322010904
SQL开始执行时间：20190322010904



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190322010932
SQL开始执行时间：20190322010932


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190322010932
SQL开始执行时间：20190322010932


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190322010932
SQL开始执行时间：20190322010932

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190322011004

20190322170914开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322170914

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190322170914
SQL开始执行时间：20190322170914
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190322170914
SQL开始执行时间：20190322170914
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190322170914
SQL开始执行时间：20190322170914



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190322170947
SQL开始执行时间：20190322170947


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190322170948
SQL开始执行时间：20190322170948


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190322170948
SQL开始执行时间：20190322170948

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190322171019

20190323010906开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323010906

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190323010906
SQL开始执行时间：20190323010906
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190323010906
SQL开始执行时间：20190323010906
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190323010906
SQL开始执行时间：20190323010906



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190323010932
SQL开始执行时间：20190323010932


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190323010932
SQL开始执行时间：20190323010932


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190323010932
SQL开始执行时间：20190323010932

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190323011003

20190323170935开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323170935

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190323170935
SQL开始执行时间：20190323170935
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190323170935
SQL开始执行时间：20190323170935
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190323170935
SQL开始执行时间：20190323170935



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190323171001
SQL开始执行时间：20190323171001


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190323171001
SQL开始执行时间：20190323171001


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190323171001
SQL开始执行时间：20190323171001

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190323171033

20190324010913开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190324010913

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190324010913
SQL开始执行时间：20190324010913
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190324010913
SQL开始执行时间：20190324010913
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190324010913
SQL开始执行时间：20190324010913



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190324010928
SQL开始执行时间：20190324010928


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190324010928
SQL开始执行时间：20190324010928


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190324010928
SQL开始执行时间：20190324010928

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190324010959

20190324170903开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190324170903

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190324170903
SQL开始执行时间：20190324170903
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190324170903
SQL开始执行时间：20190324170903
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190324170903
SQL开始执行时间：20190324170903



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190324170917
SQL开始执行时间：20190324170917


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190324170917
SQL开始执行时间：20190324170917


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190324170917
SQL开始执行时间：20190324170917

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190324170949

20190325010911开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325010911

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190325010911
SQL开始执行时间：20190325010911
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190325010911
SQL开始执行时间：20190325010911
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190325010911
SQL开始执行时间：20190325010911



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190325010925
SQL开始执行时间：20190325010925


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190325010926
SQL开始执行时间：20190325010926


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190325010926
SQL开始执行时间：20190325010926

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190325010957

20190325094708开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190325094708

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190325094708
SQL开始执行时间：20190325094708
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190325094708
SQL开始执行时间：20190325094708
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190325094708
SQL开始执行时间：20190325094708



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190325094708
SQL开始执行时间：20190325094708


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190325094708
SQL开始执行时间：20190325094708


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190325094708
SQL开始执行时间：20190325094708

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190325094739

20190325170926开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325170926

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190325170926
SQL开始执行时间：20190325170926
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190325170926
SQL开始执行时间：20190325170926
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190325170926
SQL开始执行时间：20190325170926



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190325171033
SQL开始执行时间：20190325171033


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190325171033
SQL开始执行时间：20190325171033


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190325171033
SQL开始执行时间：20190325171033

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190325171106

20190326010909开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326010909

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190326010909
SQL开始执行时间：20190326010909
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190326010909
SQL开始执行时间：20190326010909
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190326010909
SQL开始执行时间：20190326010909



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190326010938
SQL开始执行时间：20190326010938


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190326010938
SQL开始执行时间：20190326010938


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190326010939
SQL开始执行时间：20190326010939

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190326011011

20190326131700开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326131700

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190326131700
SQL开始执行时间：20190326131700
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190326131700
SQL开始执行时间：20190326131700
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190326131700
SQL开始执行时间：20190326131700



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190326131801
SQL开始执行时间：20190326131801


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190326131801
SQL开始执行时间：20190326131801


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190326131801
SQL开始执行时间：20190326131801

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190326131833

20190326170927开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326170927

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190326170928
SQL开始执行时间：20190326170928
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190326170928
SQL开始执行时间：20190326170928
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190326170928
SQL开始执行时间：20190326170928



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190326171039
SQL开始执行时间：20190326171039


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190326171039
SQL开始执行时间：20190326171039


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190326171039
SQL开始执行时间：20190326171039

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190326171111

20190327010918开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327010918

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190327010918
SQL开始执行时间：20190327010918
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190327010918
SQL开始执行时间：20190327010918
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190327010918
SQL开始执行时间：20190327010918



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190327010950
SQL开始执行时间：20190327010950


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190327010950
SQL开始执行时间：20190327010950


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190327010951
SQL开始执行时间：20190327010951

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190327011023

20190327170931开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327170931

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190327170931
SQL开始执行时间：20190327170931
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190327170931
SQL开始执行时间：20190327170931
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190327170931
SQL开始执行时间：20190327170931



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190327171019
SQL开始执行时间：20190327171019


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190327171020
SQL开始执行时间：20190327171020


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190327171020
SQL开始执行时间：20190327171020

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190327171052

20190328010925开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328010925

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190328010925
SQL开始执行时间：20190328010925
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190328010925
SQL开始执行时间：20190328010925
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190328010925
SQL开始执行时间：20190328010925



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190328010958
SQL开始执行时间：20190328010958


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190328010959
SQL开始执行时间：20190328010959


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190328010959
SQL开始执行时间：20190328010959

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190328011032

20190328111042开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328111042

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190328111042
SQL开始执行时间：20190328111042
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190328111042
SQL开始执行时间：20190328111042
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190328111042
SQL开始执行时间：20190328111042



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190328111130
SQL开始执行时间：20190328111130


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190328111130
SQL开始执行时间：20190328111130


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190328111130
SQL开始执行时间：20190328111130

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190328111202

20190328170940开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328170940

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190328170941
SQL开始执行时间：20190328170941
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190328170941
SQL开始执行时间：20190328170941
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190328170941
SQL开始执行时间：20190328170941



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190328171038
SQL开始执行时间：20190328171038


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190328171039
SQL开始执行时间：20190328171039


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190328171039
SQL开始执行时间：20190328171039

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190328171111

20190329010930开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329010930

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190329010930
SQL开始执行时间：20190329010930
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190329010930
SQL开始执行时间：20190329010930
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190329010930
SQL开始执行时间：20190329010930



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190329011004
SQL开始执行时间：20190329011004


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190329011004
SQL开始执行时间：20190329011004


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190329011004
SQL开始执行时间：20190329011004

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190329011038

20190329170937开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329170937

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190329170937
SQL开始执行时间：20190329170937
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190329170937
SQL开始执行时间：20190329170937
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190329170937
SQL开始执行时间：20190329170937



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190329171013
SQL开始执行时间：20190329171013


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190329171014
SQL开始执行时间：20190329171014


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190329171014
SQL开始执行时间：20190329171014

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190329171047

20190330010927开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330010927

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190330010928
SQL开始执行时间：20190330010928
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190330010928
SQL开始执行时间：20190330010928
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190330010928
SQL开始执行时间：20190330010928



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190330010950
SQL开始执行时间：20190330010950


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190330010950
SQL开始执行时间：20190330010950


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190330010950
SQL开始执行时间：20190330010950

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190330011024

20190330170927开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330170927

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190330170927
SQL开始执行时间：20190330170927
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190330170927
SQL开始执行时间：20190330170927
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190330170927
SQL开始执行时间：20190330170927



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190330170949
SQL开始执行时间：20190330170949


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190330170950
SQL开始执行时间：20190330170950


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190330170950
SQL开始执行时间：20190330170950

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190330171023

20190331010919开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331010919

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190331010919
SQL开始执行时间：20190331010919
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190331010919
SQL开始执行时间：20190331010919
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190331010919
SQL开始执行时间：20190331010919



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190331010934
SQL开始执行时间：20190331010934


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190331010934
SQL开始执行时间：20190331010934


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190331010934
SQL开始执行时间：20190331010934

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190331011008

20190331170921开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331170921

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190331170921
SQL开始执行时间：20190331170921
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190331170921
SQL开始执行时间：20190331170921
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190331170921
SQL开始执行时间：20190331170921



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190331170936
SQL开始执行时间：20190331170936


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190331170936
SQL开始执行时间：20190331170936


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190331170936
SQL开始执行时间：20190331170936

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190331171009

20190401010928开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190401010928

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190401010928
SQL开始执行时间：20190401010928
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190401010928
SQL开始执行时间：20190401010928
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190401010928
SQL开始执行时间：20190401010928



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190401010943
SQL开始执行时间：20190401010943


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190401010944
SQL开始执行时间：20190401010944


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190401010944
SQL开始执行时间：20190401010944

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190401011018

20190401173451开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190401173451

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190401173451
SQL开始执行时间：20190401173451
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190401173451
SQL开始执行时间：20190401173451
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190401173451
SQL开始执行时间：20190401173451



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190401173513
SQL开始执行时间：20190401173513


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190401173513
SQL开始执行时间：20190401173513


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190401173513
SQL开始执行时间：20190401173513

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190401173546

20190402011020开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190402011020

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190402011020
SQL开始执行时间：20190402011020
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190402011020
SQL开始执行时间：20190402011020
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190402011020
SQL开始执行时间：20190402011020



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190402011042
SQL开始执行时间：20190402011042


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190402011042
SQL开始执行时间：20190402011042


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190402011043
SQL开始执行时间：20190402011043

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190402011115

20190403170954开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190403170954

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190403170954
SQL开始执行时间：20190403170954
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190403170954
SQL开始执行时间：20190403170954
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190403170954
SQL开始执行时间：20190403170954



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190403171020
SQL开始执行时间：20190403171020


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190403171021
SQL开始执行时间：20190403171021


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190403171021
SQL开始执行时间：20190403171021

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190403171054

20190404011003开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404011003

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404011003
SQL开始执行时间：20190404011003
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404011003
SQL开始执行时间：20190404011003
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190404011003
SQL开始执行时间：20190404011003



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190404011029
SQL开始执行时间：20190404011029


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190404011030
SQL开始执行时间：20190404011030


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190404011030
SQL开始执行时间：20190404011030

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190404011104

20190404141439开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404141440

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404141440
SQL开始执行时间：20190404141440
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404141440
SQL开始执行时间：20190404141440
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190404141440
SQL开始执行时间：20190404141440



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190404141519
SQL开始执行时间：20190404141519


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190404141519
SQL开始执行时间：20190404141519


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190404141519
SQL开始执行时间：20190404141519

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190404141552

20190404170942开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404170942

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404170942
SQL开始执行时间：20190404170942
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404170942
SQL开始执行时间：20190404170942
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190404170942
SQL开始执行时间：20190404170942



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190404171034
SQL开始执行时间：20190404171034


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190404171034
SQL开始执行时间：20190404171034


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190404171034
SQL开始执行时间：20190404171034

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190404171107

20190405010936开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405010936

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190405010937
SQL开始执行时间：20190405010937
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190405010937
SQL开始执行时间：20190405010937
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190405010937
SQL开始执行时间：20190405010937



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190405011005
SQL开始执行时间：20190405011005


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190405011005
SQL开始执行时间：20190405011005


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190405011005
SQL开始执行时间：20190405011005

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190405011040

20190405170940开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405170940

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190405170940
SQL开始执行时间：20190405170940
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190405170940
SQL开始执行时间：20190405170940
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190405170940
SQL开始执行时间：20190405170940



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190405171008
SQL开始执行时间：20190405171008


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190405171008
SQL开始执行时间：20190405171008


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190405171008
SQL开始执行时间：20190405171008

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190405171042

20190406010942开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406010942

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190406010942
SQL开始执行时间：20190406010942
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190406010942
SQL开始执行时间：20190406010942
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190406010942
SQL开始执行时间：20190406010942



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190406010957
SQL开始执行时间：20190406010957


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190406010958
SQL开始执行时间：20190406010958


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190406010958
SQL开始执行时间：20190406010958

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190406011032

20190406170936开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406170936

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190406170936
SQL开始执行时间：20190406170936
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190406170936
SQL开始执行时间：20190406170936
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190406170936
SQL开始执行时间：20190406170936



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190406170951
SQL开始执行时间：20190406170951


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190406170952
SQL开始执行时间：20190406170952


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190406170952
SQL开始执行时间：20190406170952

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190406171025

20190407010933开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407010933

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190407010933
SQL开始执行时间：20190407010933
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190407010933
SQL开始执行时间：20190407010933
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190407010933
SQL开始执行时间：20190407010933



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190407010949
SQL开始执行时间：20190407010949


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190407010949
SQL开始执行时间：20190407010949


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190407010949
SQL开始执行时间：20190407010949

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190407011024

20190407170935开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407170935

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190407170935
SQL开始执行时间：20190407170935
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190407170935
SQL开始执行时间：20190407170935
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190407170935
SQL开始执行时间：20190407170935



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190407170950
SQL开始执行时间：20190407170950


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190407170951
SQL开始执行时间：20190407170951


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190407170951
SQL开始执行时间：20190407170951

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190407171025

20190408010947开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408010947

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190408010947
SQL开始执行时间：20190408010947
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190408010947
SQL开始执行时间：20190408010947
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190408010947
SQL开始执行时间：20190408010947



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190408011003
SQL开始执行时间：20190408011003


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190408011003
SQL开始执行时间：20190408011003


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190408011003
SQL开始执行时间：20190408011003

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190408011038

20190408170953开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408170953

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190408170953
SQL开始执行时间：20190408170953
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190408170953
SQL开始执行时间：20190408170953
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190408170953
SQL开始执行时间：20190408170953



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190408171017
SQL开始执行时间：20190408171017


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190408171017
SQL开始执行时间：20190408171017


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190408171017
SQL开始执行时间：20190408171017

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190408171051

20190409010944开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409010944

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190409010944
SQL开始执行时间：20190409010944
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190409010944
SQL开始执行时间：20190409010944
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190409010944
SQL开始执行时间：20190409010944



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190409011008
SQL开始执行时间：20190409011008


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190409011009
SQL开始执行时间：20190409011009


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190409011009
SQL开始执行时间：20190409011009

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190409011044

20190409103018开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409103018

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190409103018
SQL开始执行时间：20190409103018
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190409103018
SQL开始执行时间：20190409103018
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190409103018
SQL开始执行时间：20190409103018



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190409103102
SQL开始执行时间：20190409103102


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190409103103
SQL开始执行时间：20190409103103


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190409103103
SQL开始执行时间：20190409103103

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190409103137

20190409170952开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409170952

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190409170952
SQL开始执行时间：20190409170952
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190409170952
SQL开始执行时间：20190409170952
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190409170952
SQL开始执行时间：20190409170952



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190409171040
SQL开始执行时间：20190409171040


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190409171040
SQL开始执行时间：20190409171040


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190409171040
SQL开始执行时间：20190409171040

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190409171114

20190410010959开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410010959

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190410010959
SQL开始执行时间：20190410010959
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190410010959
SQL开始执行时间：20190410010959
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190410010959
SQL开始执行时间：20190410010959



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190410011026
SQL开始执行时间：20190410011026


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190410011026
SQL开始执行时间：20190410011026


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190410011026
SQL开始执行时间：20190410011026

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190410011100

20190410124032开始执行1900-01-10数据加载日志:
SQL开始执行时间：20190410124032

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190410124033
SQL开始执行时间：20190410124033
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190410124034
SQL开始执行时间：20190410124034
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190410124034
SQL开始执行时间：20190410124034



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190410124034
SQL开始执行时间：20190410124034


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190410124034
SQL开始执行时间：20190410124034


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190410124035
SQL开始执行时间：20190410124035

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190410124048

20190410171000开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410171000

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190410171000
SQL开始执行时间：20190410171000
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190410171000
SQL开始执行时间：20190410171000
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190410171000
SQL开始执行时间：20190410171000



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190410171815
SQL开始执行时间：20190410171815


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190410171815
SQL开始执行时间：20190410171815


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190410171816
SQL开始执行时间：20190410171816

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190410171849

20190411011005开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190411011005

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190411011005
SQL开始执行时间：20190411011005
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190411011005
SQL开始执行时间：20190411011005
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190411011005
SQL开始执行时间：20190411011005



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190411011034
SQL开始执行时间：20190411011034


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190411011034
SQL开始执行时间：20190411011034


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190411011034
SQL开始执行时间：20190411011034

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190411011108

20190411161645开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190411161645

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190411161646
SQL开始执行时间：20190411161646
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190411161647
SQL开始执行时间：20190411161647
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190411161647
SQL开始执行时间：20190411161647



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190411161647
SQL开始执行时间：20190411161647


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190411161647
SQL开始执行时间：20190411161647


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190411161648
SQL开始执行时间：20190411161648

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190411161702

20190412011130开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412011130

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412011130
SQL开始执行时间：20190412011130
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412011130
SQL开始执行时间：20190412011130
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190412011130
SQL开始执行时间：20190412011130



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190412011207
SQL开始执行时间：20190412011207


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190412011207
SQL开始执行时间：20190412011207


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190412011207
SQL开始执行时间：20190412011207

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190412011241

20190412095211开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190412095211

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412095212
SQL开始执行时间：20190412095212
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412095212
SQL开始执行时间：20190412095212
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190412095212
SQL开始执行时间：20190412095212



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190412100251
SQL开始执行时间：20190412100251


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190412100252
SQL开始执行时间：20190412100252


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190412100252
SQL开始执行时间：20190412100252

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190412100325

20190412171020开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412171020

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412171020
SQL开始执行时间：20190412171020
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412171020
SQL开始执行时间：20190412171020
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190412171020
SQL开始执行时间：20190412171020



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190412171125
SQL开始执行时间：20190412171125


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190412171126
SQL开始执行时间：20190412171126


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190412171126
SQL开始执行时间：20190412171126

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190412171200

20190413011017开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413011017

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190413011018
SQL开始执行时间：20190413011018
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190413011018
SQL开始执行时间：20190413011018
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190413011018
SQL开始执行时间：20190413011018



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190413011049
SQL开始执行时间：20190413011049


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190413011050
SQL开始执行时间：20190413011050


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190413011050
SQL开始执行时间：20190413011050

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190413011123

20190413171017开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413171017

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190413171017
SQL开始执行时间：20190413171017
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190413171017
SQL开始执行时间：20190413171017
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190413171017
SQL开始执行时间：20190413171017



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190413171049
SQL开始执行时间：20190413171049


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190413171049
SQL开始执行时间：20190413171049


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190413171049
SQL开始执行时间：20190413171049

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190413171123

20190414011018开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414011018

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190414011018
SQL开始执行时间：20190414011018
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190414011018
SQL开始执行时间：20190414011018
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190414011018
SQL开始执行时间：20190414011018



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190414011034
SQL开始执行时间：20190414011034


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190414011034
SQL开始执行时间：20190414011034


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190414011034
SQL开始执行时间：20190414011034

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190414011109

20190414171007开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414171007

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190414171008
SQL开始执行时间：20190414171008
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190414171008
SQL开始执行时间：20190414171008
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190414171008
SQL开始执行时间：20190414171008



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190414171023
SQL开始执行时间：20190414171023


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190414171024
SQL开始执行时间：20190414171024


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190414171024
SQL开始执行时间：20190414171024

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190414171058

20190415011014开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415011014

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190415011014
SQL开始执行时间：20190415011014
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190415011014
SQL开始执行时间：20190415011014
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190415011014
SQL开始执行时间：20190415011014



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190415011030
SQL开始执行时间：20190415011030


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190415011031
SQL开始执行时间：20190415011031


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190415011031
SQL开始执行时间：20190415011031

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190415011105

20190415101424开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415101424

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190415101425
SQL开始执行时间：20190415101425
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190415101425
SQL开始执行时间：20190415101425
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190415101425
SQL开始执行时间：20190415101425



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190415101517
SQL开始执行时间：20190415101517


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190415101517
SQL开始执行时间：20190415101517


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190415101517
SQL开始执行时间：20190415101517

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190415101551

20190415171039开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415171039

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190415171039
SQL开始执行时间：20190415171039
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190415171039
SQL开始执行时间：20190415171039
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190415171039
SQL开始执行时间：20190415171039



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190415171143
SQL开始执行时间：20190415171143


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190415171143
SQL开始执行时间：20190415171143


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190415171143
SQL开始执行时间：20190415171143

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190415171218

20190416011036开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416011036

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190416011036
SQL开始执行时间：20190416011036
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190416011036
SQL开始执行时间：20190416011036
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190416011036
SQL开始执行时间：20190416011036



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190416011105
SQL开始执行时间：20190416011105


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190416011105
SQL开始执行时间：20190416011105


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190416011105
SQL开始执行时间：20190416011105

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190416011140

20190416095030开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416095030

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190416095031
SQL开始执行时间：20190416095031
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190416095031
SQL开始执行时间：20190416095031
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190416095031
SQL开始执行时间：20190416095031



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190416095059
SQL开始执行时间：20190416095059


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190416095059
SQL开始执行时间：20190416095059


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190416095059
SQL开始执行时间：20190416095059

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190416095134

20190416170103开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416170103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190416170103
SQL开始执行时间：20190416170103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190416170103
SQL开始执行时间：20190416170103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190416170103
SQL开始执行时间：20190416170103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190416170138
SQL开始执行时间：20190416170138


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190416170139
SQL开始执行时间：20190416170139


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190416170139
SQL开始执行时间：20190416170139

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190416170213

20190417010055开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417010055

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190417010055
SQL开始执行时间：20190417010055
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190417010055
SQL开始执行时间：20190417010055
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190417010055
SQL开始执行时间：20190417010055



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190417010122
SQL开始执行时间：20190417010122


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190417010123
SQL开始执行时间：20190417010123


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190417010123
SQL开始执行时间：20190417010123

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190417010157

20190417170058开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417170058

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190417170058
SQL开始执行时间：20190417170058
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190417170058
SQL开始执行时间：20190417170058
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190417170058
SQL开始执行时间：20190417170058



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190417170130
SQL开始执行时间：20190417170130


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190417170130
SQL开始执行时间：20190417170130


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190417170130
SQL开始执行时间：20190417170130

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190417170205

20190418010052开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418010052

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190418010053
SQL开始执行时间：20190418010053
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190418010053
SQL开始执行时间：20190418010053
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190418010053
SQL开始执行时间：20190418010053



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190418010116
SQL开始执行时间：20190418010116


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190418010117
SQL开始执行时间：20190418010117


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190418010117
SQL开始执行时间：20190418010117

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190418010152

20190418170101开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418170101

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190418170101
SQL开始执行时间：20190418170101
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190418170101
SQL开始执行时间：20190418170101
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190418170101
SQL开始执行时间：20190418170101



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190418170136
SQL开始执行时间：20190418170136


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190418170136
SQL开始执行时间：20190418170136


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190418170136
SQL开始执行时间：20190418170136

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190418170211

20190419010056开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419010056

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190419010056
SQL开始执行时间：20190419010056
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190419010056
SQL开始执行时间：20190419010056
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190419010056
SQL开始执行时间：20190419010056



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190419010122
SQL开始执行时间：20190419010122


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190419010122
SQL开始执行时间：20190419010122


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190419010122
SQL开始执行时间：20190419010122

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190419010157

20190419170103开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419170103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190419170103
SQL开始执行时间：20190419170103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190419170103
SQL开始执行时间：20190419170103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190419170103
SQL开始执行时间：20190419170103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190419170147
SQL开始执行时间：20190419170147


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190419170147
SQL开始执行时间：20190419170147


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190419170147
SQL开始执行时间：20190419170147

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190419170224

20190420010056开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420010056

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190420010056
SQL开始执行时间：20190420010056
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190420010056
SQL开始执行时间：20190420010056
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190420010056
SQL开始执行时间：20190420010056



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190420010131
SQL开始执行时间：20190420010131


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190420010131
SQL开始执行时间：20190420010131


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190420010131
SQL开始执行时间：20190420010131

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190420010208

20190420170111开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420170111

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190420170111
SQL开始执行时间：20190420170111
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190420170111
SQL开始执行时间：20190420170111
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190420170111
SQL开始执行时间：20190420170111



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190420170146
SQL开始执行时间：20190420170146


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190420170146
SQL开始执行时间：20190420170146


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190420170146
SQL开始执行时间：20190420170146

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190420170223

20190421010049开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421010049

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190421010049
SQL开始执行时间：20190421010049
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190421010049
SQL开始执行时间：20190421010049
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190421010049
SQL开始执行时间：20190421010049



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190421010106
SQL开始执行时间：20190421010106


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190421010106
SQL开始执行时间：20190421010106


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190421010106
SQL开始执行时间：20190421010106

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190421010143

20190421170048开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421170048

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190421170048
SQL开始执行时间：20190421170048
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190421170048
SQL开始执行时间：20190421170048
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190421170048
SQL开始执行时间：20190421170048



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190421170105
SQL开始执行时间：20190421170105


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190421170105
SQL开始执行时间：20190421170105


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190421170105
SQL开始执行时间：20190421170105

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190421170141

20190422010051开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422010051

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190422010051
SQL开始执行时间：20190422010051
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190422010051
SQL开始执行时间：20190422010051
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190422010051
SQL开始执行时间：20190422010051



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190422010108
SQL开始执行时间：20190422010108


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190422010108
SQL开始执行时间：20190422010108


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190422010108
SQL开始执行时间：20190422010108

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190422010144

20190422111831开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422111831

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190422111831
SQL开始执行时间：20190422111831
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190422111831
SQL开始执行时间：20190422111831
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190422111831
SQL开始执行时间：20190422111831



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190422111936
SQL开始执行时间：20190422111936


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190422111937
SQL开始执行时间：20190422111937


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190422111937
SQL开始执行时间：20190422111937

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190422112013

20190422170056开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422170056

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190422170056
SQL开始执行时间：20190422170056
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190422170056
SQL开始执行时间：20190422170056
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190422170056
SQL开始执行时间：20190422170056



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190422170209
SQL开始执行时间：20190422170209


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190422170210
SQL开始执行时间：20190422170210


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190422170210
SQL开始执行时间：20190422170210

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190422170246

20190423010057开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423010057

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190423010057
SQL开始执行时间：20190423010057
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190423010057
SQL开始执行时间：20190423010057
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190423010057
SQL开始执行时间：20190423010057



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190423010124
SQL开始执行时间：20190423010124


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190423010124
SQL开始执行时间：20190423010124


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190423010124
SQL开始执行时间：20190423010124

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190423010201

20190423170103开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423170103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190423170103
SQL开始执行时间：20190423170103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190423170103
SQL开始执行时间：20190423170103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190423170103
SQL开始执行时间：20190423170103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190423170141
SQL开始执行时间：20190423170141


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190423170141
SQL开始执行时间：20190423170141


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190423170141
SQL开始执行时间：20190423170141

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190423170218

20190424010058开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424010058

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190424010058
SQL开始执行时间：20190424010058
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190424010058
SQL开始执行时间：20190424010058
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190424010058
SQL开始执行时间：20190424010058



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190424010133
SQL开始执行时间：20190424010133


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190424010133
SQL开始执行时间：20190424010133


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190424010134
SQL开始执行时间：20190424010134

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190424010210

20190424170103开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424170103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190424170103
SQL开始执行时间：20190424170103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190424170103
SQL开始执行时间：20190424170103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190424170103
SQL开始执行时间：20190424170103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190424170145
SQL开始执行时间：20190424170145


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190424170145
SQL开始执行时间：20190424170145


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190424170145
SQL开始执行时间：20190424170145

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190424170223

20190425010057开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425010057

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190425010057
SQL开始执行时间：20190425010057
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190425010057
SQL开始执行时间：20190425010057
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190425010057
SQL开始执行时间：20190425010057



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190425010123
SQL开始执行时间：20190425010123


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190425010123
SQL开始执行时间：20190425010123


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190425010123
SQL开始执行时间：20190425010123

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190425010200

20190425113751开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425113751

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190425113751
SQL开始执行时间：20190425113751
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190425113751
SQL开始执行时间：20190425113751
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190425113751
SQL开始执行时间：20190425113751



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190425113836
SQL开始执行时间：20190425113836


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190425113836
SQL开始执行时间：20190425113836


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190425113836
SQL开始执行时间：20190425113836

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190425113913

20190425170106开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425170106

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190425170106
SQL开始执行时间：20190425170106
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190425170106
SQL开始执行时间：20190425170106
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190425170106
SQL开始执行时间：20190425170106



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190425170206
SQL开始执行时间：20190425170206


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190425170206
SQL开始执行时间：20190425170206


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190425170206
SQL开始执行时间：20190425170206

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190425170244

20190426010059开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426010059

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190426010059
SQL开始执行时间：20190426010059
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190426010059
SQL开始执行时间：20190426010059
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190426010059
SQL开始执行时间：20190426010059



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190426010138
SQL开始执行时间：20190426010138


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190426010138
SQL开始执行时间：20190426010138


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190426010138
SQL开始执行时间：20190426010138

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190426010217

20190426170106开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426170106

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190426170106
SQL开始执行时间：20190426170106
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190426170106
SQL开始执行时间：20190426170106
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190426170106
SQL开始执行时间：20190426170106



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190426170154
SQL开始执行时间：20190426170154


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190426170154
SQL开始执行时间：20190426170154


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190426170154
SQL开始执行时间：20190426170154

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190426170236

20190427010102开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427010102

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190427010102
SQL开始执行时间：20190427010102
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190427010102
SQL开始执行时间：20190427010102
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190427010102
SQL开始执行时间：20190427010102



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190427010135
SQL开始执行时间：20190427010135


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190427010135
SQL开始执行时间：20190427010135


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190427010135
SQL开始执行时间：20190427010135

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190427010217

20190427170059开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427170059

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190427170059
SQL开始执行时间：20190427170059
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190427170059
SQL开始执行时间：20190427170059
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190427170059
SQL开始执行时间：20190427170059



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190427170132
SQL开始执行时间：20190427170132


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190427170132
SQL开始执行时间：20190427170132


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190427170132
SQL开始执行时间：20190427170132

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190427170214

20190428010052开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190428010052

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190428010052
SQL开始执行时间：20190428010052
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190428010052
SQL开始执行时间：20190428010052
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190428010052
SQL开始执行时间：20190428010052



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190428010112
SQL开始执行时间：20190428010112


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190428010112
SQL开始执行时间：20190428010112


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190428010112
SQL开始执行时间：20190428010112

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190428010154

20190428170103开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190428170103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190428170104
SQL开始执行时间：20190428170104
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190428170104
SQL开始执行时间：20190428170104
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190428170104
SQL开始执行时间：20190428170104



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190428170136
SQL开始执行时间：20190428170136


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190428170136
SQL开始执行时间：20190428170136


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190428170136
SQL开始执行时间：20190428170136

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190428170219

20190429010106开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429010106

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429010106
SQL开始执行时间：20190429010106
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429010106
SQL开始执行时间：20190429010106
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190429010106
SQL开始执行时间：20190429010106



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190429010140
SQL开始执行时间：20190429010140


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190429010140
SQL开始执行时间：20190429010140


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190429010140
SQL开始执行时间：20190429010140

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190429010223

20190429094311开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429094311

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429094311
SQL开始执行时间：20190429094311
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429094311
SQL开始执行时间：20190429094311
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190429094311
SQL开始执行时间：20190429094311



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190429094358
SQL开始执行时间：20190429094358


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190429094358
SQL开始执行时间：20190429094358


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190429094358
SQL开始执行时间：20190429094358

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190429094441

20190429150428开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429150428

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429150428
SQL开始执行时间：20190429150428
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429150428
SQL开始执行时间：20190429150428
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190429150428
SQL开始执行时间：20190429150428



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190429150514
SQL开始执行时间：20190429150514


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190429150515
SQL开始执行时间：20190429150515


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190429150515
SQL开始执行时间：20190429150515

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190429150556

20190429170108开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429170108

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429170109
SQL开始执行时间：20190429170109
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429170109
SQL开始执行时间：20190429170109
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190429170109
SQL开始执行时间：20190429170109



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190429170200
SQL开始执行时间：20190429170200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190429170200
SQL开始执行时间：20190429170200


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190429170200
SQL开始执行时间：20190429170200

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190429170243

20190430010101开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430010101

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190430010101
SQL开始执行时间：20190430010101
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190430010101
SQL开始执行时间：20190430010101
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190430010101
SQL开始执行时间：20190430010101



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190430010132
SQL开始执行时间：20190430010132


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190430010133
SQL开始执行时间：20190430010133


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190430010133
SQL开始执行时间：20190430010133

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190430010215

20190430170102开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430170102

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190430170102
SQL开始执行时间：20190430170102
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190430170102
SQL开始执行时间：20190430170102
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190430170102
SQL开始执行时间：20190430170102



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190430170136
SQL开始执行时间：20190430170136


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190430170136
SQL开始执行时间：20190430170136


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190430170136
SQL开始执行时间：20190430170136

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190430170219

20190501010054开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501010054

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190501010054
SQL开始执行时间：20190501010054
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190501010054
SQL开始执行时间：20190501010054
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190501010054
SQL开始执行时间：20190501010054



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190501010122
SQL开始执行时间：20190501010122


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190501010122
SQL开始执行时间：20190501010122


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190501010122
SQL开始执行时间：20190501010122

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190501010205

20190501170057开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501170057

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190501170057
SQL开始执行时间：20190501170057
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190501170057
SQL开始执行时间：20190501170057
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190501170057
SQL开始执行时间：20190501170057



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190501170125
SQL开始执行时间：20190501170125


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190501170125
SQL开始执行时间：20190501170125


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190501170125
SQL开始执行时间：20190501170125

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190501170208

20190502010052开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502010052

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190502010052
SQL开始执行时间：20190502010052
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190502010052
SQL开始执行时间：20190502010052
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190502010052
SQL开始执行时间：20190502010052



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190502010113
SQL开始执行时间：20190502010113


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190502010113
SQL开始执行时间：20190502010113


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190502010113
SQL开始执行时间：20190502010113

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190502010156

20190502170051开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502170051

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190502170051
SQL开始执行时间：20190502170051
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190502170051
SQL开始执行时间：20190502170051
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190502170051
SQL开始执行时间：20190502170051



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190502170112
SQL开始执行时间：20190502170112


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190502170112
SQL开始执行时间：20190502170112


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190502170112
SQL开始执行时间：20190502170112

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190502170155

20190503010050开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503010050

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190503010050
SQL开始执行时间：20190503010050
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190503010050
SQL开始执行时间：20190503010050
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190503010050
SQL开始执行时间：20190503010050



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190503010111
SQL开始执行时间：20190503010111


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190503010111
SQL开始执行时间：20190503010111


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190503010111
SQL开始执行时间：20190503010111

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190503010154

20190503170050开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503170050

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190503170050
SQL开始执行时间：20190503170050
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190503170050
SQL开始执行时间：20190503170050
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190503170050
SQL开始执行时间：20190503170050



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190503170111
SQL开始执行时间：20190503170111


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190503170111
SQL开始执行时间：20190503170111


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190503170111
SQL开始执行时间：20190503170111

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190503170154

20190504010053开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504010053

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190504010053
SQL开始执行时间：20190504010053
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190504010053
SQL开始执行时间：20190504010053
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190504010053
SQL开始执行时间：20190504010053



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190504010113
SQL开始执行时间：20190504010113


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190504010113
SQL开始执行时间：20190504010113


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190504010113
SQL开始执行时间：20190504010113

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190504010155

20190504170052开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504170052

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190504170052
SQL开始执行时间：20190504170052
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190504170052
SQL开始执行时间：20190504170052
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190504170052
SQL开始执行时间：20190504170052



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190504170113
SQL开始执行时间：20190504170113


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190504170113
SQL开始执行时间：20190504170113


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190504170113
SQL开始执行时间：20190504170113

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190504170156

20190505010051开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505010051

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190505010051
SQL开始执行时间：20190505010051
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190505010051
SQL开始执行时间：20190505010051
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190505010051
SQL开始执行时间：20190505010051



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190505010111
SQL开始执行时间：20190505010111


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190505010111
SQL开始执行时间：20190505010111


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190505010111
SQL开始执行时间：20190505010111

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190505010154

20190505170058开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505170058

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190505170058
SQL开始执行时间：20190505170058
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190505170058
SQL开始执行时间：20190505170058
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190505170058
SQL开始执行时间：20190505170058



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190505170125
SQL开始执行时间：20190505170125


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190505170125
SQL开始执行时间：20190505170125


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190505170125
SQL开始执行时间：20190505170125

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190505170209

20190506010055开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506010055

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506010055
SQL开始执行时间：20190506010055
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506010055
SQL开始执行时间：20190506010055
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190506010055
SQL开始执行时间：20190506010055



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190506010129
SQL开始执行时间：20190506010129


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506010129
SQL开始执行时间：20190506010129


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190506010129
SQL开始执行时间：20190506010129

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190506010212

20190506092139开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190506092139

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506092139
SQL开始执行时间：20190506092139
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506092139
SQL开始执行时间：20190506092139
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190506092139
SQL开始执行时间：20190506092139



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190506092319
SQL开始执行时间：20190506092319


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506092319
SQL开始执行时间：20190506092319


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190506092319
SQL开始执行时间：20190506092319

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190506092402

20190506112618开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190506112618

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506112618
SQL开始执行时间：20190506112618
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506112618
SQL开始执行时间：20190506112618
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190506112618
SQL开始执行时间：20190506112618



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190506112955
SQL开始执行时间：20190506112955


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506112955
SQL开始执行时间：20190506112955


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190506112955
SQL开始执行时间：20190506112955

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190506113038

20190506152603开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190506152603

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506152605
SQL开始执行时间：20190506152605
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506152605
SQL开始执行时间：20190506152605
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190506152605
SQL开始执行时间：20190506152605



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190506152605
SQL开始执行时间：20190506152605


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506152606
SQL开始执行时间：20190506152606


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190506152608
SQL开始执行时间：20190506152608

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190506152624

20190506153341开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190506153341

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506153343
SQL开始执行时间：20190506153343
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506153344
SQL开始执行时间：20190506153344
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190506153344
SQL开始执行时间：20190506153344



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190506153344
SQL开始执行时间：20190506153344


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506153344
SQL开始执行时间：20190506153344


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190506153346
SQL开始执行时间：20190506153346

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190506153403

20190506170102开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506170102

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506170102
SQL开始执行时间：20190506170102
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506170102
SQL开始执行时间：20190506170102
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190506170102
SQL开始执行时间：20190506170102



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190506170450
SQL开始执行时间：20190506170450


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506170450
SQL开始执行时间：20190506170450


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190506170451
SQL开始执行时间：20190506170451

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190506170534

20190507010057开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507010057

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190507010057
SQL开始执行时间：20190507010057
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190507010057
SQL开始执行时间：20190507010057
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190507010057
SQL开始执行时间：20190507010057



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190507010132
SQL开始执行时间：20190507010132


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190507010132
SQL开始执行时间：20190507010132


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190507010133
SQL开始执行时间：20190507010133

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190507010215

20190507170103开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507170103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190507170103
SQL开始执行时间：20190507170103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190507170103
SQL开始执行时间：20190507170103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190507170103
SQL开始执行时间：20190507170103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190507170145
SQL开始执行时间：20190507170145


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190507170146
SQL开始执行时间：20190507170146


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190507170146
SQL开始执行时间：20190507170146

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190507170229

20190508010100开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508010100

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190508010100
SQL开始执行时间：20190508010100
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190508010100
SQL开始执行时间：20190508010100
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190508010100
SQL开始执行时间：20190508010100



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190508010129
SQL开始执行时间：20190508010129


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190508010129
SQL开始执行时间：20190508010129


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190508010129
SQL开始执行时间：20190508010129

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190508010212

20190509170117开始执行2019-05-08数据加载日志:
SQL开始执行时间：20190509170117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190509170117
SQL开始执行时间：20190509170117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190509170117
SQL开始执行时间：20190509170117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190509170117
SQL开始执行时间：20190509170117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190509170202
SQL开始执行时间：20190509170202


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190509170203
SQL开始执行时间：20190509170203


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190509170203
SQL开始执行时间：20190509170203

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190509170254

20190509175303开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190509175303

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190509175304
SQL开始执行时间：20190509175304
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190509175304
SQL开始执行时间：20190509175304
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190509175304
SQL开始执行时间：20190509175304



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190509175402
SQL开始执行时间：20190509175402


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190509175402
SQL开始执行时间：20190509175402


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190509175402
SQL开始执行时间：20190509175402

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190509175453

20190510010110开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510010110

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190510010110
SQL开始执行时间：20190510010110
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190510010110
SQL开始执行时间：20190510010110
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190510010110
SQL开始执行时间：20190510010110



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190510010148
SQL开始执行时间：20190510010148


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190510010149
SQL开始执行时间：20190510010149


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190510010149
SQL开始执行时间：20190510010149

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190510010239

20190510170112开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510170112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190510170112
SQL开始执行时间：20190510170112
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190510170112
SQL开始执行时间：20190510170112
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190510170112
SQL开始执行时间：20190510170112



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190510170154
SQL开始执行时间：20190510170154


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190510170154
SQL开始执行时间：20190510170154


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190510170154
SQL开始执行时间：20190510170154

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190510170246

20190511010102开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511010102

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190511010102
SQL开始执行时间：20190511010102
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190511010102
SQL开始执行时间：20190511010102
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190511010102
SQL开始执行时间：20190511010102



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190511010130
SQL开始执行时间：20190511010130


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190511010130
SQL开始执行时间：20190511010130


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190511010130
SQL开始执行时间：20190511010130

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190511010221

20190511170102开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511170102

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190511170102
SQL开始执行时间：20190511170102
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190511170102
SQL开始执行时间：20190511170102
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190511170102
SQL开始执行时间：20190511170102



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190511170130
SQL开始执行时间：20190511170130


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190511170131
SQL开始执行时间：20190511170131


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190511170131
SQL开始执行时间：20190511170131

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190511170222

20190512010056开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512010056

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190512010056
SQL开始执行时间：20190512010056
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190512010056
SQL开始执行时间：20190512010056
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190512010056
SQL开始执行时间：20190512010056



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190512010118
SQL开始执行时间：20190512010118


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190512010118
SQL开始执行时间：20190512010118


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190512010118
SQL开始执行时间：20190512010118

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190512010208

20190512170057开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512170057

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190512170057
SQL开始执行时间：20190512170057
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190512170057
SQL开始执行时间：20190512170057
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190512170057
SQL开始执行时间：20190512170057



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190512170118
SQL开始执行时间：20190512170118


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190512170118
SQL开始执行时间：20190512170118


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190512170119
SQL开始执行时间：20190512170119

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190512170210

20190513010057开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513010057

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190513010057
SQL开始执行时间：20190513010057
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190513010057
SQL开始执行时间：20190513010057
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190513010057
SQL开始执行时间：20190513010057



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190513010119
SQL开始执行时间：20190513010119


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190513010119
SQL开始执行时间：20190513010119


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190513010119
SQL开始执行时间：20190513010119

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190513010210

20190513102651开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190513102651

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190513102651
SQL开始执行时间：20190513102651
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190513102651
SQL开始执行时间：20190513102651
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190513102651
SQL开始执行时间：20190513102651



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190513102803
SQL开始执行时间：20190513102803


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190513102804
SQL开始执行时间：20190513102804


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190513102804
SQL开始执行时间：20190513102804

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190513102854

20190513170104开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513170104

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190513170105
SQL开始执行时间：20190513170105
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190513170105
SQL开始执行时间：20190513170105
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190513170105
SQL开始执行时间：20190513170105



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190513170228
SQL开始执行时间：20190513170228


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190513170229
SQL开始执行时间：20190513170229


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190513170229
SQL开始执行时间：20190513170229

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190513170320

20190514010104开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514010104

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190514010105
SQL开始执行时间：20190514010105
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190514010105
SQL开始执行时间：20190514010105
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190514010105
SQL开始执行时间：20190514010105



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190514010140
SQL开始执行时间：20190514010140


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190514010140
SQL开始执行时间：20190514010140


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190514010140
SQL开始执行时间：20190514010140

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190514010232

20190514131611开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514131611

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190514131611
SQL开始执行时间：20190514131611
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190514131611
SQL开始执行时间：20190514131611
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190514131611
SQL开始执行时间：20190514131611



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190514131647
SQL开始执行时间：20190514131647


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190514131647
SQL开始执行时间：20190514131647


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190514131647
SQL开始执行时间：20190514131647

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190514131737

20190514170112开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514170112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190514170112
SQL开始执行时间：20190514170112
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190514170112
SQL开始执行时间：20190514170112
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190514170112
SQL开始执行时间：20190514170112



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190514170211
SQL开始执行时间：20190514170211


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190514170211
SQL开始执行时间：20190514170211


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190514170211
SQL开始执行时间：20190514170211

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190514170302

20190515010110开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515010110

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190515010110
SQL开始执行时间：20190515010110
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190515010110
SQL开始执行时间：20190515010110
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190515010110
SQL开始执行时间：20190515010110



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190515010200
SQL开始执行时间：20190515010200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190515010201
SQL开始执行时间：20190515010201


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190515010201
SQL开始执行时间：20190515010201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190515010252

20190515133227开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515133227

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190515133227
SQL开始执行时间：20190515133227
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190515133227
SQL开始执行时间：20190515133227
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190515133227
SQL开始执行时间：20190515133227



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190515133325
SQL开始执行时间：20190515133325


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190515133325
SQL开始执行时间：20190515133325


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190515133325
SQL开始执行时间：20190515133325

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190515133416

20190515170113开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515170113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190515170113
SQL开始执行时间：20190515170113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190515170113
SQL开始执行时间：20190515170113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190515170113
SQL开始执行时间：20190515170113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190515170215
SQL开始执行时间：20190515170215


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190515170215
SQL开始执行时间：20190515170215


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190515170215
SQL开始执行时间：20190515170215

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190515170306

20190516010100开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516010100

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190516010100
SQL开始执行时间：20190516010100
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190516010100
SQL开始执行时间：20190516010100
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190516010100
SQL开始执行时间：20190516010100



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190516010126
SQL开始执行时间：20190516010126


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190516010126
SQL开始执行时间：20190516010126


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190516010126
SQL开始执行时间：20190516010126

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190516010218

20190516170109开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516170109

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190516170110
SQL开始执行时间：20190516170110
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190516170110
SQL开始执行时间：20190516170110
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190516170110
SQL开始执行时间：20190516170110



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190516170142
SQL开始执行时间：20190516170142


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190516170142
SQL开始执行时间：20190516170142


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190516170142
SQL开始执行时间：20190516170142

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190516170234

20190517010108开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517010108

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517010109
SQL开始执行时间：20190517010109
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517010109
SQL开始执行时间：20190517010109
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190517010109
SQL开始执行时间：20190517010109



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190517010137
SQL开始执行时间：20190517010137


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190517010138
SQL开始执行时间：20190517010138


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190517010138
SQL开始执行时间：20190517010138

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190517010228

20190517082835开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517082835

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517082835
SQL开始执行时间：20190517082835
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517082835
SQL开始执行时间：20190517082835
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190517082835
SQL开始执行时间：20190517082835



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190517082907
SQL开始执行时间：20190517082907


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190517082907
SQL开始执行时间：20190517082907


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190517082907
SQL开始执行时间：20190517082907

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190517082957

20190517105509开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190517105509

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517105509
SQL开始执行时间：20190517105509
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517105509
SQL开始执行时间：20190517105509
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190517105509
SQL开始执行时间：20190517105509



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190517105541
SQL开始执行时间：20190517105541


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190517105541
SQL开始执行时间：20190517105541


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190517105541
SQL开始执行时间：20190517105541

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190517105631

20190517170111开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517170111

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517170111
SQL开始执行时间：20190517170111
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517170111
SQL开始执行时间：20190517170111
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190517170111
SQL开始执行时间：20190517170111



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190517170148
SQL开始执行时间：20190517170148


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190517170148
SQL开始执行时间：20190517170148


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190517170149
SQL开始执行时间：20190517170149

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190517170239

20190518010104开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518010104

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190518010104
SQL开始执行时间：20190518010104
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190518010104
SQL开始执行时间：20190518010104
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190518010104
SQL开始执行时间：20190518010104



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190518010133
SQL开始执行时间：20190518010133


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190518010133
SQL开始执行时间：20190518010133


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190518010133
SQL开始执行时间：20190518010133

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190518010224

20190518170102开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518170102

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190518170102
SQL开始执行时间：20190518170102
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190518170102
SQL开始执行时间：20190518170102
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190518170102
SQL开始执行时间：20190518170102



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190518170131
SQL开始执行时间：20190518170131


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190518170131
SQL开始执行时间：20190518170131


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190518170131
SQL开始执行时间：20190518170131

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190518170222

20190519010058开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519010058

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190519010058
SQL开始执行时间：20190519010058
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190519010058
SQL开始执行时间：20190519010058
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190519010058
SQL开始执行时间：20190519010058



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190519010119
SQL开始执行时间：20190519010119


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190519010119
SQL开始执行时间：20190519010119


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190519010119
SQL开始执行时间：20190519010119

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190519010210

20190519170058开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519170058

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190519170059
SQL开始执行时间：20190519170059
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190519170059
SQL开始执行时间：20190519170059
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190519170059
SQL开始执行时间：20190519170059



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190519170119
SQL开始执行时间：20190519170119


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190519170120
SQL开始执行时间：20190519170120


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190519170120
SQL开始执行时间：20190519170120

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190519170211

20190520010101开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520010101

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190520010101
SQL开始执行时间：20190520010101
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190520010101
SQL开始执行时间：20190520010101
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190520010101
SQL开始执行时间：20190520010101



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190520010123
SQL开始执行时间：20190520010123


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190520010123
SQL开始执行时间：20190520010123


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190520010123
SQL开始执行时间：20190520010123

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190520010213

20190520091744开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520091744

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190520091744
SQL开始执行时间：20190520091744
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190520091744
SQL开始执行时间：20190520091744
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190520091744
SQL开始执行时间：20190520091744



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190520091821
SQL开始执行时间：20190520091821


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190520091821
SQL开始执行时间：20190520091821


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190520091821
SQL开始执行时间：20190520091821

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190520091912

20190521082002开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521082002

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190521082002
SQL开始执行时间：20190521082002
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190521082002
SQL开始执行时间：20190521082002
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190521082002
SQL开始执行时间：20190521082002



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190521082038
SQL开始执行时间：20190521082038


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190521082038
SQL开始执行时间：20190521082038


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190521082038
SQL开始执行时间：20190521082038

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190521082130

20190521170119开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521170119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190521170119
SQL开始执行时间：20190521170119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190521170119
SQL开始执行时间：20190521170119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190521170119
SQL开始执行时间：20190521170119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190521170206
SQL开始执行时间：20190521170206


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190521170206
SQL开始执行时间：20190521170206


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190521170206
SQL开始执行时间：20190521170206

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190521170257

20190522010113开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522010113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190522010113
SQL开始执行时间：20190522010113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190522010113
SQL开始执行时间：20190522010113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190522010113
SQL开始执行时间：20190522010113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190522010152
SQL开始执行时间：20190522010152


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190522010152
SQL开始执行时间：20190522010152


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190522010153
SQL开始执行时间：20190522010153

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190522010243

20190522095125开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190522095125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190522095125
SQL开始执行时间：20190522095125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190522095125
SQL开始执行时间：20190522095125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190522095125
SQL开始执行时间：20190522095125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190522095227
SQL开始执行时间：20190522095227


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190522095227
SQL开始执行时间：20190522095227


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190522095227
SQL开始执行时间：20190522095227

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190522095340

20190522170123开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522170123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190522170123
SQL开始执行时间：20190522170123
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190522170123
SQL开始执行时间：20190522170123
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190522170123
SQL开始执行时间：20190522170123



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190522170224
SQL开始执行时间：20190522170224


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190522170225
SQL开始执行时间：20190522170225


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190522170225
SQL开始执行时间：20190522170225

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190522170316

20190523010105开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523010105

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190523010105
SQL开始执行时间：20190523010105
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190523010105
SQL开始执行时间：20190523010105
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190523010105
SQL开始执行时间：20190523010105



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190523010142
SQL开始执行时间：20190523010142


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190523010142
SQL开始执行时间：20190523010142


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190523010142
SQL开始执行时间：20190523010142

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190523010234

20190523170115开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523170115

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190523170115
SQL开始执行时间：20190523170115
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190523170115
SQL开始执行时间：20190523170115
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190523170115
SQL开始执行时间：20190523170115



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190523170213
SQL开始执行时间：20190523170213


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190523170214
SQL开始执行时间：20190523170214


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190523170214
SQL开始执行时间：20190523170214

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190523170309

20190524010105开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524010105

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524010106
SQL开始执行时间：20190524010106
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524010106
SQL开始执行时间：20190524010106
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190524010106
SQL开始执行时间：20190524010106



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190524010140
SQL开始执行时间：20190524010140


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524010140
SQL开始执行时间：20190524010140


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524010141
SQL开始执行时间：20190524010141

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190524010232

20190524134225开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524134225

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524134225
SQL开始执行时间：20190524134225
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524134225
SQL开始执行时间：20190524134225
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190524134225
SQL开始执行时间：20190524134225



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190524134346
SQL开始执行时间：20190524134346


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524134346
SQL开始执行时间：20190524134346


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524134346
SQL开始执行时间：20190524134346

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190524134437

20190524171842开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524171842

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524171843
SQL开始执行时间：20190524171843
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524171843
SQL开始执行时间：20190524171843
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190524171843
SQL开始执行时间：20190524171843



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190524172011
SQL开始执行时间：20190524172011


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524172011
SQL开始执行时间：20190524172011


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;

20190524172640开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524172640

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524172641
SQL开始执行时间：20190524172641
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524172641
SQL开始执行时间：20190524172641
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190524172641
SQL开始执行时间：20190524172641



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190524172810
SQL开始执行时间：20190524172810


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524172810
SQL开始执行时间：20190524172810


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;

20190524173220开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524173220

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524173221
SQL开始执行时间：20190524173221
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524173221
SQL开始执行时间：20190524173221
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190524173221
SQL开始执行时间：20190524173221



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190524173339
SQL开始执行时间：20190524173339


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524173340
SQL开始执行时间：20190524173340


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524173340
SQL开始执行时间：20190524173340

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190524173431

20190524173557开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524173557

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524173558
SQL开始执行时间：20190524173558
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524173558
SQL开始执行时间：20190524173558
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190524173558
SQL开始执行时间：20190524173558



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190524173716
SQL开始执行时间：20190524173716


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524173717
SQL开始执行时间：20190524173717


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524173717
SQL开始执行时间：20190524173717

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190524173809

20190525010103开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525010103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190525010104
SQL开始执行时间：20190525010104
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190525010104
SQL开始执行时间：20190525010104
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190525010104
SQL开始执行时间：20190525010104



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190525010136
SQL开始执行时间：20190525010136


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190525010136
SQL开始执行时间：20190525010136


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190525010136
SQL开始执行时间：20190525010136

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190525010228

20190525170103开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525170103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190525170103
SQL开始执行时间：20190525170103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190525170103
SQL开始执行时间：20190525170103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190525170103
SQL开始执行时间：20190525170103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190525170135
SQL开始执行时间：20190525170135


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190525170136
SQL开始执行时间：20190525170136


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190525170136
SQL开始执行时间：20190525170136

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190525170227

20190526010100开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526010100

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190526010100
SQL开始执行时间：20190526010100
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190526010100
SQL开始执行时间：20190526010100
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190526010100
SQL开始执行时间：20190526010100



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190526010122
SQL开始执行时间：20190526010122


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190526010123
SQL开始执行时间：20190526010123


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190526010123
SQL开始执行时间：20190526010123

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190526010214

20190526170100开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526170100

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190526170100
SQL开始执行时间：20190526170100
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190526170100
SQL开始执行时间：20190526170100
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190526170100
SQL开始执行时间：20190526170100



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190526170122
SQL开始执行时间：20190526170122


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190526170123
SQL开始执行时间：20190526170123


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190526170123
SQL开始执行时间：20190526170123

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190526170214

20190527010113开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527010113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190527010113
SQL开始执行时间：20190527010113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190527010113
SQL开始执行时间：20190527010113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190527010113
SQL开始执行时间：20190527010113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190527010135
SQL开始执行时间：20190527010135


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190527010136
SQL开始执行时间：20190527010136


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190527010136
SQL开始执行时间：20190527010136

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190527010227

20190527182002开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527182002

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190527182002
SQL开始执行时间：20190527182002
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190527182002
SQL开始执行时间：20190527182002
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190527182002
SQL开始执行时间：20190527182002



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190527182042
SQL开始执行时间：20190527182042


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190527182042
SQL开始执行时间：20190527182042


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190527182042
SQL开始执行时间：20190527182042

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190527182134

20190528010114开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528010114

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190528010114
SQL开始执行时间：20190528010114
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190528010114
SQL开始执行时间：20190528010114
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190528010114
SQL开始执行时间：20190528010114



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190528010153
SQL开始执行时间：20190528010153


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190528010153
SQL开始执行时间：20190528010153


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190528010154
SQL开始执行时间：20190528010154

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190528010245

20190528170117开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528170117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190528170117
SQL开始执行时间：20190528170117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190528170117
SQL开始执行时间：20190528170117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190528170117
SQL开始执行时间：20190528170117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190528170207
SQL开始执行时间：20190528170207


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190528170207
SQL开始执行时间：20190528170207


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190528170207
SQL开始执行时间：20190528170207

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190528170300

20190529010113开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529010113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190529010113
SQL开始执行时间：20190529010113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529010113
SQL开始执行时间：20190529010113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190529010113
SQL开始执行时间：20190529010113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190529010155
SQL开始执行时间：20190529010155


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190529010155
SQL开始执行时间：20190529010155


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190529010155
SQL开始执行时间：20190529010155

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190529010250

20190529093108开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529093108

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190529093108
SQL开始执行时间：20190529093108
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529093108
SQL开始执行时间：20190529093108
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190529093108
SQL开始执行时间：20190529093108



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190529093252
SQL开始执行时间：20190529093252


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190529093252
SQL开始执行时间：20190529093252


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190529093253
SQL开始执行时间：20190529093253

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190529093347

20190529100325开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529100325

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190529100325
SQL开始执行时间：20190529100325
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529100325
SQL开始执行时间：20190529100325
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190529100325
SQL开始执行时间：20190529100325



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190529100537
SQL开始执行时间：20190529100537


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190529100537
SQL开始执行时间：20190529100537


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190529100538
SQL开始执行时间：20190529100538

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190529100656

20190529170116开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529170116

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190529170116
SQL开始执行时间：20190529170116
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529170116
SQL开始执行时间：20190529170116
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190529170116
SQL开始执行时间：20190529170116



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190529170305
SQL开始执行时间：20190529170305


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190529170305
SQL开始执行时间：20190529170305


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190529170305
SQL开始执行时间：20190529170305

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190529170358

20190530010106开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530010106

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190530010106
SQL开始执行时间：20190530010106
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190530010106
SQL开始执行时间：20190530010106
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190530010106
SQL开始执行时间：20190530010106



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190530010139
SQL开始执行时间：20190530010139


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190530010139
SQL开始执行时间：20190530010139


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190530010139
SQL开始执行时间：20190530010139

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190530010230

20190530170118开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530170118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190530170119
SQL开始执行时间：20190530170119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190530170119
SQL开始执行时间：20190530170119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190530170119
SQL开始执行时间：20190530170119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190530170200
SQL开始执行时间：20190530170200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190530170200
SQL开始执行时间：20190530170200


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190530170200
SQL开始执行时间：20190530170200

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190530170252

20190531010106开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531010106

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190531010107
SQL开始执行时间：20190531010107
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190531010107
SQL开始执行时间：20190531010107
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190531010107
SQL开始执行时间：20190531010107



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190531010143
SQL开始执行时间：20190531010143


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190531010143
SQL开始执行时间：20190531010143


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190531010143
SQL开始执行时间：20190531010143

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190531010236

20190531100410开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531100410

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190531100411
SQL开始执行时间：20190531100411
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190531100411
SQL开始执行时间：20190531100411
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190531100411
SQL开始执行时间：20190531100411



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190531100516
SQL开始执行时间：20190531100516


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190531100516
SQL开始执行时间：20190531100516


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190531100517
SQL开始执行时间：20190531100517

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190531100609

20190531170112开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531170112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190531170112
SQL开始执行时间：20190531170112
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190531170112
SQL开始执行时间：20190531170112
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190531170112
SQL开始执行时间：20190531170112



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190531170222
SQL开始执行时间：20190531170222


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190531170222
SQL开始执行时间：20190531170222


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190531170222
SQL开始执行时间：20190531170222

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190531170317

20190601010101开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601010101

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190601010101
SQL开始执行时间：20190601010101
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190601010101
SQL开始执行时间：20190601010101
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190601010101
SQL开始执行时间：20190601010101



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190601010129
SQL开始执行时间：20190601010129


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190601010129
SQL开始执行时间：20190601010129


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190601010129
SQL开始执行时间：20190601010129

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190601010222

20190601170105开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601170105

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190601170105
SQL开始执行时间：20190601170105
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190601170105
SQL开始执行时间：20190601170105
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190601170105
SQL开始执行时间：20190601170105



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190601170133
SQL开始执行时间：20190601170133


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190601170134
SQL开始执行时间：20190601170134


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190601170134
SQL开始执行时间：20190601170134

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190601170227

20190602010059开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602010059

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190602010059
SQL开始执行时间：20190602010059
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190602010059
SQL开始执行时间：20190602010059
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190602010059
SQL开始执行时间：20190602010059



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190602010122
SQL开始执行时间：20190602010122


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190602010122
SQL开始执行时间：20190602010122


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190602010122
SQL开始执行时间：20190602010122

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190602010216

20190602170057开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602170057

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190602170057
SQL开始执行时间：20190602170057
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190602170057
SQL开始执行时间：20190602170057
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190602170057
SQL开始执行时间：20190602170057



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190602170119
SQL开始执行时间：20190602170119


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190602170120
SQL开始执行时间：20190602170120


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190602170120
SQL开始执行时间：20190602170120

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190602170213

20190603010100开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603010100

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190603010100
SQL开始执行时间：20190603010100
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190603010100
SQL开始执行时间：20190603010100
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190603010100
SQL开始执行时间：20190603010100



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190603010123
SQL开始执行时间：20190603010123


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190603010123
SQL开始执行时间：20190603010123


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190603010123
SQL开始执行时间：20190603010123

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190603010217

20190603170105开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603170105

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190603170106
SQL开始执行时间：20190603170106
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190603170106
SQL开始执行时间：20190603170106
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190603170106
SQL开始执行时间：20190603170106



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190603170140
SQL开始执行时间：20190603170140


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190603170140
SQL开始执行时间：20190603170140


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190603170141
SQL开始执行时间：20190603170141

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190603170235

20190604010104开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604010104

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190604010104
SQL开始执行时间：20190604010104
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190604010104
SQL开始执行时间：20190604010104
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190604010104
SQL开始执行时间：20190604010104



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190604010140
SQL开始执行时间：20190604010140


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190604010140
SQL开始执行时间：20190604010140


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190604010140
SQL开始执行时间：20190604010140

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190604010234

20190604170110开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604170110

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190604170110
SQL开始执行时间：20190604170110
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190604170110
SQL开始执行时间：20190604170110
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190604170110
SQL开始执行时间：20190604170110



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190604170153
SQL开始执行时间：20190604170153


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190604170153
SQL开始执行时间：20190604170153


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190604170153
SQL开始执行时间：20190604170153

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190604170247

20190605010107开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605010107

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190605010107
SQL开始执行时间：20190605010107
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605010107
SQL开始执行时间：20190605010107
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190605010107
SQL开始执行时间：20190605010107



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190605010141
SQL开始执行时间：20190605010141


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190605010141
SQL开始执行时间：20190605010141


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190605010141
SQL开始执行时间：20190605010141

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190605010235

20190605111936开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605111936

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190605111936
SQL开始执行时间：20190605111936
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605111936
SQL开始执行时间：20190605111936
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190605111936
SQL开始执行时间：20190605111936



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190605112321
SQL开始执行时间：20190605112321


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190605112322
SQL开始执行时间：20190605112322


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190605112322
SQL开始执行时间：20190605112322

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190605112416

20190605170108开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605170108

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190605170108
SQL开始执行时间：20190605170108
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605170108
SQL开始执行时间：20190605170108
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190605170108
SQL开始执行时间：20190605170108



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190605170502
SQL开始执行时间：20190605170502


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190605170502
SQL开始执行时间：20190605170502


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190605170503
SQL开始执行时间：20190605170503

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190605170556

20190606010104开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606010104

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190606010104
SQL开始执行时间：20190606010104
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190606010104
SQL开始执行时间：20190606010104
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190606010104
SQL开始执行时间：20190606010104



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190606010134
SQL开始执行时间：20190606010134


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190606010134
SQL开始执行时间：20190606010134


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190606010134
SQL开始执行时间：20190606010134

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190606010229

20190606170107开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606170107

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190606170107
SQL开始执行时间：20190606170107
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190606170107
SQL开始执行时间：20190606170107
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190606170107
SQL开始执行时间：20190606170107



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190606170145
SQL开始执行时间：20190606170145


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190606170145
SQL开始执行时间：20190606170145


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190606170145
SQL开始执行时间：20190606170145

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190606170241

20190607010106开始执行2019-06-06数据加载日志:
SQL开始执行时间：20190607010106

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190607010106
SQL开始执行时间：20190607010106
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190607010106
SQL开始执行时间：20190607010106
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190607010106
SQL开始执行时间：20190607010106



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190607010141
SQL开始执行时间：20190607010141


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190607010141
SQL开始执行时间：20190607010141


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190607010141
SQL开始执行时间：20190607010141

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190607010236

20190607170109开始执行2019-06-06数据加载日志:
SQL开始执行时间：20190607170109

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190607170109
SQL开始执行时间：20190607170109
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190607170109
SQL开始执行时间：20190607170109
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190607170109
SQL开始执行时间：20190607170109



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190607170144
SQL开始执行时间：20190607170144


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190607170144
SQL开始执行时间：20190607170144


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190607170144
SQL开始执行时间：20190607170144

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190607170238

20190608010103开始执行2019-06-07数据加载日志:
SQL开始执行时间：20190608010103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190608010103
SQL开始执行时间：20190608010103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190608010103
SQL开始执行时间：20190608010103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190608010103
SQL开始执行时间：20190608010103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190608010127
SQL开始执行时间：20190608010127


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190608010127
SQL开始执行时间：20190608010127


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190608010127
SQL开始执行时间：20190608010127

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190608010222

20190608170100开始执行2019-06-07数据加载日志:
SQL开始执行时间：20190608170100

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190608170100
SQL开始执行时间：20190608170100
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190608170100
SQL开始执行时间：20190608170100
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190608170100
SQL开始执行时间：20190608170100



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190608170124
SQL开始执行时间：20190608170124


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190608170124
SQL开始执行时间：20190608170124


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190608170124
SQL开始执行时间：20190608170124

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190608170218

20190609010118开始执行2019-06-08数据加载日志:
SQL开始执行时间：20190609010118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190609010118
SQL开始执行时间：20190609010118
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190609010118
SQL开始执行时间：20190609010118
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190609010118
SQL开始执行时间：20190609010118



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190609010142
SQL开始执行时间：20190609010142


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190609010142
SQL开始执行时间：20190609010142


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190609010143
SQL开始执行时间：20190609010143

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190609010238

20190609170101开始执行2019-06-08数据加载日志:
SQL开始执行时间：20190609170101

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190609170102
SQL开始执行时间：20190609170102
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190609170102
SQL开始执行时间：20190609170102
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190609170102
SQL开始执行时间：20190609170102



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190609170126
SQL开始执行时间：20190609170126


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190609170127
SQL开始执行时间：20190609170127


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190609170127
SQL开始执行时间：20190609170127

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190609170224

20190610010111开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610010111

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190610010111
SQL开始执行时间：20190610010111
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610010111
SQL开始执行时间：20190610010111
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190610010111
SQL开始执行时间：20190610010111



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190610010135
SQL开始执行时间：20190610010135


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190610010135
SQL开始执行时间：20190610010135


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190610010135
SQL开始执行时间：20190610010135

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190610010230

20190610160708开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610160708

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190610160708
SQL开始执行时间：20190610160708
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610160708
SQL开始执行时间：20190610160708
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190610160708
SQL开始执行时间：20190610160708



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190610160804
SQL开始执行时间：20190610160804


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190610160804
SQL开始执行时间：20190610160804


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190610160804
SQL开始执行时间：20190610160804

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190610160858

20190610162216开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610162216

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190610162216
SQL开始执行时间：20190610162216
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610162216
SQL开始执行时间：20190610162216
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190610162216
SQL开始执行时间：20190610162216



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190610162311
SQL开始执行时间：20190610162311


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190610162312
SQL开始执行时间：20190610162312


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190610162312
SQL开始执行时间：20190610162312

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190610162408

20190610170103开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610170103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190610170103
SQL开始执行时间：20190610170103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610170103
SQL开始执行时间：20190610170103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190610170103
SQL开始执行时间：20190610170103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190610170203
SQL开始执行时间：20190610170203


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190610170203
SQL开始执行时间：20190610170203


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190610170203
SQL开始执行时间：20190610170203

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190610170257

20190611010107开始执行2019-06-10数据加载日志:
SQL开始执行时间：20190611010107

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190611010108
SQL开始执行时间：20190611010108
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190611010108
SQL开始执行时间：20190611010108
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190611010108
SQL开始执行时间：20190611010108



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190611010143
SQL开始执行时间：20190611010143


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190611010143
SQL开始执行时间：20190611010143


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190611010143
SQL开始执行时间：20190611010143

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190611010238

20190611170115开始执行2019-06-10数据加载日志:
SQL开始执行时间：20190611170115

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190611170115
SQL开始执行时间：20190611170115
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190611170115
SQL开始执行时间：20190611170115
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190611170115
SQL开始执行时间：20190611170115



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190611170203
SQL开始执行时间：20190611170203


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190611170204
SQL开始执行时间：20190611170204


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190611170204
SQL开始执行时间：20190611170204

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190611170258

20190612010113开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612010113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190612010114
SQL开始执行时间：20190612010114
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190612010114
SQL开始执行时间：20190612010114
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190612010114
SQL开始执行时间：20190612010114



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190612010200
SQL开始执行时间：20190612010200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190612010201
SQL开始执行时间：20190612010201


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190612010201
SQL开始执行时间：20190612010201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190612010256

20190612102221开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612102221

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190612102222
SQL开始执行时间：20190612102222
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190612102222
SQL开始执行时间：20190612102222
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190612102222
SQL开始执行时间：20190612102222



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190612102310
SQL开始执行时间：20190612102310


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190612102311
SQL开始执行时间：20190612102311


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190612102311
SQL开始执行时间：20190612102311

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190612102406

20190612170119开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612170119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190612170119
SQL开始执行时间：20190612170119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190612170119
SQL开始执行时间：20190612170119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190612170119
SQL开始执行时间：20190612170119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190612170214
SQL开始执行时间：20190612170214


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190612170214
SQL开始执行时间：20190612170214


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190612170214
SQL开始执行时间：20190612170214

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190612170317

20190613010122开始执行2019-06-12数据加载日志:
SQL开始执行时间：20190613010122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190613010122
SQL开始执行时间：20190613010122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190613010122
SQL开始执行时间：20190613010122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190613010122
SQL开始执行时间：20190613010122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190613010157
SQL开始执行时间：20190613010157


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190613010158
SQL开始执行时间：20190613010158


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190613010158
SQL开始执行时间：20190613010158

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190613010253

20190613170115开始执行2019-06-12数据加载日志:
SQL开始执行时间：20190613170115

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190613170115
SQL开始执行时间：20190613170115
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190613170115
SQL开始执行时间：20190613170115
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190613170115
SQL开始执行时间：20190613170115



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190613170158
SQL开始执行时间：20190613170158


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190613170158
SQL开始执行时间：20190613170158


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190613170158
SQL开始执行时间：20190613170158

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190613170256

20190614010113开始执行2019-06-13数据加载日志:
SQL开始执行时间：20190614010113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190614010113
SQL开始执行时间：20190614010113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190614010113
SQL开始执行时间：20190614010113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190614010113
SQL开始执行时间：20190614010113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190614010151
SQL开始执行时间：20190614010151


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190614010151
SQL开始执行时间：20190614010151


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190614010151
SQL开始执行时间：20190614010151

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190614010249

20190614170119开始执行2019-06-13数据加载日志:
SQL开始执行时间：20190614170119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190614170119
SQL开始执行时间：20190614170119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190614170119
SQL开始执行时间：20190614170119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190614170119
SQL开始执行时间：20190614170119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190614170208
SQL开始执行时间：20190614170208


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190614170209
SQL开始执行时间：20190614170209


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190614170209
SQL开始执行时间：20190614170209

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190614170306

20190615010108开始执行2019-06-14数据加载日志:
SQL开始执行时间：20190615010108

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190615010109
SQL开始执行时间：20190615010109
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190615010109
SQL开始执行时间：20190615010109
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190615010109
SQL开始执行时间：20190615010109



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190615010146
SQL开始执行时间：20190615010146


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190615010146
SQL开始执行时间：20190615010146


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190615010146
SQL开始执行时间：20190615010146

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190615010244

20190615170108开始执行2019-06-14数据加载日志:
SQL开始执行时间：20190615170108

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190615170108
SQL开始执行时间：20190615170108
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190615170108
SQL开始执行时间：20190615170108
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190615170108
SQL开始执行时间：20190615170108



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190615170146
SQL开始执行时间：20190615170146


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190615170146
SQL开始执行时间：20190615170146


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190615170146
SQL开始执行时间：20190615170146

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190615170243

20190616010103开始执行2019-06-15数据加载日志:
SQL开始执行时间：20190616010103

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190616010103
SQL开始执行时间：20190616010103
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190616010103
SQL开始执行时间：20190616010103
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190616010103
SQL开始执行时间：20190616010103



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190616010128
SQL开始执行时间：20190616010128


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190616010128
SQL开始执行时间：20190616010128


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190616010128
SQL开始执行时间：20190616010128

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190616010226

20190616170105开始执行2019-06-15数据加载日志:
SQL开始执行时间：20190616170105

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190616170105
SQL开始执行时间：20190616170105
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190616170105
SQL开始执行时间：20190616170105
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190616170105
SQL开始执行时间：20190616170105



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190616170130
SQL开始执行时间：20190616170130


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190616170130
SQL开始执行时间：20190616170130


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190616170130
SQL开始执行时间：20190616170130

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190616170228

20190617010102开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617010102

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190617010102
SQL开始执行时间：20190617010102
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190617010102
SQL开始执行时间：20190617010102
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190617010102
SQL开始执行时间：20190617010102



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190617010127
SQL开始执行时间：20190617010127


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190617010127
SQL开始执行时间：20190617010127


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190617010127
SQL开始执行时间：20190617010127

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190617010225

20190617155354开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617155354

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190617155355
SQL开始执行时间：20190617155355
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190617155355
SQL开始执行时间：20190617155355
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190617155355
SQL开始执行时间：20190617155355



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190617155443
SQL开始执行时间：20190617155443


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190617155444
SQL开始执行时间：20190617155444


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190617155444
SQL开始执行时间：20190617155444

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190617155543

20190617170109开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617170109

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190617170110
SQL开始执行时间：20190617170110
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190617170110
SQL开始执行时间：20190617170110
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190617170110
SQL开始执行时间：20190617170110



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190617170208
SQL开始执行时间：20190617170208


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190617170208
SQL开始执行时间：20190617170208


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190617170208
SQL开始执行时间：20190617170208

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190617170306

20190618010110开始执行2019-06-17数据加载日志:
SQL开始执行时间：20190618010110

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190618010110
SQL开始执行时间：20190618010110
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190618010110
SQL开始执行时间：20190618010110
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190618010110
SQL开始执行时间：20190618010110



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190618010146
SQL开始执行时间：20190618010146


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190618010146
SQL开始执行时间：20190618010146


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190618010146
SQL开始执行时间：20190618010146

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190618010245

20190618170121开始执行2019-06-17数据加载日志:
SQL开始执行时间：20190618170121

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190618170121
SQL开始执行时间：20190618170121
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190618170121
SQL开始执行时间：20190618170121
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190618170121
SQL开始执行时间：20190618170121



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190618170223
SQL开始执行时间：20190618170223


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190618170223
SQL开始执行时间：20190618170223


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190618170223
SQL开始执行时间：20190618170223

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190618170323

20190619010116开始执行2019-06-18数据加载日志:
SQL开始执行时间：20190619010116

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190619010117
SQL开始执行时间：20190619010117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190619010117
SQL开始执行时间：20190619010117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190619010117
SQL开始执行时间：20190619010117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190619010208
SQL开始执行时间：20190619010208


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190619010208
SQL开始执行时间：20190619010208


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190619010208
SQL开始执行时间：20190619010208

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190619010308

20190619170121开始执行2019-06-18数据加载日志:
SQL开始执行时间：20190619170121

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190619170121
SQL开始执行时间：20190619170121
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190619170121
SQL开始执行时间：20190619170121
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190619170121
SQL开始执行时间：20190619170121



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190619170221
SQL开始执行时间：20190619170221


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190619170221
SQL开始执行时间：20190619170221


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190619170221
SQL开始执行时间：20190619170221

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190619170321

20190620010112开始执行2019-06-19数据加载日志:
SQL开始执行时间：20190620010112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190620010112
SQL开始执行时间：20190620010112
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190620010112
SQL开始执行时间：20190620010112
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190620010112
SQL开始执行时间：20190620010112



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190620010147
SQL开始执行时间：20190620010147


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190620010148
SQL开始执行时间：20190620010148


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190620010148
SQL开始执行时间：20190620010148

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190620010247

20190620170124开始执行2019-06-19数据加载日志:
SQL开始执行时间：20190620170124

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190620170124
SQL开始执行时间：20190620170124
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190620170124
SQL开始执行时间：20190620170124
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190620170124
SQL开始执行时间：20190620170124



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190620170219
SQL开始执行时间：20190620170219


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190620170219
SQL开始执行时间：20190620170219


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190620170219
SQL开始执行时间：20190620170219

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190620170320

20190621010118开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190621010118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190621010118
SQL开始执行时间：20190621010118
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190621010118
SQL开始执行时间：20190621010118
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190621010118
SQL开始执行时间：20190621010118



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190621010205
SQL开始执行时间：20190621010205


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190621010205
SQL开始执行时间：20190621010205


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190621010205
SQL开始执行时间：20190621010205

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190621010306

20190621170130开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190621170130

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190621170131
SQL开始执行时间：20190621170131
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190621170131
SQL开始执行时间：20190621170131
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190621170131
SQL开始执行时间：20190621170131



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190621170223
SQL开始执行时间：20190621170223


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190621170223
SQL开始执行时间：20190621170223


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190621170223
SQL开始执行时间：20190621170223

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190621170324

20190622010111开始执行2019-06-21数据加载日志:
SQL开始执行时间：20190622010111

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190622010111
SQL开始执行时间：20190622010111
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190622010111
SQL开始执行时间：20190622010111
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190622010111
SQL开始执行时间：20190622010111



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190622010147
SQL开始执行时间：20190622010147


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190622010147
SQL开始执行时间：20190622010147


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190622010147
SQL开始执行时间：20190622010147

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190622010248

20190622170113开始执行2019-06-21数据加载日志:
SQL开始执行时间：20190622170113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190622170113
SQL开始执行时间：20190622170113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190622170113
SQL开始执行时间：20190622170113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190622170113
SQL开始执行时间：20190622170113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190622170149
SQL开始执行时间：20190622170149


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190622170149
SQL开始执行时间：20190622170149


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190622170149
SQL开始执行时间：20190622170149

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190622170250

20190623010107开始执行2019-06-22数据加载日志:
SQL开始执行时间：20190623010107

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190623010108
SQL开始执行时间：20190623010108
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190623010108
SQL开始执行时间：20190623010108
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190623010108
SQL开始执行时间：20190623010108



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190623010134
SQL开始执行时间：20190623010134


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190623010135
SQL开始执行时间：20190623010135


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190623010135
SQL开始执行时间：20190623010135

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190623010235

20190623170106开始执行2019-06-22数据加载日志:
SQL开始执行时间：20190623170106

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190623170106
SQL开始执行时间：20190623170106
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190623170106
SQL开始执行时间：20190623170106
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190623170106
SQL开始执行时间：20190623170106



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190623170132
SQL开始执行时间：20190623170132


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190623170133
SQL开始执行时间：20190623170133


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190623170133
SQL开始执行时间：20190623170133

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190623170235

20190624010122开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624010122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190624010122
SQL开始执行时间：20190624010122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624010122
SQL开始执行时间：20190624010122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190624010122
SQL开始执行时间：20190624010122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190624010149
SQL开始执行时间：20190624010149


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190624010149
SQL开始执行时间：20190624010149


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190624010149
SQL开始执行时间：20190624010149

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190624010252

20190624084327开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624084327

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190624084328
SQL开始执行时间：20190624084328
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624084328
SQL开始执行时间：20190624084328
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190624084328
SQL开始执行时间：20190624084328



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190624084454
SQL开始执行时间：20190624084454


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190624084454
SQL开始执行时间：20190624084454


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190624084454
SQL开始执行时间：20190624084454

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190624084556

20190624092554开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624092554

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190624092554
SQL开始执行时间：20190624092554
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624092554
SQL开始执行时间：20190624092554
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190624092554
SQL开始执行时间：20190624092554



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190624092729
SQL开始执行时间：20190624092729


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190624092729
SQL开始执行时间：20190624092729


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190624092729
SQL开始执行时间：20190624092729

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190624092830

20190624170113开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624170113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190624170114
SQL开始执行时间：20190624170114
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624170114
SQL开始执行时间：20190624170114
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190624170114
SQL开始执行时间：20190624170114



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190624170252
SQL开始执行时间：20190624170252


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190624170252
SQL开始执行时间：20190624170252


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190624170252
SQL开始执行时间：20190624170252

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190624170356

20190625010119开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190625010119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190625010119
SQL开始执行时间：20190625010119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190625010119
SQL开始执行时间：20190625010119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190625010119
SQL开始执行时间：20190625010119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190625010203
SQL开始执行时间：20190625010203


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190625010204
SQL开始执行时间：20190625010204


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190625010204
SQL开始执行时间：20190625010204

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190625010307

20190625170121开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190625170121

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190625170122
SQL开始执行时间：20190625170122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190625170122
SQL开始执行时间：20190625170122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190625170122
SQL开始执行时间：20190625170122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190625170213
SQL开始执行时间：20190625170213


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190625170213
SQL开始执行时间：20190625170213


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190625170213
SQL开始执行时间：20190625170213

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190625170317

20190626010118开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190626010118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190626010119
SQL开始执行时间：20190626010119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190626010119
SQL开始执行时间：20190626010119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190626010119
SQL开始执行时间：20190626010119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190626010204
SQL开始执行时间：20190626010204


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190626010205
SQL开始执行时间：20190626010205


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190626010205
SQL开始执行时间：20190626010205

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190626010309

20190626170126开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190626170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190626170127
SQL开始执行时间：20190626170127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190626170127
SQL开始执行时间：20190626170127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190626170127
SQL开始执行时间：20190626170127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190626170225
SQL开始执行时间：20190626170225


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190626170225
SQL开始执行时间：20190626170225


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190626170225
SQL开始执行时间：20190626170225

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190626170329

20190627010126开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627010126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190627010126
SQL开始执行时间：20190627010126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190627010126
SQL开始执行时间：20190627010126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190627010126
SQL开始执行时间：20190627010126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190627010216
SQL开始执行时间：20190627010216


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190627010216
SQL开始执行时间：20190627010216


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190627010216
SQL开始执行时间：20190627010216

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190627010321

20190627091506开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627091506

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190627091506
SQL开始执行时间：20190627091506
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190627091506
SQL开始执行时间：20190627091506
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190627091506
SQL开始执行时间：20190627091506



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190627091652
SQL开始执行时间：20190627091652


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190627091652
SQL开始执行时间：20190627091652


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190627091652
SQL开始执行时间：20190627091652

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190627091816

20190627170132开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627170132

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190627170132
SQL开始执行时间：20190627170132
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190627170132
SQL开始执行时间：20190627170132
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190627170132
SQL开始执行时间：20190627170132



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190627170323
SQL开始执行时间：20190627170323


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190627170324
SQL开始执行时间：20190627170324


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190627170324
SQL开始执行时间：20190627170324

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190627170432

20190628010127开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628010127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190628010127
SQL开始执行时间：20190628010127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628010127
SQL开始执行时间：20190628010127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190628010127
SQL开始执行时间：20190628010127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190628010225
SQL开始执行时间：20190628010225


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190628010226
SQL开始执行时间：20190628010226


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190628010226
SQL开始执行时间：20190628010226

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190628010333

20190628133832开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628133832

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190628133832
SQL开始执行时间：20190628133832
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628133832
SQL开始执行时间：20190628133832
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190628133832
SQL开始执行时间：20190628133832



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190628134006
SQL开始执行时间：20190628134006


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190628134006
SQL开始执行时间：20190628134006


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190628134006
SQL开始执行时间：20190628134006

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190628134130

20190628170131开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628170131

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190628170132
SQL开始执行时间：20190628170132
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628170132
SQL开始执行时间：20190628170132
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190628170132
SQL开始执行时间：20190628170132



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190628170306
SQL开始执行时间：20190628170306


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190628170307
SQL开始执行时间：20190628170307


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190628170307
SQL开始执行时间：20190628170307

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190628170416

20190629010129开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629010129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190629010129
SQL开始执行时间：20190629010129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190629010129
SQL开始执行时间：20190629010129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190629010129
SQL开始执行时间：20190629010129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190629010227
SQL开始执行时间：20190629010227


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190629010227
SQL开始执行时间：20190629010227


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190629010227
SQL开始执行时间：20190629010227

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190629010339

20190629170126开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190629170126
SQL开始执行时间：20190629170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190629170126
SQL开始执行时间：20190629170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190629170126
SQL开始执行时间：20190629170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190629170225
SQL开始执行时间：20190629170225


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190629170225
SQL开始执行时间：20190629170225


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190629170225
SQL开始执行时间：20190629170225

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190629170337

20190630010111开始执行2019-06-29数据加载日志:
SQL开始执行时间：20190630010111

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190630010111
SQL开始执行时间：20190630010111
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190630010111
SQL开始执行时间：20190630010111
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190630010111
SQL开始执行时间：20190630010111



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190630010144
SQL开始执行时间：20190630010144


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190630010144
SQL开始执行时间：20190630010144


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190630010144
SQL开始执行时间：20190630010144

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190630010255

20190630170109开始执行2019-06-29数据加载日志:
SQL开始执行时间：20190630170109

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190630170109
SQL开始执行时间：20190630170109
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190630170109
SQL开始执行时间：20190630170109
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190630170109
SQL开始执行时间：20190630170109



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190630170142
SQL开始执行时间：20190630170142


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190630170142
SQL开始执行时间：20190630170142


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190630170142
SQL开始执行时间：20190630170142

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190630170254

20190701010112开始执行2019-06-30数据加载日志:
SQL开始执行时间：20190701010112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190701010112
SQL开始执行时间：20190701010112
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190701010112
SQL开始执行时间：20190701010112
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190701010112
SQL开始执行时间：20190701010112



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190701010144
SQL开始执行时间：20190701010144


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190701010144
SQL开始执行时间：20190701010144


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190701010145
SQL开始执行时间：20190701010145

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190701010257

20190701170112开始执行2019-06-30数据加载日志:
SQL开始执行时间：20190701170112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190701170112
SQL开始执行时间：20190701170112
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190701170112
SQL开始执行时间：20190701170112
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190701170112
SQL开始执行时间：20190701170112



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190701170147
SQL开始执行时间：20190701170147


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190701170148
SQL开始执行时间：20190701170148


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190701170148
SQL开始执行时间：20190701170148

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190701170259

20190702010113开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702010113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-07-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190702010114
SQL开始执行时间：20190702010114
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702010114
SQL开始执行时间：20190702010114
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190702010114
SQL开始执行时间：20190702010114



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190702010151
SQL开始执行时间：20190702010151


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190702010151
SQL开始执行时间：20190702010151


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190702010151
SQL开始执行时间：20190702010151

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190702010301

20190702165240开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702165240

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190702165240
SQL开始执行时间：20190702165240
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702165240
SQL开始执行时间：20190702165240
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190702165240
SQL开始执行时间：20190702165240



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190702165358
SQL开始执行时间：20190702165358


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190702165358
SQL开始执行时间：20190702165358


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190702165358
SQL开始执行时间：20190702165358

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190702165507

20190702170116开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702170116

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190702170116
SQL开始执行时间：20190702170116
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702170116
SQL开始执行时间：20190702170116
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190702170116
SQL开始执行时间：20190702170116



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190702170245
SQL开始执行时间：20190702170245


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190702170245
SQL开始执行时间：20190702170245


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190702170245
SQL开始执行时间：20190702170245

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190702170355

20190703010114开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703010114

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190703010114
SQL开始执行时间：20190703010114
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190703010114
SQL开始执行时间：20190703010114
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190703010114
SQL开始执行时间：20190703010114



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190703010244
SQL开始执行时间：20190703010244


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190703010244
SQL开始执行时间：20190703010244


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190703010245
SQL开始执行时间：20190703010245

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190703010354

20190703170118开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703170118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190703170118
SQL开始执行时间：20190703170118
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190703170118
SQL开始执行时间：20190703170118
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190703170118
SQL开始执行时间：20190703170118



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190703170258
SQL开始执行时间：20190703170258


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190703170259
SQL开始执行时间：20190703170259


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190703170259
SQL开始执行时间：20190703170259

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190703170410

20190704010117开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704010117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190704010117
SQL开始执行时间：20190704010117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704010117
SQL开始执行时间：20190704010117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190704010117
SQL开始执行时间：20190704010117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190704010211
SQL开始执行时间：20190704010211


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190704010211
SQL开始执行时间：20190704010211


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190704010211
SQL开始执行时间：20190704010211

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190704010321

20190704170126开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190704170126
SQL开始执行时间：20190704170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704170126
SQL开始执行时间：20190704170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190704170126
SQL开始执行时间：20190704170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190704170228
SQL开始执行时间：20190704170228


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190704170228
SQL开始执行时间：20190704170228


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190704170228
SQL开始执行时间：20190704170228

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190704170340

20190705010116开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705010116

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190705010116
SQL开始执行时间：20190705010116
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190705010116
SQL开始执行时间：20190705010116
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190705010116
SQL开始执行时间：20190705010116



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190705010208
SQL开始执行时间：20190705010208


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190705010208
SQL开始执行时间：20190705010208


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190705010208
SQL开始执行时间：20190705010208

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190705010321

20190705170123开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705170123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190705170124
SQL开始执行时间：20190705170124
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190705170124
SQL开始执行时间：20190705170124
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190705170124
SQL开始执行时间：20190705170124



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190705170222
SQL开始执行时间：20190705170222


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190705170222
SQL开始执行时间：20190705170222


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190705170223
SQL开始执行时间：20190705170223

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190705170334

20190706010122开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706010122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190706010122
SQL开始执行时间：20190706010122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190706010122
SQL开始执行时间：20190706010122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190706010122
SQL开始执行时间：20190706010122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190706010212
SQL开始执行时间：20190706010212


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190706010212
SQL开始执行时间：20190706010212


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190706010212
SQL开始执行时间：20190706010212

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190706010324

20190706170123开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706170123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190706170123
SQL开始执行时间：20190706170123
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190706170123
SQL开始执行时间：20190706170123
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190706170123
SQL开始执行时间：20190706170123



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190706170213
SQL开始执行时间：20190706170213


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190706170213
SQL开始执行时间：20190706170213


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190706170213
SQL开始执行时间：20190706170213

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190706170324

20190707010111开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707010111

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190707010111
SQL开始执行时间：20190707010111
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190707010111
SQL开始执行时间：20190707010111
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190707010111
SQL开始执行时间：20190707010111



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190707010156
SQL开始执行时间：20190707010156


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190707010156
SQL开始执行时间：20190707010156


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190707010156
SQL开始执行时间：20190707010156

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190707010308

20190707170112开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707170112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190707170112
SQL开始执行时间：20190707170112
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190707170112
SQL开始执行时间：20190707170112
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190707170112
SQL开始执行时间：20190707170112



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190707170156
SQL开始执行时间：20190707170156


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190707170157
SQL开始执行时间：20190707170157


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190707170157
SQL开始执行时间：20190707170157

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190707170309

20190708010111开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708010111

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190708010111
SQL开始执行时间：20190708010111
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190708010111
SQL开始执行时间：20190708010111
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190708010111
SQL开始执行时间：20190708010111



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190708010144
SQL开始执行时间：20190708010144


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190708010144
SQL开始执行时间：20190708010144


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190708010144
SQL开始执行时间：20190708010144

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190708010256

20190708170125开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708170125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190708170125
SQL开始执行时间：20190708170125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190708170125
SQL开始执行时间：20190708170125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190708170125
SQL开始执行时间：20190708170125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190708170220
SQL开始执行时间：20190708170220


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190708170220
SQL开始执行时间：20190708170220


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190708170220
SQL开始执行时间：20190708170220

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190708170333

20190709010127开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709010127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190709010128
SQL开始执行时间：20190709010128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190709010128
SQL开始执行时间：20190709010128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190709010128
SQL开始执行时间：20190709010128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190709010224
SQL开始执行时间：20190709010224


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190709010224
SQL开始执行时间：20190709010224


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190709010224
SQL开始执行时间：20190709010224

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190709010337

20190709170131开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709170131

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190709170131
SQL开始执行时间：20190709170131
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190709170131
SQL开始执行时间：20190709170131
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190709170131
SQL开始执行时间：20190709170131



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190709170231
SQL开始执行时间：20190709170231


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190709170231
SQL开始执行时间：20190709170231


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190709170231
SQL开始执行时间：20190709170231

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190709170343

20190710010119开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710010119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190710010119
SQL开始执行时间：20190710010119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190710010119
SQL开始执行时间：20190710010119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190710010119
SQL开始执行时间：20190710010119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190710010220
SQL开始执行时间：20190710010220


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190710010221
SQL开始执行时间：20190710010221


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190710010221
SQL开始执行时间：20190710010221

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190710010333

20190710170127开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710170127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190710170127
SQL开始执行时间：20190710170127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190710170127
SQL开始执行时间：20190710170127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190710170127
SQL开始执行时间：20190710170127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190710170230
SQL开始执行时间：20190710170230


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190710170230
SQL开始执行时间：20190710170230


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190710170230
SQL开始执行时间：20190710170230

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190710170343

20190711010119开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711010119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190711010120
SQL开始执行时间：20190711010120
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190711010120
SQL开始执行时间：20190711010120
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190711010120
SQL开始执行时间：20190711010120



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190711010206
SQL开始执行时间：20190711010206


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190711010206
SQL开始执行时间：20190711010206


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190711010206
SQL开始执行时间：20190711010206

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190711010319

20190711170129开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711170129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190711170129
SQL开始执行时间：20190711170129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190711170129
SQL开始执行时间：20190711170129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190711170129
SQL开始执行时间：20190711170129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190711170234
SQL开始执行时间：20190711170234


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190711170234
SQL开始执行时间：20190711170234


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190711170234
SQL开始执行时间：20190711170234

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190711170346

20190712010129开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712010129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190712010129
SQL开始执行时间：20190712010129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190712010129
SQL开始执行时间：20190712010129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190712010129
SQL开始执行时间：20190712010129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190712010234
SQL开始执行时间：20190712010234


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190712010234
SQL开始执行时间：20190712010234


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190712010234
SQL开始执行时间：20190712010234

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190712010346

20190712170123开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712170123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190712170123
SQL开始执行时间：20190712170123
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190712170123
SQL开始执行时间：20190712170123
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190712170123
SQL开始执行时间：20190712170123



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190712170242
SQL开始执行时间：20190712170242


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190712170243
SQL开始执行时间：20190712170243


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190712170243
SQL开始执行时间：20190712170243

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190712170355

20190713010124开始执行2019-07-12数据加载日志:
SQL开始执行时间：20190713010124

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190713010125
SQL开始执行时间：20190713010125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190713010125
SQL开始执行时间：20190713010125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190713010125
SQL开始执行时间：20190713010125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190713010237
SQL开始执行时间：20190713010237


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190713010237
SQL开始执行时间：20190713010237


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190713010237
SQL开始执行时间：20190713010237

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190713010351

20190713170125开始执行2019-07-12数据加载日志:
SQL开始执行时间：20190713170125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190713170125
SQL开始执行时间：20190713170125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190713170125
SQL开始执行时间：20190713170125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190713170125
SQL开始执行时间：20190713170125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190713170237
SQL开始执行时间：20190713170237


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190713170238
SQL开始执行时间：20190713170238


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190713170238
SQL开始执行时间：20190713170238

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190713170351

20190714010113开始执行2019-07-13数据加载日志:
SQL开始执行时间：20190714010113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190714010113
SQL开始执行时间：20190714010113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190714010113
SQL开始执行时间：20190714010113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190714010113
SQL开始执行时间：20190714010113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190714010203
SQL开始执行时间：20190714010203


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190714010203
SQL开始执行时间：20190714010203


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190714010203
SQL开始执行时间：20190714010203

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190714010316

20190714170114开始执行2019-07-13数据加载日志:
SQL开始执行时间：20190714170114

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190714170115
SQL开始执行时间：20190714170115
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190714170115
SQL开始执行时间：20190714170115
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190714170115
SQL开始执行时间：20190714170115



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190714170204
SQL开始执行时间：20190714170204


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190714170205
SQL开始执行时间：20190714170205


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190714170205
SQL开始执行时间：20190714170205

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190714170319

20190715010112开始执行2019-07-14数据加载日志:
SQL开始执行时间：20190715010112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190715010113
SQL开始执行时间：20190715010113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715010113
SQL开始执行时间：20190715010113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190715010113
SQL开始执行时间：20190715010113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190715010146
SQL开始执行时间：20190715010146


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190715010146
SQL开始执行时间：20190715010146


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190715010146
SQL开始执行时间：20190715010146

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190715010301

20190715131501开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190715131501

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190715131501
SQL开始执行时间：20190715131501
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715131501
SQL开始执行时间：20190715131501
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190715131501
SQL开始执行时间：20190715131501



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190715131613
SQL开始执行时间：20190715131613


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190715131613
SQL开始执行时间：20190715131613


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190715131613
SQL开始执行时间：20190715131613

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190715131726

20190715170122开始执行2019-07-14数据加载日志:
SQL开始执行时间：20190715170122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190715170122
SQL开始执行时间：20190715170122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715170122
SQL开始执行时间：20190715170122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190715170122
SQL开始执行时间：20190715170122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190715170248
SQL开始执行时间：20190715170248


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190715170248
SQL开始执行时间：20190715170248


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190715170249
SQL开始执行时间：20190715170249

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190715170401

20190716010306开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716010306

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716010306
SQL开始执行时间：20190716010306
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716010306
SQL开始执行时间：20190716010306
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190716010306
SQL开始执行时间：20190716010306



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190716010432
SQL开始执行时间：20190716010432


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716010432
SQL开始执行时间：20190716010432


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190716010432
SQL开始执行时间：20190716010432

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190716010545

20190716160353开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716160353

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716160353
SQL开始执行时间：20190716160353
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716160353
SQL开始执行时间：20190716160353
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190716160353
SQL开始执行时间：20190716160353



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190716160518
SQL开始执行时间：20190716160518


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716160518
SQL开始执行时间：20190716160518


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190716160518
SQL开始执行时间：20190716160518

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190716160630

20190716161717开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716161717

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716161717
SQL开始执行时间：20190716161717
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716161717
SQL开始执行时间：20190716161717
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190716161717
SQL开始执行时间：20190716161717



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190716161842
SQL开始执行时间：20190716161842


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716161842
SQL开始执行时间：20190716161842


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190716161843
SQL开始执行时间：20190716161843

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190716161955

20190716165433开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716165433

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716165433
SQL开始执行时间：20190716165433
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716165433
SQL开始执行时间：20190716165433
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190716165433
SQL开始执行时间：20190716165433



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190716165559
SQL开始执行时间：20190716165559


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716165559
SQL开始执行时间：20190716165559


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190716165559
SQL开始执行时间：20190716165559

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190716165712

20190716170129开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716170129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716170130
SQL开始执行时间：20190716170130
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716170130
SQL开始执行时间：20190716170130
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190716170130
SQL开始执行时间：20190716170130



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190716170257
SQL开始执行时间：20190716170257


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716170257
SQL开始执行时间：20190716170257


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190716170257
SQL开始执行时间：20190716170257

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190716170410

20190717010124开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717010124

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190717010124
SQL开始执行时间：20190717010124
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717010124
SQL开始执行时间：20190717010124
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190717010124
SQL开始执行时间：20190717010124



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190717010252
SQL开始执行时间：20190717010252


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190717010252
SQL开始执行时间：20190717010252


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190717010252
SQL开始执行时间：20190717010252

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190717010405

20190717170126开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190717170126
SQL开始执行时间：20190717170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717170126
SQL开始执行时间：20190717170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190717170126
SQL开始执行时间：20190717170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190717170256
SQL开始执行时间：20190717170256


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190717170257
SQL开始执行时间：20190717170257


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190717170257
SQL开始执行时间：20190717170257

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190717170410

20190718010122开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718010122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190718010122
SQL开始执行时间：20190718010122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718010122
SQL开始执行时间：20190718010122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190718010122
SQL开始执行时间：20190718010122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190718010211
SQL开始执行时间：20190718010211


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190718010212
SQL开始执行时间：20190718010212


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190718010212
SQL开始执行时间：20190718010212

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190718010325

20190718092204开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190718092204

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190718092204
SQL开始执行时间：20190718092204
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718092204
SQL开始执行时间：20190718092204
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190718092204
SQL开始执行时间：20190718092204



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190718092254
SQL开始执行时间：20190718092254


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190718092254
SQL开始执行时间：20190718092254


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190718092254
SQL开始执行时间：20190718092254

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190718092408

20190718170127开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718170127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190718170128
SQL开始执行时间：20190718170128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718170128
SQL开始执行时间：20190718170128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190718170128
SQL开始执行时间：20190718170128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190718170227
SQL开始执行时间：20190718170227


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190718170227
SQL开始执行时间：20190718170227


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190718170227
SQL开始执行时间：20190718170227

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190718170339

20190719010123开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719010123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190719010123
SQL开始执行时间：20190719010123
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190719010123
SQL开始执行时间：20190719010123
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190719010123
SQL开始执行时间：20190719010123



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190719010221
SQL开始执行时间：20190719010221


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190719010222
SQL开始执行时间：20190719010222


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190719010222
SQL开始执行时间：20190719010222

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190719010335

20190719170126开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190719170126
SQL开始执行时间：20190719170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190719170126
SQL开始执行时间：20190719170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190719170126
SQL开始执行时间：20190719170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190719170228
SQL开始执行时间：20190719170228


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190719170228
SQL开始执行时间：20190719170228


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190719170229
SQL开始执行时间：20190719170229

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190719170340

20190720010118开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720010118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190720010118
SQL开始执行时间：20190720010118
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190720010118
SQL开始执行时间：20190720010118
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190720010118
SQL开始执行时间：20190720010118



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190720010207
SQL开始执行时间：20190720010207


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190720010208
SQL开始执行时间：20190720010208


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190720010208
SQL开始执行时间：20190720010208

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190720010319

20190720170119开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720170119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190720170119
SQL开始执行时间：20190720170119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190720170119
SQL开始执行时间：20190720170119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190720170119
SQL开始执行时间：20190720170119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190720170209
SQL开始执行时间：20190720170209


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190720170210
SQL开始执行时间：20190720170210


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190720170210
SQL开始执行时间：20190720170210

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190720170322

20190721010113开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721010113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190721010113
SQL开始执行时间：20190721010113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190721010113
SQL开始执行时间：20190721010113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190721010113
SQL开始执行时间：20190721010113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190721010153
SQL开始执行时间：20190721010153


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190721010153
SQL开始执行时间：20190721010153


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190721010153
SQL开始执行时间：20190721010153

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190721010305

20190721170113开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721170113

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190721170113
SQL开始执行时间：20190721170113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190721170113
SQL开始执行时间：20190721170113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190721170113
SQL开始执行时间：20190721170113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190721170152
SQL开始执行时间：20190721170152


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190721170152
SQL开始执行时间：20190721170152


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190721170153
SQL开始执行时间：20190721170153

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190721170305

20190722010112开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722010112

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190722010113
SQL开始执行时间：20190722010113
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190722010113
SQL开始执行时间：20190722010113
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190722010113
SQL开始执行时间：20190722010113



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190722010145
SQL开始执行时间：20190722010145


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190722010145
SQL开始执行时间：20190722010145


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190722010145
SQL开始执行时间：20190722010145

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190722010257

20190722170119开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722170119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190722170119
SQL开始执行时间：20190722170119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190722170119
SQL开始执行时间：20190722170119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190722170119
SQL开始执行时间：20190722170119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190722170200
SQL开始执行时间：20190722170200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190722170200
SQL开始执行时间：20190722170200


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190722170201
SQL开始执行时间：20190722170201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190722170315

20190723010118开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723010118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190723010118
SQL开始执行时间：20190723010118
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190723010118
SQL开始执行时间：20190723010118
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190723010119
SQL开始执行时间：20190723010119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190723010200
SQL开始执行时间：20190723010200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190723010201
SQL开始执行时间：20190723010201


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190723010201
SQL开始执行时间：20190723010201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190723010313

20190723170126开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190723170126
SQL开始执行时间：20190723170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190723170126
SQL开始执行时间：20190723170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190723170126
SQL开始执行时间：20190723170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190723170216
SQL开始执行时间：20190723170216


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190723170216
SQL开始执行时间：20190723170216


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190723170216
SQL开始执行时间：20190723170216

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190723170330

20190724010125开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724010125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190724010125
SQL开始执行时间：20190724010125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190724010125
SQL开始执行时间：20190724010125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190724010125
SQL开始执行时间：20190724010125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190724010217
SQL开始执行时间：20190724010217


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190724010218
SQL开始执行时间：20190724010218


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190724010218
SQL开始执行时间：20190724010218

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190724010332

20190724170128开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724170128

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190724170128
SQL开始执行时间：20190724170128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190724170128
SQL开始执行时间：20190724170128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190724170128
SQL开始执行时间：20190724170128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190724170227
SQL开始执行时间：20190724170227


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190724170227
SQL开始执行时间：20190724170227


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190724170227
SQL开始执行时间：20190724170227

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190724170343

20190725010116开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725010116

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190725010116
SQL开始执行时间：20190725010116
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190725010116
SQL开始执行时间：20190725010116
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190725010116
SQL开始执行时间：20190725010116



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190725010210
SQL开始执行时间：20190725010210


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190725010210
SQL开始执行时间：20190725010210


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190725010210
SQL开始执行时间：20190725010210

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190725010325

20190725170130开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725170130

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190725170131
SQL开始执行时间：20190725170131
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190725170131
SQL开始执行时间：20190725170131
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190725170131
SQL开始执行时间：20190725170131



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190725170235
SQL开始执行时间：20190725170235


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190725170236
SQL开始执行时间：20190725170236


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190725170236
SQL开始执行时间：20190725170236

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190725170351

20190726010128开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726010128

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726010129
SQL开始执行时间：20190726010129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726010129
SQL开始执行时间：20190726010129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190726010129
SQL开始执行时间：20190726010129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190726010224
SQL开始执行时间：20190726010224


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726010225
SQL开始执行时间：20190726010225


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190726010225
SQL开始执行时间：20190726010225

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190726010339

20190726085849开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726085849

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726085850
SQL开始执行时间：20190726085850
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726085850
SQL开始执行时间：20190726085850
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190726085850
SQL开始执行时间：20190726085850



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190726085951
SQL开始执行时间：20190726085951


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726085951
SQL开始执行时间：20190726085951


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190726085952
SQL开始执行时间：20190726085952

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190726090107

20190726132438开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726132438

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726132438
SQL开始执行时间：20190726132438
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726132438
SQL开始执行时间：20190726132438
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190726132438
SQL开始执行时间：20190726132438



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190726132536
SQL开始执行时间：20190726132536


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726132536
SQL开始执行时间：20190726132536


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190726132536
SQL开始执行时间：20190726132536

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190726132652

20190726170129开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726170129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726170129
SQL开始执行时间：20190726170129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726170129
SQL开始执行时间：20190726170129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190726170129
SQL开始执行时间：20190726170129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190726170229
SQL开始执行时间：20190726170229


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726170230
SQL开始执行时间：20190726170230


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190726170230
SQL开始执行时间：20190726170230

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190726170344

20190727010119开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727010119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190727010119
SQL开始执行时间：20190727010119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190727010119
SQL开始执行时间：20190727010119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190727010119
SQL开始执行时间：20190727010119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190727010226
SQL开始执行时间：20190727010226


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190727010226
SQL开始执行时间：20190727010226


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190727010226
SQL开始执行时间：20190727010226

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190727010344

20190727170124开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727170124

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190727170125
SQL开始执行时间：20190727170125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190727170125
SQL开始执行时间：20190727170125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190727170125
SQL开始执行时间：20190727170125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190727170231
SQL开始执行时间：20190727170231


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190727170232
SQL开始执行时间：20190727170232


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190727170232
SQL开始执行时间：20190727170232

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190727170350

20190728010117开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728010117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190728010117
SQL开始执行时间：20190728010117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190728010117
SQL开始执行时间：20190728010117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190728010117
SQL开始执行时间：20190728010117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190728010201
SQL开始执行时间：20190728010201


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190728010202
SQL开始执行时间：20190728010202


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190728010202
SQL开始执行时间：20190728010202

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190728010320

20190728170116开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728170116

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190728170117
SQL开始执行时间：20190728170117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190728170117
SQL开始执行时间：20190728170117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190728170117
SQL开始执行时间：20190728170117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190728170201
SQL开始执行时间：20190728170201


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190728170201
SQL开始执行时间：20190728170201


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190728170201
SQL开始执行时间：20190728170201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190728170319

20190729010114开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729010114

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190729010114
SQL开始执行时间：20190729010114
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729010114
SQL开始执行时间：20190729010114
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190729010114
SQL开始执行时间：20190729010114



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190729010150
SQL开始执行时间：20190729010150


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190729010150
SQL开始执行时间：20190729010150


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190729010150
SQL开始执行时间：20190729010150

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190729010309

20190729111245开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190729111245

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190729111245
SQL开始执行时间：20190729111245
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729111245
SQL开始执行时间：20190729111245
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190729111245
SQL开始执行时间：20190729111245



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190729111345
SQL开始执行时间：20190729111345


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190729111345
SQL开始执行时间：20190729111345


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190729111345
SQL开始执行时间：20190729111345

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190729111500

20190729170118开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729170118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190729170118
SQL开始执行时间：20190729170118
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729170118
SQL开始执行时间：20190729170118
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190729170118
SQL开始执行时间：20190729170118



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190729170226
SQL开始执行时间：20190729170226


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190729170226
SQL开始执行时间：20190729170226


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190729170226
SQL开始执行时间：20190729170226

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190729170343

20190730010124开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730010124

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190730010124
SQL开始执行时间：20190730010124
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730010124
SQL开始执行时间：20190730010124
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190730010124
SQL开始执行时间：20190730010124



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190730010238
SQL开始执行时间：20190730010238


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190730010238
SQL开始执行时间：20190730010238


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190730010238
SQL开始执行时间：20190730010238

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190730010359

20190730090624开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190730090624

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190730090624
SQL开始执行时间：20190730090624
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730090624
SQL开始执行时间：20190730090624
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190730090624
SQL开始执行时间：20190730090624



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190730090710
SQL开始执行时间：20190730090710


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190730090710
SQL开始执行时间：20190730090710


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190730090710
SQL开始执行时间：20190730090710

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190730090828

20190730170131开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730170131

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190730170131
SQL开始执行时间：20190730170131
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730170131
SQL开始执行时间：20190730170131
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190730170131
SQL开始执行时间：20190730170131



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190730170251
SQL开始执行时间：20190730170251


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190730170252
SQL开始执行时间：20190730170252


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190730170252
SQL开始执行时间：20190730170252

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190730170412

20190731010129开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731010129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190731010130
SQL开始执行时间：20190731010130
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731010130
SQL开始执行时间：20190731010130
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190731010130
SQL开始执行时间：20190731010130



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190731010232
SQL开始执行时间：20190731010232


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190731010232
SQL开始执行时间：20190731010232


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190731010232
SQL开始执行时间：20190731010232

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190731010353

20190731103428开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190731103428

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190731103428
SQL开始执行时间：20190731103428
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731103428
SQL开始执行时间：20190731103428
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190731103428
SQL开始执行时间：20190731103428



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190731103531
SQL开始执行时间：20190731103531


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190731103532
SQL开始执行时间：20190731103532


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190731103532
SQL开始执行时间：20190731103532

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190731103650

20190731170140开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731170140

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190731170140
SQL开始执行时间：20190731170140
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731170140
SQL开始执行时间：20190731170140
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190731170140
SQL开始执行时间：20190731170140



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190731170258
SQL开始执行时间：20190731170258


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190731170259
SQL开始执行时间：20190731170259


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190731170259
SQL开始执行时间：20190731170259

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190731170418

20190801010124开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801010124

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190801010125
SQL开始执行时间：20190801010125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190801010125
SQL开始执行时间：20190801010125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190801010125
SQL开始执行时间：20190801010125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190801010242
SQL开始执行时间：20190801010242


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190801010243
SQL开始执行时间：20190801010243


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190801010243
SQL开始执行时间：20190801010243

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190801010403

20190801170130开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801170130

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190801170130
SQL开始执行时间：20190801170130
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190801170130
SQL开始执行时间：20190801170130
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190801170130
SQL开始执行时间：20190801170130



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190801170256
SQL开始执行时间：20190801170256


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190801170256
SQL开始执行时间：20190801170256


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190801170257
SQL开始执行时间：20190801170257

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190801170418

20190802010127开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802010127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190802010128
SQL开始执行时间：20190802010128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190802010128
SQL开始执行时间：20190802010128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190802010128
SQL开始执行时间：20190802010128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190802010232
SQL开始执行时间：20190802010232


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190802010232
SQL开始执行时间：20190802010232


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190802010232
SQL开始执行时间：20190802010232

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190802010353

20190802170136开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802170136

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190802170136
SQL开始执行时间：20190802170136
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190802170136
SQL开始执行时间：20190802170136
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190802170136
SQL开始执行时间：20190802170136



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190802170300
SQL开始执行时间：20190802170300


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190802170300
SQL开始执行时间：20190802170300


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190802170300
SQL开始执行时间：20190802170300

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190802170423

20190803010123开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803010123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190803010123
SQL开始执行时间：20190803010123
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190803010123
SQL开始执行时间：20190803010123
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190803010123
SQL开始执行时间：20190803010123



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190803010231
SQL开始执行时间：20190803010231


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190803010232
SQL开始执行时间：20190803010232


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190803010232
SQL开始执行时间：20190803010232

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190803010355

20190803170129开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803170129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190803170129
SQL开始执行时间：20190803170129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190803170129
SQL开始执行时间：20190803170129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190803170129
SQL开始执行时间：20190803170129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190803170238
SQL开始执行时间：20190803170238


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190803170238
SQL开始执行时间：20190803170238


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190803170238
SQL开始执行时间：20190803170238

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190803170400

20190804010116开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804010116

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190804010117
SQL开始执行时间：20190804010117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190804010117
SQL开始执行时间：20190804010117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190804010117
SQL开始执行时间：20190804010117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190804010212
SQL开始执行时间：20190804010212


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190804010212
SQL开始执行时间：20190804010212


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190804010212
SQL开始执行时间：20190804010212

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190804010335

20190804170118开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804170118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190804170118
SQL开始执行时间：20190804170118
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190804170118
SQL开始执行时间：20190804170118
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190804170118
SQL开始执行时间：20190804170118



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190804170214
SQL开始执行时间：20190804170214


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190804170214
SQL开始执行时间：20190804170214


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190804170214
SQL开始执行时间：20190804170214

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190804170336

20190805010117开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805010117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190805010117
SQL开始执行时间：20190805010117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190805010117
SQL开始执行时间：20190805010117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190805010117
SQL开始执行时间：20190805010117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190805010155
SQL开始执行时间：20190805010155


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190805010155
SQL开始执行时间：20190805010155


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190805010155
SQL开始执行时间：20190805010155

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190805010318

20190805170117开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805170117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190805170117
SQL开始执行时间：20190805170117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190805170117
SQL开始执行时间：20190805170117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190805170117
SQL开始执行时间：20190805170117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190805170200
SQL开始执行时间：20190805170200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190805170200
SQL开始执行时间：20190805170200


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190805170200
SQL开始执行时间：20190805170200

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190805170321

20190806010117开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806010117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190806010117
SQL开始执行时间：20190806010117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190806010117
SQL开始执行时间：20190806010117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190806010117
SQL开始执行时间：20190806010117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190806010200
SQL开始执行时间：20190806010200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190806010201
SQL开始执行时间：20190806010201


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190806010201
SQL开始执行时间：20190806010201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190806010321

20190806170123开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806170123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190806170124
SQL开始执行时间：20190806170124
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190806170124
SQL开始执行时间：20190806170124
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190806170124
SQL开始执行时间：20190806170124



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190806170215
SQL开始执行时间：20190806170215


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190806170215
SQL开始执行时间：20190806170215


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190806170215
SQL开始执行时间：20190806170215

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190806170336

20190807010121开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807010121

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190807010121
SQL开始执行时间：20190807010121
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190807010121
SQL开始执行时间：20190807010121
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190807010121
SQL开始执行时间：20190807010121



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190807010211
SQL开始执行时间：20190807010211


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190807010211
SQL开始执行时间：20190807010211


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190807010211
SQL开始执行时间：20190807010211

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190807010331

20190807170129开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807170129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190807170129
SQL开始执行时间：20190807170129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190807170129
SQL开始执行时间：20190807170129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190807170129
SQL开始执行时间：20190807170129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190807170229
SQL开始执行时间：20190807170229


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190807170229
SQL开始执行时间：20190807170229


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190807170229
SQL开始执行时间：20190807170229

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190807170349

20190808010122开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808010122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190808010123
SQL开始执行时间：20190808010123
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190808010123
SQL开始执行时间：20190808010123
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190808010123
SQL开始执行时间：20190808010123



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190808010221
SQL开始执行时间：20190808010221


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190808010221
SQL开始执行时间：20190808010221


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190808010221
SQL开始执行时间：20190808010221

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190808010341

20190808093239开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190808093239

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190808093239
SQL开始执行时间：20190808093239
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190808093239
SQL开始执行时间：20190808093239
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190808093239
SQL开始执行时间：20190808093239



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190808093437
SQL开始执行时间：20190808093437


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190808093438
SQL开始执行时间：20190808093438


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190808093438
SQL开始执行时间：20190808093438

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190808093559

20190808170128开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808170128

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190808170128
SQL开始执行时间：20190808170128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190808170128
SQL开始执行时间：20190808170128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190808170128
SQL开始执行时间：20190808170128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190808170327
SQL开始执行时间：20190808170327


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190808170328
SQL开始执行时间：20190808170328


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190808170328
SQL开始执行时间：20190808170328

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190808170448

20190809010120开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809010120

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190809010120
SQL开始执行时间：20190809010120
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809010120
SQL开始执行时间：20190809010120
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190809010120
SQL开始执行时间：20190809010120



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190809010319
SQL开始执行时间：20190809010319


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190809010319
SQL开始执行时间：20190809010319


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190809010319
SQL开始执行时间：20190809010319

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190809010439

20190809170123开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809170123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190809170124
SQL开始执行时间：20190809170124
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809170124
SQL开始执行时间：20190809170124
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190809170124
SQL开始执行时间：20190809170124



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190809170332
SQL开始执行时间：20190809170332


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190809170332
SQL开始执行时间：20190809170332


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190809170333
SQL开始执行时间：20190809170333

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190809170453

20190810010122开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810010122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190810010122
SQL开始执行时间：20190810010122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190810010122
SQL开始执行时间：20190810010122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190810010122
SQL开始执行时间：20190810010122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190810010211
SQL开始执行时间：20190810010211


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190810010211
SQL开始执行时间：20190810010211


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190810010211
SQL开始执行时间：20190810010211

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190810010335

20190810170125开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810170125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190810170126
SQL开始执行时间：20190810170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190810170126
SQL开始执行时间：20190810170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190810170126
SQL开始执行时间：20190810170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190810170214
SQL开始执行时间：20190810170214


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190810170214
SQL开始执行时间：20190810170214


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190810170214
SQL开始执行时间：20190810170214

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190810170337

20190811010118开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811010118

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190811010118
SQL开始执行时间：20190811010118
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190811010118
SQL开始执行时间：20190811010118
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190811010118
SQL开始执行时间：20190811010118



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190811010204
SQL开始执行时间：20190811010204


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190811010205
SQL开始执行时间：20190811010205


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190811010205
SQL开始执行时间：20190811010205

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190811010326

20190811170115开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811170115

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190811170115
SQL开始执行时间：20190811170115
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190811170115
SQL开始执行时间：20190811170115
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190811170115
SQL开始执行时间：20190811170115



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190811170203
SQL开始执行时间：20190811170203


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190811170203
SQL开始执行时间：20190811170203


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190811170204
SQL开始执行时间：20190811170204

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190811170326

20190812010120开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812010120

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190812010121
SQL开始执行时间：20190812010121
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190812010121
SQL开始执行时间：20190812010121
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190812010121
SQL开始执行时间：20190812010121



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190812010159
SQL开始执行时间：20190812010159


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190812010200
SQL开始执行时间：20190812010200


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190812010200
SQL开始执行时间：20190812010200

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190812010323

20190812170131开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812170131

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190812170132
SQL开始执行时间：20190812170132
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190812170132
SQL开始执行时间：20190812170132
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190812170132
SQL开始执行时间：20190812170132



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190812170228
SQL开始执行时间：20190812170228


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190812170228
SQL开始执行时间：20190812170228


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190812170228
SQL开始执行时间：20190812170228

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190812170349

20190813010129开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813010129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190813010130
SQL开始执行时间：20190813010130
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813010130
SQL开始执行时间：20190813010130
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190813010130
SQL开始执行时间：20190813010130



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190813010229
SQL开始执行时间：20190813010229


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190813010230
SQL开始执行时间：20190813010230


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190813010230
SQL开始执行时间：20190813010230

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190813010351

20190813111600开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190813111600

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190813111600
SQL开始执行时间：20190813111600
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813111600
SQL开始执行时间：20190813111600
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190813111600
SQL开始执行时间：20190813111600



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190813111659
SQL开始执行时间：20190813111659


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190813111659
SQL开始执行时间：20190813111659


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190813111659
SQL开始执行时间：20190813111659

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190813111817

20190813170135开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813170135

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190813170135
SQL开始执行时间：20190813170135
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813170135
SQL开始执行时间：20190813170135
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190813170135
SQL开始执行时间：20190813170135



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190813170259
SQL开始执行时间：20190813170259


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190813170300
SQL开始执行时间：20190813170300


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190813170300
SQL开始执行时间：20190813170300

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190813170419

20190814010131开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814010131

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190814010131
SQL开始执行时间：20190814010131
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814010131
SQL开始执行时间：20190814010131
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190814010131
SQL开始执行时间：20190814010131



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190814010303
SQL开始执行时间：20190814010303


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190814010303
SQL开始执行时间：20190814010303


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190814010303
SQL开始执行时间：20190814010303

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190814010422

20190814170147开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814170147

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190814170147
SQL开始执行时间：20190814170147
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814170147
SQL开始执行时间：20190814170147
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190814170147
SQL开始执行时间：20190814170147



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190814170335
SQL开始执行时间：20190814170335


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190814170335
SQL开始执行时间：20190814170335


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190814170335
SQL开始执行时间：20190814170335

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190814170458

20190815010125开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815010125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190815010125
SQL开始执行时间：20190815010125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190815010125
SQL开始执行时间：20190815010125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190815010125
SQL开始执行时间：20190815010125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190815010248
SQL开始执行时间：20190815010248


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190815010248
SQL开始执行时间：20190815010248


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190815010249
SQL开始执行时间：20190815010249

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190815010408

20190815095738开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190815095738

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190815095739
SQL开始执行时间：20190815095739
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190815095739
SQL开始执行时间：20190815095739
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190815095739
SQL开始执行时间：20190815095739



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190815095903
SQL开始执行时间：20190815095903


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190815095903
SQL开始执行时间：20190815095903


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190815095903
SQL开始执行时间：20190815095903

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190815100023

20190815170127开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815170127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190815170127
SQL开始执行时间：20190815170127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190815170127
SQL开始执行时间：20190815170127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190815170127
SQL开始执行时间：20190815170127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190815170259
SQL开始执行时间：20190815170259


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190815170259
SQL开始执行时间：20190815170259


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190815170259
SQL开始执行时间：20190815170259

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190815170418

20190816010121开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816010121

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190816010121
SQL开始执行时间：20190816010121
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190816010121
SQL开始执行时间：20190816010121
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190816010121
SQL开始执行时间：20190816010121



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190816010250
SQL开始执行时间：20190816010250


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190816010250
SQL开始执行时间：20190816010250


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190816010251
SQL开始执行时间：20190816010251

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190816010410

20190816170133开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816170133

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190816170133
SQL开始执行时间：20190816170133
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190816170133
SQL开始执行时间：20190816170133
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190816170133
SQL开始执行时间：20190816170133



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190816170313
SQL开始执行时间：20190816170313


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190816170314
SQL开始执行时间：20190816170314


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190816170314
SQL开始执行时间：20190816170314

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190816170436

20190817010128开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817010128

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190817010128
SQL开始执行时间：20190817010128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190817010128
SQL开始执行时间：20190817010128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190817010128
SQL开始执行时间：20190817010128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190817010221
SQL开始执行时间：20190817010221


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190817010222
SQL开始执行时间：20190817010222


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190817010222
SQL开始执行时间：20190817010222

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190817010343

20190817170127开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817170127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190817170127
SQL开始执行时间：20190817170127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190817170127
SQL开始执行时间：20190817170127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190817170127
SQL开始执行时间：20190817170127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190817170221
SQL开始执行时间：20190817170221


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190817170221
SQL开始执行时间：20190817170221


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190817170222
SQL开始执行时间：20190817170222

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190817170343

20190819142835开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190819142835

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190819142835
SQL开始执行时间：20190819142835
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190819142835
SQL开始执行时间：20190819142835
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190819142835
SQL开始执行时间：20190819142835



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190819142938
SQL开始执行时间：20190819142938


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190819142938
SQL开始执行时间：20190819142938


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190819142938
SQL开始执行时间：20190819142938

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190819143100

20190820091158开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820091158

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190820091159
SQL开始执行时间：20190820091159
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190820091159
SQL开始执行时间：20190820091159
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190820091159
SQL开始执行时间：20190820091159



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190820091315
SQL开始执行时间：20190820091315


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190820091316
SQL开始执行时间：20190820091316


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190820091316
SQL开始执行时间：20190820091316

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190820091438

20190820142334开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190820142334

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190820142334
SQL开始执行时间：20190820142334
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190820142334
SQL开始执行时间：20190820142334
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190820142334
SQL开始执行时间：20190820142334



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190820142334
SQL开始执行时间：20190820142334


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190820142335
SQL开始执行时间：20190820142335


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190820142335
SQL开始执行时间：20190820142335

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190820142456

20190820170137开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820170137

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190820170138
SQL开始执行时间：20190820170138
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190820170138
SQL开始执行时间：20190820170138
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190820170138
SQL开始执行时间：20190820170138



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190820170301
SQL开始执行时间：20190820170301


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190820170301
SQL开始执行时间：20190820170301


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190820170301
SQL开始执行时间：20190820170301

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190820170424

20190821010124开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821010124

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190821010125
SQL开始执行时间：20190821010125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190821010125
SQL开始执行时间：20190821010125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190821010125
SQL开始执行时间：20190821010125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190821010238
SQL开始执行时间：20190821010238


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190821010239
SQL开始执行时间：20190821010239


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190821010239
SQL开始执行时间：20190821010239

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190821010401

20190821170135开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821170135

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190821170135
SQL开始执行时间：20190821170135
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190821170135
SQL开始执行时间：20190821170135
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190821170135
SQL开始执行时间：20190821170135



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190821170253
SQL开始执行时间：20190821170253


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190821170253
SQL开始执行时间：20190821170253


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190821170253
SQL开始执行时间：20190821170253

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190821170416

20190822010125开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822010125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190822010125
SQL开始执行时间：20190822010125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190822010125
SQL开始执行时间：20190822010125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190822010125
SQL开始执行时间：20190822010125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190822010221
SQL开始执行时间：20190822010221


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190822010221
SQL开始执行时间：20190822010221


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190822010221
SQL开始执行时间：20190822010221

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190822010343

20190822170128开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822170128

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190822170129
SQL开始执行时间：20190822170129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190822170129
SQL开始执行时间：20190822170129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190822170129
SQL开始执行时间：20190822170129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190822170230
SQL开始执行时间：20190822170230


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190822170230
SQL开始执行时间：20190822170230


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190822170230
SQL开始执行时间：20190822170230

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190822170354

20190823010126开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823010126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190823010127
SQL开始执行时间：20190823010127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190823010127
SQL开始执行时间：20190823010127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190823010127
SQL开始执行时间：20190823010127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190823010216
SQL开始执行时间：20190823010216


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190823010216
SQL开始执行时间：20190823010216


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190823010216
SQL开始执行时间：20190823010216

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190823010339

20190823170128开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823170128

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190823170129
SQL开始执行时间：20190823170129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190823170129
SQL开始执行时间：20190823170129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190823170129
SQL开始执行时间：20190823170129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190823170223
SQL开始执行时间：20190823170223


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190823170223
SQL开始执行时间：20190823170223


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190823170223
SQL开始执行时间：20190823170223

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190823170346

20190824010120开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824010120

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190824010121
SQL开始执行时间：20190824010121
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190824010121
SQL开始执行时间：20190824010121
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190824010121
SQL开始执行时间：20190824010121



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190824010212
SQL开始执行时间：20190824010212


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190824010212
SQL开始执行时间：20190824010212


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190824010212
SQL开始执行时间：20190824010212

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190824010335

20190824170126开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190824170127
SQL开始执行时间：20190824170127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190824170127
SQL开始执行时间：20190824170127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190824170127
SQL开始执行时间：20190824170127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190824170218
SQL开始执行时间：20190824170218


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190824170218
SQL开始执行时间：20190824170218


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190824170218
SQL开始执行时间：20190824170218

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190824170340

20190825010117开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825010117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190825010117
SQL开始执行时间：20190825010117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190825010117
SQL开始执行时间：20190825010117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190825010117
SQL开始执行时间：20190825010117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190825010200
SQL开始执行时间：20190825010200


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190825010201
SQL开始执行时间：20190825010201


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190825010201
SQL开始执行时间：20190825010201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190825010324

20190825170117开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825170117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190825170117
SQL开始执行时间：20190825170117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190825170117
SQL开始执行时间：20190825170117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190825170117
SQL开始执行时间：20190825170117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190825170201
SQL开始执行时间：20190825170201


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190825170201
SQL开始执行时间：20190825170201


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190825170201
SQL开始执行时间：20190825170201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190825170324

20190826010117开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826010117

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190826010117
SQL开始执行时间：20190826010117
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190826010117
SQL开始执行时间：20190826010117
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190826010117
SQL开始执行时间：20190826010117



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190826010155
SQL开始执行时间：20190826010155


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190826010155
SQL开始执行时间：20190826010155


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190826010155
SQL开始执行时间：20190826010155

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190826010318

20190826092702开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190826092702

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190826092702
SQL开始执行时间：20190826092702
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190826092702
SQL开始执行时间：20190826092702
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190826092702
SQL开始执行时间：20190826092702



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190826092753
SQL开始执行时间：20190826092753


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190826092753
SQL开始执行时间：20190826092753


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190826092754
SQL开始执行时间：20190826092754

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190826092916

20190826170127开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826170127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190826170127
SQL开始执行时间：20190826170127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190826170127
SQL开始执行时间：20190826170127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190826170127
SQL开始执行时间：20190826170127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190826170227
SQL开始执行时间：20190826170227


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190826170227
SQL开始执行时间：20190826170227


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190826170228
SQL开始执行时间：20190826170228

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190826170350

20190827010128开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827010128

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190827010128
SQL开始执行时间：20190827010128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827010128
SQL开始执行时间：20190827010128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190827010128
SQL开始执行时间：20190827010128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190827010229
SQL开始执行时间：20190827010229


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190827010230
SQL开始执行时间：20190827010230


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190827010230
SQL开始执行时间：20190827010230

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190827010354

20190827092803开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190827092803

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190827092803
SQL开始执行时间：20190827092803
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827092803
SQL开始执行时间：20190827092803
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190827092803
SQL开始执行时间：20190827092803



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190827092851
SQL开始执行时间：20190827092851


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190827092851
SQL开始执行时间：20190827092851


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190827092851
SQL开始执行时间：20190827092851

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190827093016

20190827170135开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827170135

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190827170136
SQL开始执行时间：20190827170136
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827170136
SQL开始执行时间：20190827170136
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190827170136
SQL开始执行时间：20190827170136



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190827170249
SQL开始执行时间：20190827170249


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190827170249
SQL开始执行时间：20190827170249


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190827170250
SQL开始执行时间：20190827170250

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190827170414

20190828010133开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828010133

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190828010134
SQL开始执行时间：20190828010134
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828010134
SQL开始执行时间：20190828010134
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190828010134
SQL开始执行时间：20190828010134



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190828010238
SQL开始执行时间：20190828010238


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190828010238
SQL开始执行时间：20190828010238


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190828010238
SQL开始执行时间：20190828010238

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190828010402

20190828093432开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190828093432

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190828093432
SQL开始执行时间：20190828093432
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828093432
SQL开始执行时间：20190828093432
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190828093432
SQL开始执行时间：20190828093432



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190828093536
SQL开始执行时间：20190828093536


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190828093536
SQL开始执行时间：20190828093536


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190828093537
SQL开始执行时间：20190828093537

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190828093659

20190828170135开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828170135

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190828170136
SQL开始执行时间：20190828170136
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828170136
SQL开始执行时间：20190828170136
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190828170136
SQL开始执行时间：20190828170136



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190828170245
SQL开始执行时间：20190828170245


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190828170245
SQL开始执行时间：20190828170245


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190828170245
SQL开始执行时间：20190828170245

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190828170408

20190829010125开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829010125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190829010125
SQL开始执行时间：20190829010125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190829010125
SQL开始执行时间：20190829010125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190829010125
SQL开始执行时间：20190829010125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190829010235
SQL开始执行时间：20190829010235


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190829010235
SQL开始执行时间：20190829010235


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190829010235
SQL开始执行时间：20190829010235

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190829010359

20190829170135开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829170135

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190829170135
SQL开始执行时间：20190829170135
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190829170135
SQL开始执行时间：20190829170135
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190829170135
SQL开始执行时间：20190829170135



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190829170253
SQL开始执行时间：20190829170253


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190829170253
SQL开始执行时间：20190829170253


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190829170254
SQL开始执行时间：20190829170254

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190829170418

20190830010134开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830010134

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190830010135
SQL开始执行时间：20190830010135
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190830010135
SQL开始执行时间：20190830010135
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190830010135
SQL开始执行时间：20190830010135



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190830010233
SQL开始执行时间：20190830010233


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190830010233
SQL开始执行时间：20190830010233


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190830010233
SQL开始执行时间：20190830010233

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190830010358

20190830170139开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830170139

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190830170139
SQL开始执行时间：20190830170139
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190830170139
SQL开始执行时间：20190830170139
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190830170139
SQL开始执行时间：20190830170139



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190830170250
SQL开始执行时间：20190830170250


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190830170250
SQL开始执行时间：20190830170250


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190830170250
SQL开始执行时间：20190830170250

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190830170416

20190831010146开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831010146

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190831010147
SQL开始执行时间：20190831010147
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190831010147
SQL开始执行时间：20190831010147
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190831010147
SQL开始执行时间：20190831010147



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190831010257
SQL开始执行时间：20190831010257


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190831010257
SQL开始执行时间：20190831010257


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190831010257
SQL开始执行时间：20190831010257

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190831010422

20190831170130开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831170130

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190831170130
SQL开始执行时间：20190831170130
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190831170130
SQL开始执行时间：20190831170130
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190831170130
SQL开始执行时间：20190831170130



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190831170240
SQL开始执行时间：20190831170240


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190831170241
SQL开始执行时间：20190831170241


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190831170241
SQL开始执行时间：20190831170241

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190831170405

20190901010119开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901010119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190901010119
SQL开始执行时间：20190901010119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190901010119
SQL开始执行时间：20190901010119
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190901010119
SQL开始执行时间：20190901010119



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190901010214
SQL开始执行时间：20190901010214


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190901010215
SQL开始执行时间：20190901010215


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190901010215
SQL开始执行时间：20190901010215

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190901010339

20190901170119开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901170119

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190901170119
SQL开始执行时间：20190901170119
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190901170120
SQL开始执行时间：20190901170120
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190901170120
SQL开始执行时间：20190901170120



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190901170214
SQL开始执行时间：20190901170214


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190901170214
SQL开始执行时间：20190901170214


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190901170215
SQL开始执行时间：20190901170215

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190901170338

20190902010133开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902010133

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190902010133
SQL开始执行时间：20190902010133
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902010133
SQL开始执行时间：20190902010133
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190902010133
SQL开始执行时间：20190902010133



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190902010212
SQL开始执行时间：20190902010212


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190902010212
SQL开始执行时间：20190902010212


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190902010212
SQL开始执行时间：20190902010212

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190902010336

20190902150952开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902150952

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190902150952
SQL开始执行时间：20190902150952
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902150952
SQL开始执行时间：20190902150952
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190902150952
SQL开始执行时间：20190902150952



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190902151045
SQL开始执行时间：20190902151045


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190902151045
SQL开始执行时间：20190902151045


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190902151045
SQL开始执行时间：20190902151045

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190902151210

20190902170126开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190902170126
SQL开始执行时间：20190902170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902170126
SQL开始执行时间：20190902170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190902170126
SQL开始执行时间：20190902170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190902170219
SQL开始执行时间：20190902170219


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190902170219
SQL开始执行时间：20190902170219


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190902170219
SQL开始执行时间：20190902170219

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190902170343

20190903010132开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903010132

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190903010132
SQL开始执行时间：20190903010132
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190903010132
SQL开始执行时间：20190903010132
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190903010132
SQL开始执行时间：20190903010132



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190903010236
SQL开始执行时间：20190903010236


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190903010236
SQL开始执行时间：20190903010236


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190903010236
SQL开始执行时间：20190903010236

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190903010402

20190903170136开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903170136

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190903170137
SQL开始执行时间：20190903170137
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190903170137
SQL开始执行时间：20190903170137
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190903170137
SQL开始执行时间：20190903170137



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190903170254
SQL开始执行时间：20190903170254


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190903170255
SQL开始执行时间：20190903170255


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190903170255
SQL开始执行时间：20190903170255

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190903170422

20190904010122开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904010122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904010123
SQL开始执行时间：20190904010123
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904010123
SQL开始执行时间：20190904010123
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904010123
SQL开始执行时间：20190904010123



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904010241
SQL开始执行时间：20190904010241


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904010241
SQL开始执行时间：20190904010241


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904010241
SQL开始执行时间：20190904010241

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904010408

20190904170129开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904170129

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904170129
SQL开始执行时间：20190904170129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904170129
SQL开始执行时间：20190904170129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904170129
SQL开始执行时间：20190904170129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904170256
SQL开始执行时间：20190904170256


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904170256
SQL开始执行时间：20190904170256


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904170256
SQL开始执行时间：20190904170256

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904170426

20190904174636开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904174636

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904174637
SQL开始执行时间：20190904174637
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904174637
SQL开始执行时间：20190904174637
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904174637
SQL开始执行时间：20190904174637



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904174802
SQL开始执行时间：20190904174802


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904174802
SQL开始执行时间：20190904174802


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904174802
SQL开始执行时间：20190904174802

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904174932

20190904181420开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904181420

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904181420
SQL开始执行时间：20190904181420
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904181420
SQL开始执行时间：20190904181420
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904181420
SQL开始执行时间：20190904181420



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904181547
SQL开始执行时间：20190904181547


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904181547
SQL开始执行时间：20190904181547


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904181547
SQL开始执行时间：20190904181547

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904181717

20190904183327开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190904183327

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904183328
SQL开始执行时间：20190904183328
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904183328
SQL开始执行时间：20190904183328
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904183328
SQL开始执行时间：20190904183328



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904183537
SQL开始执行时间：20190904183537


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904183537
SQL开始执行时间：20190904183537


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904183537
SQL开始执行时间：20190904183537

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904183707

20190904184409开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904184409

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904184409
SQL开始执行时间：20190904184409
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904184409
SQL开始执行时间：20190904184409
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904184409
SQL开始执行时间：20190904184409



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904184617
SQL开始执行时间：20190904184617


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904184618
SQL开始执行时间：20190904184618


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904184618
SQL开始执行时间：20190904184618

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904184747

20190904184843开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904184843

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904184844
SQL开始执行时间：20190904184844
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904184844
SQL开始执行时间：20190904184844
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904184844
SQL开始执行时间：20190904184844



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904185052
SQL开始执行时间：20190904185052


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904185052
SQL开始执行时间：20190904185052


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904185052
SQL开始执行时间：20190904185052

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904185221

20190904190302开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904190302

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904190302
SQL开始执行时间：20190904190302
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904190302
SQL开始执行时间：20190904190302
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904190302
SQL开始执行时间：20190904190302



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904190510
SQL开始执行时间：20190904190510


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904190511
SQL开始执行时间：20190904190511


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904190511
SQL开始执行时间：20190904190511

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904190640

20190904191859开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904191859

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904191859
SQL开始执行时间：20190904191859
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904191859
SQL开始执行时间：20190904191859
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904191859
SQL开始执行时间：20190904191859



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904192108
SQL开始执行时间：20190904192108


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904192108
SQL开始执行时间：20190904192108


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904192108
SQL开始执行时间：20190904192108

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904192236

20190904192822开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904192822

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904192823
SQL开始执行时间：20190904192823
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904192823
SQL开始执行时间：20190904192823
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904192823
SQL开始执行时间：20190904192823



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904193031
SQL开始执行时间：20190904193031


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904193031
SQL开始执行时间：20190904193031


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904193032
SQL开始执行时间：20190904193032

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904193200

20190904193637开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904193637

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904193637
SQL开始执行时间：20190904193637
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904193637
SQL开始执行时间：20190904193637
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190904193638
SQL开始执行时间：20190904193638



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190904193845
SQL开始执行时间：20190904193845


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904193845
SQL开始执行时间：20190904193845


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904193845
SQL开始执行时间：20190904193845

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190904194013

20190905010121开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905010121

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905010122
SQL开始执行时间：20190905010122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905010122
SQL开始执行时间：20190905010122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190905010122
SQL开始执行时间：20190905010122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190905010331
SQL开始执行时间：20190905010331


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905010331
SQL开始执行时间：20190905010331


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190905010331
SQL开始执行时间：20190905010331

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190905010500

20190905101235开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905101235

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905101235
SQL开始执行时间：20190905101235
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905101235
SQL开始执行时间：20190905101235
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190905101235
SQL开始执行时间：20190905101235



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190905101446
SQL开始执行时间：20190905101446


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905101446
SQL开始执行时间：20190905101446


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190905101446
SQL开始执行时间：20190905101446

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190905101615

20190905110936开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190905110936

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905110936
SQL开始执行时间：20190905110936
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905110936
SQL开始执行时间：20190905110936
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190905110936
SQL开始执行时间：20190905110936



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190905111109
SQL开始执行时间：20190905111109


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905111110
SQL开始执行时间：20190905111110


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190905111110
SQL开始执行时间：20190905111110

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190905111239

20190905162805开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905162805

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905162805
SQL开始执行时间：20190905162805
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905162805
SQL开始执行时间：20190905162805
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190905162805
SQL开始执行时间：20190905162805



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190905163018
SQL开始执行时间：20190905163018


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905163018
SQL开始执行时间：20190905163018


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190905163018
SQL开始执行时间：20190905163018

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190905163146

20190905170125开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905170125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905170126
SQL开始执行时间：20190905170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905170126
SQL开始执行时间：20190905170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190905170126
SQL开始执行时间：20190905170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190905170341
SQL开始执行时间：20190905170341


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905170341
SQL开始执行时间：20190905170341


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190905170342
SQL开始执行时间：20190905170342

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190905170511

20190906010122开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906010122

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190906010122
SQL开始执行时间：20190906010122
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190906010122
SQL开始执行时间：20190906010122
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190906010122
SQL开始执行时间：20190906010122



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190906010301
SQL开始执行时间：20190906010301


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190906010302
SQL开始执行时间：20190906010302


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190906010302
SQL开始执行时间：20190906010302

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190906010430

20190906170131开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906170131

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190906170132
SQL开始执行时间：20190906170132
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190906170132
SQL开始执行时间：20190906170132
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190906170132
SQL开始执行时间：20190906170132



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190906170320
SQL开始执行时间：20190906170320


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190906170320
SQL开始执行时间：20190906170320


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190906170320
SQL开始执行时间：20190906170320

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190906170451

20190907010131开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907010131

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190907010131
SQL开始执行时间：20190907010131
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190907010131
SQL开始执行时间：20190907010131
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190907010131
SQL开始执行时间：20190907010131



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190907010231
SQL开始执行时间：20190907010231


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190907010231
SQL开始执行时间：20190907010231


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190907010231
SQL开始执行时间：20190907010231

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190907010401

20190907170138开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907170138

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190907170139
SQL开始执行时间：20190907170139
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190907170139
SQL开始执行时间：20190907170139
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190907170139
SQL开始执行时间：20190907170139



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190907170238
SQL开始执行时间：20190907170238


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190907170239
SQL开始执行时间：20190907170239


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190907170239
SQL开始执行时间：20190907170239

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190907170409

20190908010120开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908010120

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190908010121
SQL开始执行时间：20190908010121
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190908010121
SQL开始执行时间：20190908010121
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190908010121
SQL开始执行时间：20190908010121



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190908010219
SQL开始执行时间：20190908010219


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190908010220
SQL开始执行时间：20190908010220


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190908010220
SQL开始执行时间：20190908010220

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190908010350

20190908170126开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190908170126
SQL开始执行时间：20190908170126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190908170126
SQL开始执行时间：20190908170126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190908170126
SQL开始执行时间：20190908170126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190908170225
SQL开始执行时间：20190908170225


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190908170225
SQL开始执行时间：20190908170225


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190908170225
SQL开始执行时间：20190908170225

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190908170355

20190909010120开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909010120

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190909010120
SQL开始执行时间：20190909010120
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909010120
SQL开始执行时间：20190909010120
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190909010120
SQL开始执行时间：20190909010120



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190909010201
SQL开始执行时间：20190909010201


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190909010201
SQL开始执行时间：20190909010201


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190909010201
SQL开始执行时间：20190909010201

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190909010331

20190909133014开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909133014

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190909133014
SQL开始执行时间：20190909133014
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909133014
SQL开始执行时间：20190909133014
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190909133014
SQL开始执行时间：20190909133014



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190909133056
SQL开始执行时间：20190909133056


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190909133056
SQL开始执行时间：20190909133056


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190909133056
SQL开始执行时间：20190909133056

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190909133226

20190909151435开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190909151435

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190909151435
SQL开始执行时间：20190909151435
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909151435
SQL开始执行时间：20190909151435
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190909151435
SQL开始执行时间：20190909151435



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190909151516
SQL开始执行时间：20190909151516


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190909151517
SQL开始执行时间：20190909151517


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190909151517
SQL开始执行时间：20190909151517

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190909151645

20190909170136开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909170136

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190909170136
SQL开始执行时间：20190909170136
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909170136
SQL开始执行时间：20190909170136
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190909170136
SQL开始执行时间：20190909170136



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190909170236
SQL开始执行时间：20190909170236


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190909170237
SQL开始执行时间：20190909170237


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190909170237
SQL开始执行时间：20190909170237

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190909170406

20190910010135开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910010135

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190910010135
SQL开始执行时间：20190910010135
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910010135
SQL开始执行时间：20190910010135
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190910010135
SQL开始执行时间：20190910010135



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190910010235
SQL开始执行时间：20190910010235


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190910010235
SQL开始执行时间：20190910010235


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190910010236
SQL开始执行时间：20190910010236

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190910010405

20190910101201开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190910101201

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190910101202
SQL开始执行时间：20190910101202
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910101202
SQL开始执行时间：20190910101202
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190910101202
SQL开始执行时间：20190910101202



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190910101259
SQL开始执行时间：20190910101259


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190910101259
SQL开始执行时间：20190910101259


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190910101300
SQL开始执行时间：20190910101300

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190910101429

20190910170142开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910170142

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190910170143
SQL开始执行时间：20190910170143
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910170143
SQL开始执行时间：20190910170143
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190910170143
SQL开始执行时间：20190910170143



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190910170255
SQL开始执行时间：20190910170255


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190910170255
SQL开始执行时间：20190910170255


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190910170255
SQL开始执行时间：20190910170255

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190910170425

20190911010131开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911010131

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190911010131
SQL开始执行时间：20190911010131
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190911010131
SQL开始执行时间：20190911010131
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190911010131
SQL开始执行时间：20190911010131



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190911010248
SQL开始执行时间：20190911010248


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190911010249
SQL开始执行时间：20190911010249


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190911010249
SQL开始执行时间：20190911010249

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190911010419

20190911170200开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911170200

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190911170201
SQL开始执行时间：20190911170201
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190911170201
SQL开始执行时间：20190911170201
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190911170201
SQL开始执行时间：20190911170201



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190911170342
SQL开始执行时间：20190911170342


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190911170342
SQL开始执行时间：20190911170342


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190911170342
SQL开始执行时间：20190911170342

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190911170515

20190912010136开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912010136

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190912010136
SQL开始执行时间：20190912010136
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190912010136
SQL开始执行时间：20190912010136
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190912010136
SQL开始执行时间：20190912010136



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190912010259
SQL开始执行时间：20190912010259


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190912010259
SQL开始执行时间：20190912010259


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190912010259
SQL开始执行时间：20190912010259

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190912010430

20190912170138开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912170138

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190912170138
SQL开始执行时间：20190912170138
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190912170138
SQL开始执行时间：20190912170138
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190912170138
SQL开始执行时间：20190912170138



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190912170304
SQL开始执行时间：20190912170304


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190912170304
SQL开始执行时间：20190912170304


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190912170304
SQL开始执行时间：20190912170304

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190912170435

20190913010124开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913010124

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190913010124
SQL开始执行时间：20190913010124
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190913010124
SQL开始执行时间：20190913010124
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190913010124
SQL开始执行时间：20190913010124



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190913010230
SQL开始执行时间：20190913010230


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190913010231
SQL开始执行时间：20190913010231


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190913010231
SQL开始执行时间：20190913010231

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190913010402

20190913170127开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913170127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190913170128
SQL开始执行时间：20190913170128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190913170128
SQL开始执行时间：20190913170128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190913170128
SQL开始执行时间：20190913170128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190913170234
SQL开始执行时间：20190913170234


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190913170234
SQL开始执行时间：20190913170234


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190913170234
SQL开始执行时间：20190913170234

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190913170406

20190914010214开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914010214

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190914010215
SQL开始执行时间：20190914010215
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190914010215
SQL开始执行时间：20190914010215
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190914010215
SQL开始执行时间：20190914010215



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190914010300
SQL开始执行时间：20190914010300


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190914010300
SQL开始执行时间：20190914010300


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190914010300
SQL开始执行时间：20190914010300

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190914010432

20190914170127开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914170127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190914170128
SQL开始执行时间：20190914170128
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190914170128
SQL开始执行时间：20190914170128
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190914170128
SQL开始执行时间：20190914170128



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190914170213
SQL开始执行时间：20190914170213


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190914170213
SQL开始执行时间：20190914170213


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190914170213
SQL开始执行时间：20190914170213

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190914170345

20190915010125开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915010125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190915010125
SQL开始执行时间：20190915010125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190915010125
SQL开始执行时间：20190915010125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190915010125
SQL开始执行时间：20190915010125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190915010208
SQL开始执行时间：20190915010208


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190915010208
SQL开始执行时间：20190915010208


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190915010208
SQL开始执行时间：20190915010208

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190915010342

20190915170126开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915170126

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190915170127
SQL开始执行时间：20190915170127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190915170127
SQL开始执行时间：20190915170127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190915170127
SQL开始执行时间：20190915170127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190915170209
SQL开始执行时间：20190915170209


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190915170209
SQL开始执行时间：20190915170209


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190915170209
SQL开始执行时间：20190915170209

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190915170341

20190916010125开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916010125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916010126
SQL开始执行时间：20190916010126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916010126
SQL开始执行时间：20190916010126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190916010126
SQL开始执行时间：20190916010126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190916010208
SQL开始执行时间：20190916010208


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916010208
SQL开始执行时间：20190916010208


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916010208
SQL开始执行时间：20190916010208

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190916010342

20190916084200开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916084200

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916084201
SQL开始执行时间：20190916084201
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916084201
SQL开始执行时间：20190916084201
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190916084201
SQL开始执行时间：20190916084201



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190916084340
SQL开始执行时间：20190916084340


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916084340
SQL开始执行时间：20190916084340


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916084340
SQL开始执行时间：20190916084340

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190916084512

20190916085857开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916085857

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916085858
SQL开始执行时间：20190916085858
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916085858
SQL开始执行时间：20190916085858
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190916085858
SQL开始执行时间：20190916085858



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190916090038
SQL开始执行时间：20190916090038


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916090039
SQL开始执行时间：20190916090039


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916090039
SQL开始执行时间：20190916090039

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190916090211

20190916090756开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916090756

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916090756
SQL开始执行时间：20190916090756
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916090756
SQL开始执行时间：20190916090756
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190916090756
SQL开始执行时间：20190916090756



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190916090938
SQL开始执行时间：20190916090938


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916090939
SQL开始执行时间：20190916090939


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916090939
SQL开始执行时间：20190916090939

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190916091112

20190916092722开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916092722

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916092722
SQL开始执行时间：20190916092722
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916092722
SQL开始执行时间：20190916092722
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190916092722
SQL开始执行时间：20190916092722



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190916092904
SQL开始执行时间：20190916092904


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916092904
SQL开始执行时间：20190916092904


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916092904
SQL开始执行时间：20190916092904

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190916093036

20190916100151开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916100151

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916100151
SQL开始执行时间：20190916100151
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916100151
SQL开始执行时间：20190916100151
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190916100151
SQL开始执行时间：20190916100151



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190916100332
SQL开始执行时间：20190916100332


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916100332
SQL开始执行时间：20190916100332


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916100333
SQL开始执行时间：20190916100333

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190916100504

20190916170141开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916170141

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916170141
SQL开始执行时间：20190916170141
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916170141
SQL开始执行时间：20190916170141
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190916170141
SQL开始执行时间：20190916170141



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190916170332
SQL开始执行时间：20190916170332


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916170332
SQL开始执行时间：20190916170332


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916170332
SQL开始执行时间：20190916170332

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190916170504

20190917010145开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917010145

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190917010146
SQL开始执行时间：20190917010146
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190917010146
SQL开始执行时间：20190917010146
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190917010146
SQL开始执行时间：20190917010146



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190917010338
SQL开始执行时间：20190917010338


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190917010339
SQL开始执行时间：20190917010339


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190917010339
SQL开始执行时间：20190917010339

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190917010510

20190917091921开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190917091921

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190917091921
SQL开始执行时间：20190917091921
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190917091921
SQL开始执行时间：20190917091921
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190917091921
SQL开始执行时间：20190917091921



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190917092031
SQL开始执行时间：20190917092031


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190917092031
SQL开始执行时间：20190917092031


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190917092031
SQL开始执行时间：20190917092031

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190917092201

20190917170154开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917170154

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190917170154
SQL开始执行时间：20190917170154
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190917170154
SQL开始执行时间：20190917170154
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190917170154
SQL开始执行时间：20190917170154



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190917170359
SQL开始执行时间：20190917170359


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190917170359
SQL开始执行时间：20190917170359


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190917170359
SQL开始执行时间：20190917170359

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190917170530

20190918010138开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918010138

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190918010138
SQL开始执行时间：20190918010138
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918010138
SQL开始执行时间：20190918010138
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190918010138
SQL开始执行时间：20190918010138



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190918010301
SQL开始执行时间：20190918010301


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190918010301
SQL开始执行时间：20190918010301


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190918010301
SQL开始执行时间：20190918010301

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190918010433

20190918170146开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918170146

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190918170146
SQL开始执行时间：20190918170146
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918170146
SQL开始执行时间：20190918170146
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190918170146
SQL开始执行时间：20190918170146



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190918170314
SQL开始执行时间：20190918170314


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190918170315
SQL开始执行时间：20190918170315


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190918170315
SQL开始执行时间：20190918170315

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190918170448

20190919010128开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919010128

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190919010129
SQL开始执行时间：20190919010129
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190919010129
SQL开始执行时间：20190919010129
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190919010129
SQL开始执行时间：20190919010129



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190919010237
SQL开始执行时间：20190919010237


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190919010237
SQL开始执行时间：20190919010237


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190919010237
SQL开始执行时间：20190919010237

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190919010408

20190919134822开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190919134822

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190919134822
SQL开始执行时间：20190919134822
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190919134822
SQL开始执行时间：20190919134822
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190919134822
SQL开始执行时间：20190919134822



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190919134914
SQL开始执行时间：20190919134914


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190919134914
SQL开始执行时间：20190919134914


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190919134915
SQL开始执行时间：20190919134915

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190919135046

20190919170154开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919170154

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190919170154
SQL开始执行时间：20190919170154
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190919170154
SQL开始执行时间：20190919170154
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190919170154
SQL开始执行时间：20190919170154



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190919170323
SQL开始执行时间：20190919170323


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190919170324
SQL开始执行时间：20190919170324


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190919170324
SQL开始执行时间：20190919170324

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190919170456

20190920010154开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920010154

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190920010154
SQL开始执行时间：20190920010154
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190920010154
SQL开始执行时间：20190920010154
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190920010154
SQL开始执行时间：20190920010154



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190920010314
SQL开始执行时间：20190920010314


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190920010314
SQL开始执行时间：20190920010314


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190920010314
SQL开始执行时间：20190920010314

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190920010446

20190920170204开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920170204

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190920170204
SQL开始执行时间：20190920170204
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190920170204
SQL开始执行时间：20190920170204
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190920170204
SQL开始执行时间：20190920170204



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190920170331
SQL开始执行时间：20190920170331


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190920170331
SQL开始执行时间：20190920170331


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190920170332
SQL开始执行时间：20190920170332

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190920170504

20190921010133开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921010133

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190921010133
SQL开始执行时间：20190921010133
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190921010133
SQL开始执行时间：20190921010133
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190921010133
SQL开始执行时间：20190921010133



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190921010255
SQL开始执行时间：20190921010255


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190921010255
SQL开始执行时间：20190921010255


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190921010255
SQL开始执行时间：20190921010255

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190921010428

20190921170133开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921170133

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190921170134
SQL开始执行时间：20190921170134
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190921170134
SQL开始执行时间：20190921170134
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190921170134
SQL开始执行时间：20190921170134



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190921170256
SQL开始执行时间：20190921170256


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190921170256
SQL开始执行时间：20190921170256


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190921170256
SQL开始执行时间：20190921170256

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190921170429

20190922010123开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922010123

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190922010123
SQL开始执行时间：20190922010123
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190922010123
SQL开始执行时间：20190922010123
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190922010123
SQL开始执行时间：20190922010123



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190922010217
SQL开始执行时间：20190922010217


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190922010217
SQL开始执行时间：20190922010217


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190922010217
SQL开始执行时间：20190922010217

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190922010350

20190922170125开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922170125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190922170125
SQL开始执行时间：20190922170125
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190922170125
SQL开始执行时间：20190922170125
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190922170125
SQL开始执行时间：20190922170125



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190922170219
SQL开始执行时间：20190922170219


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190922170220
SQL开始执行时间：20190922170220


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190922170220
SQL开始执行时间：20190922170220

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190922170352

20190923010125开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923010125

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190923010126
SQL开始执行时间：20190923010126
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923010126
SQL开始执行时间：20190923010126
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190923010126
SQL开始执行时间：20190923010126



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190923010208
SQL开始执行时间：20190923010208


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190923010208
SQL开始执行时间：20190923010208


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190923010208
SQL开始执行时间：20190923010208

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190923010340

20190923113406开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190923113406

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190923113406
SQL开始执行时间：20190923113406
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923113406
SQL开始执行时间：20190923113406
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190923113406
SQL开始执行时间：20190923113406



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190923113531
SQL开始执行时间：20190923113531


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190923113531
SQL开始执行时间：20190923113531


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190923113531
SQL开始执行时间：20190923113531

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190923113708

20190923170142开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923170142

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190923170142
SQL开始执行时间：20190923170142
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923170142
SQL开始执行时间：20190923170142
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190923170142
SQL开始执行时间：20190923170142



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190923170324
SQL开始执行时间：20190923170324


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190923170325
SQL开始执行时间：20190923170325


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190923170325
SQL开始执行时间：20190923170325

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190923170500

20190924010137开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924010137

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190924010137
SQL开始执行时间：20190924010137
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924010137
SQL开始执行时间：20190924010137
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190924010137
SQL开始执行时间：20190924010137



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190924010320
SQL开始执行时间：20190924010320


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190924010321
SQL开始执行时间：20190924010321


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190924010321
SQL开始执行时间：20190924010321

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190924010458

20190924170150开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924170150

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190924170151
SQL开始执行时间：20190924170151
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924170151
SQL开始执行时间：20190924170151
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190924170151
SQL开始执行时间：20190924170151



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190924170350
SQL开始执行时间：20190924170350


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190924170350
SQL开始执行时间：20190924170350


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190924170351
SQL开始执行时间：20190924170351

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190924170528

20190925010147开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925010147

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190925010147
SQL开始执行时间：20190925010147
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190925010147
SQL开始执行时间：20190925010147
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190925010147
SQL开始执行时间：20190925010147



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190925010309
SQL开始执行时间：20190925010309


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190925010310
SQL开始执行时间：20190925010310


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190925010310
SQL开始执行时间：20190925010310

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190925010447

20190925113241开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190925113241

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190925113242
SQL开始执行时间：20190925113242
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190925113242
SQL开始执行时间：20190925113242
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190925113242
SQL开始执行时间：20190925113242



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190925113402
SQL开始执行时间：20190925113402


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190925113403
SQL开始执行时间：20190925113403


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190925113403
SQL开始执行时间：20190925113403

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190925113538

20190925170158开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925170158

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190925170158
SQL开始执行时间：20190925170158
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190925170158
SQL开始执行时间：20190925170158
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190925170158
SQL开始执行时间：20190925170158



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190925170330
SQL开始执行时间：20190925170330


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190925170331
SQL开始执行时间：20190925170331


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190925170331
SQL开始执行时间：20190925170331

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190925170507

20190926010144开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190926010144

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190926010145
SQL开始执行时间：20190926010145
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190926010145
SQL开始执行时间：20190926010145
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190926010145
SQL开始执行时间：20190926010145



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190926010322
SQL开始执行时间：20190926010322


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190926010322
SQL开始执行时间：20190926010322


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190926010322
SQL开始执行时间：20190926010322

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190926010459

20190926170152开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190926170152

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190926170152
SQL开始执行时间：20190926170152
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190926170152
SQL开始执行时间：20190926170152
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190926170152
SQL开始执行时间：20190926170152



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190926170342
SQL开始执行时间：20190926170342


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190926170342
SQL开始执行时间：20190926170342


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190926170342
SQL开始执行时间：20190926170342

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190926170520

20190927010144开始执行2019-09-26数据加载日志:
SQL开始执行时间：20190927010144

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190927010144
SQL开始执行时间：20190927010144
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190927010145
SQL开始执行时间：20190927010145
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190927010145
SQL开始执行时间：20190927010145



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190927010310
SQL开始执行时间：20190927010310


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190927010311
SQL开始执行时间：20190927010311


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190927010311
SQL开始执行时间：20190927010311

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190927010448

20190927170150开始执行2019-09-26数据加载日志:
SQL开始执行时间：20190927170150

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190927170150
SQL开始执行时间：20190927170150
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190927170150
SQL开始执行时间：20190927170150
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190927170150
SQL开始执行时间：20190927170150



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190927170329
SQL开始执行时间：20190927170329


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190927170329
SQL开始执行时间：20190927170329


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190927170329
SQL开始执行时间：20190927170329

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190927170508
SQL开始执行时间：20190927170508

update pdm.invoice_order s
  join (select * from ufdata.department where db = 'UFDATA_111_2018'  group by cdepcode) c
    on s.cdepcode = c.cdepcode
   set s.cdepname = c.cdepname
 where s.cdepname is null
   and s.cdepcode is not null

;
SQL结束执行时间：20190927170508

20190928010137开始执行2019-09-27数据加载日志:
SQL开始执行时间：20190928010137

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190928010137
SQL开始执行时间：20190928010137
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190928010137
SQL开始执行时间：20190928010137
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190928010137
SQL开始执行时间：20190928010137



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190928010256
SQL开始执行时间：20190928010256


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190928010256
SQL开始执行时间：20190928010256


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190928010256
SQL开始执行时间：20190928010256

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190928010434
SQL开始执行时间：20190928010434

update pdm.invoice_order s
  join (select * from ufdata.department where db = 'UFDATA_111_2018'  group by cdepcode) c
    on s.cdepcode = c.cdepcode
   set s.cdepname = c.cdepname
 where s.cdepname is null
   and s.cdepcode is not null

;
SQL结束执行时间：20190928010434

20190928170139开始执行2019-09-27数据加载日志:
SQL开始执行时间：20190928170139

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190928170139
SQL开始执行时间：20190928170139
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190928170139
SQL开始执行时间：20190928170139
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190928170139
SQL开始执行时间：20190928170139



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190928170257
SQL开始执行时间：20190928170257


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190928170257
SQL开始执行时间：20190928170257


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190928170258
SQL开始执行时间：20190928170258

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190928170435
SQL开始执行时间：20190928170435

update pdm.invoice_order s
  join (select * from ufdata.department where db = 'UFDATA_111_2018'  group by cdepcode) c
    on s.cdepcode = c.cdepcode
   set s.cdepname = c.cdepname
 where s.cdepname is null
   and s.cdepcode is not null

;
SQL结束执行时间：20190928170436

20190929010127开始执行2019-09-28数据加载日志:
SQL开始执行时间：20190929010127

create temporary table pdm.invoice_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.invoice_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190929010127
SQL开始执行时间：20190929010127
  
delete from pdm.invoice_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190929010127
SQL开始执行时间：20190929010127
delete from pdm.invoice_order_pre where true_ccuscode = 'DL1101002' and cinvcode = 'QT00004'
;
SQL结束执行时间：20190929010127
SQL开始执行时间：20190929010127



delete from pdm.invoice_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.invoice_order_pre)
;
SQL结束执行时间：20190929010228
SQL开始执行时间：20190929010228


create temporary table pdm.invoice_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,e.specification_type
      ,f.plan_class
      ,f.key_project
   from (select specification_type,bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190929010228
SQL开始执行时间：20190929010228


insert into pdm.invoice_order
select a.sbvid
      ,a.autoid
      ,a.ddate
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.csbvcode
      ,a.csocode
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,f.level_three
      ,e.cinvbrand
      ,a.cvenabbname
      ,a.cstcode
      ,e.specification_type
      ,case when a.itb = '1' then '退补'
          else '正常' end
      ,case when a.breturnflag = 'Y' then '是'
          else '否' end
      ,a.tbquantity
      ,localtimestamp()
  from pdm.invoice_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,specification_type,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190929010229
SQL开始执行时间：20190929010229

delete from pdm.invoice_order where concat(db,sbvid) in (select concat(db,sbvid) from edw.invoice_order where state = '无效') 
;
SQL结束执行时间：20190929010408
SQL开始执行时间：20190929010408

update pdm.invoice_order s
  join (select * from ufdata.department where db = 'UFDATA_111_2018'  group by cdepcode) c
    on s.cdepcode = c.cdepcode
   set s.cdepname = c.cdepname
 where s.cdepname is null
   and s.cdepcode is not null

;
SQL结束执行时间：20190929010408
