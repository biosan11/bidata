
20190102133818å¼€å§‹æ‰§è¡Œ2019-01-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102133818

truncate table pdm.ehr_employee
;

20190102134000å¼€å§‹æ‰§è¡Œ2019-01-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102134000

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102134000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102134000
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102134000

20190103090721å¼€å§‹æ‰§è¡Œ2019-01-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190103090721

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190103090721
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190103090721
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190103090721

20190105095151å¼€å§‹æ‰§è¡Œ2019-01-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190105095151

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190105095151
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190105095151
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190105095151

20190105095303å¼€å§‹æ‰§è¡Œ2019-01-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190105095303

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190105095303
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190105095303
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190105095303

20190107085802å¼€å§‹æ‰§è¡Œ2019-01-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190107085802

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190107085802
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190107085802
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190107085802

20190107090103å¼€å§‹æ‰§è¡Œ2019-01-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190107090103

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190107090103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190107090103
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190107090103

20190108015809å¼€å§‹æ‰§è¡Œ2019-01-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190108015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190108015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190108015809
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190108015809

20190109015808å¼€å§‹æ‰§è¡Œ2019-01-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190109015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190109015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190109015808
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190109015808

20190110015808å¼€å§‹æ‰§è¡Œ2019-01-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190110015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190110015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190110015808
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190110015808

20190111015808å¼€å§‹æ‰§è¡Œ2019-01-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190111015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190111015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190111015808
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190111015808

20190112015808å¼€å§‹æ‰§è¡Œ2019-01-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190112015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190112015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190112015808
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;

20190114091152å¼€å§‹æ‰§è¡Œ2019-01-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190114091152

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190114091152
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190114091152
insert into pdm.ehr_employee
select *
  from edw.ehr_employee
 where end_dt = '3000-12-31'
;

20190115083439å¼€å§‹æ‰§è¡Œ2019-01-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115083439

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115083439
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115083439
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,a.age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = '´ıÈëÖ°' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> '´ıÈëÖ°' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;

20190115083809å¼€å§‹æ‰§è¡Œ2019-01-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115083809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115083809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115083809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,a.age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = '´ıÈëÖ°' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> '´ıÈëÖ°' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;

20190115084941å¼€å§‹æ‰§è¡Œ2019-01-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115084941

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115084941
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115084941
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,a.age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = '´ıÈëÖ°' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> '´ıÈëÖ°' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;

20190115085225å¼€å§‹æ‰§è¡Œ2019-01-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115085225

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115085225
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115085225
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,a.age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115085225

20190115085231å¼€å§‹æ‰§è¡Œ2019-01-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115085231

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115085231
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115085231
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,a.age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115085231

20190116015810å¼€å§‹æ‰§è¡Œ2019-01-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190116015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190116015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190116015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,a.age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190116015810

20190117015810å¼€å§‹æ‰§è¡Œ2019-01-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190117015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190117015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190117015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,a.age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190117015810

20190118015810å¼€å§‹æ‰§è¡Œ2019-01-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190118015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190118015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190118015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190118015810

20190119015815å¼€å§‹æ‰§è¡Œ2019-01-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190119015815

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190119015815
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190119015815
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190119015816

20190121102731å¼€å§‹æ‰§è¡Œ2019-01-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190121102731

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190121102731
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190121102731
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190121102731

20190122015816å¼€å§‹æ‰§è¡Œ2019-01-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190122015816

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190122015816
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190122015816
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190122015816

20190123015819å¼€å§‹æ‰§è¡Œ2019-01-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190123015819

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190123015819
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190123015819
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190123015819

20190124015812å¼€å§‹æ‰§è¡Œ2019-01-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190124015812

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190124015812
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190124015812
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190124015813

20190126015830å¼€å§‹æ‰§è¡Œ2019-01-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190126015830

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190126015830
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190126015830
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190126015830

20190127015808å¼€å§‹æ‰§è¡Œ2019-01-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190127015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190127015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190127015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190127015808

20190128015809å¼€å§‹æ‰§è¡Œ2019-01-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190128015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190128015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190128015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190128015809

20190129015811å¼€å§‹æ‰§è¡Œ2019-01-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190129015811

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190129015811
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190129015811
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190129015811

20190130015808å¼€å§‹æ‰§è¡Œ2019-01-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190130015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190130015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190130015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190130015809

20190131015808å¼€å§‹æ‰§è¡Œ2019-01-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190131015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190131015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190131015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190131015808

20190201015810å¼€å§‹æ‰§è¡Œ2019-02-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190201015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190201015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190201015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190201015810

20190202015808å¼€å§‹æ‰§è¡Œ2019-02-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190202015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190202015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190202015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190202015808

20190203015808å¼€å§‹æ‰§è¡Œ2019-02-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190203015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190203015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190203015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190203015808

20190204015810å¼€å§‹æ‰§è¡Œ2019-02-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190204015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190204015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190204015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190204015810

20190205015809å¼€å§‹æ‰§è¡Œ2019-02-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190205015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190205015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190205015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190205015809

20190206015808å¼€å§‹æ‰§è¡Œ2019-02-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190206015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190206015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190206015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190206015808

20190207015809å¼€å§‹æ‰§è¡Œ2019-02-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190207015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190207015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190207015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190207015809

20190211091402å¼€å§‹æ‰§è¡Œ2019-02-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190211091402

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190211091402
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190211091402
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190211091402

20190212015807å¼€å§‹æ‰§è¡Œ2019-02-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190212015807

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190212015807
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190212015807
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190212015807

20190213015810å¼€å§‹æ‰§è¡Œ2019-02-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190213015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190213015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190213015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190213015810

20190214015807å¼€å§‹æ‰§è¡Œ2019-02-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190214015807

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190214015807
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190214015807
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190214015808

20190215015807å¼€å§‹æ‰§è¡Œ2019-02-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190215015807

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190215015807
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190215015807
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190215015807

20190216015808å¼€å§‹æ‰§è¡Œ2019-02-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190216015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190216015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190216015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190216015808

20190217015807å¼€å§‹æ‰§è¡Œ2019-02-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190217015807

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190217015807
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190217015807
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190217015807

20190218015807å¼€å§‹æ‰§è¡Œ2019-02-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190218015807

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190218015807
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190218015807
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190218015807

20190219015807å¼€å§‹æ‰§è¡Œ2019-02-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190219015807

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190219015807
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190219015807
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190219015807

20190220015809å¼€å§‹æ‰§è¡Œ2019-02-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190220015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190220015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190220015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190220015809

20190221015810å¼€å§‹æ‰§è¡Œ2019-02-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190221015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190221015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190221015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190221015810

20190222015808å¼€å§‹æ‰§è¡Œ2019-02-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190222015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190222015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190222015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190222015808

20190223015809å¼€å§‹æ‰§è¡Œ2019-02-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190223015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190223015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190223015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190223015809

20190224015807å¼€å§‹æ‰§è¡Œ2019-02-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190224015807

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190224015807
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190224015807
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190224015807

20190225015808å¼€å§‹æ‰§è¡Œ2019-02-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190225015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190225015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190225015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190225015808

20190226015810å¼€å§‹æ‰§è¡Œ2019-02-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190226015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190226015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190226015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190226015810

20190227015808å¼€å§‹æ‰§è¡Œ2019-02-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190227015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190227015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190227015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190227015808

20190228015808å¼€å§‹æ‰§è¡Œ2019-02-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190228015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190228015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190228015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190228015808

20190301015808å¼€å§‹æ‰§è¡Œ2019-03-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301015808

20190302015809å¼€å§‹æ‰§è¡Œ2019-03-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190302015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190302015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190302015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190302015809

20190303015809å¼€å§‹æ‰§è¡Œ2019-03-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190303015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190303015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190303015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190303015809

20190304015808å¼€å§‹æ‰§è¡Œ2019-03-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304015808

20190305084022å¼€å§‹æ‰§è¡Œ2019-03-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305084022

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305084023
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305084023
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;

20190305084217å¼€å§‹æ‰§è¡Œ2019-03-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305084217

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305084217
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305084217
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305084217

20190306015809å¼€å§‹æ‰§è¡Œ2019-03-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306015809

20190307015808å¼€å§‹æ‰§è¡Œ2019-03-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307015808

20190308015808å¼€å§‹æ‰§è¡Œ2019-03-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308015808

20190309015809å¼€å§‹æ‰§è¡Œ2019-03-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309015809

20190310015809å¼€å§‹æ‰§è¡Œ2019-03-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310015809

20190311015808å¼€å§‹æ‰§è¡Œ2019-03-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311015809

20190312015808å¼€å§‹æ‰§è¡Œ2019-03-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312015808

20190313015810å¼€å§‹æ‰§è¡Œ2019-03-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313015810

20190314015811å¼€å§‹æ‰§è¡Œ2019-03-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314015811

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314015811
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314015811
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314015811

20190315015808å¼€å§‹æ‰§è¡Œ2019-03-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315015808

20190316015809å¼€å§‹æ‰§è¡Œ2019-03-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316015809

20190317015810å¼€å§‹æ‰§è¡Œ2019-03-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317015810

20190318015808å¼€å§‹æ‰§è¡Œ2019-03-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318015808

20190319015808å¼€å§‹æ‰§è¡Œ2019-03-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319015808

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319015808
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319015808
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319015808

20190320015810å¼€å§‹æ‰§è¡Œ2019-03-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320015810

20190321015814å¼€å§‹æ‰§è¡Œ2019-03-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321015814

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321015814
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321015814
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321015814

20190322015810å¼€å§‹æ‰§è¡Œ2019-03-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322015810

20190323015811å¼€å§‹æ‰§è¡Œ2019-03-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323015811

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323015811
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323015811
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323015811

20190324015809å¼€å§‹æ‰§è¡Œ2019-03-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324015809

20190325015809å¼€å§‹æ‰§è¡Œ2019-03-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325015809

20190326015812å¼€å§‹æ‰§è¡Œ2019-03-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326015812

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326015812
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326015812
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326015812

20190327015810å¼€å§‹æ‰§è¡Œ2019-03-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327015810

20190328015809å¼€å§‹æ‰§è¡Œ2019-03-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328015809

20190329015809å¼€å§‹æ‰§è¡Œ2019-03-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329015809
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329015809

20190330015810å¼€å§‹æ‰§è¡Œ2019-03-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330015810

20190331015810å¼€å§‹æ‰§è¡Œ2019-03-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331015810
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331015810

20190401015811å¼€å§‹æ‰§è¡Œ2019-04-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401015811

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401015811
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401015811
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401015811

20190402015819å¼€å§‹æ‰§è¡Œ2019-04-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402015819

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402015820
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402015820
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402015820

20190403094554å¼€å§‹æ‰§è¡Œ2019-04-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403094554

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403094554
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403094554
insert into pdm.ehr_employee
select a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403094554

20190404015812å¼€å§‹æ‰§è¡Œ2019-04-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404015812

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404015812
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404015812
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404015813

20190405015813å¼€å§‹æ‰§è¡Œ2019-04-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405015813

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405015813
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405015813
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405015813

20190406015810å¼€å§‹æ‰§è¡Œ2019-04-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406015810
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406015810

20190407015810å¼€å§‹æ‰§è¡Œ2019-04-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407015810
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407015810

20190408015812å¼€å§‹æ‰§è¡Œ2019-04-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408015812

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408015812
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408015812
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408015812

20190409015810å¼€å§‹æ‰§è¡Œ2019-04-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409015810

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409015810
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409015810
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409015810

20190410015809å¼€å§‹æ‰§è¡Œ2019-04-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410015809

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410015809
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410015809
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410015810

20190411142758å¼€å§‹æ‰§è¡Œ2019-04-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142758

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142758
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411142758
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411142758

20190412015814å¼€å§‹æ‰§è¡Œ2019-04-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412015814

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412015814
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412015814
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412015814

20190413015812å¼€å§‹æ‰§è¡Œ2019-04-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413015812

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413015812
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413015812
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413015812

20190425103546å¼€å§‹æ‰§è¡Œ2019-04-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425103546

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425103546
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425103546
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425103546

20190425103845å¼€å§‹æ‰§è¡Œ2019-04-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425103845

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425103845
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425103845
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425103845

20190425104746å¼€å§‹æ‰§è¡Œ2019-04-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425104746

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425104746
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425104746
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425104746

20190427015846å¼€å§‹æ‰§è¡Œ2019-04-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427015846

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427015846
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427015846
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427015846

20190428015844å¼€å§‹æ‰§è¡Œ2019-04-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428015844

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428015844
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428015844
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428015844

20190429015847å¼€å§‹æ‰§è¡Œ2019-04-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429015847

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429015847
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429015847
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429015847

20190430015848å¼€å§‹æ‰§è¡Œ2019-04-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430015848

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430015848
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430015848
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430015848

20190501015839å¼€å§‹æ‰§è¡Œ2019-05-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501015839

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501015839
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501015839
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501015839

20190502015840å¼€å§‹æ‰§è¡Œ2019-05-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502015840

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502015840
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502015840
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502015840

20190505092526å¼€å§‹æ‰§è¡Œ2019-05-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505092526

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505092527
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505092527
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505092527

20190506015840å¼€å§‹æ‰§è¡Œ2019-05-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506015840

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506015840
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506015840
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506015840

20190507015840å¼€å§‹æ‰§è¡Œ2019-05-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507015840

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507015840
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507015840
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507015840

20190508015839å¼€å§‹æ‰§è¡Œ2019-05-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508015839

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508015839
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508015839
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508015840

20190510015850å¼€å§‹æ‰§è¡Œ2019-05-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510015850

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510015850
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510015850
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510015850

20190511015858å¼€å§‹æ‰§è¡Œ2019-05-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511015858

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511015858
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511015858
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511015858

20190512015845å¼€å§‹æ‰§è¡Œ2019-05-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512015845

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512015845
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512015845
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512015845

20190513015844å¼€å§‹æ‰§è¡Œ2019-05-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513015844

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513015844
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513015844
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513015845

20190514015848å¼€å§‹æ‰§è¡Œ2019-05-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514015848

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514015848
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514015848
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514015848

20190515015847å¼€å§‹æ‰§è¡Œ2019-05-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515015847

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515015847
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515015847
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515015847

20190516015901å¼€å§‹æ‰§è¡Œ2019-05-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516015901

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516015901
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516015901
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516015901

20190517015848å¼€å§‹æ‰§è¡Œ2019-05-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517015848

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517015848
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517015848
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517015848

20190518015859å¼€å§‹æ‰§è¡Œ2019-05-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518015859

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518015859
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518015859
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518015859

20190519015848å¼€å§‹æ‰§è¡Œ2019-05-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519015848

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519015848
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519015848
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519015848

20190520015848å¼€å§‹æ‰§è¡Œ2019-05-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520015848

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520015848
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520015848
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520015848

20190521015922å¼€å§‹æ‰§è¡Œ2019-05-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521015922

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521015922
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521015922
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521015922

20190522015850å¼€å§‹æ‰§è¡Œ2019-05-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522015850

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522015850
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522015850
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522015850

20190523015851å¼€å§‹æ‰§è¡Œ2019-05-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523015851

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523015851
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523015851
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523015851

20190524015934å¼€å§‹æ‰§è¡Œ2019-05-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524015934

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524015934
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524015934
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524015934

20190525015932å¼€å§‹æ‰§è¡Œ2019-05-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525015932

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525015932
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525015932
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525015932

20190526015951å¼€å§‹æ‰§è¡Œ2019-05-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526015951

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526015951
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526015951
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526015951

20190527015930å¼€å§‹æ‰§è¡Œ2019-05-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527015930

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527015930
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527015930
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527015930

20190527105031å¼€å§‹æ‰§è¡Œ2019-01-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527105031

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527105031
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527105031
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527105031

20190527160351å¼€å§‹æ‰§è¡Œ2019-01-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527160351

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527160351
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527160351
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527160351

20190528015934å¼€å§‹æ‰§è¡Œ2019-05-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528015934

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528015934
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528015934
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528015934

20190529015931å¼€å§‹æ‰§è¡Œ2019-05-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529015931

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529015931
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529015931
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529015931

20190530015935å¼€å§‹æ‰§è¡Œ2019-05-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530015935

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530015935
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530015935
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530015935

20190531015936å¼€å§‹æ‰§è¡Œ2019-05-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531015936

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531015936
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531015936
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531015936

20190601015947å¼€å§‹æ‰§è¡Œ2019-06-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601015947

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601015947
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601015947
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601015947

20190602015938å¼€å§‹æ‰§è¡Œ2019-06-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602015938

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602015938
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602015938
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602015938

20190603015939å¼€å§‹æ‰§è¡Œ2019-06-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603015939

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603015939
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603015939
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603015939

20190604015951å¼€å§‹æ‰§è¡Œ2019-06-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604015951

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604015951
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604015951
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604015951

20190605020002å¼€å§‹æ‰§è¡Œ2019-06-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605020002

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605020002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605020002
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605020002

20190606015945å¼€å§‹æ‰§è¡Œ2019-06-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606015945

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606015945
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606015945
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606015945

20190607015941å¼€å§‹æ‰§è¡Œ2019-06-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607015941

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607015941
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607015941
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607015941

20190608015945å¼€å§‹æ‰§è¡Œ2019-06-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608015945

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608015945
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608015945
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608015945

20190609015945å¼€å§‹æ‰§è¡Œ2019-06-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609015945

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609015945
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609015945
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609015946

20190610020006å¼€å§‹æ‰§è¡Œ2019-06-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610020006

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610020006
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610020006

20190611015938å¼€å§‹æ‰§è¡Œ2019-06-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611015938

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611015938
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611015938
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611015938

20190612020016å¼€å§‹æ‰§è¡Œ2019-06-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612020016

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612020016
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612020016

20190613020010å¼€å§‹æ‰§è¡Œ2019-06-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613020010

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613020010
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613020010

20190614020009å¼€å§‹æ‰§è¡Œ2019-06-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614020009

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614020009
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614020009

20190615020005å¼€å§‹æ‰§è¡Œ2019-06-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615020005

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615020005
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615020005
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615020005

20190616020010å¼€å§‹æ‰§è¡Œ2019-06-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616020010

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616020010
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616020010

20190617020016å¼€å§‹æ‰§è¡Œ2019-06-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617020016

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617020016
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617020016

20190618015952å¼€å§‹æ‰§è¡Œ2019-06-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618015952

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618015952
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618015952
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618015952

20190619020009å¼€å§‹æ‰§è¡Œ2019-06-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619020009

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619020009
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619020010

20190620015947å¼€å§‹æ‰§è¡Œ2019-06-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620015947

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620015947
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620015947
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620015948

20190621015947å¼€å§‹æ‰§è¡Œ2019-06-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621015947

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621015947
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621015947
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621015947

20190622020002å¼€å§‹æ‰§è¡Œ2019-06-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622020002

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622020003
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622020003
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622020003

20190623015947å¼€å§‹æ‰§è¡Œ2019-06-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623015947

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623015947
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623015947
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623015948

20190624015957å¼€å§‹æ‰§è¡Œ2019-06-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624015957

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624015957
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624015957
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624015957

20190625020050å¼€å§‹æ‰§è¡Œ2019-06-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625020050

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625020050
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625020050
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625020050

20190626015953å¼€å§‹æ‰§è¡Œ2019-06-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626015953

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626015953
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626015953
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626015953

20190627020016å¼€å§‹æ‰§è¡Œ2019-06-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627020016

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627020016
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627020016

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627020016

20190628020032å¼€å§‹æ‰§è¡Œ2019-06-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628020032

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628020032
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628020032
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628020032
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628020032

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628020032

20190629015943å¼€å§‹æ‰§è¡Œ2019-06-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629015943

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629015943
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629015943
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629015943
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629015943

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629015943

20190630020009å¼€å§‹æ‰§è¡Œ2019-06-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630020009

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630020009
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630020010

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630020010

20190701015946å¼€å§‹æ‰§è¡Œ2019-07-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701015946

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701015946
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701015946
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701015946
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701015946

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701015947

20190702020006å¼€å§‹æ‰§è¡Œ2019-07-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702020006

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702020006
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702020006

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702020007

20190703020010å¼€å§‹æ‰§è¡Œ2019-07-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703020010

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703020010
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190703020010

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190703020010

20190704015953å¼€å§‹æ‰§è¡Œ2019-07-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704015953

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704015953
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704015953
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704015953
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190704015953

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190704015953

20190705020014å¼€å§‹æ‰§è¡Œ2019-07-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705020014

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705020014
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190705020014

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190705020015

20190706020025å¼€å§‹æ‰§è¡Œ2019-07-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706020025

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706020025
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706020025
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706020025
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190706020025

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190706020026

20190707020002å¼€å§‹æ‰§è¡Œ2019-07-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707020002

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707020002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707020002
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707020002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190707020002

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190707020002

20190708020014å¼€å§‹æ‰§è¡Œ2019-07-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708020014

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708020014
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190708020014

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190708020014

20190709015954å¼€å§‹æ‰§è¡Œ2019-07-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709015954

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709015954
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709015954
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709015955
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190709015955

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190709015955

20190710020014å¼€å§‹æ‰§è¡Œ2019-07-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710020014

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710020014
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190710020014

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190710020014

20190711020003å¼€å§‹æ‰§è¡Œ2019-07-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711020003

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711020003
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711020003
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711020003
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190711020003

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190711020003

20190712020010å¼€å§‹æ‰§è¡Œ2019-07-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712020010

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712020010
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190712020011

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190712020011

20190713015950å¼€å§‹æ‰§è¡Œ2019-07-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713015950

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713015950
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713015950
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713015951
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190713015951

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190713015951

20190714015951å¼€å§‹æ‰§è¡Œ2019-07-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190714015951

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190714015951
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190714015951
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190714015951
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190714015951

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190714015951

20190715015950å¼€å§‹æ‰§è¡Œ2019-07-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715015950

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715015950
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715015950
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715015950
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190715015950

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190715015950

20190716015949å¼€å§‹æ‰§è¡Œ2019-07-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716015949

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716015949
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716015949
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716015949
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190716015949

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190716015950

20190717020004å¼€å§‹æ‰§è¡Œ2019-07-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717020004

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717020004
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717020004
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717020004
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190717020004

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190717020004

20190718015953å¼€å§‹æ‰§è¡Œ2019-07-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718015953

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718015953
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718015953
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718015953
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190718015953

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190718015953

20190719015946å¼€å§‹æ‰§è¡Œ2019-07-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719015946

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719015946
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719015946
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719015946
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190719015946

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190719015946

20190722094827å¼€å§‹æ‰§è¡Œ2019-07-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722094827

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722094827
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722094827
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722094827
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190722094827

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190722094827

20190723015959å¼€å§‹æ‰§è¡Œ2019-07-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723015959

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723015959
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723015959
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723015959
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190723015959

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190723020000

20190724020038å¼€å§‹æ‰§è¡Œ2019-07-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724020038

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724020038
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724020038
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724020038
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190724020038

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190724020038

20190725020103å¼€å§‹æ‰§è¡Œ2019-07-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725020103

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725020103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725020103
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(a.birthday, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS decimal(3,0) )  as age
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725020103
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190725020103

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190725020104

20190726091908å¼€å§‹æ‰§è¡Œ2019-07-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726091908

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726091908
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726091908
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726091908
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190726091908

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190726091908

20190727020015å¼€å§‹æ‰§è¡Œ2019-07-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727020015

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727020015
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727020015
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727020015
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190727020015

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190727020015

20190728015958å¼€å§‹æ‰§è¡Œ2019-07-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728015958

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728015958
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728015958
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728015958
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190728015958

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190728015958

20190729015959å¼€å§‹æ‰§è¡Œ2019-07-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729015959

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729015959
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729015959
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729015959
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190729015959

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190729015959

20190730015954å¼€å§‹æ‰§è¡Œ2019-07-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730015954

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730015954
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730015954
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730015954
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190730015954

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190730015954

20190731020044å¼€å§‹æ‰§è¡Œ2019-07-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731020044

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731020044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731020044
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731020044
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190731020044

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190731020044

20190801020010å¼€å§‹æ‰§è¡Œ2019-08-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801020010

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801020010
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190801020010

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190801020010

20190802020025å¼€å§‹æ‰§è¡Œ2019-08-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802020025

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802020025
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802020025
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802020026
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190802020026

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190802020026

20190803020014å¼€å§‹æ‰§è¡Œ2019-08-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803020014

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803020014
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190803020014

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190803020014

20190804020010å¼€å§‹æ‰§è¡Œ2019-08-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804020010

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804020010
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190804020010

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190804020010

20190805020006å¼€å§‹æ‰§è¡Œ2019-08-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805020006

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805020006
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190805020006

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190805020006

20190806020004å¼€å§‹æ‰§è¡Œ2019-08-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806020004

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806020004
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806020004
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806020004
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806020004

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806020004

20190806102833å¼€å§‹æ‰§è¡Œ2019-08-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806102833

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806102833
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806102833
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806102833
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190806102833

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190806102833

20190807020003å¼€å§‹æ‰§è¡Œ2019-08-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807020003

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807020003
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807020003
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807020003
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190807020003

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190807020003

20190808020000å¼€å§‹æ‰§è¡Œ2019-08-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808020000

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808020000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808020000
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808020000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190808020000

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190808020000

20190809020001å¼€å§‹æ‰§è¡Œ2019-08-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809020001

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809020001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809020001
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809020001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190809020001

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190809020001

20190810015959å¼€å§‹æ‰§è¡Œ2019-08-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810015959

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810015959
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810015959
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810015959
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190810015959

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190810015959

20190811015959å¼€å§‹æ‰§è¡Œ2019-08-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811015959

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811015959
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811015959
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811015959
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190811015959

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190811015959

20190812020001å¼€å§‹æ‰§è¡Œ2019-08-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812020001

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812020001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812020001
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812020002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190812020002

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190812020002

20190813020000å¼€å§‹æ‰§è¡Œ2019-08-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813020000

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813020000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813020000
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813020000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190813020000

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190813020000

20190814020002å¼€å§‹æ‰§è¡Œ2019-08-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814020002

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814020002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814020002
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814020002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190814020002

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190814020002

20190815020013å¼€å§‹æ‰§è¡Œ2019-08-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815020013

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815020013
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190815020013

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190815020014

20190816020011å¼€å§‹æ‰§è¡Œ2019-08-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816020011

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816020011
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190816020011

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190816020011

20190817020013å¼€å§‹æ‰§è¡Œ2019-08-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817020013

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817020013
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190817020013

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190817020013

20190818020007å¼€å§‹æ‰§è¡Œ2019-08-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190818020007

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190818020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190818020007
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190818020008
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190818020008

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190818020008

20190819020010å¼€å§‹æ‰§è¡Œ2019-08-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819020010

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819020010
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190819020010

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190819020010

20190820020016å¼€å§‹æ‰§è¡Œ2019-08-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820020016

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820020016
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190820020016

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190820020017

20190821020019å¼€å§‹æ‰§è¡Œ2019-08-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821020019

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821020019
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821020019
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821020019
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190821020019

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190821020019

20190822020023å¼€å§‹æ‰§è¡Œ2019-08-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822020023

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822020023
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822020023
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822020024
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190822020024

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190822020024

20190823020018å¼€å§‹æ‰§è¡Œ2019-08-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823020018

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823020018
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190823020018

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190823020018

20190824020017å¼€å§‹æ‰§è¡Œ2019-08-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824020017

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824020017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824020017
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824020017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190824020017

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190824020017

20190825020015å¼€å§‹æ‰§è¡Œ2019-08-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825020015

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825020015
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825020015
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825020015
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190825020015

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190825020016

20190826020019å¼€å§‹æ‰§è¡Œ2019-08-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826020019

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826020019
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826020019
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826020019
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190826020019

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190826020019

20190827020017å¼€å§‹æ‰§è¡Œ2019-08-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827020017

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827020017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827020017
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827020017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190827020017

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190827020017

20190828020016å¼€å§‹æ‰§è¡Œ2019-08-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828020016

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828020016
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190828020016

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190828020016

20190829020018å¼€å§‹æ‰§è¡Œ2019-08-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829020018

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829020018
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190829020018

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190829020018

20190830020018å¼€å§‹æ‰§è¡Œ2019-08-30æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830020018

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830020018
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190830020018

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190830020018

20190831020018å¼€å§‹æ‰§è¡Œ2019-08-31æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831020018

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831020018
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190831020018

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190831020018

20190901020017å¼€å§‹æ‰§è¡Œ2019-09-01æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901020017

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901020017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901020017
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901020017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190901020017

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190901020017

20190902020013å¼€å§‹æ‰§è¡Œ2019-09-02æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902020013

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902020013
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190902020013

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190902020013

20190903020013å¼€å§‹æ‰§è¡Œ2019-09-03æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903020013

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903020013
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190903020013

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190903020013

20190904020013å¼€å§‹æ‰§è¡Œ2019-09-04æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904020013

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904020013
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190904020013

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190904020013

20190905020024å¼€å§‹æ‰§è¡Œ2019-09-05æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905020024

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905020024
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905020024
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905020024
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190905020024

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190905020024

20190906020018å¼€å§‹æ‰§è¡Œ2019-09-06æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906020018

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906020018
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190906020018

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190906020018

20190907020016å¼€å§‹æ‰§è¡Œ2019-09-07æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907020016

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907020016
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190907020016

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190907020017

20190908020017å¼€å§‹æ‰§è¡Œ2019-09-08æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908020017

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908020017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908020017
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908020017
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190908020017

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190908020017

20190909020013å¼€å§‹æ‰§è¡Œ2019-09-09æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909020013

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909020013
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190909020014

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190909020014

20190910020022å¼€å§‹æ‰§è¡Œ2019-09-10æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910020022

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910020022
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910020022
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910020022
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190910020022

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190910020023

20190911020018å¼€å§‹æ‰§è¡Œ2019-09-11æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911020018

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911020018
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911020018
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190911020018

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190911020018

20190912020015å¼€å§‹æ‰§è¡Œ2019-09-12æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912020015

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912020015
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912020015
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912020016
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190912020016

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190912020016

20190913020007å¼€å§‹æ‰§è¡Œ2019-09-13æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913020007

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913020007
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190913020007

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190913020007

20190914020006å¼€å§‹æ‰§è¡Œ2019-09-14æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914020006

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914020006
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190914020006

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190914020006

20190915020007å¼€å§‹æ‰§è¡Œ2019-09-15æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915020007

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915020007
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190915020007

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190915020007

20190916020007å¼€å§‹æ‰§è¡Œ2019-09-16æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916020007

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916020007
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190916020007

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190916020007

20190917020008å¼€å§‹æ‰§è¡Œ2019-09-17æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917020008

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917020008
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917020008
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917020008
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190917020008

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190917020008

20190918020013å¼€å§‹æ‰§è¡Œ2019-09-18æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918020013

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918020013
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918020013
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918020014
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190918020014

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190918020014

20190919020006å¼€å§‹æ‰§è¡Œ2019-09-19æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919020006

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919020006
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190919020006

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190919020006

20190920020011å¼€å§‹æ‰§è¡Œ2019-09-20æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920020011

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920020011
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190920020011

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190920020011

20190921020009å¼€å§‹æ‰§è¡Œ2019-09-21æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921020009

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921020009
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190921020009

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190921020009

20190922020009å¼€å§‹æ‰§è¡Œ2019-09-22æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922020009

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922020009
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190922020009

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190922020009

20190923020006å¼€å§‹æ‰§è¡Œ2019-09-23æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923020006

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923020006
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190923020006

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190923020006

20190924020009å¼€å§‹æ‰§è¡Œ2019-09-24æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924020009

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924020009
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924020010
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190924020010

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190924020010

20190925020011å¼€å§‹æ‰§è¡Œ2019-09-25æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925020011

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925020011
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190925020011

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190925020011

20190926020007å¼€å§‹æ‰§è¡Œ2019-09-26æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926020007

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926020007
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926020007
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190926020007

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190926020008

20190927020011å¼€å§‹æ‰§è¡Œ2019-09-27æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927020011

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927020011
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927020011
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190927020011

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190927020012

20190928020009å¼€å§‹æ‰§è¡Œ2019-09-28æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928020009

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928020009
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928020009
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190928020009

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190928020009

20190929020006å¼€å§‹æ‰§è¡Œ2019-09-29æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929020006

truncate table pdm.ehr_employee
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929020006
insert into pdm.ehr_employee
select distinct a.userid
      ,a.jobnumber
      ,a.name
      ,a.address_usual
      ,a.poidempadmin
      ,a.poidempreserve2
      ,DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(a.birthday)), '%Y')+0 AS ag
      ,a.gender
      ,a.major
      ,a.educationlevel
      ,a.mobilephone
      ,a.workdate
      ,case when a.workdate is null and employeestatus <> 'å¾…å…¥èŒ' then CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) )
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(workdate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end as workyeartotal
      ,case when employeestatus = 'å¾…å…¥èŒ' then 0
       else CAST(( unix_timestamp( now() ) - unix_timestamp(str_to_date(entrydate, '%Y-%m-%d %H')) ) / 3600 / 24/365 AS DECIMAL ( 3, 1 ) ) end  as workyearcompanytotal
      ,a.birthday
      ,a.first_dept
      ,a.second_dept
      ,a.third_dept
      ,a.fourth_dept
      ,a.fifth_dept
      ,a.sixth_dept
      ,a.position_name
      ,a.jobpost_name
      ,a.oidjoblevel
      ,a.entrydate
      ,a.startdate
      ,a.stopdate
      ,a.TransitionType
      ,a.probation
      ,a.employeestatus
      ,a.employmenttype
      ,a.probationstartdate
      ,a.probationstopdate
      ,a.regularizationdate
      ,a.probationresult
      ,a.lastworkdate
      ,a.extlizhireason_107502_632202192
      ,a.start_dt
      ,a.end_dt
  from edw.ehr_employee a
 where end_dt = '3000-12-31'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929020006
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190929020006

update pdm.ehr_employee a
 inner join edw.dic_ehr_withdrawn b
    on a.name = b.name
   set a.third_dept = b.third_dept
      ,a.fourth_dept = b.fourth_dept
      ,a.fifth_dept = b.fifth_dept
      ,a.sixth_dept = b.sixth_dept
 where b.type = '1'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190929020006
