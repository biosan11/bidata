
20181129011027开始执行2018-11-28数据加载日志:
SQL开始执行时间：20181129011027



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-11-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129011027
SQL开始执行时间：20181129011027

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181129011027
SQL开始执行时间：20181129011027


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129011027
SQL开始执行时间：20181129011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181129011028
SQL开始执行时间：20181129011028

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;

20181129084643开始执行2018-11-28数据加载日志:
SQL开始执行时间：20181129084643



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-11-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129084643
SQL开始执行时间：20181129084643

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181129084644
SQL开始执行时间：20181129084644


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129084644
SQL开始执行时间：20181129084644

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181129084645
SQL开始执行时间：20181129084645

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;

20181129084825开始执行2018-11-28数据加载日志:
SQL开始执行时间：20181129084825



create table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-11-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129084825
SQL开始执行时间：20181129084825

create table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181129084826
SQL开始执行时间：20181129084826


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129084826
SQL开始执行时间：20181129084826

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181129084827
SQL开始执行时间：20181129084827

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;

20181129085040开始执行2018-11-28数据加载日志:
SQL开始执行时间：20181129085040



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-11-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129085040
SQL开始执行时间：20181129085040

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
      ,b.cvenabbname
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181129085040
SQL开始执行时间：20181129085040


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129085040
SQL开始执行时间：20181129085040

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181129085041
SQL开始执行时间：20181129085041

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181129085041

20181129085101开始执行2018-11-28数据加载日志:
SQL开始执行时间：20181129085101



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-11-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129085101
SQL开始执行时间：20181129085101

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
      ,b.cvenabbname
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181129085101
SQL开始执行时间：20181129085101


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129085101
SQL开始执行时间：20181129085101

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181129085103
SQL开始执行时间：20181129085103

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181129085103

20181130011024开始执行2018-11-29数据加载日志:
SQL开始执行时间：20181130011024



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-11-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20181130011024
SQL开始执行时间：20181130011024

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
      ,b.cvenabbname
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181130011024
SQL开始执行时间：20181130011024


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181130011024
SQL开始执行时间：20181130011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181130011025
SQL开始执行时间：20181130011025

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181130011025

20181201011028开始执行2018-11-30数据加载日志:
SQL开始执行时间：20181201011028



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-11-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20181201011028
SQL开始执行时间：20181201011028

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
      ,b.cvenabbname
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181201011028
SQL开始执行时间：20181201011028


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181201011028
SQL开始执行时间：20181201011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181201011030
SQL开始执行时间：20181201011030

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181201011030

20181202011026开始执行2018-12-01数据加载日志:
SQL开始执行时间：20181202011026



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-12-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181202011026
SQL开始执行时间：20181202011026

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
      ,b.cvenabbname
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181202011026
SQL开始执行时间：20181202011026


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181202011026
SQL开始执行时间：20181202011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181202011027
SQL开始执行时间：20181202011027

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181202011027

20181203011024开始执行2018-12-02数据加载日志:
SQL开始执行时间：20181203011024



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-12-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20181203011024
SQL开始执行时间：20181203011024

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
      ,b.cvenabbname
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181203011024
SQL开始执行时间：20181203011024


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181203011024
SQL开始执行时间：20181203011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181203011024
SQL开始执行时间：20181203011024

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181203011024

20181204011024开始执行2018-12-03数据加载日志:
SQL开始执行时间：20181204011024



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-12-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20181204011024
SQL开始执行时间：20181204011024

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
      ,b.cvenabbname
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181204011025
SQL开始执行时间：20181204011025


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181204011025
SQL开始执行时间：20181204011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181204011026
SQL开始执行时间：20181204011026

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181204011026

20181205011024开始执行2018-12-04数据加载日志:
SQL开始执行时间：20181205011024



create temporary table pdm.sales_order_pre as 
select *
  from edw.sales_order a
 where left(a.sys_time,10) > '2018-12-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20181205011024
SQL开始执行时间：20181205011024

create temporary table pdm.mid_sales_order as 
select a.*
      ,b.cwhcode
      ,b.cvenabbname
  from pdm.sales_order_pre a
  left join (select csocode,cwhcode,cvenabbname from edw.dispatch_order group by csocode union
             select csocode,cwhcode,cvenabbname from edw.invoice_order group by csocode) b
    on a.csocode = b.csocode
;
SQL结束执行时间：20181205011025
SQL开始执行时间：20181205011025


delete from pdm.mid_sales_order where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181205011025
SQL开始执行时间：20181205011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181205011026
SQL开始执行时间：20181205011026

insert into pdm.sales_order
select a.csocode
      ,a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.itaxunitprice
      ,a.citemname
      ,a.cvenabbname
      ,a.cstcode
      ,localtimestamp()
  from pdm.mid_sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181205011026

20181206011025开始执行2018-12-05数据加载日志:
SQL开始执行时间：20181206011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206011025
SQL开始执行时间：20181206011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206011025
SQL开始执行时间：20181206011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206011025
SQL开始执行时间：20181206011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181206011026
SQL开始执行时间：20181206011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,case when e.bi_cinvcode is not null and e.item_code is not null  then e.item_code else '请核查' end
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.sales_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206011026

20181206103149开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206103149


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206103149
SQL开始执行时间：20181206103149



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206103150
SQL开始执行时间：20181206103150


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206103150
SQL开始执行时间：20181206103150

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181206103251
SQL开始执行时间：20181206103251

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20181206103412开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206103412


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206103412
SQL开始执行时间：20181206103412



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206103413
SQL开始执行时间：20181206103413


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206103413
SQL开始执行时间：20181206103413

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181206103514
SQL开始执行时间：20181206103514

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206103515

20181207011027开始执行2018-12-06数据加载日志:
SQL开始执行时间：20181207011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20181207011027
SQL开始执行时间：20181207011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181207011027
SQL开始执行时间：20181207011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181207011027
SQL开始执行时间：20181207011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181207011028
SQL开始执行时间：20181207011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181207011028

20181208011025开始执行2018-12-07数据加载日志:
SQL开始执行时间：20181208011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20181208011025
SQL开始执行时间：20181208011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181208011025
SQL开始执行时间：20181208011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181208011025
SQL开始执行时间：20181208011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181208011026
SQL开始执行时间：20181208011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181208011026

20181209011023开始执行2018-12-08数据加载日志:
SQL开始执行时间：20181209011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20181209011024
SQL开始执行时间：20181209011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181209011024
SQL开始执行时间：20181209011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181209011024
SQL开始执行时间：20181209011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181209011024
SQL开始执行时间：20181209011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181209011024

20181210011024开始执行2018-12-09数据加载日志:
SQL开始执行时间：20181210011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20181210011024
SQL开始执行时间：20181210011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181210011025
SQL开始执行时间：20181210011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181210011025
SQL开始执行时间：20181210011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181210011025
SQL开始执行时间：20181210011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181210011025

20181211011026开始执行2018-12-10数据加载日志:
SQL开始执行时间：20181211011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20181211011026
SQL开始执行时间：20181211011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181211011026
SQL开始执行时间：20181211011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181211011026
SQL开始执行时间：20181211011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181211011028
SQL开始执行时间：20181211011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20181211162130开始执行2018-12-10数据加载日志:
SQL开始执行时间：20181211162130


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20181211162131
SQL开始执行时间：20181211162131



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181211162131
SQL开始执行时间：20181211162131


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181211162131
SQL开始执行时间：20181211162131

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181211162132
SQL开始执行时间：20181211162132

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20181211162301开始执行2018-12-10数据加载日志:
SQL开始执行时间：20181211162301


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20181211162301
SQL开始执行时间：20181211162301



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181211162301
SQL开始执行时间：20181211162301


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181211162301
SQL开始执行时间：20181211162301

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181211162302
SQL开始执行时间：20181211162302

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181211162302

20181212011024开始执行2018-12-11数据加载日志:
SQL开始执行时间：20181212011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20181212011024
SQL开始执行时间：20181212011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181212011024
SQL开始执行时间：20181212011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181212011024
SQL开始执行时间：20181212011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181212011025
SQL开始执行时间：20181212011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181212011025

20181213011025开始执行2018-12-12数据加载日志:
SQL开始执行时间：20181213011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20181213011025
SQL开始执行时间：20181213011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181213011025
SQL开始执行时间：20181213011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181213011025
SQL开始执行时间：20181213011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181213011026
SQL开始执行时间：20181213011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181213011026

20181214011028开始执行2018-12-13数据加载日志:
SQL开始执行时间：20181214011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20181214011028
SQL开始执行时间：20181214011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181214011028
SQL开始执行时间：20181214011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181214011028
SQL开始执行时间：20181214011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181214011029
SQL开始执行时间：20181214011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181214011029

20181215011025开始执行2018-12-14数据加载日志:
SQL开始执行时间：20181215011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20181215011025
SQL开始执行时间：20181215011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181215011025
SQL开始执行时间：20181215011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181215011025
SQL开始执行时间：20181215011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181215011027
SQL开始执行时间：20181215011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181215011027

20181216011024开始执行2018-12-15数据加载日志:
SQL开始执行时间：20181216011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20181216011024
SQL开始执行时间：20181216011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181216011024
SQL开始执行时间：20181216011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181216011024
SQL开始执行时间：20181216011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181216011024
SQL开始执行时间：20181216011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181216011024

20181217011027开始执行2018-12-16数据加载日志:
SQL开始执行时间：20181217011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20181217011027
SQL开始执行时间：20181217011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181217011027
SQL开始执行时间：20181217011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181217011027
SQL开始执行时间：20181217011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181217011027
SQL开始执行时间：20181217011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181217011027

20181218011026开始执行2018-12-17数据加载日志:
SQL开始执行时间：20181218011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20181218011026
SQL开始执行时间：20181218011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181218011026
SQL开始执行时间：20181218011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181218011026
SQL开始执行时间：20181218011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181218011028
SQL开始执行时间：20181218011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181218011028

20181219011027开始执行2018-12-18数据加载日志:
SQL开始执行时间：20181219011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219011027
SQL开始执行时间：20181219011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219011028
SQL开始执行时间：20181219011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219011028
SQL开始执行时间：20181219011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181219011028
SQL开始执行时间：20181219011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219011028

20181219110830开始执行1900-01-1数据加载日志:
SQL开始执行时间：20181219110830


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-1'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219110831
SQL开始执行时间：20181219110831



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219110831
SQL开始执行时间：20181219110831


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219110831
SQL开始执行时间：20181219110831

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181219110831
SQL开始执行时间：20181219110831

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219110832

20181219181129开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181219181129


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219181129
SQL开始执行时间：20181219181129



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219181129
SQL开始执行时间：20181219181129


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219181129
SQL开始执行时间：20181219181129

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181219181129
SQL开始执行时间：20181219181129

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219181129

20181219181604开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181219181604


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219181604
SQL开始执行时间：20181219181604



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219181604
SQL开始执行时间：20181219181604


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219181605
SQL开始执行时间：20181219181605

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181219181605
SQL开始执行时间：20181219181605

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219181605

20181220011028开始执行2018-12-19数据加载日志:
SQL开始执行时间：20181220011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20181220011028
SQL开始执行时间：20181220011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181220011029
SQL开始执行时间：20181220011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181220011029
SQL开始执行时间：20181220011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181220011030
SQL开始执行时间：20181220011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181220011030

20181221011025开始执行2018-12-20数据加载日志:
SQL开始执行时间：20181221011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20181221011025
SQL开始执行时间：20181221011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181221011026
SQL开始执行时间：20181221011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181221011026
SQL开始执行时间：20181221011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181221011027
SQL开始执行时间：20181221011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181221011027

20181221151145开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181221151145


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181221151146
SQL开始执行时间：20181221151146



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181221151146
SQL开始执行时间：20181221151146


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181221151146
SQL开始执行时间：20181221151146

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181221151146
SQL开始执行时间：20181221151146

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181221151147

20181222011025开始执行2018-12-21数据加载日志:
SQL开始执行时间：20181222011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20181222011025
SQL开始执行时间：20181222011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181222011026
SQL开始执行时间：20181222011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181222011026
SQL开始执行时间：20181222011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181222011027
SQL开始执行时间：20181222011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181222011027

20181223011025开始执行2018-12-22数据加载日志:
SQL开始执行时间：20181223011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20181223011025
SQL开始执行时间：20181223011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181223011025
SQL开始执行时间：20181223011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181223011025
SQL开始执行时间：20181223011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181223011025
SQL开始执行时间：20181223011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181223011025

20181224011025开始执行2018-12-23数据加载日志:
SQL开始执行时间：20181224011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20181224011025
SQL开始执行时间：20181224011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181224011025
SQL开始执行时间：20181224011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181224011025
SQL开始执行时间：20181224011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181224011025
SQL开始执行时间：20181224011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181224011025

20181224100746开始执行2018-12-21数据加载日志:
SQL开始执行时间：20181224100746


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20181224100746
SQL开始执行时间：20181224100746



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181224100747
SQL开始执行时间：20181224100747


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181224100747
SQL开始执行时间：20181224100747

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181224100748
SQL开始执行时间：20181224100748

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181224100748

20181225011025开始执行2018-12-24数据加载日志:
SQL开始执行时间：20181225011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225011025
SQL开始执行时间：20181225011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225011025
SQL开始执行时间：20181225011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225011025
SQL开始执行时间：20181225011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181225011026
SQL开始执行时间：20181225011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225011027

20181225104723开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181225104723


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225104724
SQL开始执行时间：20181225104724



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225104724
SQL开始执行时间：20181225104724


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225104725
SQL开始执行时间：20181225104725

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181225104725
SQL开始执行时间：20181225104725

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225104725

20181225202716开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181225202716


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225202716
SQL开始执行时间：20181225202716



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225202717
SQL开始执行时间：20181225202717


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225202717
SQL开始执行时间：20181225202717

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181225202717
SQL开始执行时间：20181225202717

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225202717

20181226011025开始执行2018-12-25数据加载日志:
SQL开始执行时间：20181226011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226011025
SQL开始执行时间：20181226011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226011025
SQL开始执行时间：20181226011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226011025
SQL开始执行时间：20181226011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181226011026
SQL开始执行时间：20181226011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181226011026

20181226142330开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181226142330


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226142331
SQL开始执行时间：20181226142331



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226142331
SQL开始执行时间：20181226142331


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226142331
SQL开始执行时间：20181226142331

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181226142331
SQL开始执行时间：20181226142331

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181226142332

20181227011028开始执行2018-12-26数据加载日志:
SQL开始执行时间：20181227011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20181227011028
SQL开始执行时间：20181227011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181227011028
SQL开始执行时间：20181227011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181227011028
SQL开始执行时间：20181227011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181227011029
SQL开始执行时间：20181227011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181227011029

20181228011029开始执行2018-12-27数据加载日志:
SQL开始执行时间：20181228011029


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20181228011029
SQL开始执行时间：20181228011029



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181228011029
SQL开始执行时间：20181228011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181228011029
SQL开始执行时间：20181228011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181228011030
SQL开始执行时间：20181228011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181228011030

20181229011027开始执行2018-12-28数据加载日志:
SQL开始执行时间：20181229011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181229011027
SQL开始执行时间：20181229011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181229011028
SQL开始执行时间：20181229011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181229011028
SQL开始执行时间：20181229011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181229011028
SQL开始执行时间：20181229011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181229011028

20181230011028开始执行2018-12-29数据加载日志:
SQL开始执行时间：20181230011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20181230011028
SQL开始执行时间：20181230011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181230011029
SQL开始执行时间：20181230011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181230011029
SQL开始执行时间：20181230011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181230011029
SQL开始执行时间：20181230011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181230011029

20181231011026开始执行2018-12-30数据加载日志:
SQL开始执行时间：20181231011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20181231011026
SQL开始执行时间：20181231011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181231011026
SQL开始执行时间：20181231011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181231011026
SQL开始执行时间：20181231011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20181231011026
SQL开始执行时间：20181231011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181231011026

20190101011025开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190101011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190101011025
SQL开始执行时间：20190101011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190101011026
SQL开始执行时间：20190101011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190101011026
SQL开始执行时间：20190101011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190101011026
SQL开始执行时间：20190101011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190101011026

20190102011025开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190102011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190102011025
SQL开始执行时间：20190102011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190102011026
SQL开始执行时间：20190102011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190102011026
SQL开始执行时间：20190102011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190102011026
SQL开始执行时间：20190102011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190102011026

20190103011028开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190103011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190103011028
SQL开始执行时间：20190103011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190103011028
SQL开始执行时间：20190103011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190103011028
SQL开始执行时间：20190103011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190103011029
SQL开始执行时间：20190103011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190103011029

20190104011025开始执行2019-01-03数据加载日志:
SQL开始执行时间：20190104011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190104011026
SQL开始执行时间：20190104011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190104011026
SQL开始执行时间：20190104011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190104011026
SQL开始执行时间：20190104011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190104011027
SQL开始执行时间：20190104011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190104011027

20190105011026开始执行2019-01-04数据加载日志:
SQL开始执行时间：20190105011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190105011026
SQL开始执行时间：20190105011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190105011027
SQL开始执行时间：20190105011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190105011027
SQL开始执行时间：20190105011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190105011027
SQL开始执行时间：20190105011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190105011027

20190106011025开始执行2019-01-05数据加载日志:
SQL开始执行时间：20190106011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190106011025
SQL开始执行时间：20190106011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190106011026
SQL开始执行时间：20190106011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190106011026
SQL开始执行时间：20190106011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190106011026
SQL开始执行时间：20190106011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190106011026

20190107011024开始执行2019-01-06数据加载日志:
SQL开始执行时间：20190107011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190107011024
SQL开始执行时间：20190107011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190107011024
SQL开始执行时间：20190107011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190107011024
SQL开始执行时间：20190107011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190107011024
SQL开始执行时间：20190107011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190107011024

20190108011026开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190108011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190108011026
SQL开始执行时间：20190108011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190108011027
SQL开始执行时间：20190108011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190108011027
SQL开始执行时间：20190108011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190108011028
SQL开始执行时间：20190108011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190108011028

20190109011028开始执行2019-01-08数据加载日志:
SQL开始执行时间：20190109011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190109011029
SQL开始执行时间：20190109011029



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190109011029
SQL开始执行时间：20190109011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190109011029
SQL开始执行时间：20190109011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190109011030
SQL开始执行时间：20190109011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190109011030

20190110011025开始执行2019-01-09数据加载日志:
SQL开始执行时间：20190110011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190110011025
SQL开始执行时间：20190110011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190110011026
SQL开始执行时间：20190110011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190110011026
SQL开始执行时间：20190110011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190110011027
SQL开始执行时间：20190110011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190110011027

20190111011028开始执行2019-01-10数据加载日志:
SQL开始执行时间：20190111011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190111011028
SQL开始执行时间：20190111011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190111011029
SQL开始执行时间：20190111011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190111011029
SQL开始执行时间：20190111011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190111011030
SQL开始执行时间：20190111011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190111011030

20190112011029开始执行2019-01-11数据加载日志:
SQL开始执行时间：20190112011029


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190112011029
SQL开始执行时间：20190112011029



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190112011029
SQL开始执行时间：20190112011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190112011029
SQL开始执行时间：20190112011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190112011030
SQL开始执行时间：20190112011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190112011030

20190113011025开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190113011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190113011025
SQL开始执行时间：20190113011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190113011025
SQL开始执行时间：20190113011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190113011025
SQL开始执行时间：20190113011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190113011025
SQL开始执行时间：20190113011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190113011025

20190114011025开始执行2019-01-13数据加载日志:
SQL开始执行时间：20190114011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190114011025
SQL开始执行时间：20190114011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190114011025
SQL开始执行时间：20190114011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190114011025
SQL开始执行时间：20190114011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190114011025
SQL开始执行时间：20190114011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190114011025

20190115011026开始执行2019-01-14数据加载日志:
SQL开始执行时间：20190115011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115011026
SQL开始执行时间：20190115011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115011026
SQL开始执行时间：20190115011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115011026
SQL开始执行时间：20190115011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190115011028
SQL开始执行时间：20190115011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190115011028

20190116011026开始执行2019-01-15数据加载日志:
SQL开始执行时间：20190116011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190116011026
SQL开始执行时间：20190116011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190116011026
SQL开始执行时间：20190116011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190116011026
SQL开始执行时间：20190116011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190116011027
SQL开始执行时间：20190116011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190116011027

20190117011026开始执行2019-01-16数据加载日志:
SQL开始执行时间：20190117011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117011026
SQL开始执行时间：20190117011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190117011027
SQL开始执行时间：20190117011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117011027
SQL开始执行时间：20190117011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190117011028
SQL开始执行时间：20190117011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190117011028

20190118011026开始执行2019-01-17数据加载日志:
SQL开始执行时间：20190118011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118011026
SQL开始执行时间：20190118011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118011026
SQL开始执行时间：20190118011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118011026
SQL开始执行时间：20190118011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190118011026
SQL开始执行时间：20190118011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190118011026

20190122172937开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122172937


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122172938
SQL开始执行时间：20190122172938



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122172938
SQL开始执行时间：20190122172938


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122172938
SQL开始执行时间：20190122172938

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190122172938
SQL开始执行时间：20190122172938

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190122172938

20190123011029开始执行2019-01-22数据加载日志:
SQL开始执行时间：20190123011029


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190123011029
SQL开始执行时间：20190123011029



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190123011029
SQL开始执行时间：20190123011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190123011029
SQL开始执行时间：20190123011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190123011029
SQL开始执行时间：20190123011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190123011029

20190124011026开始执行2019-01-23数据加载日志:
SQL开始执行时间：20190124011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190124011026
SQL开始执行时间：20190124011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190124011026
SQL开始执行时间：20190124011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190124011026
SQL开始执行时间：20190124011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190124011026
SQL开始执行时间：20190124011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190124011026

20190126011024开始执行2019-01-25数据加载日志:
SQL开始执行时间：20190126011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190126011024
SQL开始执行时间：20190126011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190126011024
SQL开始执行时间：20190126011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190126011024
SQL开始执行时间：20190126011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;

20190128085728开始执行2019-01-27数据加载日志:
SQL开始执行时间：20190128085728


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190128085728
SQL开始执行时间：20190128085728



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190128085729
SQL开始执行时间：20190128085729


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190128085729
SQL开始执行时间：20190128085729

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190128085729
SQL开始执行时间：20190128085729

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190128085729

20190129011024开始执行2019-01-28数据加载日志:
SQL开始执行时间：20190129011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129011024
SQL开始执行时间：20190129011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190129011024
SQL开始执行时间：20190129011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129011024
SQL开始执行时间：20190129011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190129011024
SQL开始执行时间：20190129011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190129011024

20190130011025开始执行2019-01-29数据加载日志:
SQL开始执行时间：20190130011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190130011025
SQL开始执行时间：20190130011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190130011025
SQL开始执行时间：20190130011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190130011025
SQL开始执行时间：20190130011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190130011025
SQL开始执行时间：20190130011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190130011025

20190131011022开始执行2019-01-30数据加载日志:
SQL开始执行时间：20190131011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190131011022
SQL开始执行时间：20190131011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190131011022
SQL开始执行时间：20190131011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190131011022
SQL开始执行时间：20190131011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190131011022
SQL开始执行时间：20190131011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190131011022

20190201011024开始执行2019-01-31数据加载日志:
SQL开始执行时间：20190201011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190201011024
SQL开始执行时间：20190201011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190201011024
SQL开始执行时间：20190201011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190201011024
SQL开始执行时间：20190201011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190201011024
SQL开始执行时间：20190201011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190201011024

20190202011022开始执行2019-02-01数据加载日志:
SQL开始执行时间：20190202011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190202011022
SQL开始执行时间：20190202011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190202011022
SQL开始执行时间：20190202011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190202011022
SQL开始执行时间：20190202011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190202011022
SQL开始执行时间：20190202011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190202011022

20190203011021开始执行2019-02-02数据加载日志:
SQL开始执行时间：20190203011021


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190203011021
SQL开始执行时间：20190203011021



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190203011021
SQL开始执行时间：20190203011021


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190203011021
SQL开始执行时间：20190203011021

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190203011021
SQL开始执行时间：20190203011021

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190203011021

20190204011024开始执行2019-02-03数据加载日志:
SQL开始执行时间：20190204011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190204011024
SQL开始执行时间：20190204011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190204011024
SQL开始执行时间：20190204011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190204011024
SQL开始执行时间：20190204011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190204011024
SQL开始执行时间：20190204011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190204011024

20190205011022开始执行2019-02-04数据加载日志:
SQL开始执行时间：20190205011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190205011022
SQL开始执行时间：20190205011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190205011022
SQL开始执行时间：20190205011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190205011022
SQL开始执行时间：20190205011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190205011022
SQL开始执行时间：20190205011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190205011022

20190206011021开始执行2019-02-05数据加载日志:
SQL开始执行时间：20190206011021


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190206011021
SQL开始执行时间：20190206011021



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190206011021
SQL开始执行时间：20190206011021


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190206011021
SQL开始执行时间：20190206011021

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190206011021
SQL开始执行时间：20190206011021

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190206011021

20190207011024开始执行2019-02-06数据加载日志:
SQL开始执行时间：20190207011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190207011024
SQL开始执行时间：20190207011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190207011025
SQL开始执行时间：20190207011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190207011025
SQL开始执行时间：20190207011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190207011025
SQL开始执行时间：20190207011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190207011025

20190208011024开始执行2019-02-07数据加载日志:
SQL开始执行时间：20190208011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190208011024
SQL开始执行时间：20190208011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190208011024
SQL开始执行时间：20190208011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190208011024
SQL开始执行时间：20190208011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190208011024
SQL开始执行时间：20190208011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190208011024

20190209011022开始执行2019-02-08数据加载日志:
SQL开始执行时间：20190209011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190209011022
SQL开始执行时间：20190209011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190209011022
SQL开始执行时间：20190209011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190209011022
SQL开始执行时间：20190209011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190209011022
SQL开始执行时间：20190209011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190209011022

20190210011024开始执行2019-02-09数据加载日志:
SQL开始执行时间：20190210011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190210011024
SQL开始执行时间：20190210011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190210011024
SQL开始执行时间：20190210011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190210011024
SQL开始执行时间：20190210011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190210011024
SQL开始执行时间：20190210011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190210011024

20190211011024开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190211011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190211011024
SQL开始执行时间：20190211011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190211011024
SQL开始执行时间：20190211011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190211011024
SQL开始执行时间：20190211011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190211011024
SQL开始执行时间：20190211011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190211011024

20190212011022开始执行2019-02-11数据加载日志:
SQL开始执行时间：20190212011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190212011022
SQL开始执行时间：20190212011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190212011022
SQL开始执行时间：20190212011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190212011022
SQL开始执行时间：20190212011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190212011022
SQL开始执行时间：20190212011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190212011022

20190213011024开始执行2019-02-12数据加载日志:
SQL开始执行时间：20190213011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190213011024
SQL开始执行时间：20190213011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190213011024
SQL开始执行时间：20190213011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190213011024
SQL开始执行时间：20190213011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190213011024
SQL开始执行时间：20190213011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190213011024

20190214011025开始执行2019-02-13数据加载日志:
SQL开始执行时间：20190214011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190214011025
SQL开始执行时间：20190214011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190214011025
SQL开始执行时间：20190214011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190214011025
SQL开始执行时间：20190214011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190214011025
SQL开始执行时间：20190214011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190214092028开始执行2019-02-13数据加载日志:
SQL开始执行时间：20190214092028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190214092028
SQL开始执行时间：20190214092028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190214092028
SQL开始执行时间：20190214092028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190214092028
SQL开始执行时间：20190214092028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190214092028
SQL开始执行时间：20190214092028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190214092028

20190215011022开始执行2019-02-14数据加载日志:
SQL开始执行时间：20190215011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190215011022
SQL开始执行时间：20190215011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190215011022
SQL开始执行时间：20190215011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190215011022
SQL开始执行时间：20190215011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190215011022
SQL开始执行时间：20190215011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190215011023

20190216011022开始执行2019-02-15数据加载日志:
SQL开始执行时间：20190216011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190216011022
SQL开始执行时间：20190216011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190216011022
SQL开始执行时间：20190216011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190216011022
SQL开始执行时间：20190216011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190216011022
SQL开始执行时间：20190216011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190216011022

20190217011021开始执行2019-02-16数据加载日志:
SQL开始执行时间：20190217011021


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190217011021
SQL开始执行时间：20190217011021



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190217011022
SQL开始执行时间：20190217011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190217011022
SQL开始执行时间：20190217011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190217011022
SQL开始执行时间：20190217011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190217011022

20190218011033开始执行2019-02-17数据加载日志:
SQL开始执行时间：20190218011033


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190218011033
SQL开始执行时间：20190218011033



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190218011033
SQL开始执行时间：20190218011033


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190218011033
SQL开始执行时间：20190218011033

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190218011033
SQL开始执行时间：20190218011033

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190218011033

20190219011022开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190219011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190219011022
SQL开始执行时间：20190219011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190219011022
SQL开始执行时间：20190219011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190219011022
SQL开始执行时间：20190219011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190219011022
SQL开始执行时间：20190219011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190219011022

20190220011022开始执行2019-02-19数据加载日志:
SQL开始执行时间：20190220011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220011022
SQL开始执行时间：20190220011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190220011022
SQL开始执行时间：20190220011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220011022
SQL开始执行时间：20190220011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190220011022
SQL开始执行时间：20190220011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190220011022

20190221011022开始执行2019-02-20数据加载日志:
SQL开始执行时间：20190221011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190221011022
SQL开始执行时间：20190221011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190221011022
SQL开始执行时间：20190221011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190221011022
SQL开始执行时间：20190221011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190221011022
SQL开始执行时间：20190221011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190221011022

20190222011022开始执行2019-02-21数据加载日志:
SQL开始执行时间：20190222011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190222011022
SQL开始执行时间：20190222011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190222011022
SQL开始执行时间：20190222011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190222011022
SQL开始执行时间：20190222011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190222011022
SQL开始执行时间：20190222011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190222011022

20190223011022开始执行2019-02-22数据加载日志:
SQL开始执行时间：20190223011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190223011022
SQL开始执行时间：20190223011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190223011022
SQL开始执行时间：20190223011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190223011022
SQL开始执行时间：20190223011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190223011023
SQL开始执行时间：20190223011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190223011023

20190224011021开始执行2019-02-23数据加载日志:
SQL开始执行时间：20190224011021


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190224011021
SQL开始执行时间：20190224011021



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190224011022
SQL开始执行时间：20190224011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190224011022
SQL开始执行时间：20190224011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190224011022
SQL开始执行时间：20190224011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190224011022

20190225011024开始执行2019-02-24数据加载日志:
SQL开始执行时间：20190225011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190225011024
SQL开始执行时间：20190225011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190225011025
SQL开始执行时间：20190225011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190225011025
SQL开始执行时间：20190225011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190225011025
SQL开始执行时间：20190225011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190225011025

20190226011023开始执行2019-02-25数据加载日志:
SQL开始执行时间：20190226011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190226011023
SQL开始执行时间：20190226011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190226011023
SQL开始执行时间：20190226011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190226011023
SQL开始执行时间：20190226011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190226011023
SQL开始执行时间：20190226011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190226011023

20190227011025开始执行2019-02-26数据加载日志:
SQL开始执行时间：20190227011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190227011025
SQL开始执行时间：20190227011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190227011025
SQL开始执行时间：20190227011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190227011025
SQL开始执行时间：20190227011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190227011025
SQL开始执行时间：20190227011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190227011025

20190228011022开始执行2019-02-27数据加载日志:
SQL开始执行时间：20190228011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190228011022
SQL开始执行时间：20190228011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190228011022
SQL开始执行时间：20190228011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190228011022
SQL开始执行时间：20190228011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190228011022
SQL开始执行时间：20190228011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190228011022

20190301011025开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301011025
SQL开始执行时间：20190301011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301011025
SQL开始执行时间：20190301011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301011025
SQL开始执行时间：20190301011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190301011025
SQL开始执行时间：20190301011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190301011025

20190302011022开始执行2019-03-01数据加载日志:
SQL开始执行时间：20190302011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190302011022
SQL开始执行时间：20190302011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190302011023
SQL开始执行时间：20190302011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190302011023
SQL开始执行时间：20190302011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190302011023
SQL开始执行时间：20190302011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190302011023

20190303011022开始执行2019-03-02数据加载日志:
SQL开始执行时间：20190303011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190303011022
SQL开始执行时间：20190303011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190303011023
SQL开始执行时间：20190303011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190303011023
SQL开始执行时间：20190303011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190303011023
SQL开始执行时间：20190303011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190303011023

20190304011022开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190304011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190304011022
SQL开始执行时间：20190304011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190304011022
SQL开始执行时间：20190304011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190304011022
SQL开始执行时间：20190304011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190304011022
SQL开始执行时间：20190304011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190304011022

20190305011023开始执行2019-03-04数据加载日志:
SQL开始执行时间：20190305011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190305011023
SQL开始执行时间：20190305011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190305011023
SQL开始执行时间：20190305011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190305011023
SQL开始执行时间：20190305011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190305011023
SQL开始执行时间：20190305011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190305011023

20190306011025开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190306011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190306011025
SQL开始执行时间：20190306011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190306011025
SQL开始执行时间：20190306011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190306011025
SQL开始执行时间：20190306011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190306011026
SQL开始执行时间：20190306011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190306011026

20190307011023开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190307011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190307011023
SQL开始执行时间：20190307011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190307011023
SQL开始执行时间：20190307011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190307011023
SQL开始执行时间：20190307011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190307011023
SQL开始执行时间：20190307011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190307011023

20190308011025开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190308011025
SQL开始执行时间：20190308011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190308011026
SQL开始执行时间：20190308011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190308011026
SQL开始执行时间：20190308011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190308011026
SQL开始执行时间：20190308011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190308011026

20190309011023开始执行2019-03-08数据加载日志:
SQL开始执行时间：20190309011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190309011023
SQL开始执行时间：20190309011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190309011023
SQL开始执行时间：20190309011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190309011023
SQL开始执行时间：20190309011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190309011023
SQL开始执行时间：20190309011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190309011023

20190310011022开始执行2019-03-09数据加载日志:
SQL开始执行时间：20190310011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190310011022
SQL开始执行时间：20190310011022



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190310011022
SQL开始执行时间：20190310011022


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190310011022
SQL开始执行时间：20190310011022

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190310011022
SQL开始执行时间：20190310011022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190310011022

20190311011023开始执行2019-03-10数据加载日志:
SQL开始执行时间：20190311011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190311011023
SQL开始执行时间：20190311011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190311011023
SQL开始执行时间：20190311011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190311011023
SQL开始执行时间：20190311011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190311011023
SQL开始执行时间：20190311011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190311011023

20190312011023开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190312011023
SQL开始执行时间：20190312011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190312011024
SQL开始执行时间：20190312011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190312011024
SQL开始执行时间：20190312011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190312011024
SQL开始执行时间：20190312011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190312011024

20190313011023开始执行2019-03-12数据加载日志:
SQL开始执行时间：20190313011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190313011023
SQL开始执行时间：20190313011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190313011023
SQL开始执行时间：20190313011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190313011023
SQL开始执行时间：20190313011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190313011023
SQL开始执行时间：20190313011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190313011023

20190314011023开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314011023
SQL开始执行时间：20190314011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190314011023
SQL开始执行时间：20190314011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314011023
SQL开始执行时间：20190314011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190314011023
SQL开始执行时间：20190314011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190314011024

20190315011023开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315011023


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190315011023
SQL开始执行时间：20190315011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190315011023
SQL开始执行时间：20190315011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190315011023
SQL开始执行时间：20190315011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190315011024
SQL开始执行时间：20190315011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190315011024

20190316011024开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190316011024
SQL开始执行时间：20190316011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190316011024
SQL开始执行时间：20190316011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190316011024
SQL开始执行时间：20190316011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190316011024
SQL开始执行时间：20190316011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190316011024

20190317011025开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190317011025
SQL开始执行时间：20190317011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190317011025
SQL开始执行时间：20190317011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190317011025
SQL开始执行时间：20190317011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190317011025
SQL开始执行时间：20190317011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190317011025

20190318011022开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318011022


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190318011023
SQL开始执行时间：20190318011023



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190318011023
SQL开始执行时间：20190318011023


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190318011023
SQL开始执行时间：20190318011023

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190318011023
SQL开始执行时间：20190318011023

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190318011023

20190319011025开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190319011025
SQL开始执行时间：20190319011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190319011026
SQL开始执行时间：20190319011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190319011026
SQL开始执行时间：20190319011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190319011026
SQL开始执行时间：20190319011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190319011026

20190320011026开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190320011026
SQL开始执行时间：20190320011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190320011027
SQL开始执行时间：20190320011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190320011027
SQL开始执行时间：20190320011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190320011027
SQL开始执行时间：20190320011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190320011027

20190321011025开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190321011025
SQL开始执行时间：20190321011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190321011025
SQL开始执行时间：20190321011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190321011025
SQL开始执行时间：20190321011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190321011025
SQL开始执行时间：20190321011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190321011025

20190322011025开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190322011025
SQL开始执行时间：20190322011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190322011025
SQL开始执行时间：20190322011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190322011025
SQL开始执行时间：20190322011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190322011025
SQL开始执行时间：20190322011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190322011025

20190323011025开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190323011025
SQL开始执行时间：20190323011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190323011025
SQL开始执行时间：20190323011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190323011025
SQL开始执行时间：20190323011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190323011025
SQL开始执行时间：20190323011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20190325155607开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325155607


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190325155607
SQL开始执行时间：20190325155607



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190325155608
SQL开始执行时间：20190325155608


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190325155608
SQL开始执行时间：20190325155608

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190325155608
SQL开始执行时间：20190325155608

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190325155608

20190326011028开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190326011028
SQL开始执行时间：20190326011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190326011028
SQL开始执行时间：20190326011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190326011028
SQL开始执行时间：20190326011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190326011028
SQL开始执行时间：20190326011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190326011028

20190327011025开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190327011025
SQL开始执行时间：20190327011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190327011026
SQL开始执行时间：20190327011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190327011026
SQL开始执行时间：20190327011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190327011026
SQL开始执行时间：20190327011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190327011026

20190328011027开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190328011027
SQL开始执行时间：20190328011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190328011028
SQL开始执行时间：20190328011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190328011028
SQL开始执行时间：20190328011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190328011028
SQL开始执行时间：20190328011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190328011028

20190329011028开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190329011028
SQL开始执行时间：20190329011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190329011028
SQL开始执行时间：20190329011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190329011028
SQL开始执行时间：20190329011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190329011028
SQL开始执行时间：20190329011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190329011028

20190330011026开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190330011026
SQL开始执行时间：20190330011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190330011026
SQL开始执行时间：20190330011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190330011026
SQL开始执行时间：20190330011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190330011026
SQL开始执行时间：20190330011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190330011026

20190331011027开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190331011027
SQL开始执行时间：20190331011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190331011027
SQL开始执行时间：20190331011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190331011027
SQL开始执行时间：20190331011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190331011027
SQL开始执行时间：20190331011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190331011027

20190401011027开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190401011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190401011027
SQL开始执行时间：20190401011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190401011028
SQL开始执行时间：20190401011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190401011028
SQL开始执行时间：20190401011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190401011028
SQL开始执行时间：20190401011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190401011028

20190402011025开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190402011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190402011025
SQL开始执行时间：20190402011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190402011026
SQL开始执行时间：20190402011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190402011026
SQL开始执行时间：20190402011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190402011026
SQL开始执行时间：20190402011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190402011026

20190403011026开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190403011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190403011026
SQL开始执行时间：20190403011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190403011027
SQL开始执行时间：20190403011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190403011027
SQL开始执行时间：20190403011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190403011027
SQL开始执行时间：20190403011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190403011027

20190404011025开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404011025
SQL开始执行时间：20190404011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190404011025
SQL开始执行时间：20190404011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404011025
SQL开始执行时间：20190404011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190404011026
SQL开始执行时间：20190404011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190404011026

20190405011028开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190405011028
SQL开始执行时间：20190405011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190405011028
SQL开始执行时间：20190405011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190405011028
SQL开始执行时间：20190405011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190405011028
SQL开始执行时间：20190405011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190405011028

20190406011028开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190406011028
SQL开始执行时间：20190406011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190406011028
SQL开始执行时间：20190406011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190406011028
SQL开始执行时间：20190406011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190406011028
SQL开始执行时间：20190406011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190406011028

20190407011027开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190407011027
SQL开始执行时间：20190407011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190407011027
SQL开始执行时间：20190407011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190407011027
SQL开始执行时间：20190407011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190407011027
SQL开始执行时间：20190407011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190407011027

20190408011025开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190408011025
SQL开始执行时间：20190408011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190408011025
SQL开始执行时间：20190408011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190408011025
SQL开始执行时间：20190408011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190408011025
SQL开始执行时间：20190408011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190408011025

20190409011026开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190409011027
SQL开始执行时间：20190409011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190409011027
SQL开始执行时间：20190409011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190409011027
SQL开始执行时间：20190409011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190409011027
SQL开始执行时间：20190409011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190409011027

20190410011026开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190410011026
SQL开始执行时间：20190410011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190410011026
SQL开始执行时间：20190410011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190410011026
SQL开始执行时间：20190410011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190410011027
SQL开始执行时间：20190410011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190410011027

20190411011028开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190411011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190411011028
SQL开始执行时间：20190411011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190411011028
SQL开始执行时间：20190411011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190411011028
SQL开始执行时间：20190411011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190411011028
SQL开始执行时间：20190411011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190411011028

20190412011027开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412011027
SQL开始执行时间：20190412011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190412011027
SQL开始执行时间：20190412011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412011027
SQL开始执行时间：20190412011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190412011027
SQL开始执行时间：20190412011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190412011027

20190413011028开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190413011028
SQL开始执行时间：20190413011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190413011028
SQL开始执行时间：20190413011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190413011028
SQL开始执行时间：20190413011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190413011028
SQL开始执行时间：20190413011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190413011028

20190414011028开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190414011028
SQL开始执行时间：20190414011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190414011028
SQL开始执行时间：20190414011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190414011028
SQL开始执行时间：20190414011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190414011028
SQL开始执行时间：20190414011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190414011028

20190415011028开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190415011028
SQL开始执行时间：20190415011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190415011028
SQL开始执行时间：20190415011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190415011028
SQL开始执行时间：20190415011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190415011028
SQL开始执行时间：20190415011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190415011028

20190416011028开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190416011028
SQL开始执行时间：20190416011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190416011028
SQL开始执行时间：20190416011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190416011028
SQL开始执行时间：20190416011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190416011029
SQL开始执行时间：20190416011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190416011029

20190417011028开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190417011028
SQL开始执行时间：20190417011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190417011028
SQL开始执行时间：20190417011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190417011028
SQL开始执行时间：20190417011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190417011028
SQL开始执行时间：20190417011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190417011028

20190418011025开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190418011025
SQL开始执行时间：20190418011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190418011025
SQL开始执行时间：20190418011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190418011025
SQL开始执行时间：20190418011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190418011025
SQL开始执行时间：20190418011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190418011025

20190419011028开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190419011028
SQL开始执行时间：20190419011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190419011028
SQL开始执行时间：20190419011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190419011028
SQL开始执行时间：20190419011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190419011028
SQL开始执行时间：20190419011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190419011028

20190420011025开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190420011025
SQL开始执行时间：20190420011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190420011025
SQL开始执行时间：20190420011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190420011025
SQL开始执行时间：20190420011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190420011026
SQL开始执行时间：20190420011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190420011026

20190421011024开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421011024


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190421011024
SQL开始执行时间：20190421011024



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190421011024
SQL开始执行时间：20190421011024


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190421011024
SQL开始执行时间：20190421011024

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190421011024
SQL开始执行时间：20190421011024

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190421011024

20190422011037开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190422011037
SQL开始执行时间：20190422011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190422011037
SQL开始执行时间：20190422011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190422011037
SQL开始执行时间：20190422011037

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190422011037
SQL开始执行时间：20190422011037

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190422011037

20190423011025开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190423011025
SQL开始执行时间：20190423011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190423011025
SQL开始执行时间：20190423011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190423011025
SQL开始执行时间：20190423011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190423011026
SQL开始执行时间：20190423011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190423011026

20190424011025开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190424011025
SQL开始执行时间：20190424011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190424011025
SQL开始执行时间：20190424011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190424011025
SQL开始执行时间：20190424011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190424011025
SQL开始执行时间：20190424011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190424011025

20190425011025开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190425011026
SQL开始执行时间：20190425011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190425011026
SQL开始执行时间：20190425011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190425011026
SQL开始执行时间：20190425011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190425011026
SQL开始执行时间：20190425011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190425011026

20190426011025开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190426011025
SQL开始执行时间：20190426011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190426011026
SQL开始执行时间：20190426011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190426011026
SQL开始执行时间：20190426011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190426011026
SQL开始执行时间：20190426011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190426011026

20190427011027开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190427011027
SQL开始执行时间：20190427011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190427011028
SQL开始执行时间：20190427011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190427011028
SQL开始执行时间：20190427011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190427011028
SQL开始执行时间：20190427011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190427011028

20190428011025开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190428011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190428011025
SQL开始执行时间：20190428011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190428011025
SQL开始执行时间：20190428011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190428011025
SQL开始执行时间：20190428011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190428011025
SQL开始执行时间：20190428011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190428011025

20190429011026开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429011026
SQL开始执行时间：20190429011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190429011026
SQL开始执行时间：20190429011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429011026
SQL开始执行时间：20190429011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190429011027
SQL开始执行时间：20190429011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190429011027

20190430011026开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190430011026
SQL开始执行时间：20190430011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190430011026
SQL开始执行时间：20190430011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190430011026
SQL开始执行时间：20190430011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190430011026
SQL开始执行时间：20190430011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190430011026

20190501011026开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501011026


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190501011026
SQL开始执行时间：20190501011026



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190501011026
SQL开始执行时间：20190501011026


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190501011026
SQL开始执行时间：20190501011026

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190501011026
SQL开始执行时间：20190501011026

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190501011026

20190502011025开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502011025


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190502011025
SQL开始执行时间：20190502011025



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190502011025
SQL开始执行时间：20190502011025


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190502011025
SQL开始执行时间：20190502011025

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190502011025
SQL开始执行时间：20190502011025

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190502011025

20190503011027开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190503011027
SQL开始执行时间：20190503011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190503011027
SQL开始执行时间：20190503011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190503011027
SQL开始执行时间：20190503011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190503011027
SQL开始执行时间：20190503011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190503011027

20190504011027开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190504011027
SQL开始执行时间：20190504011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190504011028
SQL开始执行时间：20190504011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190504011028
SQL开始执行时间：20190504011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190504011028
SQL开始执行时间：20190504011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190504011028

20190505011027开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190505011027
SQL开始执行时间：20190505011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190505011027
SQL开始执行时间：20190505011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190505011027
SQL开始执行时间：20190505011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190505011027
SQL开始执行时间：20190505011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190505011027

20190506011028开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506011028
SQL开始执行时间：20190506011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506011028
SQL开始执行时间：20190506011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506011028
SQL开始执行时间：20190506011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190506011028
SQL开始执行时间：20190506011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190506011028

20190507011027开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190507011027
SQL开始执行时间：20190507011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190507011028
SQL开始执行时间：20190507011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190507011028
SQL开始执行时间：20190507011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190507011028
SQL开始执行时间：20190507011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190507011028

20190508011027开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190508011027
SQL开始执行时间：20190508011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190508011028
SQL开始执行时间：20190508011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190508011028
SQL开始执行时间：20190508011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190508011028
SQL开始执行时间：20190508011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190508011028

20190509175837开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190509175837


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190509175837
SQL开始执行时间：20190509175837



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190509175837
SQL开始执行时间：20190509175837


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190509175837
SQL开始执行时间：20190509175837

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190509175838
SQL开始执行时间：20190509175838

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190509175838

20190510011029开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510011029


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190510011029
SQL开始执行时间：20190510011029



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190510011030
SQL开始执行时间：20190510011030


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190510011030
SQL开始执行时间：20190510011030

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190510011030
SQL开始执行时间：20190510011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190510011030

20190511011027开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190511011027
SQL开始执行时间：20190511011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190511011027
SQL开始执行时间：20190511011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190511011027
SQL开始执行时间：20190511011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190511011027
SQL开始执行时间：20190511011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190511011027

20190512011029开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512011029


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190512011029
SQL开始执行时间：20190512011029



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190512011029
SQL开始执行时间：20190512011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190512011029
SQL开始执行时间：20190512011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190512011029
SQL开始执行时间：20190512011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190512011029

20190513011028开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190513011028
SQL开始执行时间：20190513011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190513011029
SQL开始执行时间：20190513011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190513011029
SQL开始执行时间：20190513011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190513011029
SQL开始执行时间：20190513011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190513011029

20190514011028开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190514011028
SQL开始执行时间：20190514011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190514011028
SQL开始执行时间：20190514011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190514011028
SQL开始执行时间：20190514011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190514011028
SQL开始执行时间：20190514011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190514011028

20190515011027开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190515011027
SQL开始执行时间：20190515011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190515011028
SQL开始执行时间：20190515011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190515011028
SQL开始执行时间：20190515011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190515011028
SQL开始执行时间：20190515011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190515011028

20190516011027开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190516011027
SQL开始执行时间：20190516011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190516011027
SQL开始执行时间：20190516011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190516011027
SQL开始执行时间：20190516011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190516011028
SQL开始执行时间：20190516011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190516011028

20190517011028开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517011028
SQL开始执行时间：20190517011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190517011028
SQL开始执行时间：20190517011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517011028
SQL开始执行时间：20190517011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190517011029
SQL开始执行时间：20190517011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190517011029

20190518011028开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190518011028
SQL开始执行时间：20190518011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190518011029
SQL开始执行时间：20190518011029


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190518011029
SQL开始执行时间：20190518011029

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190518011029
SQL开始执行时间：20190518011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190518011029

20190519011030开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190519011030
SQL开始执行时间：20190519011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190519011030
SQL开始执行时间：20190519011030


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190519011030
SQL开始执行时间：20190519011030

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190519011030
SQL开始执行时间：20190519011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190519011030

20190520011029开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520011029


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190520011029
SQL开始执行时间：20190520011029



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190520011030
SQL开始执行时间：20190520011030


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190520011030
SQL开始执行时间：20190520011030

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190520011030
SQL开始执行时间：20190520011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190520011030

20190521011028开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190521011028
SQL开始执行时间：20190521011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190521011028
SQL开始执行时间：20190521011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190521011028
SQL开始执行时间：20190521011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190521011028
SQL开始执行时间：20190521011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190521011028

20190522011030开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190522011030
SQL开始执行时间：20190522011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190522011030
SQL开始执行时间：20190522011030


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190522011030
SQL开始执行时间：20190522011030

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190522011030
SQL开始执行时间：20190522011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190522011030

20190523011027开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190523011027
SQL开始执行时间：20190523011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190523011027
SQL开始执行时间：20190523011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190523011027
SQL开始执行时间：20190523011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190523011027
SQL开始执行时间：20190523011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190523011027

20190524011030开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524011030
SQL开始执行时间：20190524011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524011030
SQL开始执行时间：20190524011030


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524011030
SQL开始执行时间：20190524011030

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190524011031
SQL开始执行时间：20190524011031

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190524011031

20190525011027开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190525011027
SQL开始执行时间：20190525011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190525011028
SQL开始执行时间：20190525011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190525011028
SQL开始执行时间：20190525011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190525011028
SQL开始执行时间：20190525011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190525011028

20190526011030开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190526011030
SQL开始执行时间：20190526011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190526011030
SQL开始执行时间：20190526011030


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190526011030
SQL开始执行时间：20190526011030

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190526011030
SQL开始执行时间：20190526011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190526011030

20190527011039开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190527011039
SQL开始执行时间：20190527011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190527011039
SQL开始执行时间：20190527011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190527011039
SQL开始执行时间：20190527011039

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190527011039
SQL开始执行时间：20190527011039

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190527011039

20190528011027开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190528011027
SQL开始执行时间：20190528011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190528011028
SQL开始执行时间：20190528011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190528011028
SQL开始执行时间：20190528011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190528011028
SQL开始执行时间：20190528011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190528011028

20190529011031开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529011031


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190529011031
SQL开始执行时间：20190529011031



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190529011032
SQL开始执行时间：20190529011032


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529011032
SQL开始执行时间：20190529011032

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190529011032
SQL开始执行时间：20190529011032

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190529011032

20190530011030开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190530011030
SQL开始执行时间：20190530011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190530011031
SQL开始执行时间：20190530011031


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190530011031
SQL开始执行时间：20190530011031

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190530011031
SQL开始执行时间：20190530011031

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190530011031

20190531011031开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531011031


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190531011031
SQL开始执行时间：20190531011031



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190531011031
SQL开始执行时间：20190531011031


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190531011031
SQL开始执行时间：20190531011031

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190531011032
SQL开始执行时间：20190531011032

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190531011032

20190601011030开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190601011030
SQL开始执行时间：20190601011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190601011031
SQL开始执行时间：20190601011031


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190601011031
SQL开始执行时间：20190601011031

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190601011031
SQL开始执行时间：20190601011031

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190601011031

20190602011027开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190602011027
SQL开始执行时间：20190602011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190602011027
SQL开始执行时间：20190602011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190602011027
SQL开始执行时间：20190602011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190602011027
SQL开始执行时间：20190602011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190602011027

20190603011027开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190603011027
SQL开始执行时间：20190603011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190603011027
SQL开始执行时间：20190603011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190603011027
SQL开始执行时间：20190603011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190603011027
SQL开始执行时间：20190603011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190603011027

20190604011027开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190604011027
SQL开始执行时间：20190604011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190604011027
SQL开始执行时间：20190604011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190604011027
SQL开始执行时间：20190604011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190604011027
SQL开始执行时间：20190604011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190604011028

20190605011031开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605011031


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190605011031
SQL开始执行时间：20190605011031



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190605011031
SQL开始执行时间：20190605011031


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605011031
SQL开始执行时间：20190605011031

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190605011031
SQL开始执行时间：20190605011031

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190605011032

20190606011028开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190606011028
SQL开始执行时间：20190606011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190606011028
SQL开始执行时间：20190606011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190606011028
SQL开始执行时间：20190606011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190606011029
SQL开始执行时间：20190606011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190606011029

20190607011030开始执行2019-06-06数据加载日志:
SQL开始执行时间：20190607011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190607011030
SQL开始执行时间：20190607011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190607011031
SQL开始执行时间：20190607011031


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190607011031
SQL开始执行时间：20190607011031

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190607011031
SQL开始执行时间：20190607011031

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190607011031

20190608011027开始执行2019-06-07数据加载日志:
SQL开始执行时间：20190608011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190608011027
SQL开始执行时间：20190608011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190608011027
SQL开始执行时间：20190608011027


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190608011027
SQL开始执行时间：20190608011027

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190608011027
SQL开始执行时间：20190608011027

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190608011027

20190609011042开始执行2019-06-08数据加载日志:
SQL开始执行时间：20190609011042


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190609011042
SQL开始执行时间：20190609011042



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190609011042
SQL开始执行时间：20190609011042


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190609011042
SQL开始执行时间：20190609011042

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190609011042
SQL开始执行时间：20190609011042

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190609011042

20190610011037开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190610011037
SQL开始执行时间：20190610011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190610011037
SQL开始执行时间：20190610011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610011037
SQL开始执行时间：20190610011037

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190610011037
SQL开始执行时间：20190610011037

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190610011037

20190611011027开始执行2019-06-10数据加载日志:
SQL开始执行时间：20190611011027


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190611011027
SQL开始执行时间：20190611011027



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190611011028
SQL开始执行时间：20190611011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190611011028
SQL开始执行时间：20190611011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190611011028
SQL开始执行时间：20190611011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190611011028

20190612011028开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190612011028
SQL开始执行时间：20190612011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190612011028
SQL开始执行时间：20190612011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190612011028
SQL开始执行时间：20190612011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190612011028
SQL开始执行时间：20190612011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190612011029

20190613011041开始执行2019-06-12数据加载日志:
SQL开始执行时间：20190613011041


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190613011041
SQL开始执行时间：20190613011041



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190613011041
SQL开始执行时间：20190613011041


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190613011041
SQL开始执行时间：20190613011041

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190613011041
SQL开始执行时间：20190613011041

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190613011041

20190614011028开始执行2019-06-13数据加载日志:
SQL开始执行时间：20190614011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190614011028
SQL开始执行时间：20190614011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190614011028
SQL开始执行时间：20190614011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190614011028
SQL开始执行时间：20190614011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190614011029
SQL开始执行时间：20190614011029

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190614011029

20190615011031开始执行2019-06-14数据加载日志:
SQL开始执行时间：20190615011031


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190615011031
SQL开始执行时间：20190615011031



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190615011032
SQL开始执行时间：20190615011032


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190615011032
SQL开始执行时间：20190615011032

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190615011032
SQL开始执行时间：20190615011032

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190615011032

20190616011028开始执行2019-06-15数据加载日志:
SQL开始执行时间：20190616011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190616011028
SQL开始执行时间：20190616011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190616011028
SQL开始执行时间：20190616011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190616011028
SQL开始执行时间：20190616011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190616011028
SQL开始执行时间：20190616011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190616011028

20190617011030开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190617011030
SQL开始执行时间：20190617011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190617011030
SQL开始执行时间：20190617011030


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190617011030
SQL开始执行时间：20190617011030

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190617011030
SQL开始执行时间：20190617011030

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190617011030

20190618011032开始执行2019-06-17数据加载日志:
SQL开始执行时间：20190618011032


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190618011032
SQL开始执行时间：20190618011032



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190618011032
SQL开始执行时间：20190618011032


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190618011032
SQL开始执行时间：20190618011032

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190618011033
SQL开始执行时间：20190618011033

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190618011033

20190619011032开始执行2019-06-18数据加载日志:
SQL开始执行时间：20190619011032


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190619011032
SQL开始执行时间：20190619011032



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190619011032
SQL开始执行时间：20190619011032


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190619011032
SQL开始执行时间：20190619011032

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190619011033
SQL开始执行时间：20190619011033

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190619011033

20190620011032开始执行2019-06-19数据加载日志:
SQL开始执行时间：20190620011032


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190620011032
SQL开始执行时间：20190620011032



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190620011032
SQL开始执行时间：20190620011032


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190620011032
SQL开始执行时间：20190620011032

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190620011032
SQL开始执行时间：20190620011032

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190620011033

20190621011030开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190621011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190621011030
SQL开始执行时间：20190621011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190621011031
SQL开始执行时间：20190621011031


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190621011031
SQL开始执行时间：20190621011031

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190621011031
SQL开始执行时间：20190621011031

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190621011031

20190622011033开始执行2019-06-21数据加载日志:
SQL开始执行时间：20190622011033


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190622011033
SQL开始执行时间：20190622011033



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190622011033
SQL开始执行时间：20190622011033


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190622011033
SQL开始执行时间：20190622011033

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190622011034
SQL开始执行时间：20190622011034

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190622011034

20190623011028开始执行2019-06-22数据加载日志:
SQL开始执行时间：20190623011028


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190623011028
SQL开始执行时间：20190623011028



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190623011028
SQL开始执行时间：20190623011028


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190623011028
SQL开始执行时间：20190623011028

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190623011028
SQL开始执行时间：20190623011028

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190623011028

20190624011046开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624011046


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190624011046
SQL开始执行时间：20190624011046



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190624011046
SQL开始执行时间：20190624011046


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624011046
SQL开始执行时间：20190624011046

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190624011046
SQL开始执行时间：20190624011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190624011046

20190625011032开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190625011032


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190625011032
SQL开始执行时间：20190625011032



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190625011033
SQL开始执行时间：20190625011033


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190625011033
SQL开始执行时间：20190625011033

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190625011033
SQL开始执行时间：20190625011033

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190625011033

20190626011030开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190626011030


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190626011030
SQL开始执行时间：20190626011030



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190626011031
SQL开始执行时间：20190626011031


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190626011031
SQL开始执行时间：20190626011031

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190626011031
SQL开始执行时间：20190626011031

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190626011031

20190627011032开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627011032


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190627011032
SQL开始执行时间：20190627011032



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190627011032
SQL开始执行时间：20190627011032


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190627011032
SQL开始执行时间：20190627011032

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190627011033
SQL开始执行时间：20190627011033

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190627011033

20190628011036开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190628011036
SQL开始执行时间：20190628011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190628011036
SQL开始执行时间：20190628011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628011036
SQL开始执行时间：20190628011036

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190628011037
SQL开始执行时间：20190628011037

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190628011037

20190628133657开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628133657


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190628133658
SQL开始执行时间：20190628133658



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190628133658
SQL开始执行时间：20190628133658


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628133658
SQL开始执行时间：20190628133658

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190628133826
SQL开始执行时间：20190628133826

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190628133827

20190629011033开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629011033


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190629011033
SQL开始执行时间：20190629011033



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190629011033
SQL开始执行时间：20190629011033


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190629011033
SQL开始执行时间：20190629011033

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190629011036
SQL开始执行时间：20190629011036

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190629011036

20190630011034开始执行2019-06-29数据加载日志:
SQL开始执行时间：20190630011034


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190630011034
SQL开始执行时间：20190630011034



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190630011035
SQL开始执行时间：20190630011035


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190630011035
SQL开始执行时间：20190630011035

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190630011036
SQL开始执行时间：20190630011036

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190630011036

20190701011032开始执行2019-06-30数据加载日志:
SQL开始执行时间：20190701011032


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190701011032
SQL开始执行时间：20190701011032



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190701011033
SQL开始执行时间：20190701011033


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190701011033
SQL开始执行时间：20190701011033

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190701011034
SQL开始执行时间：20190701011034

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190701011034

20190702011036开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-07-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190702011036
SQL开始执行时间：20190702011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190702011036
SQL开始执行时间：20190702011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702011036
SQL开始执行时间：20190702011036

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190702011039
SQL开始执行时间：20190702011039

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190702011039

20190702165129开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702165129


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190702165129
SQL开始执行时间：20190702165129



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190702165129
SQL开始执行时间：20190702165129


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702165129
SQL开始执行时间：20190702165129

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190702165143
SQL开始执行时间：20190702165143

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190702165143

20190703011033开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703011033


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190703011033
SQL开始执行时间：20190703011033



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190703011033
SQL开始执行时间：20190703011033


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190703011033
SQL开始执行时间：20190703011033

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190703011048
SQL开始执行时间：20190703011048

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190703011048

20190703084947开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703084947


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190703084948
SQL开始执行时间：20190703084948



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190703084948
SQL开始执行时间：20190703084948


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190703084948
SQL开始执行时间：20190703084948

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190703085443
SQL开始执行时间：20190703085443

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190703085443

20190704011035开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190704011036
SQL开始执行时间：20190704011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190704011036
SQL开始执行时间：20190704011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704011036
SQL开始执行时间：20190704011036

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190704011336
SQL开始执行时间：20190704011336

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190704011337

20190704102124开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704102124


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190704102125
SQL开始执行时间：20190704102125



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190704102125
SQL开始执行时间：20190704102125


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704102125
SQL开始执行时间：20190704102125

delete from pdm.sales_order where id in (select id from  pdm.sales_order_pre)
;
SQL结束执行时间：20190704102632
SQL开始执行时间：20190704102632

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190704102632

20190704103923开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190704103923


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190704103923
SQL开始执行时间：20190704103923



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190704103924
SQL开始执行时间：20190704103924


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704103924
SQL开始执行时间：20190704103924

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190704104344
SQL开始执行时间：20190704104344

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190704104345

20190705011036开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190705011037
SQL开始执行时间：20190705011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190705011037
SQL开始执行时间：20190705011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190705011037
SQL开始执行时间：20190705011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190705011500
SQL开始执行时间：20190705011500

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190705011501

20190705101514开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190705101514


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190705101514
SQL开始执行时间：20190705101514



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190705101514
SQL开始执行时间：20190705101514


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190705101514
SQL开始执行时间：20190705101514

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190705101519
SQL开始执行时间：20190705101519

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190705101519

20190706011034开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706011034


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190706011034
SQL开始执行时间：20190706011034



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190706011034
SQL开始执行时间：20190706011034


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190706011034
SQL开始执行时间：20190706011034

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190706011042
SQL开始执行时间：20190706011042

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190706011042

20190707011032开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707011032


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190707011032
SQL开始执行时间：20190707011032



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190707011032
SQL开始执行时间：20190707011032


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190707011032
SQL开始执行时间：20190707011032

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190707011037
SQL开始执行时间：20190707011037

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190707011037

20190708011033开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708011033


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190708011033
SQL开始执行时间：20190708011033



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190708011033
SQL开始执行时间：20190708011033


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190708011033
SQL开始执行时间：20190708011033

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190708011036
SQL开始执行时间：20190708011036

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190708011036

20190708091414开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190708091414


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190708091414
SQL开始执行时间：20190708091414



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190708091415
SQL开始执行时间：20190708091415


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190708091415
SQL开始执行时间：20190708091415

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190708091420
SQL开始执行时间：20190708091420

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190708091420

20190709011035开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190709011035
SQL开始执行时间：20190709011035



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190709011035
SQL开始执行时间：20190709011035


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190709011035
SQL开始执行时间：20190709011035

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190709011043
SQL开始执行时间：20190709011043

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190709011043

20190709103444开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190709103444


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190709103444
SQL开始执行时间：20190709103444



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190709103444
SQL开始执行时间：20190709103444


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190709103444
SQL开始执行时间：20190709103444

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190709103449
SQL开始执行时间：20190709103449

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190709103449

20190710011034开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710011034


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190710011034
SQL开始执行时间：20190710011034



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190710011034
SQL开始执行时间：20190710011034


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190710011034
SQL开始执行时间：20190710011034

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190710011040
SQL开始执行时间：20190710011040

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190710011040

20190711011037开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190711011037
SQL开始执行时间：20190711011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190711011037
SQL开始执行时间：20190711011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190711011037
SQL开始执行时间：20190711011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190711011043
SQL开始执行时间：20190711011043

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190711011043

20190711090858开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190711090858


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190711090858
SQL开始执行时间：20190711090858



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190711090858
SQL开始执行时间：20190711090858


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190711090858
SQL开始执行时间：20190711090858

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190711090904
SQL开始执行时间：20190711090904

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190711090904

20190712011038开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190712011038
SQL开始执行时间：20190712011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190712011039
SQL开始执行时间：20190712011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190712011039
SQL开始执行时间：20190712011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190712011046
SQL开始执行时间：20190712011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190712011046

20190713011036开始执行2019-07-12数据加载日志:
SQL开始执行时间：20190713011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190713011036
SQL开始执行时间：20190713011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190713011036
SQL开始执行时间：20190713011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190713011036
SQL开始执行时间：20190713011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190713011042
SQL开始执行时间：20190713011042

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190713011042

20190714011037开始执行2019-07-13数据加载日志:
SQL开始执行时间：20190714011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190714011037
SQL开始执行时间：20190714011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190714011037
SQL开始执行时间：20190714011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190714011037
SQL开始执行时间：20190714011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190714011041
SQL开始执行时间：20190714011041

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190714011041

20190715011036开始执行2019-07-14数据加载日志:
SQL开始执行时间：20190715011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190715011036
SQL开始执行时间：20190715011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190715011036
SQL开始执行时间：20190715011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715011036
SQL开始执行时间：20190715011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190715011039
SQL开始执行时间：20190715011039

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190715011039

20190715131222开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190715131222


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190715131222
SQL开始执行时间：20190715131222



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190715131222
SQL开始执行时间：20190715131222


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715131222
SQL开始执行时间：20190715131222

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190715131229
SQL开始执行时间：20190715131229

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190715131229

20190716011039开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716011039
SQL开始执行时间：20190716011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716011039
SQL开始执行时间：20190716011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716011039
SQL开始执行时间：20190716011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190716011048
SQL开始执行时间：20190716011048

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190716011048

20190716160129开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716160129


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716160129
SQL开始执行时间：20190716160129



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716160130
SQL开始执行时间：20190716160130


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716160130
SQL开始执行时间：20190716160130

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190716160138
SQL开始执行时间：20190716160138

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190716160138

20190716161452开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716161452


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716161452
SQL开始执行时间：20190716161452



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716161452
SQL开始执行时间：20190716161452


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716161452
SQL开始执行时间：20190716161452

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190716161501
SQL开始执行时间：20190716161501

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190716161501

20190716165227开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716165227


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190716165227
SQL开始执行时间：20190716165227



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716165227
SQL开始执行时间：20190716165227


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716165227
SQL开始执行时间：20190716165227

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190716165236
SQL开始执行时间：20190716165236

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190716165236

20190717011036开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190717011036
SQL开始执行时间：20190717011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190717011036
SQL开始执行时间：20190717011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717011036
SQL开始执行时间：20190717011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190717011047
SQL开始执行时间：20190717011047

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190717011047

20190717085450开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190717085450


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190717085450
SQL开始执行时间：20190717085450



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190717085451
SQL开始执行时间：20190717085451


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717085451
SQL开始执行时间：20190717085451

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190717085456
SQL开始执行时间：20190717085456

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190717085456

20190717093217开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190717093217


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190717093217
SQL开始执行时间：20190717093217



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190717093218
SQL开始执行时间：20190717093218


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717093218
SQL开始执行时间：20190717093218

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190717093223
SQL开始执行时间：20190717093223

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190717093223

20190718011036开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190718011036
SQL开始执行时间：20190718011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190718011036
SQL开始执行时间：20190718011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718011036
SQL开始执行时间：20190718011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190718011042
SQL开始执行时间：20190718011042

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190718011042

20190718092838开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190718092838


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190718092838
SQL开始执行时间：20190718092838



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190718092838
SQL开始执行时间：20190718092838


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718092838
SQL开始执行时间：20190718092838

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190718092843
SQL开始执行时间：20190718092843

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190718092843

20190719011035开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190719011035
SQL开始执行时间：20190719011035



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190719011035
SQL开始执行时间：20190719011035


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190719011035
SQL开始执行时间：20190719011035

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190719011042
SQL开始执行时间：20190719011042

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190719011042

20190719090320开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190719090320


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190719090321
SQL开始执行时间：20190719090321



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190719090321
SQL开始执行时间：20190719090321


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190719090321
SQL开始执行时间：20190719090321

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190719090326
SQL开始执行时间：20190719090326

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190719090326

20190720011036开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190720011036
SQL开始执行时间：20190720011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190720011036
SQL开始执行时间：20190720011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190720011036
SQL开始执行时间：20190720011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190720011043
SQL开始执行时间：20190720011043

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190720011043

20190721011036开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190721011036
SQL开始执行时间：20190721011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190721011037
SQL开始执行时间：20190721011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190721011037
SQL开始执行时间：20190721011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190721011042
SQL开始执行时间：20190721011042

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190721011042

20190722011033开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722011033


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190722011033
SQL开始执行时间：20190722011033



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190722011033
SQL开始执行时间：20190722011033


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190722011033
SQL开始执行时间：20190722011033

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190722011036
SQL开始执行时间：20190722011036

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190722011036

20190723011035开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190723011035
SQL开始执行时间：20190723011035



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190723011036
SQL开始执行时间：20190723011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190723011036
SQL开始执行时间：20190723011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190723011041
SQL开始执行时间：20190723011041

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190723011041

20190723164707开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190723164707


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190723164708
SQL开始执行时间：20190723164708



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190723164708
SQL开始执行时间：20190723164708


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190723164708
SQL开始执行时间：20190723164708

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190723164743
SQL开始执行时间：20190723164743

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190723164743

20190724011035开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190724011036
SQL开始执行时间：20190724011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190724011036
SQL开始执行时间：20190724011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190724011036
SQL开始执行时间：20190724011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190724011112
SQL开始执行时间：20190724011112

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190724011112

20190725011037开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190725011038
SQL开始执行时间：20190725011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190725011038
SQL开始执行时间：20190725011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190725011038
SQL开始执行时间：20190725011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190725011517
SQL开始执行时间：20190725011517

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190725011517

20190725133454开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190725133454


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190725133454
SQL开始执行时间：20190725133454



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190725133455
SQL开始执行时间：20190725133455


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190725133455
SQL开始执行时间：20190725133455

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190725133500
SQL开始执行时间：20190725133500

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190725133500

20190726011035开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726011035
SQL开始执行时间：20190726011035



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726011035
SQL开始执行时间：20190726011035


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726011035
SQL开始执行时间：20190726011035

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190726011042
SQL开始执行时间：20190726011042

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190726011042

20190726085559开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726085559


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190726085559
SQL开始执行时间：20190726085559



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726085600
SQL开始执行时间：20190726085600


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726085600
SQL开始执行时间：20190726085600

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190726085605
SQL开始执行时间：20190726085605

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190726085605

20190727011040开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727011040


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190727011040
SQL开始执行时间：20190727011040



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190727011040
SQL开始执行时间：20190727011040


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190727011040
SQL开始执行时间：20190727011040

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190727011047
SQL开始执行时间：20190727011047

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190727011047

20190728011035开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190728011035
SQL开始执行时间：20190728011035



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190728011036
SQL开始执行时间：20190728011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190728011036
SQL开始执行时间：20190728011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190728011040
SQL开始执行时间：20190728011040

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190728011040

20190729011036开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190729011036
SQL开始执行时间：20190729011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190729011036
SQL开始执行时间：20190729011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729011036
SQL开始执行时间：20190729011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190729011039
SQL开始执行时间：20190729011039

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190729011039

20190729111042开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190729111042


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190729111043
SQL开始执行时间：20190729111043



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190729111043
SQL开始执行时间：20190729111043


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729111043
SQL开始执行时间：20190729111043

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190729111049
SQL开始执行时间：20190729111049

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190729111049

20190730011037开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190730011037
SQL开始执行时间：20190730011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190730011037
SQL开始执行时间：20190730011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730011037
SQL开始执行时间：20190730011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190730011046
SQL开始执行时间：20190730011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190730011046

20190731011039开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190731011039
SQL开始执行时间：20190731011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190731011039
SQL开始执行时间：20190731011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731011039
SQL开始执行时间：20190731011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190731011046
SQL开始执行时间：20190731011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190731011046

20190731103341开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190731103341


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190731103341
SQL开始执行时间：20190731103341



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190731103341
SQL开始执行时间：20190731103341


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731103341
SQL开始执行时间：20190731103341

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190731103348
SQL开始执行时间：20190731103348

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190731103348

20190801011040开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801011040


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190801011040
SQL开始执行时间：20190801011040



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190801011040
SQL开始执行时间：20190801011040


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190801011040
SQL开始执行时间：20190801011040

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190801011049
SQL开始执行时间：20190801011049

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190801011049

20190802011036开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190802011036
SQL开始执行时间：20190802011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190802011037
SQL开始执行时间：20190802011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190802011037
SQL开始执行时间：20190802011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190802011044
SQL开始执行时间：20190802011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190802011044

20190803011037开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190803011037
SQL开始执行时间：20190803011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190803011037
SQL开始执行时间：20190803011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190803011037
SQL开始执行时间：20190803011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190803011044
SQL开始执行时间：20190803011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190803011044

20190804011035开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190804011036
SQL开始执行时间：20190804011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190804011036
SQL开始执行时间：20190804011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190804011036
SQL开始执行时间：20190804011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190804011041
SQL开始执行时间：20190804011041

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190804011041

20190805011034开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805011034


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190805011035
SQL开始执行时间：20190805011035



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190805011035
SQL开始执行时间：20190805011035


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190805011035
SQL开始执行时间：20190805011035

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190805011038
SQL开始执行时间：20190805011038

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190805011038

20190805132322开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190805132322


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190805132322
SQL开始执行时间：20190805132322



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190805132322
SQL开始执行时间：20190805132322


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190805132322
SQL开始执行时间：20190805132322

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190805132331
SQL开始执行时间：20190805132331

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190805132331

20190806011040开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806011040


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190806011040
SQL开始执行时间：20190806011040



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190806011040
SQL开始执行时间：20190806011040


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190806011040
SQL开始执行时间：20190806011040

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190806011051
SQL开始执行时间：20190806011051

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190806011051

20190806093417开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190806093417


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190806093417
SQL开始执行时间：20190806093417



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190806093417
SQL开始执行时间：20190806093417


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190806093417
SQL开始执行时间：20190806093417

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190806093423
SQL开始执行时间：20190806093423

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190806093423

20190807011036开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190807011036
SQL开始执行时间：20190807011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190807011036
SQL开始执行时间：20190807011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190807011036
SQL开始执行时间：20190807011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190807011044
SQL开始执行时间：20190807011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190807011044

20190807153617开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190807153617


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190807153617
SQL开始执行时间：20190807153617



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190807153618
SQL开始执行时间：20190807153618


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190807153618
SQL开始执行时间：20190807153618

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190807153625
SQL开始执行时间：20190807153625

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190807153625

20190808011036开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190808011036
SQL开始执行时间：20190808011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190808011037
SQL开始执行时间：20190808011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190808011037
SQL开始执行时间：20190808011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190808011046
SQL开始执行时间：20190808011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190808011046

20190809011036开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190809011036
SQL开始执行时间：20190809011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190809011036
SQL开始执行时间：20190809011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809011036
SQL开始执行时间：20190809011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190809011042
SQL开始执行时间：20190809011042

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190809011043

20190810011041开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810011041


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190810011041
SQL开始执行时间：20190810011041



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190810011041
SQL开始执行时间：20190810011041


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190810011041
SQL开始执行时间：20190810011041

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190810011048
SQL开始执行时间：20190810011048

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190810011048

20190811011039开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190811011039
SQL开始执行时间：20190811011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190811011039
SQL开始执行时间：20190811011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190811011039
SQL开始执行时间：20190811011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190811011044
SQL开始执行时间：20190811011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190811011045

20190812011035开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190812011035
SQL开始执行时间：20190812011035



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190812011035
SQL开始执行时间：20190812011035


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190812011035
SQL开始执行时间：20190812011035

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190812011039
SQL开始执行时间：20190812011039

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190812011039

20190813011039开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190813011039
SQL开始执行时间：20190813011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190813011040
SQL开始执行时间：20190813011040


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813011040
SQL开始执行时间：20190813011040

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190813011046
SQL开始执行时间：20190813011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190813011046

20190813111515开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190813111515


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190813111515
SQL开始执行时间：20190813111515



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190813111515
SQL开始执行时间：20190813111515


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813111515
SQL开始执行时间：20190813111515

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190813111522
SQL开始执行时间：20190813111522

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190813111522

20190814011035开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814011035


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190814011035
SQL开始执行时间：20190814011035



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190814011036
SQL开始执行时间：20190814011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814011036
SQL开始执行时间：20190814011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190814011043
SQL开始执行时间：20190814011043

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190814011043

20190815011038开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190815011038
SQL开始执行时间：20190815011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190815011038
SQL开始执行时间：20190815011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190815011038
SQL开始执行时间：20190815011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190815011044
SQL开始执行时间：20190815011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190815011045

20190816011037开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190816011037
SQL开始执行时间：20190816011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190816011038
SQL开始执行时间：20190816011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190816011038
SQL开始执行时间：20190816011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190816011044
SQL开始执行时间：20190816011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190816011044

20190817011039开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190817011039
SQL开始执行时间：20190817011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190817011039
SQL开始执行时间：20190817011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190817011039
SQL开始执行时间：20190817011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190817011047
SQL开始执行时间：20190817011047

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190817011047

20190818011038开始执行2019-08-17数据加载日志:
SQL开始执行时间：20190818011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190818011038
SQL开始执行时间：20190818011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190818011038
SQL开始执行时间：20190818011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190818011038
SQL开始执行时间：20190818011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190818011044
SQL开始执行时间：20190818011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190818011044

20190819011036开始执行2019-08-18数据加载日志:
SQL开始执行时间：20190819011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190819011036
SQL开始执行时间：20190819011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190819011036
SQL开始执行时间：20190819011036


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190819011036
SQL开始执行时间：20190819011036

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190819011039
SQL开始执行时间：20190819011039

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190819011039

20190819142602开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190819142602


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190819142602
SQL开始执行时间：20190819142602



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190819142602
SQL开始执行时间：20190819142602


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190819142602
SQL开始执行时间：20190819142602

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190819142611
SQL开始执行时间：20190819142611

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190819142611

20190820011038开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190820011038
SQL开始执行时间：20190820011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190820011038
SQL开始执行时间：20190820011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190820011038
SQL开始执行时间：20190820011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190820011049
SQL开始执行时间：20190820011049

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190820011049

20190821011037开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821011037


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190821011037
SQL开始执行时间：20190821011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190821011038
SQL开始执行时间：20190821011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190821011038
SQL开始执行时间：20190821011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190821011045
SQL开始执行时间：20190821011045

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190821011045

20190821100453开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190821100453


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190821100453
SQL开始执行时间：20190821100453



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190821100453
SQL开始执行时间：20190821100453


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190821100453
SQL开始执行时间：20190821100453

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190821100500
SQL开始执行时间：20190821100500

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190821100501

20190822011038开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190822011038
SQL开始执行时间：20190822011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190822011038
SQL开始执行时间：20190822011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190822011038
SQL开始执行时间：20190822011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190822011046
SQL开始执行时间：20190822011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190822011047

20190822091144开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190822091144


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190822091144
SQL开始执行时间：20190822091144



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190822091145
SQL开始执行时间：20190822091145


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190822091145
SQL开始执行时间：20190822091145

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190822091153
SQL开始执行时间：20190822091153

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190822091153

20190823011038开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190823011038
SQL开始执行时间：20190823011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190823011038
SQL开始执行时间：20190823011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190823011038
SQL开始执行时间：20190823011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190823011048
SQL开始执行时间：20190823011048

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190823011048

20190823092048开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190823092048


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190823092048
SQL开始执行时间：20190823092048



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190823092048
SQL开始执行时间：20190823092048


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190823092048
SQL开始执行时间：20190823092048

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190823092055
SQL开始执行时间：20190823092055

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190823092055

20190824011038开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190824011038
SQL开始执行时间：20190824011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190824011038
SQL开始执行时间：20190824011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190824011038
SQL开始执行时间：20190824011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190824011047
SQL开始执行时间：20190824011047

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190824011047

20190825011036开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190825011037
SQL开始执行时间：20190825011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190825011037
SQL开始执行时间：20190825011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190825011037
SQL开始执行时间：20190825011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190825011043
SQL开始执行时间：20190825011043

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190825011043

20190826011039开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190826011039
SQL开始执行时间：20190826011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190826011039
SQL开始执行时间：20190826011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190826011039
SQL开始执行时间：20190826011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190826011043
SQL开始执行时间：20190826011043

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190826011043

20190827011038开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190827011038
SQL开始执行时间：20190827011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190827011038
SQL开始执行时间：20190827011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827011038
SQL开始执行时间：20190827011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190827011044
SQL开始执行时间：20190827011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190827011044

20190827092551开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190827092551


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190827092552
SQL开始执行时间：20190827092552



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190827092552
SQL开始执行时间：20190827092552


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827092552
SQL开始执行时间：20190827092552

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190827092557
SQL开始执行时间：20190827092557

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190827092557

20190828011038开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190828011038
SQL开始执行时间：20190828011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190828011038
SQL开始执行时间：20190828011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828011038
SQL开始执行时间：20190828011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190828011046
SQL开始执行时间：20190828011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190828011046

20190828093200开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190828093200


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190828093200
SQL开始执行时间：20190828093200



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190828093201
SQL开始执行时间：20190828093201


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828093201
SQL开始执行时间：20190828093201

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190828093208
SQL开始执行时间：20190828093208

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190828093208

20190829011040开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829011040


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190829011040
SQL开始执行时间：20190829011040



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190829011040
SQL开始执行时间：20190829011040


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190829011040
SQL开始执行时间：20190829011040

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190829011050
SQL开始执行时间：20190829011050

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190829011050

20190830011041开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830011041


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190830011041
SQL开始执行时间：20190830011041



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190830011041
SQL开始执行时间：20190830011041


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190830011041
SQL开始执行时间：20190830011041

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190830011049
SQL开始执行时间：20190830011049

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190830011049

20190831011057开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831011057


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190831011057
SQL开始执行时间：20190831011057



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190831011058
SQL开始执行时间：20190831011058


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190831011058
SQL开始执行时间：20190831011058

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190831011107
SQL开始执行时间：20190831011107

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190831011107

20190901011036开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190901011037
SQL开始执行时间：20190901011037



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190901011037
SQL开始执行时间：20190901011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190901011037
SQL开始执行时间：20190901011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190901011045
SQL开始执行时间：20190901011045

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190901011045

20190902011051开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902011051


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190902011051
SQL开始执行时间：20190902011051



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190902011051
SQL开始执行时间：20190902011051


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902011051
SQL开始执行时间：20190902011051

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190902011056
SQL开始执行时间：20190902011056

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190902011056

20190902154439开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902154439


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190902154440
SQL开始执行时间：20190902154440



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190902154440
SQL开始执行时间：20190902154440


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902154440
SQL开始执行时间：20190902154440

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190902155137
SQL开始执行时间：20190902155137

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190902155138

20190903011038开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190903011039
SQL开始执行时间：20190903011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190903011039
SQL开始执行时间：20190903011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190903011039
SQL开始执行时间：20190903011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190903011607
SQL开始执行时间：20190903011607

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190903011607

20190904011039开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904011039
SQL开始执行时间：20190904011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904011039
SQL开始执行时间：20190904011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904011039
SQL开始执行时间：20190904011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190904011048
SQL开始执行时间：20190904011048

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190904011048

20190904183051开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190904183051


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190904183051
SQL开始执行时间：20190904183051



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904183052
SQL开始执行时间：20190904183052


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904183052
SQL开始执行时间：20190904183052

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190904183100
SQL开始执行时间：20190904183100

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190904183100

20190905011038开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905011038
SQL开始执行时间：20190905011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905011038
SQL开始执行时间：20190905011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905011038
SQL开始执行时间：20190905011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190905011049
SQL开始执行时间：20190905011049

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190905011049

20190905110633开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190905110633


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190905110633
SQL开始执行时间：20190905110633



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905110633
SQL开始执行时间：20190905110633


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905110633
SQL开始执行时间：20190905110633

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190905110643
SQL开始执行时间：20190905110643

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190905110643

20190906011042开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906011042


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190906011042
SQL开始执行时间：20190906011042



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190906011042
SQL开始执行时间：20190906011042


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190906011042
SQL开始执行时间：20190906011042

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190906011054
SQL开始执行时间：20190906011054

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190906011054

20190907011042开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907011042


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190907011042
SQL开始执行时间：20190907011042



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190907011042
SQL开始执行时间：20190907011042


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190907011042
SQL开始执行时间：20190907011042

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190907011051
SQL开始执行时间：20190907011051

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190907011051

20190908011036开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908011036


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190908011036
SQL开始执行时间：20190908011036



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190908011037
SQL开始执行时间：20190908011037


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190908011037
SQL开始执行时间：20190908011037

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190908011044
SQL开始执行时间：20190908011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190908011044

20190909011038开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190909011038
SQL开始执行时间：20190909011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190909011038
SQL开始执行时间：20190909011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909011038
SQL开始执行时间：20190909011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190909011043
SQL开始执行时间：20190909011043

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190909011043

20190909090608开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190909090608


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190909090608
SQL开始执行时间：20190909090608



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190909090608
SQL开始执行时间：20190909090608


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909090608
SQL开始执行时间：20190909090608

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190909090619
SQL开始执行时间：20190909090619

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190909090619

20190910011041开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910011041


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190910011041
SQL开始执行时间：20190910011041



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190910011041
SQL开始执行时间：20190910011041


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910011041
SQL开始执行时间：20190910011041

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190910011054
SQL开始执行时间：20190910011054

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190910011054

20190910101541开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190910101541


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190910101542
SQL开始执行时间：20190910101542



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190910101542
SQL开始执行时间：20190910101542


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910101542
SQL开始执行时间：20190910101542

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190910101548
SQL开始执行时间：20190910101548

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190910101548

20190911011039开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190911011039
SQL开始执行时间：20190911011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190911011039
SQL开始执行时间：20190911011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190911011039
SQL开始执行时间：20190911011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190911011048
SQL开始执行时间：20190911011048

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190911011048

20190912011039开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190912011039
SQL开始执行时间：20190912011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190912011039
SQL开始执行时间：20190912011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190912011039
SQL开始执行时间：20190912011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190912011048
SQL开始执行时间：20190912011048

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190912011048

20190913011042开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913011042


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190913011042
SQL开始执行时间：20190913011042



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190913011043
SQL开始执行时间：20190913011043


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190913011043
SQL开始执行时间：20190913011043

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190913011052
SQL开始执行时间：20190913011052

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190913011052

20190914011056开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914011056


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190914011056
SQL开始执行时间：20190914011056



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190914011056
SQL开始执行时间：20190914011056


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190914011056
SQL开始执行时间：20190914011056

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190914011104
SQL开始执行时间：20190914011104

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190914011104

20190915011039开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190915011040
SQL开始执行时间：20190915011040



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190915011040
SQL开始执行时间：20190915011040


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190915011040
SQL开始执行时间：20190915011040

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190915011045
SQL开始执行时间：20190915011045

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190915011045

20190916011041开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916011041


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916011041
SQL开始执行时间：20190916011041



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916011041
SQL开始执行时间：20190916011041


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916011041
SQL开始执行时间：20190916011041

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190916011046
SQL开始执行时间：20190916011046

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916011046

20190916084644开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916084644


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916084644
SQL开始执行时间：20190916084644



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916084644
SQL开始执行时间：20190916084644


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916084644
SQL开始执行时间：20190916084644

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190916084658
SQL开始执行时间：20190916084658

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916084658

20190916093048开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916093048


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916093048
SQL开始执行时间：20190916093048



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916093048
SQL开始执行时间：20190916093048


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916093048
SQL开始执行时间：20190916093048

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190916093101
SQL开始执行时间：20190916093101

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916093102

20190916095807开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916095807


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190916095807
SQL开始执行时间：20190916095807



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916095807
SQL开始执行时间：20190916095807


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916095807
SQL开始执行时间：20190916095807

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190916095820
SQL开始执行时间：20190916095820

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190916095820

20190917011041开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917011041


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190917011041
SQL开始执行时间：20190917011041



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190917011041
SQL开始执行时间：20190917011041


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190917011041
SQL开始执行时间：20190917011041

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190917011057
SQL开始执行时间：20190917011057

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190917011057

20190918011041开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918011041


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190918011041
SQL开始执行时间：20190918011041



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190918011041
SQL开始执行时间：20190918011041


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918011041
SQL开始执行时间：20190918011041

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190918011450
SQL开始执行时间：20190918011450

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190918011451

20190918083347开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190918083347


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190918083347
SQL开始执行时间：20190918083347



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190918083348
SQL开始执行时间：20190918083348


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918083348
SQL开始执行时间：20190918083348

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190918083348
SQL开始执行时间：20190918083348

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190918083348

20190918094126开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190918094126


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190918094126
SQL开始执行时间：20190918094126



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190918094126
SQL开始执行时间：20190918094126


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918094126
SQL开始执行时间：20190918094126

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190918094136
SQL开始执行时间：20190918094136

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190918094136

20190919011043开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919011043


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190919011044
SQL开始执行时间：20190919011044



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190919011044
SQL开始执行时间：20190919011044


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190919011044
SQL开始执行时间：20190919011044

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190919011057
SQL开始执行时间：20190919011057

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190919011057

20190919102011开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190919102011


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190919102011
SQL开始执行时间：20190919102011



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190919102011
SQL开始执行时间：20190919102011


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190919102011
SQL开始执行时间：20190919102011

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190919102022
SQL开始执行时间：20190919102022

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190919102022

20190920011040开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920011040


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190920011040
SQL开始执行时间：20190920011040



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190920011040
SQL开始执行时间：20190920011040


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190920011040
SQL开始执行时间：20190920011040

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190920011053
SQL开始执行时间：20190920011053

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190920011053

20190921011042开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921011042


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190921011043
SQL开始执行时间：20190921011043



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190921011043
SQL开始执行时间：20190921011043


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190921011043
SQL开始执行时间：20190921011043

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190921011052
SQL开始执行时间：20190921011052

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190921011052

20190922011038开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190922011038
SQL开始执行时间：20190922011038



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190922011038
SQL开始执行时间：20190922011038


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190922011038
SQL开始执行时间：20190922011038

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190922011045
SQL开始执行时间：20190922011045

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190922011045

20190923011038开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923011038


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190923011039
SQL开始执行时间：20190923011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190923011039
SQL开始执行时间：20190923011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923011039
SQL开始执行时间：20190923011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190923011044
SQL开始执行时间：20190923011044

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190923011044

20190923113034开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190923113034


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190923113034
SQL开始执行时间：20190923113034



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190923113034
SQL开始执行时间：20190923113034


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923113034
SQL开始执行时间：20190923113034

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190923113043
SQL开始执行时间：20190923113043

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190923113043

20190924011045开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924011045


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190924011045
SQL开始执行时间：20190924011045



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190924011045
SQL开始执行时间：20190924011045


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924011045
SQL开始执行时间：20190924011045

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190924011058
SQL开始执行时间：20190924011058

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190924011058

20190924094350开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190924094350


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190924094350
SQL开始执行时间：20190924094350



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190924094351
SQL开始执行时间：20190924094351


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924094351
SQL开始执行时间：20190924094351

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190924094400
SQL开始执行时间：20190924094400

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190924094400

20190925011043开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925011043


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190925011044
SQL开始执行时间：20190925011044



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190925011044
SQL开始执行时间：20190925011044


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190925011044
SQL开始执行时间：20190925011044

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190925011056
SQL开始执行时间：20190925011056

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190925011057

20190925113135开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190925113135


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190925113135
SQL开始执行时间：20190925113135



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190925113135
SQL开始执行时间：20190925113135


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190925113135
SQL开始执行时间：20190925113135

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190925113148
SQL开始执行时间：20190925113148

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190925113148

20190926011042开始执行2019-09-25数据加载日志:
SQL开始执行时间：20190926011042


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190926011042
SQL开始执行时间：20190926011042



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190926011042
SQL开始执行时间：20190926011042


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190926011042
SQL开始执行时间：20190926011042

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190926011057
SQL开始执行时间：20190926011057

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190926011057

20190927011041开始执行2019-09-26数据加载日志:
SQL开始执行时间：20190927011042


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190927011042
SQL开始执行时间：20190927011042



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190927011042
SQL开始执行时间：20190927011042


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190927011042
SQL开始执行时间：20190927011042

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190927011051
SQL开始执行时间：20190927011051

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190927011052

20190928011044开始执行2019-09-27数据加载日志:
SQL开始执行时间：20190928011044


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190928011044
SQL开始执行时间：20190928011044



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190928011044
SQL开始执行时间：20190928011044


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190928011044
SQL开始执行时间：20190928011044

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190928011054
SQL开始执行时间：20190928011054

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190928011054
SQL开始执行时间：20190928011054

update pdm.sales_order s
  join (select * from ufdata.department where db = 'UFDATA_111_2018'  group by cdepcode) c
    on s.cdepcode = c.cdepcode
   set s.cdepname = c.cdepname
 where s.cdepname is null
   and s.cdepcode is not null

;
SQL结束执行时间：20190928011054

20190929011039开始执行2019-09-28数据加载日志:
SQL开始执行时间：20190929011039


create temporary table pdm.sales_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.sales_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190929011039
SQL开始执行时间：20190929011039



create temporary table pdm.sales_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190929011039
SQL开始执行时间：20190929011039


delete from pdm.sales_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190929011039
SQL开始执行时间：20190929011039

delete from pdm.sales_order where concat(id,db) in (select concat(id,db) from  pdm.sales_order_pre)
;
SQL结束执行时间：20190929011047
SQL开始执行时间：20190929011047

insert into pdm.sales_order
select a.csocode
      ,a.autoid
      ,a.id
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ddate
      ,a.cpersoncode
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.itaxunitprice
      ,a.iquantity
      ,a.itax
      ,a.isum
      ,a.citemname
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.sales_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.sales_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20190929011047
SQL开始执行时间：20190929011047

update pdm.sales_order s
  join (select * from ufdata.department where db = 'UFDATA_111_2018'  group by cdepcode) c
    on s.cdepcode = c.cdepcode
   set s.cdepname = c.cdepname
 where s.cdepname is null
   and s.cdepcode is not null

;
SQL结束执行时间：20190929011047
