
20181129013031开始执行2018-11-28数据加载日志:
SQL开始执行时间：20181129013031



create temporary table pdm.outdepot_order_pre as 
select *
  from edw.outdepot_order a
 where left(a.sys_time,10) > '2018-11-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181129013031
SQL开始执行时间：20181129013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181129013031
SQL开始执行时间：20181129013031

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181129013033
SQL开始执行时间：20181129013033

insert into pdm.outdepot_order
select a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.citemname
      ,null
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181129013033

20181130013030开始执行2018-11-29数据加载日志:
SQL开始执行时间：20181130013030



create temporary table pdm.outdepot_order_pre as 
select *
  from edw.outdepot_order a
 where left(a.sys_time,10) > '2018-11-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20181130013030
SQL开始执行时间：20181130013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181130013030
SQL开始执行时间：20181130013030

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181130013031
SQL开始执行时间：20181130013031

insert into pdm.outdepot_order
select a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.citemname
      ,null
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181130013031

20181201013029开始执行2018-11-30数据加载日志:
SQL开始执行时间：20181201013029



create temporary table pdm.outdepot_order_pre as 
select *
  from edw.outdepot_order a
 where left(a.sys_time,10) > '2018-11-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20181201013029
SQL开始执行时间：20181201013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181201013029
SQL开始执行时间：20181201013029

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181201013032
SQL开始执行时间：20181201013032

insert into pdm.outdepot_order
select a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.citemname
      ,null
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181201013032

20181202013029开始执行2018-12-01数据加载日志:
SQL开始执行时间：20181202013029



create temporary table pdm.outdepot_order_pre as 
select *
  from edw.outdepot_order a
 where left(a.sys_time,10) > '2018-12-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181202013029
SQL开始执行时间：20181202013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181202013029
SQL开始执行时间：20181202013029

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181202013029
SQL开始执行时间：20181202013029

insert into pdm.outdepot_order
select a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.citemname
      ,null
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181202013029

20181203013032开始执行2018-12-02数据加载日志:
SQL开始执行时间：20181203013032



create temporary table pdm.outdepot_order_pre as 
select *
  from edw.outdepot_order a
 where left(a.sys_time,10) > '2018-12-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20181203013032
SQL开始执行时间：20181203013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181203013032
SQL开始执行时间：20181203013032

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181203013032
SQL开始执行时间：20181203013032

insert into pdm.outdepot_order
select a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.citemname
      ,null
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181203013032

20181204013032开始执行2018-12-03数据加载日志:
SQL开始执行时间：20181204013032



create temporary table pdm.outdepot_order_pre as 
select *
  from edw.outdepot_order a
 where left(a.sys_time,10) > '2018-12-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20181204013032
SQL开始执行时间：20181204013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181204013032
SQL开始执行时间：20181204013032

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181204013034
SQL开始执行时间：20181204013034

insert into pdm.outdepot_order
select a.id
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝莱'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '湖北奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '四川美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,null
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.citemname
      ,null
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db

;
SQL结束执行时间：20181204013034

20181204175352开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181204175352


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181204175353
SQL开始执行时间：20181204175353

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181204175353
SQL开始执行时间：20181204175353

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181204175646
SQL开始执行时间：20181204175646

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181204175646
SQL开始执行时间：20181204175646


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,case when e.bi_cinvcode is not null and e.item_code is not null  then e.item_code else '请核查' end
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.outdepot_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181204175703

20181205013029开始执行2018-12-04数据加载日志:
SQL开始执行时间：20181205013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20181205013029
SQL开始执行时间：20181205013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181205013029
SQL开始执行时间：20181205013029

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181205013030
SQL开始执行时间：20181205013030

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181205013030
SQL开始执行时间：20181205013030


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,case when e.bi_cinvcode is not null and e.item_code is not null  then e.item_code else '请核查' end
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.outdepot_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181205013030

20181206013029开始执行2018-12-05数据加载日志:
SQL开始执行时间：20181206013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206013029
SQL开始执行时间：20181206013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206013029
SQL开始执行时间：20181206013029

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181206013031
SQL开始执行时间：20181206013031

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206013031
SQL开始执行时间：20181206013031


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,case when e.bi_cinvcode is not null and e.item_code is not null  then e.item_code else '请核查' end
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.outdepot_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206013031

20181206100812开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206100812


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206100812
SQL开始执行时间：20181206100812

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206100812
SQL开始执行时间：20181206100812

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181206100812
SQL开始执行时间：20181206100812

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206100812
SQL开始执行时间：20181206100812


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,case when e.bi_cinvcode is not null and e.item_code is not null  then e.item_code else '请核查' end
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join pdm.outdepot_order_item e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206100812

20181206101456开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206101456


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206101457
SQL开始执行时间：20181206101457

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206101457
SQL开始执行时间：20181206101457

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181206101457
SQL开始执行时间：20181206101457

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206101457
SQL开始执行时间：20181206101457


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.invoice_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20181206101530开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206101530


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206101530
SQL开始执行时间：20181206101530

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206101530
SQL开始执行时间：20181206101530

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181206101530
SQL开始执行时间：20181206101530

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206101531
SQL开始执行时间：20181206101531


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;

20181206101609开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206101609


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206101610
SQL开始执行时间：20181206101610

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206101610
SQL开始执行时间：20181206101610

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181206101610
SQL开始执行时间：20181206101610

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206101610
SQL开始执行时间：20181206101610


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206101612

20181206133447开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206133447


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206133448
SQL开始执行时间：20181206133448

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206133448
SQL开始执行时间：20181206133448

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181206133448
SQL开始执行时间：20181206133448

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206133448
SQL开始执行时间：20181206133448


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206133449

20181206141818开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181206141818


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181206141819
SQL开始执行时间：20181206141819

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181206141819
SQL开始执行时间：20181206141819

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181206141819
SQL开始执行时间：20181206141819

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181206141819
SQL开始执行时间：20181206141819


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181206141820

20181207013032开始执行2018-12-06数据加载日志:
SQL开始执行时间：20181207013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20181207013032
SQL开始执行时间：20181207013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181207013032
SQL开始执行时间：20181207013032

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181207013033
SQL开始执行时间：20181207013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181207013033
SQL开始执行时间：20181207013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181207013033

20181208013033开始执行2018-12-07数据加载日志:
SQL开始执行时间：20181208013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20181208013033
SQL开始执行时间：20181208013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181208013033
SQL开始执行时间：20181208013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181208013033
SQL开始执行时间：20181208013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181208013035
SQL开始执行时间：20181208013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181208013035
SQL开始执行时间：20181208013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181208013035

20181209013030开始执行2018-12-08数据加载日志:
SQL开始执行时间：20181209013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20181209013030
SQL开始执行时间：20181209013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181209013030
SQL开始执行时间：20181209013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181209013030
SQL开始执行时间：20181209013030

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181209013031
SQL开始执行时间：20181209013031

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181209013031
SQL开始执行时间：20181209013031


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181209013031

20181210013029开始执行2018-12-09数据加载日志:
SQL开始执行时间：20181210013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20181210013029
SQL开始执行时间：20181210013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181210013029
SQL开始执行时间：20181210013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181210013029
SQL开始执行时间：20181210013029

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181210013029
SQL开始执行时间：20181210013029

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181210013029
SQL开始执行时间：20181210013029


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181210013029

20181211013031开始执行2018-12-10数据加载日志:
SQL开始执行时间：20181211013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20181211013031
SQL开始执行时间：20181211013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181211013031
SQL开始执行时间：20181211013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181211013031
SQL开始执行时间：20181211013031

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181211013033
SQL开始执行时间：20181211013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181211013033
SQL开始执行时间：20181211013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181211013033

20181212013030开始执行2018-12-11数据加载日志:
SQL开始执行时间：20181212013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20181212013030
SQL开始执行时间：20181212013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181212013030
SQL开始执行时间：20181212013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181212013030
SQL开始执行时间：20181212013030

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181212013032
SQL开始执行时间：20181212013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181212013032
SQL开始执行时间：20181212013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181212013032

20181212144848开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181212144848


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181212144848
SQL开始执行时间：20181212144848

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181212144848
SQL开始执行时间：20181212144848
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181212144848
SQL开始执行时间：20181212144848

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181212144848
SQL开始执行时间：20181212144848

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181212144849
SQL开始执行时间：20181212144849


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181212144850

20181213013030开始执行2018-12-12数据加载日志:
SQL开始执行时间：20181213013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20181213013030
SQL开始执行时间：20181213013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181213013030
SQL开始执行时间：20181213013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181213013030
SQL开始执行时间：20181213013030

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181213013031
SQL开始执行时间：20181213013031

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181213013032
SQL开始执行时间：20181213013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181213013032

20181214013030开始执行2018-12-13数据加载日志:
SQL开始执行时间：20181214013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20181214013030
SQL开始执行时间：20181214013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181214013030
SQL开始执行时间：20181214013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181214013030
SQL开始执行时间：20181214013030

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181214013032
SQL开始执行时间：20181214013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181214013032
SQL开始执行时间：20181214013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181214013032

20181214130638开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181214130638


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181214130639
SQL开始执行时间：20181214130639

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181214130639
SQL开始执行时间：20181214130639
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181214130639
SQL开始执行时间：20181214130639

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181214130639
SQL开始执行时间：20181214130639

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181214130639
SQL开始执行时间：20181214130639


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,a.iunitcost
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181214130641

20181215013033开始执行2018-12-14数据加载日志:
SQL开始执行时间：20181215013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20181215013033
SQL开始执行时间：20181215013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181215013033
SQL开始执行时间：20181215013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181215013033
SQL开始执行时间：20181215013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181215013035
SQL开始执行时间：20181215013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181215013035
SQL开始执行时间：20181215013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181215013035

20181216013030开始执行2018-12-15数据加载日志:
SQL开始执行时间：20181216013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20181216013030
SQL开始执行时间：20181216013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181216013030
SQL开始执行时间：20181216013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181216013030
SQL开始执行时间：20181216013030

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181216013030
SQL开始执行时间：20181216013030

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181216013030
SQL开始执行时间：20181216013030


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181216013030

20181217013032开始执行2018-12-16数据加载日志:
SQL开始执行时间：20181217013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20181217013032
SQL开始执行时间：20181217013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181217013032
SQL开始执行时间：20181217013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181217013032
SQL开始执行时间：20181217013032

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181217013032
SQL开始执行时间：20181217013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181217013033
SQL开始执行时间：20181217013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181217013033

20181218013033开始执行2018-12-17数据加载日志:
SQL开始执行时间：20181218013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20181218013033
SQL开始执行时间：20181218013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181218013033
SQL开始执行时间：20181218013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181218013033
SQL开始执行时间：20181218013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181218013036
SQL开始执行时间：20181218013036

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181218013036
SQL开始执行时间：20181218013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181218013036

20181219013033开始执行2018-12-18数据加载日志:
SQL开始执行时间：20181219013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219013033
SQL开始执行时间：20181219013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219013033
SQL开始执行时间：20181219013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181219013033
SQL开始执行时间：20181219013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181219013035
SQL开始执行时间：20181219013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219013036
SQL开始执行时间：20181219013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219013036

20181219111315开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181219111315


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219111315
SQL开始执行时间：20181219111315

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219111315
SQL开始执行时间：20181219111315
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181219111315
SQL开始执行时间：20181219111315

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181219111315
SQL开始执行时间：20181219111315

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219111316
SQL开始执行时间：20181219111316


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219111317

20181219181136开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181219181136


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219181136
SQL开始执行时间：20181219181136

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219181136
SQL开始执行时间：20181219181136
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181219181136
SQL开始执行时间：20181219181136

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181219181136
SQL开始执行时间：20181219181136

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219181137
SQL开始执行时间：20181219181137


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219181137

20181219181655开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181219181655


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181219181655
SQL开始执行时间：20181219181655

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181219181655
SQL开始执行时间：20181219181655
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181219181655
SQL开始执行时间：20181219181655

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181219181656
SQL开始执行时间：20181219181656

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181219181656
SQL开始执行时间：20181219181656


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181219181656

20181220013033开始执行2018-12-19数据加载日志:
SQL开始执行时间：20181220013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20181220013033
SQL开始执行时间：20181220013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181220013033
SQL开始执行时间：20181220013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181220013033
SQL开始执行时间：20181220013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181220013034
SQL开始执行时间：20181220013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181220013034
SQL开始执行时间：20181220013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181220013034

20181221013033开始执行2018-12-20数据加载日志:
SQL开始执行时间：20181221013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20181221013033
SQL开始执行时间：20181221013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181221013033
SQL开始执行时间：20181221013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181221013033
SQL开始执行时间：20181221013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181221013033
SQL开始执行时间：20181221013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181221013033
SQL开始执行时间：20181221013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181221013033

20181221153654开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181221153654


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181221153655
SQL开始执行时间：20181221153655

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181221153655
SQL开始执行时间：20181221153655
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181221153655
SQL开始执行时间：20181221153655

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181221153655
SQL开始执行时间：20181221153655

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181221153655
SQL开始执行时间：20181221153655


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181221153657

20181222013033开始执行2018-12-21数据加载日志:
SQL开始执行时间：20181222013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20181222013033
SQL开始执行时间：20181222013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181222013033
SQL开始执行时间：20181222013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181222013033
SQL开始执行时间：20181222013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181222013035
SQL开始执行时间：20181222013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181222013035
SQL开始执行时间：20181222013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181222013035

20181223013032开始执行2018-12-22数据加载日志:
SQL开始执行时间：20181223013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20181223013032
SQL开始执行时间：20181223013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181223013032
SQL开始执行时间：20181223013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181223013032
SQL开始执行时间：20181223013032

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181223013032
SQL开始执行时间：20181223013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181223013032
SQL开始执行时间：20181223013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181223013032

20181224013032开始执行2018-12-23数据加载日志:
SQL开始执行时间：20181224013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20181224013033
SQL开始执行时间：20181224013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181224013033
SQL开始执行时间：20181224013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181224013033
SQL开始执行时间：20181224013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181224013033
SQL开始执行时间：20181224013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181224013033
SQL开始执行时间：20181224013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181224013033

20181224100753开始执行2018-12-21数据加载日志:
SQL开始执行时间：20181224100753


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20181224100753
SQL开始执行时间：20181224100753

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181224100753
SQL开始执行时间：20181224100753
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181224100753
SQL开始执行时间：20181224100753

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181224100755
SQL开始执行时间：20181224100755

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181224100755
SQL开始执行时间：20181224100755


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181224100755

20181225013033开始执行2018-12-24数据加载日志:
SQL开始执行时间：20181225013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225013034
SQL开始执行时间：20181225013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225013034
SQL开始执行时间：20181225013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181225013034
SQL开始执行时间：20181225013034

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181225013035
SQL开始执行时间：20181225013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,case when f.true_item_code is null then '请核查'
            else f.plan_class end as plan_class
      ,case when f.true_item_code is null then '请核查'
            else f.key_project end as key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225013036
SQL开始执行时间：20181225013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225013036

20181225105241开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181225105241


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225105242
SQL开始执行时间：20181225105242

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225105242
SQL开始执行时间：20181225105242
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181225105242
SQL开始执行时间：20181225105242

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181225105242
SQL开始执行时间：20181225105242

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225105242
SQL开始执行时间：20181225105242


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225105244

20181225202649开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181225202649


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181225202650
SQL开始执行时间：20181225202650

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181225202650
SQL开始执行时间：20181225202650
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181225202650
SQL开始执行时间：20181225202650

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181225202650
SQL开始执行时间：20181225202650

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181225202650
SQL开始执行时间：20181225202650


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181225202652

20181226013037开始执行2018-12-25数据加载日志:
SQL开始执行时间：20181226013037


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226013037
SQL开始执行时间：20181226013037

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226013037
SQL开始执行时间：20181226013037
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181226013037
SQL开始执行时间：20181226013037

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181226013039
SQL开始执行时间：20181226013039

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226013039
SQL开始执行时间：20181226013039


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,a.citemname
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode

;
SQL结束执行时间：20181226013039

20181226102259开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181226102259


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226102259
SQL开始执行时间：20181226102259

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226102300
SQL开始执行时间：20181226102300
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181226102300
SQL开始执行时间：20181226102300

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181226102300
SQL开始执行时间：20181226102300

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226102300
SQL开始执行时间：20181226102300


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case f.item_code is not null and a.citemname is null then f.level_three 
       else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20181226102416开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181226102416


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226102417
SQL开始执行时间：20181226102417

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226102417
SQL开始执行时间：20181226102417
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181226102417
SQL开始执行时间：20181226102417

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181226102417
SQL开始执行时间：20181226102417

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226102417
SQL开始执行时间：20181226102417


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181226102419

20181226131512开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181226131512


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226131512
SQL开始执行时间：20181226131512

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226131512
SQL开始执行时间：20181226131512
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181226131512
SQL开始执行时间：20181226131512

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181226131512
SQL开始执行时间：20181226131512

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226131513
SQL开始执行时间：20181226131513


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181226131514

20181226142320开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181226142320


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181226142321
SQL开始执行时间：20181226142321

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181226142321
SQL开始执行时间：20181226142321
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181226142321
SQL开始执行时间：20181226142321

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181226142321
SQL开始执行时间：20181226142321

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181226142322
SQL开始执行时间：20181226142322


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181226142323

20181227013034开始执行2018-12-26数据加载日志:
SQL开始执行时间：20181227013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20181227013034
SQL开始执行时间：20181227013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181227013034
SQL开始执行时间：20181227013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181227013034
SQL开始执行时间：20181227013034

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181227013036
SQL开始执行时间：20181227013036

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181227013036
SQL开始执行时间：20181227013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181227013037

20181227220050开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181227220050


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181227220051
SQL开始执行时间：20181227220051

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181227220051
SQL开始执行时间：20181227220051
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181227220051
SQL开始执行时间：20181227220051

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181227220051
SQL开始执行时间：20181227220051

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181227220051
SQL开始执行时间：20181227220051


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181227220052

20181228013037开始执行2018-12-27数据加载日志:
SQL开始执行时间：20181228013037


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20181228013038
SQL开始执行时间：20181228013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181228013038
SQL开始执行时间：20181228013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181228013038
SQL开始执行时间：20181228013038

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181228013040
SQL开始执行时间：20181228013040

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181228013040
SQL开始执行时间：20181228013040


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181228013040

20181229013034开始执行2018-12-28数据加载日志:
SQL开始执行时间：20181229013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20181229013034
SQL开始执行时间：20181229013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181229013034
SQL开始执行时间：20181229013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181229013034
SQL开始执行时间：20181229013034

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181229013035
SQL开始执行时间：20181229013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181229013035
SQL开始执行时间：20181229013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181229013035

20181229101042开始执行1900-01-01数据加载日志:
SQL开始执行时间：20181229101042


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20181229101042
SQL开始执行时间：20181229101042

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181229101042
SQL开始执行时间：20181229101042
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181229101042
SQL开始执行时间：20181229101042

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181229101043
SQL开始执行时间：20181229101043

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181229101043
SQL开始执行时间：20181229101043


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181229101045

20181230013035开始执行2018-12-29数据加载日志:
SQL开始执行时间：20181230013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20181230013035
SQL开始执行时间：20181230013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181230013035
SQL开始执行时间：20181230013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181230013035
SQL开始执行时间：20181230013035

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181230013035
SQL开始执行时间：20181230013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181230013036
SQL开始执行时间：20181230013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181230013036

20181231013034开始执行2018-12-30数据加载日志:
SQL开始执行时间：20181231013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20181231013034
SQL开始执行时间：20181231013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20181231013034
SQL开始执行时间：20181231013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20181231013034
SQL开始执行时间：20181231013034

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20181231013034
SQL开始执行时间：20181231013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20181231013034
SQL开始执行时间：20181231013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20181231013034

20190101013032开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190101013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190101013032
SQL开始执行时间：20190101013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190101013032
SQL开始执行时间：20190101013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190101013032
SQL开始执行时间：20190101013032

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190101013032
SQL开始执行时间：20190101013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190101013032
SQL开始执行时间：20190101013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190101013032

20190102013031开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190102013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190102013031
SQL开始执行时间：20190102013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190102013031
SQL开始执行时间：20190102013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190102013031
SQL开始执行时间：20190102013031

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190102013031
SQL开始执行时间：20190102013031

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190102013032
SQL开始执行时间：20190102013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190102013032

20190103013034开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190103013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190103013035
SQL开始执行时间：20190103013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190103013035
SQL开始执行时间：20190103013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190103013035
SQL开始执行时间：20190103013035

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190103013035
SQL开始执行时间：20190103013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190103013036
SQL开始执行时间：20190103013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190103013036

20190103095954开始执行2018-12-29数据加载日志:
SQL开始执行时间：20190103095954


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2018-12-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190103095954
SQL开始执行时间：20190103095954

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190103095954
SQL开始执行时间：20190103095954
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190103095954
SQL开始执行时间：20190103095954

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190103095955
SQL开始执行时间：20190103095955

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190103095955
SQL开始执行时间：20190103095955


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190103095955

20190104013032开始执行2019-01-03数据加载日志:
SQL开始执行时间：20190104013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190104013032
SQL开始执行时间：20190104013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190104013032
SQL开始执行时间：20190104013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190104013032
SQL开始执行时间：20190104013032

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190104013033
SQL开始执行时间：20190104013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190104013033
SQL开始执行时间：20190104013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190104013033

20190104093136开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190104093136


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190104093136
SQL开始执行时间：20190104093136

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190104093136
SQL开始执行时间：20190104093136
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190104093136
SQL开始执行时间：20190104093136

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190104093138
SQL开始执行时间：20190104093138

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190104093138
SQL开始执行时间：20190104093138


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190104093138

20190104093856开始执行2019-01-02数据加载日志:
SQL开始执行时间：20190104093856


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190104093856
SQL开始执行时间：20190104093856

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190104093856
SQL开始执行时间：20190104093856
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190104093856
SQL开始执行时间：20190104093856

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190104093858
SQL开始执行时间：20190104093858

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190104093859
SQL开始执行时间：20190104093859


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190104093859

20190105013032开始执行2019-01-04数据加载日志:
SQL开始执行时间：20190105013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190105013032
SQL开始执行时间：20190105013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190105013032
SQL开始执行时间：20190105013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190105013032
SQL开始执行时间：20190105013032

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190105013033
SQL开始执行时间：20190105013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190105013034
SQL开始执行时间：20190105013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190105013034

20190105101230开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190105101230


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190105101231
SQL开始执行时间：20190105101231

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190105101231
SQL开始执行时间：20190105101231
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190105101231
SQL开始执行时间：20190105101231

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190105101231
SQL开始执行时间：20190105101231

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190105101232
SQL开始执行时间：20190105101232


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190105101233

20190106013031开始执行2019-01-05数据加载日志:
SQL开始执行时间：20190106013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190106013031
SQL开始执行时间：20190106013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190106013031
SQL开始执行时间：20190106013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190106013031
SQL开始执行时间：20190106013031

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190106013032
SQL开始执行时间：20190106013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190106013032
SQL开始执行时间：20190106013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190106013032

20190107013031开始执行2019-01-06数据加载日志:
SQL开始执行时间：20190107013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190107013031
SQL开始执行时间：20190107013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190107013031
SQL开始执行时间：20190107013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190107013031
SQL开始执行时间：20190107013031

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190107013032
SQL开始执行时间：20190107013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190107013032
SQL开始执行时间：20190107013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190107013032

20190108013033开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190108013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190108013033
SQL开始执行时间：20190108013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190108013033
SQL开始执行时间：20190108013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190108013033
SQL开始执行时间：20190108013033

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190108013035
SQL开始执行时间：20190108013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190108013035
SQL开始执行时间：20190108013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190108013035

20190109013034开始执行2019-01-08数据加载日志:
SQL开始执行时间：20190109013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190109013034
SQL开始执行时间：20190109013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190109013034
SQL开始执行时间：20190109013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190109013034
SQL开始执行时间：20190109013034

delete from pdm.outdepot_order where id in (select id from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190109013035
SQL开始执行时间：20190109013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190109013036
SQL开始执行时间：20190109013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190109013036

20190109090840开始执行2019-01-07数据加载日志:
SQL开始执行时间：20190109090840


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190109090840
SQL开始执行时间：20190109090840

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190109090840
SQL开始执行时间：20190109090840
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190109090840
SQL开始执行时间：20190109090840

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190109090843
SQL开始执行时间：20190109090843

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190109090843
SQL开始执行时间：20190109090843


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190109090844

20190110013033开始执行2019-01-09数据加载日志:
SQL开始执行时间：20190110013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190110013033
SQL开始执行时间：20190110013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190110013033
SQL开始执行时间：20190110013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190110013033
SQL开始执行时间：20190110013033

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190110013035
SQL开始执行时间：20190110013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190110013035
SQL开始执行时间：20190110013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190110013035

20190111013035开始执行2019-01-10数据加载日志:
SQL开始执行时间：20190111013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190111013035
SQL开始执行时间：20190111013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190111013035
SQL开始执行时间：20190111013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190111013035
SQL开始执行时间：20190111013035

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190111013036
SQL开始执行时间：20190111013036

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190111013036
SQL开始执行时间：20190111013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190111013036

20190111125833开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190111125833


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190111125834
SQL开始执行时间：20190111125834

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190111125834
SQL开始执行时间：20190111125834
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190111125834
SQL开始执行时间：20190111125834

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190111125834
SQL开始执行时间：20190111125834

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190111125834
SQL开始执行时间：20190111125834


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190111125836

20190112013036开始执行2019-01-11数据加载日志:
SQL开始执行时间：20190112013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190112013036
SQL开始执行时间：20190112013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190112013036
SQL开始执行时间：20190112013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190112013036
SQL开始执行时间：20190112013036

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190112013038
SQL开始执行时间：20190112013038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190112013038
SQL开始执行时间：20190112013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190112013038

20190113013031开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190113013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190113013031
SQL开始执行时间：20190113013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190113013031
SQL开始执行时间：20190113013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190113013031
SQL开始执行时间：20190113013031

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190113013031
SQL开始执行时间：20190113013031

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190113013031
SQL开始执行时间：20190113013031


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190113013031

20190114013034开始执行2019-01-13数据加载日志:
SQL开始执行时间：20190114013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190114013034
SQL开始执行时间：20190114013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190114013034
SQL开始执行时间：20190114013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190114013034
SQL开始执行时间：20190114013034

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190114013034
SQL开始执行时间：20190114013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190114013034
SQL开始执行时间：20190114013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190114013034

20190114165231开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190114165231


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190114165231
SQL开始执行时间：20190114165231

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190114165231
SQL开始执行时间：20190114165231
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190114165231
SQL开始执行时间：20190114165231

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190114165231
SQL开始执行时间：20190114165231

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190114165231
SQL开始执行时间：20190114165231


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190114165232

20190115013033开始执行2019-01-14数据加载日志:
SQL开始执行时间：20190115013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115013033
SQL开始执行时间：20190115013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115013033
SQL开始执行时间：20190115013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190115013033
SQL开始执行时间：20190115013033

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190115013036
SQL开始执行时间：20190115013036

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115013036
SQL开始执行时间：20190115013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190115013036

20190115085909开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190115085909


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115085909
SQL开始执行时间：20190115085909

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115085909
SQL开始执行时间：20190115085909
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190115085909
SQL开始执行时间：20190115085909

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190115085911
SQL开始执行时间：20190115085911

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115085912
SQL开始执行时间：20190115085912


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190115085912

20190115090837开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190115090837


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115090837
SQL开始执行时间：20190115090837

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115090837
SQL开始执行时间：20190115090837
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190115090837
SQL开始执行时间：20190115090837

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190115090840
SQL开始执行时间：20190115090840

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115090840
SQL开始执行时间：20190115090840


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190115090840

20190115093048开始执行2019-01-12数据加载日志:
SQL开始执行时间：20190115093048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190115093048
SQL开始执行时间：20190115093048

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190115093048
SQL开始执行时间：20190115093048
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190115093048
SQL开始执行时间：20190115093048

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190115093052
SQL开始执行时间：20190115093052

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190115093052
SQL开始执行时间：20190115093052


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190115093052

20190116013035开始执行2019-01-15数据加载日志:
SQL开始执行时间：20190116013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190116013035
SQL开始执行时间：20190116013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190116013035
SQL开始执行时间：20190116013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190116013035
SQL开始执行时间：20190116013035

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190116013037
SQL开始执行时间：20190116013037

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190116013038
SQL开始执行时间：20190116013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,a.iprice
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190116013038

20190117013037开始执行2019-01-16数据加载日志:
SQL开始执行时间：20190117013037


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117013037
SQL开始执行时间：20190117013037

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117013037
SQL开始执行时间：20190117013037
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190117013037
SQL开始执行时间：20190117013037

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190117013039
SQL开始执行时间：20190117013039

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190117013040
SQL开始执行时间：20190117013040


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190117013040

20190117092703开始执行2019-01-16数据加载日志:
SQL开始执行时间：20190117092703


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190117092703
SQL开始执行时间：20190117092703

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190117092703
SQL开始执行时间：20190117092703
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190117092703
SQL开始执行时间：20190117092703

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190117092706
SQL开始执行时间：20190117092706

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190117092706
SQL开始执行时间：20190117092706


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190117092706

20190118013033开始执行2019-01-17数据加载日志:
SQL开始执行时间：20190118013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118013033
SQL开始执行时间：20190118013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118013033
SQL开始执行时间：20190118013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190118013033
SQL开始执行时间：20190118013033

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190118013034
SQL开始执行时间：20190118013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118013034
SQL开始执行时间：20190118013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190118013034

20190118091331开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118091331


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118091332
SQL开始执行时间：20190118091332

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118091332
SQL开始执行时间：20190118091332
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190118091332
SQL开始执行时间：20190118091332

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190118091332
SQL开始执行时间：20190118091332

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118091333
SQL开始执行时间：20190118091333


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190118091425开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118091425


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118091426
SQL开始执行时间：20190118091426

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118091426
SQL开始执行时间：20190118091426
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190118091426
SQL开始执行时间：20190118091426

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190118091426
SQL开始执行时间：20190118091426

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118091426
SQL开始执行时间：20190118091426


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190118091428

20190118101707开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118101707


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118101708
SQL开始执行时间：20190118101708

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118101708
SQL开始执行时间：20190118101708
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190118101708
SQL开始执行时间：20190118101708

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190118102015
SQL开始执行时间：20190118102015

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118102015
SQL开始执行时间：20190118102015


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190118102016

20190118104706开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118104706


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118104706
SQL开始执行时间：20190118104706

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118104706
SQL开始执行时间：20190118104706
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190118104706
SQL开始执行时间：20190118104706

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190118104706
SQL开始执行时间：20190118104706

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118104707
SQL开始执行时间：20190118104707


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190118104707

20190118110003开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118110003


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118110003
SQL开始执行时间：20190118110003

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118110003
SQL开始执行时间：20190118110003
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190118110003
SQL开始执行时间：20190118110003

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190118110003
SQL开始执行时间：20190118110003

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118110004
SQL开始执行时间：20190118110004


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190118110005

20190118114526开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118114526


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118114526
SQL开始执行时间：20190118114526

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118114527
SQL开始执行时间：20190118114527
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190118114527
SQL开始执行时间：20190118114527

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190118114833
SQL开始执行时间：20190118114833

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118114833
SQL开始执行时间：20190118114833


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190118114834

20190118130319开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190118130319


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190118130320
SQL开始执行时间：20190118130320

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190118130320
SQL开始执行时间：20190118130320
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190118130320
SQL开始执行时间：20190118130320

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190118130322
SQL开始执行时间：20190118130322

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190118130322
SQL开始执行时间：20190118130322


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190118130326

20190122165537开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122165537


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122165538
SQL开始执行时间：20190122165538

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122165538
SQL开始执行时间：20190122165538
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190122165538
SQL开始执行时间：20190122165538

delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190122165608
SQL开始执行时间：20190122165608

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122165609
SQL开始执行时间：20190122165609


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190122170326开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122170326


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122170327
SQL开始执行时间：20190122170327

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122170327
SQL开始执行时间：20190122170327
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190122170327
SQL开始执行时间：20190122170327

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190122170452
SQL开始执行时间：20190122170452

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122170452
SQL开始执行时间：20190122170452


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join ufdata.warehouse c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join ufdata.department d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190122172155开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122172155


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122172155
SQL开始执行时间：20190122172155

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122172155
SQL开始执行时间：20190122172155
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190122172155
SQL开始执行时间：20190122172155

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190122172330
SQL开始执行时间：20190122172330

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122172330
SQL开始执行时间：20190122172330


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190122172516开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122172516


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122172516
SQL开始执行时间：20190122172516

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122172516
SQL开始执行时间：20190122172516
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190122172516
SQL开始执行时间：20190122172516

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190122172700
SQL开始执行时间：20190122172700

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122172701
SQL开始执行时间：20190122172701


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190122173301开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190122173301


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190122173302
SQL开始执行时间：20190122173302

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190122173302
SQL开始执行时间：20190122173302
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190122173302
SQL开始执行时间：20190122173302

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190122173405
SQL开始执行时间：20190122173405

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190122173405
SQL开始执行时间：20190122173405


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190122173405

20190123013034开始执行2019-01-22数据加载日志:
SQL开始执行时间：20190123013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190123013034
SQL开始执行时间：20190123013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190123013034
SQL开始执行时间：20190123013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190123013034
SQL开始执行时间：20190123013034

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190123013040
SQL开始执行时间：20190123013040

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190123013040
SQL开始执行时间：20190123013040


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190123013040

20190123161110开始执行2019-01-17数据加载日志:
SQL开始执行时间：20190123161110


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190123161111
SQL开始执行时间：20190123161111

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190123161111
SQL开始执行时间：20190123161111
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190123161111
SQL开始执行时间：20190123161111

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190123162649
SQL开始执行时间：20190123162649

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190123162650
SQL开始执行时间：20190123162650


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190123162651

20190124013037开始执行2019-01-23数据加载日志:
SQL开始执行时间：20190124013037


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190124013037
SQL开始执行时间：20190124013037

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190124013037
SQL开始执行时间：20190124013037
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190124013037
SQL开始执行时间：20190124013037

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190124013043
SQL开始执行时间：20190124013043

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190124013043
SQL开始执行时间：20190124013043


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190124013043

20190124085351开始执行2019-01-20数据加载日志:
SQL开始执行时间：20190124085351


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190124085352
SQL开始执行时间：20190124085352

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190124085352
SQL开始执行时间：20190124085352
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190124085352
SQL开始执行时间：20190124085352

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190124085501
SQL开始执行时间：20190124085501

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190124085502
SQL开始执行时间：20190124085502


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190124085502

20190125132855开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190125132855


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125132856
SQL开始执行时间：20190125132856

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125132856
SQL开始执行时间：20190125132856
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190125132856
SQL开始执行时间：20190125132856

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;

20190125133510开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190125133510


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125133511
SQL开始执行时间：20190125133511

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125133511
SQL开始执行时间：20190125133511
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190125133511
SQL开始执行时间：20190125133511

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190125133511
SQL开始执行时间：20190125133511

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190125133511
SQL开始执行时间：20190125133511


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190125133607开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190125133607


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125133608
SQL开始执行时间：20190125133608

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125133608
SQL开始执行时间：20190125133608
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190125133608
SQL开始执行时间：20190125133608

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190125133608
SQL开始执行时间：20190125133608

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190125133608
SQL开始执行时间：20190125133608


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190125133609

20190125151034开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190125151034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190125151035
SQL开始执行时间：20190125151035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190125151035
SQL开始执行时间：20190125151035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190125151035
SQL开始执行时间：20190125151035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190125151035
SQL开始执行时间：20190125151035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190125151035
SQL开始执行时间：20190125151035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190125151036

20190126013029开始执行2019-01-25数据加载日志:
SQL开始执行时间：20190126013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190126013029
SQL开始执行时间：20190126013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190126013029
SQL开始执行时间：20190126013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190126013029
SQL开始执行时间：20190126013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190126013033
SQL开始执行时间：20190126013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190126013034
SQL开始执行时间：20190126013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190126013034

20190127013025开始执行2019-01-26数据加载日志:
SQL开始执行时间：20190127013025


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190127013025
SQL开始执行时间：20190127013025

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190127013025
SQL开始执行时间：20190127013025
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190127013025
SQL开始执行时间：20190127013025

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190127013026
SQL开始执行时间：20190127013026

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190127013026
SQL开始执行时间：20190127013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190127013026

20190128013028开始执行2019-01-27数据加载日志:
SQL开始执行时间：20190128013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190128013028
SQL开始执行时间：20190128013028

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190128013028
SQL开始执行时间：20190128013028
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190128013028
SQL开始执行时间：20190128013028

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190128013028
SQL开始执行时间：20190128013028

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190128013028
SQL开始执行时间：20190128013028


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190128013028

20190128135119开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190128135119


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190128135120
SQL开始执行时间：20190128135120

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190128135120
SQL开始执行时间：20190128135120
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190128135120
SQL开始执行时间：20190128135120

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190128135120
SQL开始执行时间：20190128135120

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190128135120
SQL开始执行时间：20190128135120


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190128142057开始执行2019-01-01数据加载日志:
SQL开始执行时间：20190128142057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190128142058
SQL开始执行时间：20190128142058

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190128142058
SQL开始执行时间：20190128142058
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190128142058
SQL开始执行时间：20190128142058

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190128142058
SQL开始执行时间：20190128142058

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190128142058
SQL开始执行时间：20190128142058


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190128142059

20190129013027开始执行2019-01-28数据加载日志:
SQL开始执行时间：20190129013027


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129013027
SQL开始执行时间：20190129013027

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129013027
SQL开始执行时间：20190129013027
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190129013027
SQL开始执行时间：20190129013027

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190129013027
SQL开始执行时间：20190129013027

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190129013028
SQL开始执行时间：20190129013028


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190129013028

20190129094300开始执行2019-01-29数据加载日志:
SQL开始执行时间：20190129094300


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129094300
SQL开始执行时间：20190129094300

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129094300
SQL开始执行时间：20190129094300
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190129094300
SQL开始执行时间：20190129094300

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190129094300
SQL开始执行时间：20190129094300

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190129094300
SQL开始执行时间：20190129094300


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190129094300

20190129094521开始执行2019-01-28数据加载日志:
SQL开始执行时间：20190129094521


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190129094521
SQL开始执行时间：20190129094521

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190129094521
SQL开始执行时间：20190129094521
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190129094521
SQL开始执行时间：20190129094521

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190129094522
SQL开始执行时间：20190129094522

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190129094522
SQL开始执行时间：20190129094522


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190129094522

20190130013029开始执行2019-01-29数据加载日志:
SQL开始执行时间：20190130013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190130013030
SQL开始执行时间：20190130013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190130013030
SQL开始执行时间：20190130013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190130013030
SQL开始执行时间：20190130013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190130013032
SQL开始执行时间：20190130013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190130013032
SQL开始执行时间：20190130013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190130013032

20190131013032开始执行2019-01-30数据加载日志:
SQL开始执行时间：20190131013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190131013032
SQL开始执行时间：20190131013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190131013032
SQL开始执行时间：20190131013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190131013032
SQL开始执行时间：20190131013032

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190131013035
SQL开始执行时间：20190131013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190131013035
SQL开始执行时间：20190131013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190131013035

20190201013028开始执行2019-01-31数据加载日志:
SQL开始执行时间：20190201013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-01-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190201013028
SQL开始执行时间：20190201013028

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190201013028
SQL开始执行时间：20190201013028
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190201013028
SQL开始执行时间：20190201013028

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190201013029
SQL开始执行时间：20190201013029

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190201013029
SQL开始执行时间：20190201013029


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190201013029

20190202013028开始执行2019-02-01数据加载日志:
SQL开始执行时间：20190202013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190202013029
SQL开始执行时间：20190202013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190202013029
SQL开始执行时间：20190202013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190202013029
SQL开始执行时间：20190202013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190202013029
SQL开始执行时间：20190202013029

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190202013029
SQL开始执行时间：20190202013029


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190202013030

20190203013028开始执行2019-02-02数据加载日志:
SQL开始执行时间：20190203013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190203013028
SQL开始执行时间：20190203013028

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190203013028
SQL开始执行时间：20190203013028
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190203013028
SQL开始执行时间：20190203013028

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190203013028
SQL开始执行时间：20190203013028

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190203013028
SQL开始执行时间：20190203013028


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190203013028

20190204013025开始执行2019-02-03数据加载日志:
SQL开始执行时间：20190204013025


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190204013026
SQL开始执行时间：20190204013026

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190204013026
SQL开始执行时间：20190204013026
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190204013026
SQL开始执行时间：20190204013026

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190204013026
SQL开始执行时间：20190204013026

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190204013026
SQL开始执行时间：20190204013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190204013026

20190205013025开始执行2019-02-04数据加载日志:
SQL开始执行时间：20190205013025


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190205013025
SQL开始执行时间：20190205013025

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190205013025
SQL开始执行时间：20190205013025
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190205013025
SQL开始执行时间：20190205013025

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190205013025
SQL开始执行时间：20190205013025

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190205013026
SQL开始执行时间：20190205013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190205013026

20190206013029开始执行2019-02-05数据加载日志:
SQL开始执行时间：20190206013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190206013029
SQL开始执行时间：20190206013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190206013029
SQL开始执行时间：20190206013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190206013029
SQL开始执行时间：20190206013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190206013029
SQL开始执行时间：20190206013029

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190206013029
SQL开始执行时间：20190206013029


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190206013029

20190207013025开始执行2019-02-06数据加载日志:
SQL开始执行时间：20190207013025


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190207013026
SQL开始执行时间：20190207013026

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190207013026
SQL开始执行时间：20190207013026
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190207013026
SQL开始执行时间：20190207013026

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190207013026
SQL开始执行时间：20190207013026

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190207013026
SQL开始执行时间：20190207013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190207013026

20190208013026开始执行2019-02-07数据加载日志:
SQL开始执行时间：20190208013026


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190208013026
SQL开始执行时间：20190208013026

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190208013026
SQL开始执行时间：20190208013026
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190208013026
SQL开始执行时间：20190208013026

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190208013026
SQL开始执行时间：20190208013026

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190208013026
SQL开始执行时间：20190208013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190208013026

20190209013026开始执行2019-02-08数据加载日志:
SQL开始执行时间：20190209013026


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190209013026
SQL开始执行时间：20190209013026

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190209013026
SQL开始执行时间：20190209013026
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190209013026
SQL开始执行时间：20190209013026

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190209013026
SQL开始执行时间：20190209013026

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190209013026
SQL开始执行时间：20190209013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190209013026

20190210013025开始执行2019-02-09数据加载日志:
SQL开始执行时间：20190210013025


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190210013025
SQL开始执行时间：20190210013025

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190210013025
SQL开始执行时间：20190210013025
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190210013025
SQL开始执行时间：20190210013025

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190210013025
SQL开始执行时间：20190210013025

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190210013026
SQL开始执行时间：20190210013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190210013026

20190211013025开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190211013025


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190211013026
SQL开始执行时间：20190211013026

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190211013026
SQL开始执行时间：20190211013026
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190211013026
SQL开始执行时间：20190211013026

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190211013026
SQL开始执行时间：20190211013026

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190211013026
SQL开始执行时间：20190211013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190211013026

20190211105737开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190211105737


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190211105737
SQL开始执行时间：20190211105737

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190211105737
SQL开始执行时间：20190211105737
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190211105737
SQL开始执行时间：20190211105737

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190211105844
SQL开始执行时间：20190211105844

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190211105844
SQL开始执行时间：20190211105844


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190211105844

20190211141213开始执行2019-02-10数据加载日志:
SQL开始执行时间：20190211141213


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190211141213
SQL开始执行时间：20190211141213

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190211141213
SQL开始执行时间：20190211141213
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190211141213
SQL开始执行时间：20190211141213

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190211141307
SQL开始执行时间：20190211141307

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190211141308
SQL开始执行时间：20190211141308


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190211141308

20190212013029开始执行2019-02-11数据加载日志:
SQL开始执行时间：20190212013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190212013029
SQL开始执行时间：20190212013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190212013029
SQL开始执行时间：20190212013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190212013029
SQL开始执行时间：20190212013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190212013032
SQL开始执行时间：20190212013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190212013032
SQL开始执行时间：20190212013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190212013032

20190212130125开始执行2019-02-11数据加载日志:
SQL开始执行时间：20190212130125


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190212130125
SQL开始执行时间：20190212130125

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190212130125
SQL开始执行时间：20190212130125
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190212130125
SQL开始执行时间：20190212130125

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190212130128
SQL开始执行时间：20190212130128

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190212130128
SQL开始执行时间：20190212130128


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190212130128

20190213013030开始执行2019-02-12数据加载日志:
SQL开始执行时间：20190213013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190213013030
SQL开始执行时间：20190213013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190213013030
SQL开始执行时间：20190213013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190213013030
SQL开始执行时间：20190213013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190213013034
SQL开始执行时间：20190213013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190213013034
SQL开始执行时间：20190213013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190213013034

20190214013030开始执行2019-02-13数据加载日志:
SQL开始执行时间：20190214013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190214013030
SQL开始执行时间：20190214013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190214013030
SQL开始执行时间：20190214013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190214013030
SQL开始执行时间：20190214013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190214013034
SQL开始执行时间：20190214013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190214013034
SQL开始执行时间：20190214013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190214013034

20190215013028开始执行2019-02-14数据加载日志:
SQL开始执行时间：20190215013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190215013028
SQL开始执行时间：20190215013028

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190215013028
SQL开始执行时间：20190215013028
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190215013028
SQL开始执行时间：20190215013028

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190215013032
SQL开始执行时间：20190215013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190215013032
SQL开始执行时间：20190215013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190215013032

20190216013027开始执行2019-02-15数据加载日志:
SQL开始执行时间：20190216013027


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190216013027
SQL开始执行时间：20190216013027

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190216013027
SQL开始执行时间：20190216013027
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190216013027
SQL开始执行时间：20190216013027

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190216013032
SQL开始执行时间：20190216013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190216013032
SQL开始执行时间：20190216013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190216013032

20190217013026开始执行2019-02-16数据加载日志:
SQL开始执行时间：20190217013026


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190217013026
SQL开始执行时间：20190217013026

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190217013026
SQL开始执行时间：20190217013026
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190217013026
SQL开始执行时间：20190217013026

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190217013026
SQL开始执行时间：20190217013026

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190217013026
SQL开始执行时间：20190217013026


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190217013026

20190218013037开始执行2019-02-17数据加载日志:
SQL开始执行时间：20190218013037


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190218013037
SQL开始执行时间：20190218013037

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190218013037
SQL开始执行时间：20190218013037
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190218013037
SQL开始执行时间：20190218013037

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190218013037
SQL开始执行时间：20190218013037

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190218013038
SQL开始执行时间：20190218013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190218013038

20190219013029开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190219013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190219013029
SQL开始执行时间：20190219013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190219013029
SQL开始执行时间：20190219013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190219013029
SQL开始执行时间：20190219013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190219013032
SQL开始执行时间：20190219013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190219013032
SQL开始执行时间：20190219013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190219013032

20190219113340开始执行2019-02-18数据加载日志:
SQL开始执行时间：20190219113340


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190219113340
SQL开始执行时间：20190219113340

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190219113340
SQL开始执行时间：20190219113340
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190219113340
SQL开始执行时间：20190219113340

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190219113349
SQL开始执行时间：20190219113349

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190219113349
SQL开始执行时间：20190219113349


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190219113349

20190220013031开始执行2019-02-19数据加载日志:
SQL开始执行时间：20190220013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220013031
SQL开始执行时间：20190220013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220013031
SQL开始执行时间：20190220013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190220013031
SQL开始执行时间：20190220013031

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190220013037
SQL开始执行时间：20190220013037

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190220013037
SQL开始执行时间：20190220013037


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190220094713开始执行2019-02-19数据加载日志:
SQL开始执行时间：20190220094713


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190220094713
SQL开始执行时间：20190220094713

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190220094713
SQL开始执行时间：20190220094713
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190220094713
SQL开始执行时间：20190220094713

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190220094719
SQL开始执行时间：20190220094719

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190220094719
SQL开始执行时间：20190220094719


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190220094719

20190221013030开始执行2019-02-20数据加载日志:
SQL开始执行时间：20190221013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190221013030
SQL开始执行时间：20190221013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190221013030
SQL开始执行时间：20190221013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190221013030
SQL开始执行时间：20190221013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190221013035
SQL开始执行时间：20190221013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190221013036
SQL开始执行时间：20190221013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190221013036

20190222013028开始执行2019-02-21数据加载日志:
SQL开始执行时间：20190222013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190222013028
SQL开始执行时间：20190222013028

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190222013028
SQL开始执行时间：20190222013028
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190222013028
SQL开始执行时间：20190222013028

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190222013033
SQL开始执行时间：20190222013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190222013033
SQL开始执行时间：20190222013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,case when f.item_code is not null and a.citemname is null then f.level_three else a.citemname end 
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190222013033

20190223013028开始执行2019-02-22数据加载日志:
SQL开始执行时间：20190223013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190223013028
SQL开始执行时间：20190223013028

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190223013028
SQL开始执行时间：20190223013028
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190223013028
SQL开始执行时间：20190223013028

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190223013032
SQL开始执行时间：20190223013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190223013032
SQL开始执行时间：20190223013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190223013032

20190224013028开始执行2019-02-23数据加载日志:
SQL开始执行时间：20190224013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190224013028
SQL开始执行时间：20190224013028

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190224013028
SQL开始执行时间：20190224013028
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190224013028
SQL开始执行时间：20190224013028

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190224013028
SQL开始执行时间：20190224013028

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190224013028
SQL开始执行时间：20190224013028


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190224013028

20190225013026开始执行2019-02-24数据加载日志:
SQL开始执行时间：20190225013026


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190225013026
SQL开始执行时间：20190225013026

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190225013026
SQL开始执行时间：20190225013026
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190225013026
SQL开始执行时间：20190225013026

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190225013026
SQL开始执行时间：20190225013026

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190225013027
SQL开始执行时间：20190225013027


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190225013027

20190226013034开始执行2019-02-25数据加载日志:
SQL开始执行时间：20190226013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190226013034
SQL开始执行时间：20190226013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190226013034
SQL开始执行时间：20190226013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190226013034
SQL开始执行时间：20190226013034

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190226013046
SQL开始执行时间：20190226013046

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190226013046
SQL开始执行时间：20190226013046


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190226013046

20190227013033开始执行2019-02-26数据加载日志:
SQL开始执行时间：20190227013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190227013033
SQL开始执行时间：20190227013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190227013033
SQL开始执行时间：20190227013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190227013033
SQL开始执行时间：20190227013033

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190227013038
SQL开始执行时间：20190227013038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190227013039
SQL开始执行时间：20190227013039


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190227013039

20190228013029开始执行2019-02-27数据加载日志:
SQL开始执行时间：20190228013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190228013029
SQL开始执行时间：20190228013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190228013029
SQL开始执行时间：20190228013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190228013029
SQL开始执行时间：20190228013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190228013033
SQL开始执行时间：20190228013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190228013034
SQL开始执行时间：20190228013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190228013034

20190301013032开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301013032
SQL开始执行时间：20190301013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301013032
SQL开始执行时间：20190301013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190301013032
SQL开始执行时间：20190301013032

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190301013038
SQL开始执行时间：20190301013038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301013038
SQL开始执行时间：20190301013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190301013038

20190301094212开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301094212


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301094212
SQL开始执行时间：20190301094212

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301094212
SQL开始执行时间：20190301094212
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190301094212
SQL开始执行时间：20190301094212

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190301094222
SQL开始执行时间：20190301094222

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301094222
SQL开始执行时间：20190301094222


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190301094222

20190301113544开始执行2019-02-28数据加载日志:
SQL开始执行时间：20190301113544


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-02-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190301113545
SQL开始执行时间：20190301113545

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190301113545
SQL开始执行时间：20190301113545
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190301113545
SQL开始执行时间：20190301113545

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190301113545
SQL开始执行时间：20190301113545

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190301113546
SQL开始执行时间：20190301113546


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190301113547

20190302013033开始执行2019-03-01数据加载日志:
SQL开始执行时间：20190302013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190302013034
SQL开始执行时间：20190302013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190302013034
SQL开始执行时间：20190302013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190302013034
SQL开始执行时间：20190302013034

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190302013038
SQL开始执行时间：20190302013038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190302013038
SQL开始执行时间：20190302013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190302013038

20190303013028开始执行2019-03-02数据加载日志:
SQL开始执行时间：20190303013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190303013029
SQL开始执行时间：20190303013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190303013029
SQL开始执行时间：20190303013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190303013029
SQL开始执行时间：20190303013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190303013029
SQL开始执行时间：20190303013029

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190303013029
SQL开始执行时间：20190303013029


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190303013029

20190304013029开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190304013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190304013029
SQL开始执行时间：20190304013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190304013029
SQL开始执行时间：20190304013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190304013029
SQL开始执行时间：20190304013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190304013029
SQL开始执行时间：20190304013029

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190304013029
SQL开始执行时间：20190304013029


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190304013029

20190304161732开始执行2019-03-03数据加载日志:
SQL开始执行时间：20190304161732


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190304161732
SQL开始执行时间：20190304161732

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190304161732
SQL开始执行时间：20190304161732
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190304161732
SQL开始执行时间：20190304161732

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190304161736
SQL开始执行时间：20190304161736

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190304161737
SQL开始执行时间：20190304161737


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190304161737

20190305013031开始执行2019-03-04数据加载日志:
SQL开始执行时间：20190305013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190305013031
SQL开始执行时间：20190305013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190305013031
SQL开始执行时间：20190305013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190305013031
SQL开始执行时间：20190305013031

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190305013038
SQL开始执行时间：20190305013038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190305013038
SQL开始执行时间：20190305013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190305013038

20190306013031开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190306013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190306013031
SQL开始执行时间：20190306013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190306013031
SQL开始执行时间：20190306013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190306013031
SQL开始执行时间：20190306013031

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190306013034
SQL开始执行时间：20190306013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190306013035
SQL开始执行时间：20190306013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190306013035

20190306175249开始执行2019-03-05数据加载日志:
SQL开始执行时间：20190306175249


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190306175249
SQL开始执行时间：20190306175249

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190306175249
SQL开始执行时间：20190306175249
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190306175249
SQL开始执行时间：20190306175249

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190306175603
SQL开始执行时间：20190306175603

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190306175603
SQL开始执行时间：20190306175603


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190306175603

20190307013032开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190307013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190307013032
SQL开始执行时间：20190307013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190307013032
SQL开始执行时间：20190307013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190307013032
SQL开始执行时间：20190307013032

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190307013035
SQL开始执行时间：20190307013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190307013036
SQL开始执行时间：20190307013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190307013036

20190307171118开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190307171118


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190307171118
SQL开始执行时间：20190307171118

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190307171118
SQL开始执行时间：20190307171118
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190307171118
SQL开始执行时间：20190307171118

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190307171437
SQL开始执行时间：20190307171437

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190307171438
SQL开始执行时间：20190307171438


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190307171438

20190308013030开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190308013030
SQL开始执行时间：20190308013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190308013030
SQL开始执行时间：20190308013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190308013030
SQL开始执行时间：20190308013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190308013038
SQL开始执行时间：20190308013038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190308013038
SQL开始执行时间：20190308013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190308013039

20190308092616开始执行2019-03-06数据加载日志:
SQL开始执行时间：20190308092616


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190308092616
SQL开始执行时间：20190308092616

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190308092616
SQL开始执行时间：20190308092616
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190308092616
SQL开始执行时间：20190308092616

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190308092903
SQL开始执行时间：20190308092903

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190308092903
SQL开始执行时间：20190308092903


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190308092903

20190308094339开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190308094339


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190308094339
SQL开始执行时间：20190308094339

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190308094339
SQL开始执行时间：20190308094339
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190308094339
SQL开始执行时间：20190308094339

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190308094625
SQL开始执行时间：20190308094625

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190308094625
SQL开始执行时间：20190308094625


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190308094625

20190309013028开始执行2019-03-08数据加载日志:
SQL开始执行时间：20190309013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190309013029
SQL开始执行时间：20190309013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190309013029
SQL开始执行时间：20190309013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190309013029
SQL开始执行时间：20190309013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190309013032
SQL开始执行时间：20190309013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190309013032
SQL开始执行时间：20190309013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190309013032

20190310013027开始执行2019-03-09数据加载日志:
SQL开始执行时间：20190310013027


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190310013027
SQL开始执行时间：20190310013027

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190310013027
SQL开始执行时间：20190310013027
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190310013027
SQL开始执行时间：20190310013027

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190310013027
SQL开始执行时间：20190310013027

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190310013027
SQL开始执行时间：20190310013027


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190310013027

20190311013026开始执行2019-03-10数据加载日志:
SQL开始执行时间：20190311013027


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190311013027
SQL开始执行时间：20190311013027

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190311013027
SQL开始执行时间：20190311013027
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190311013027
SQL开始执行时间：20190311013027

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190311013027
SQL开始执行时间：20190311013027

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190311013027
SQL开始执行时间：20190311013027


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190311013027

20190312013030开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190312013030
SQL开始执行时间：20190312013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190312013030
SQL开始执行时间：20190312013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190312013030
SQL开始执行时间：20190312013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190312013037
SQL开始执行时间：20190312013037

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190312013037
SQL开始执行时间：20190312013037


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190312133341开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312133341


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190312133341
SQL开始执行时间：20190312133341

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190312133341
SQL开始执行时间：20190312133341
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190312133341
SQL开始执行时间：20190312133341

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190312133348
SQL开始执行时间：20190312133348

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190312133348
SQL开始执行时间：20190312133348


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;

20190312133853开始执行2019-03-11数据加载日志:
SQL开始执行时间：20190312133853


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190312133853
SQL开始执行时间：20190312133853

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190312133853
SQL开始执行时间：20190312133853
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190312133853
SQL开始执行时间：20190312133853

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190312133859
SQL开始执行时间：20190312133859

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190312133859
SQL开始执行时间：20190312133859


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190312133900

20190313013033开始执行2019-03-12数据加载日志:
SQL开始执行时间：20190313013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190313013033
SQL开始执行时间：20190313013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190313013033
SQL开始执行时间：20190313013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190313013033
SQL开始执行时间：20190313013033

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190313013041
SQL开始执行时间：20190313013041

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190313013041
SQL开始执行时间：20190313013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190313013042

20190314013031开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314013031
SQL开始执行时间：20190314013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314013031
SQL开始执行时间：20190314013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190314013031
SQL开始执行时间：20190314013031

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190314013034
SQL开始执行时间：20190314013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190314013034
SQL开始执行时间：20190314013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190314013034

20190314105302开始执行2019-03-13数据加载日志:
SQL开始执行时间：20190314105302


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190314105302
SQL开始执行时间：20190314105302

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190314105302
SQL开始执行时间：20190314105302
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190314105302
SQL开始执行时间：20190314105302

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190314105319
SQL开始执行时间：20190314105319

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190314105319
SQL开始执行时间：20190314105319


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190314105319

20190315013030开始执行2019-03-14数据加载日志:
SQL开始执行时间：20190315013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190315013030
SQL开始执行时间：20190315013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190315013030
SQL开始执行时间：20190315013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190315013030
SQL开始执行时间：20190315013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190315013035
SQL开始执行时间：20190315013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190315013035
SQL开始执行时间：20190315013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190315013035

20190316013029开始执行2019-03-15数据加载日志:
SQL开始执行时间：20190316013029


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190316013029
SQL开始执行时间：20190316013029

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190316013029
SQL开始执行时间：20190316013029
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190316013029
SQL开始执行时间：20190316013029

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190316013033
SQL开始执行时间：20190316013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190316013033
SQL开始执行时间：20190316013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190316013033

20190317013027开始执行2019-03-16数据加载日志:
SQL开始执行时间：20190317013027


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190317013027
SQL开始执行时间：20190317013027

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190317013027
SQL开始执行时间：20190317013027
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190317013027
SQL开始执行时间：20190317013027

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190317013027
SQL开始执行时间：20190317013027

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190317013028
SQL开始执行时间：20190317013028


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190317013028

20190318013030开始执行2019-03-17数据加载日志:
SQL开始执行时间：20190318013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190318013030
SQL开始执行时间：20190318013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190318013030
SQL开始执行时间：20190318013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190318013030
SQL开始执行时间：20190318013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190318013030
SQL开始执行时间：20190318013030

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190318013030
SQL开始执行时间：20190318013030


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190318013030

20190318094803开始执行2019-03-07数据加载日志:
SQL开始执行时间：20190318094803


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190318094803
SQL开始执行时间：20190318094803

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190318094803
SQL开始执行时间：20190318094803
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190318094803
SQL开始执行时间：20190318094803

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190318095117
SQL开始执行时间：20190318095117

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190318095117
SQL开始执行时间：20190318095117


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190318095118

20190319013030开始执行2019-03-18数据加载日志:
SQL开始执行时间：20190319013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190319013030
SQL开始执行时间：20190319013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190319013030
SQL开始执行时间：20190319013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190319013030
SQL开始执行时间：20190319013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190319013035
SQL开始执行时间：20190319013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190319013036
SQL开始执行时间：20190319013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190319013036

20190319114305开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190319114305


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190319114306
SQL开始执行时间：20190319114306

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190319114306
SQL开始执行时间：20190319114306
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190319114306
SQL开始执行时间：20190319114306

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190319114306
SQL开始执行时间：20190319114306

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190319114307
SQL开始执行时间：20190319114307


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190319114308

20190320013030开始执行2019-03-19数据加载日志:
SQL开始执行时间：20190320013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190320013030
SQL开始执行时间：20190320013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190320013030
SQL开始执行时间：20190320013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190320013030
SQL开始执行时间：20190320013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190320013034
SQL开始执行时间：20190320013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190320013035
SQL开始执行时间：20190320013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190320013035

20190321013032开始执行2019-03-20数据加载日志:
SQL开始执行时间：20190321013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190321013032
SQL开始执行时间：20190321013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190321013032
SQL开始执行时间：20190321013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190321013032
SQL开始执行时间：20190321013032

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190321013037
SQL开始执行时间：20190321013037

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190321013038
SQL开始执行时间：20190321013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190321013038

20190322013033开始执行2019-03-21数据加载日志:
SQL开始执行时间：20190322013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190322013033
SQL开始执行时间：20190322013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190322013033
SQL开始执行时间：20190322013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190322013033
SQL开始执行时间：20190322013033

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190322013037
SQL开始执行时间：20190322013037

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190322013038
SQL开始执行时间：20190322013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190322013038

20190323013031开始执行2019-03-22数据加载日志:
SQL开始执行时间：20190323013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190323013031
SQL开始执行时间：20190323013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190323013031
SQL开始执行时间：20190323013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190323013031
SQL开始执行时间：20190323013031

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190323013038
SQL开始执行时间：20190323013038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190323013038
SQL开始执行时间：20190323013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190323013038

20190324013028开始执行2019-03-23数据加载日志:
SQL开始执行时间：20190324013028


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190324013028
SQL开始执行时间：20190324013028

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190324013028
SQL开始执行时间：20190324013028
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190324013028
SQL开始执行时间：20190324013028

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190324013028
SQL开始执行时间：20190324013028

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190324013028
SQL开始执行时间：20190324013028


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190324013028

20190325013027开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325013027


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190325013027
SQL开始执行时间：20190325013027

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190325013027
SQL开始执行时间：20190325013027
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190325013027
SQL开始执行时间：20190325013027

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190325013028
SQL开始执行时间：20190325013028

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190325013028
SQL开始执行时间：20190325013028


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190325013028

20190325093551开始执行2019-03-24数据加载日志:
SQL开始执行时间：20190325093551


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190325093551
SQL开始执行时间：20190325093551

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190325093551
SQL开始执行时间：20190325093551
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190325093551
SQL开始执行时间：20190325093551

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190325093617
SQL开始执行时间：20190325093617

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190325093617
SQL开始执行时间：20190325093617


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190325093617

20190326013036开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190326013036
SQL开始执行时间：20190326013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190326013036
SQL开始执行时间：20190326013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190326013036
SQL开始执行时间：20190326013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190326013043
SQL开始执行时间：20190326013043

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190326013043
SQL开始执行时间：20190326013043


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190326013043

20190326145116开始执行2019-03-25数据加载日志:
SQL开始执行时间：20190326145116


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190326145117
SQL开始执行时间：20190326145117

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190326145117
SQL开始执行时间：20190326145117
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190326145117
SQL开始执行时间：20190326145117

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190326145145
SQL开始执行时间：20190326145145

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190326145146
SQL开始执行时间：20190326145146


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190326145146

20190327013034开始执行2019-03-26数据加载日志:
SQL开始执行时间：20190327013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190327013034
SQL开始执行时间：20190327013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190327013034
SQL开始执行时间：20190327013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190327013034
SQL开始执行时间：20190327013034

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190327013043
SQL开始执行时间：20190327013043

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190327013043
SQL开始执行时间：20190327013043


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190327013043

20190328013035开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190328013036
SQL开始执行时间：20190328013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190328013036
SQL开始执行时间：20190328013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190328013036
SQL开始执行时间：20190328013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190328013042
SQL开始执行时间：20190328013042

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190328013042
SQL开始执行时间：20190328013042


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190328013042

20190328111223开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328111223


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190328111223
SQL开始执行时间：20190328111223

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190328111223
SQL开始执行时间：20190328111223
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190328111223
SQL开始执行时间：20190328111223

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190328111236
SQL开始执行时间：20190328111236

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190328111236
SQL开始执行时间：20190328111236


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190328111236

20190328132836开始执行2019-03-27数据加载日志:
SQL开始执行时间：20190328132836


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190328132836
SQL开始执行时间：20190328132836

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190328132836
SQL开始执行时间：20190328132836
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190328132836
SQL开始执行时间：20190328132836

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190328132856
SQL开始执行时间：20190328132856

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190328132856
SQL开始执行时间：20190328132856


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190328132856

20190329013035开始执行2019-03-28数据加载日志:
SQL开始执行时间：20190329013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190329013035
SQL开始执行时间：20190329013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190329013035
SQL开始执行时间：20190329013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190329013035
SQL开始执行时间：20190329013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190329013042
SQL开始执行时间：20190329013042

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190329013042
SQL开始执行时间：20190329013042


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190329013042

20190330013036开始执行2019-03-29数据加载日志:
SQL开始执行时间：20190330013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190330013036
SQL开始执行时间：20190330013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190330013036
SQL开始执行时间：20190330013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190330013036
SQL开始执行时间：20190330013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190330013040
SQL开始执行时间：20190330013040

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190330013041
SQL开始执行时间：20190330013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190330013041

20190331013030开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190331013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190331013030
SQL开始执行时间：20190331013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190331013030
SQL开始执行时间：20190331013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190331013030
SQL开始执行时间：20190331013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190331013030
SQL开始执行时间：20190331013030

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190331013030
SQL开始执行时间：20190331013030


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190331013030

20190401013030开始执行2019-03-31数据加载日志:
SQL开始执行时间：20190401013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-31'
  and year(ddate)>=2018
;
SQL结束执行时间：20190401013030
SQL开始执行时间：20190401013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190401013030
SQL开始执行时间：20190401013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190401013030
SQL开始执行时间：20190401013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190401013030
SQL开始执行时间：20190401013030

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190401013031
SQL开始执行时间：20190401013031


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190401013031

20190401095456开始执行2019-03-30数据加载日志:
SQL开始执行时间：20190401095456


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-03-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190401095456
SQL开始执行时间：20190401095456

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190401095456
SQL开始执行时间：20190401095456
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190401095456
SQL开始执行时间：20190401095456

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190401095526
SQL开始执行时间：20190401095526

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190401095527
SQL开始执行时间：20190401095527


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190401095527

20190402013033开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190402013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190402013033
SQL开始执行时间：20190402013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190402013033
SQL开始执行时间：20190402013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190402013033
SQL开始执行时间：20190402013033

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190402013041
SQL开始执行时间：20190402013041

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190402013041
SQL开始执行时间：20190402013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190402013041

20190403013034开始执行2019-04-02数据加载日志:
SQL开始执行时间：20190403013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190403013034
SQL开始执行时间：20190403013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190403013034
SQL开始执行时间：20190403013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190403013034
SQL开始执行时间：20190403013034

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190403013041
SQL开始执行时间：20190403013041

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190403013041
SQL开始执行时间：20190403013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190403013041

20190404013036开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404013036
SQL开始执行时间：20190404013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404013036
SQL开始执行时间：20190404013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190404013036
SQL开始执行时间：20190404013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190404013042
SQL开始执行时间：20190404013042

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190404013042
SQL开始执行时间：20190404013042


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190404013042

20190404141747开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404141747


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404141747
SQL开始执行时间：20190404141747

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404141747
SQL开始执行时间：20190404141747
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190404141747
SQL开始执行时间：20190404141747

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190404141806
SQL开始执行时间：20190404141806

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190404141806
SQL开始执行时间：20190404141806


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190404141806

20190404143921开始执行2019-04-03数据加载日志:
SQL开始执行时间：20190404143921


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404143921
SQL开始执行时间：20190404143921

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404143921
SQL开始执行时间：20190404143921
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190404143921
SQL开始执行时间：20190404143921

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190404143940
SQL开始执行时间：20190404143940

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190404143940
SQL开始执行时间：20190404143940


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190404143940

20190404144301开始执行2019-04-01数据加载日志:
SQL开始执行时间：20190404144301


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190404144301
SQL开始执行时间：20190404144301

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190404144301
SQL开始执行时间：20190404144301
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190404144301
SQL开始执行时间：20190404144301

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190404144320
SQL开始执行时间：20190404144320

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190404144321
SQL开始执行时间：20190404144321


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190404144321

20190405013033开始执行2019-04-04数据加载日志:
SQL开始执行时间：20190405013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190405013033
SQL开始执行时间：20190405013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190405013033
SQL开始执行时间：20190405013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190405013033
SQL开始执行时间：20190405013033

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190405013038
SQL开始执行时间：20190405013038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190405013038
SQL开始执行时间：20190405013038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190405013038

20190406013030开始执行2019-04-05数据加载日志:
SQL开始执行时间：20190406013030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190406013030
SQL开始执行时间：20190406013030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190406013030
SQL开始执行时间：20190406013030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190406013030
SQL开始执行时间：20190406013030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190406013031
SQL开始执行时间：20190406013031

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190406013031
SQL开始执行时间：20190406013031


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190406013031

20190407013032开始执行2019-04-06数据加载日志:
SQL开始执行时间：20190407013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190407013032
SQL开始执行时间：20190407013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190407013032
SQL开始执行时间：20190407013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190407013032
SQL开始执行时间：20190407013032

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190407013032
SQL开始执行时间：20190407013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190407013033
SQL开始执行时间：20190407013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190407013033

20190408013031开始执行2019-04-07数据加载日志:
SQL开始执行时间：20190408013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190408013031
SQL开始执行时间：20190408013031

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190408013031
SQL开始执行时间：20190408013031
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190408013031
SQL开始执行时间：20190408013031

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190408013031
SQL开始执行时间：20190408013031

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190408013031
SQL开始执行时间：20190408013031


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190408013031

20190409013035开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190409013036
SQL开始执行时间：20190409013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190409013036
SQL开始执行时间：20190409013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190409013036
SQL开始执行时间：20190409013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190409013042
SQL开始执行时间：20190409013042

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190409013043
SQL开始执行时间：20190409013043


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190409013043

20190409134323开始执行2019-04-08数据加载日志:
SQL开始执行时间：20190409134323


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-08'
  and year(ddate)>=2018
;
SQL结束执行时间：20190409134323
SQL开始执行时间：20190409134323

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190409134323
SQL开始执行时间：20190409134323
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190409134323
SQL开始执行时间：20190409134323

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190409134337
SQL开始执行时间：20190409134337

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190409134337
SQL开始执行时间：20190409134337


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190409134337

20190410013038开始执行2019-04-09数据加载日志:
SQL开始执行时间：20190410013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190410013038
SQL开始执行时间：20190410013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190410013038
SQL开始执行时间：20190410013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190410013038
SQL开始执行时间：20190410013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190410013049
SQL开始执行时间：20190410013049

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190410013050
SQL开始执行时间：20190410013050


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190410013050

20190410124106开始执行1900-01-10数据加载日志:
SQL开始执行时间：20190410124106


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190410124107
SQL开始执行时间：20190410124107

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190410124107
SQL开始执行时间：20190410124107
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190410124107
SQL开始执行时间：20190410124107

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190410124107
SQL开始执行时间：20190410124107

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190410124108
SQL开始执行时间：20190410124108


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190410124109

20190411013036开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190411013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190411013036
SQL开始执行时间：20190411013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190411013036
SQL开始执行时间：20190411013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190411013036
SQL开始执行时间：20190411013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190411013040
SQL开始执行时间：20190411013040

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190411013041
SQL开始执行时间：20190411013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190411013041

20190411161024开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190411161024


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190411161024
SQL开始执行时间：20190411161024

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190411161024
SQL开始执行时间：20190411161024
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190411161025
SQL开始执行时间：20190411161025

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190411161025
SQL开始执行时间：20190411161025

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190411161025
SQL开始执行时间：20190411161025


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190411161026

20190412013034开始执行2019-04-11数据加载日志:
SQL开始执行时间：20190412013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412013034
SQL开始执行时间：20190412013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412013034
SQL开始执行时间：20190412013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190412013034
SQL开始执行时间：20190412013034

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190412013041
SQL开始执行时间：20190412013041

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190412013041
SQL开始执行时间：20190412013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190412013041

20190412095241开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190412095241


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412095241
SQL开始执行时间：20190412095241

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412095241
SQL开始执行时间：20190412095241
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190412095241
SQL开始执行时间：20190412095241

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;

20190412095701开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190412095701


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412095701
SQL开始执行时间：20190412095701

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412095701
SQL开始执行时间：20190412095701
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190412095701
SQL开始执行时间：20190412095701

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;

20190412102807开始执行2019-04-10数据加载日志:
SQL开始执行时间：20190412102807


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190412102807
SQL开始执行时间：20190412102807

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190412102807
SQL开始执行时间：20190412102807
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190412102807
SQL开始执行时间：20190412102807

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190412103250
SQL开始执行时间：20190412103250

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190412103250
SQL开始执行时间：20190412103250


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190412103251

20190413013035开始执行2019-04-12数据加载日志:
SQL开始执行时间：20190413013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190413013036
SQL开始执行时间：20190413013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190413013036
SQL开始执行时间：20190413013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190413013036
SQL开始执行时间：20190413013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190413013040
SQL开始执行时间：20190413013040

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190413013041
SQL开始执行时间：20190413013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190413013041

20190414013033开始执行2019-04-13数据加载日志:
SQL开始执行时间：20190414013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190414013033
SQL开始执行时间：20190414013033

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190414013033
SQL开始执行时间：20190414013033
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190414013033
SQL开始执行时间：20190414013033

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190414013033
SQL开始执行时间：20190414013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190414013034
SQL开始执行时间：20190414013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190414013034

20190415013031开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190415013032
SQL开始执行时间：20190415013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190415013032
SQL开始执行时间：20190415013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190415013032
SQL开始执行时间：20190415013032

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190415013032
SQL开始执行时间：20190415013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190415013032
SQL开始执行时间：20190415013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190415013032

20190415101405开始执行2019-04-14数据加载日志:
SQL开始执行时间：20190415101405


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190415101405
SQL开始执行时间：20190415101405

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190415101405
SQL开始执行时间：20190415101405
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190415101405
SQL开始执行时间：20190415101405

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190415101415
SQL开始执行时间：20190415101415

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190415101415
SQL开始执行时间：20190415101415


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190415101415

20190416013037开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416013037


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190416013037
SQL开始执行时间：20190416013037

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190416013037
SQL开始执行时间：20190416013037
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190416013037
SQL开始执行时间：20190416013037

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190416013044
SQL开始执行时间：20190416013044

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190416013044
SQL开始执行时间：20190416013044


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190416013044

20190416095148开始执行2019-04-15数据加载日志:
SQL开始执行时间：20190416095148


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190416095148
SQL开始执行时间：20190416095148

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190416095148
SQL开始执行时间：20190416095148
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190416095148
SQL开始执行时间：20190416095148

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190416095155
SQL开始执行时间：20190416095155

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190416095155
SQL开始执行时间：20190416095155


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190416095155

20190417013035开始执行2019-04-16数据加载日志:
SQL开始执行时间：20190417013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190417013035
SQL开始执行时间：20190417013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190417013035
SQL开始执行时间：20190417013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190417013035
SQL开始执行时间：20190417013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190417013040
SQL开始执行时间：20190417013040

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190417013041
SQL开始执行时间：20190417013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190417013041

20190418013035开始执行2019-04-17数据加载日志:
SQL开始执行时间：20190418013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190418013035
SQL开始执行时间：20190418013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190418013035
SQL开始执行时间：20190418013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190418013035
SQL开始执行时间：20190418013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190418013039
SQL开始执行时间：20190418013039

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190418013040
SQL开始执行时间：20190418013040


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190418013040

20190419013038开始执行2019-04-18数据加载日志:
SQL开始执行时间：20190419013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190419013038
SQL开始执行时间：20190419013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190419013038
SQL开始执行时间：20190419013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190419013038
SQL开始执行时间：20190419013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190419013045
SQL开始执行时间：20190419013045

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190419013045
SQL开始执行时间：20190419013045


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190419013045

20190420013038开始执行2019-04-19数据加载日志:
SQL开始执行时间：20190420013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190420013038
SQL开始执行时间：20190420013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190420013038
SQL开始执行时间：20190420013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190420013038
SQL开始执行时间：20190420013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190420013043
SQL开始执行时间：20190420013043

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190420013043
SQL开始执行时间：20190420013043


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190420013043

20190421013031开始执行2019-04-20数据加载日志:
SQL开始执行时间：20190421013031


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190421013032
SQL开始执行时间：20190421013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190421013032
SQL开始执行时间：20190421013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190421013032
SQL开始执行时间：20190421013032

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190421013032
SQL开始执行时间：20190421013032

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190421013032
SQL开始执行时间：20190421013032


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190421013032

20190422013040开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422013040


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190422013041
SQL开始执行时间：20190422013041

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190422013041
SQL开始执行时间：20190422013041
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190422013041
SQL开始执行时间：20190422013041

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190422013041
SQL开始执行时间：20190422013041

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190422013041
SQL开始执行时间：20190422013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190422013041

20190422112107开始执行2019-04-21数据加载日志:
SQL开始执行时间：20190422112107


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190422112107
SQL开始执行时间：20190422112107

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190422112107
SQL开始执行时间：20190422112107
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190422112107
SQL开始执行时间：20190422112107

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190422112131
SQL开始执行时间：20190422112131

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190422112131
SQL开始执行时间：20190422112131


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190422112131

20190423013038开始执行2019-04-22数据加载日志:
SQL开始执行时间：20190423013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190423013038
SQL开始执行时间：20190423013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190423013038
SQL开始执行时间：20190423013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190423013038
SQL开始执行时间：20190423013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190423013047
SQL开始执行时间：20190423013047

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190423013048
SQL开始执行时间：20190423013048


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190423013048

20190424013036开始执行2019-04-23数据加载日志:
SQL开始执行时间：20190424013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190424013036
SQL开始执行时间：20190424013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190424013036
SQL开始执行时间：20190424013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190424013036
SQL开始执行时间：20190424013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190424013044
SQL开始执行时间：20190424013044

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190424013045
SQL开始执行时间：20190424013045


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190424013045

20190425013036开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190425013036
SQL开始执行时间：20190425013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190425013036
SQL开始执行时间：20190425013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190425013036
SQL开始执行时间：20190425013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190425013043
SQL开始执行时间：20190425013043

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190425013043
SQL开始执行时间：20190425013043


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190425013043

20190425114030开始执行2019-04-24数据加载日志:
SQL开始执行时间：20190425114030


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-24'
  and year(ddate)>=2018
;
SQL结束执行时间：20190425114030
SQL开始执行时间：20190425114030

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190425114030
SQL开始执行时间：20190425114030
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190425114030
SQL开始执行时间：20190425114030

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190425114052
SQL开始执行时间：20190425114052

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190425114052
SQL开始执行时间：20190425114052


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190425114052

20190426013036开始执行2019-04-25数据加载日志:
SQL开始执行时间：20190426013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-25'
  and year(ddate)>=2018
;
SQL结束执行时间：20190426013037
SQL开始执行时间：20190426013037

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190426013037
SQL开始执行时间：20190426013037
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190426013037
SQL开始执行时间：20190426013037

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190426013045
SQL开始执行时间：20190426013045

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190426013045
SQL开始执行时间：20190426013045


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190426013045

20190427013037开始执行2019-04-26数据加载日志:
SQL开始执行时间：20190427013037


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-26'
  and year(ddate)>=2018
;
SQL结束执行时间：20190427013037
SQL开始执行时间：20190427013037

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190427013037
SQL开始执行时间：20190427013037
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190427013037
SQL开始执行时间：20190427013037

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190427013039
SQL开始执行时间：20190427013039

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190427013039
SQL开始执行时间：20190427013039


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190427013039

20190428013033开始执行2019-04-27数据加载日志:
SQL开始执行时间：20190428013033


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-27'
  and year(ddate)>=2018
;
SQL结束执行时间：20190428013034
SQL开始执行时间：20190428013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190428013034
SQL开始执行时间：20190428013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190428013034
SQL开始执行时间：20190428013034

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190428013034
SQL开始执行时间：20190428013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190428013034
SQL开始执行时间：20190428013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190428013034

20190429013038开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429013038
SQL开始执行时间：20190429013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429013038
SQL开始执行时间：20190429013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190429013038
SQL开始执行时间：20190429013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190429013045
SQL开始执行时间：20190429013045

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190429013046
SQL开始执行时间：20190429013046


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190429013046

20190429094507开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429094507


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429094507
SQL开始执行时间：20190429094507

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429094507
SQL开始执行时间：20190429094507
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190429094507
SQL开始执行时间：20190429094507

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190429094516
SQL开始执行时间：20190429094516

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190429094516
SQL开始执行时间：20190429094516


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190429094516

20190429151535开始执行2019-04-28数据加载日志:
SQL开始执行时间：20190429151535


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-28'
  and year(ddate)>=2018
;
SQL结束执行时间：20190429151535
SQL开始执行时间：20190429151535

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190429151535
SQL开始执行时间：20190429151535
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190429151535
SQL开始执行时间：20190429151535

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190429151544
SQL开始执行时间：20190429151544

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190429151544
SQL开始执行时间：20190429151544


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190429151544

20190430013038开始执行2019-04-29数据加载日志:
SQL开始执行时间：20190430013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-29'
  and year(ddate)>=2018
;
SQL结束执行时间：20190430013038
SQL开始执行时间：20190430013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190430013038
SQL开始执行时间：20190430013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190430013038
SQL开始执行时间：20190430013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190430013043
SQL开始执行时间：20190430013043

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190430013044
SQL开始执行时间：20190430013044


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190430013044

20190501013036开始执行2019-04-30数据加载日志:
SQL开始执行时间：20190501013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-04-30'
  and year(ddate)>=2018
;
SQL结束执行时间：20190501013036
SQL开始执行时间：20190501013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190501013036
SQL开始执行时间：20190501013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190501013036
SQL开始执行时间：20190501013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190501013040
SQL开始执行时间：20190501013040

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190501013041
SQL开始执行时间：20190501013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190501013041

20190502013034开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190502013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190502013034
SQL开始执行时间：20190502013034

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190502013034
SQL开始执行时间：20190502013034
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190502013034
SQL开始执行时间：20190502013034

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190502013034
SQL开始执行时间：20190502013034

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190502013034
SQL开始执行时间：20190502013034


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190502013034

20190503013032开始执行2019-05-02数据加载日志:
SQL开始执行时间：20190503013032


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-02'
  and year(ddate)>=2018
;
SQL结束执行时间：20190503013032
SQL开始执行时间：20190503013032

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190503013032
SQL开始执行时间：20190503013032
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190503013032
SQL开始执行时间：20190503013032

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190503013033
SQL开始执行时间：20190503013033

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190503013033
SQL开始执行时间：20190503013033


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190503013033

20190504013035开始执行2019-05-03数据加载日志:
SQL开始执行时间：20190504013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-03'
  and year(ddate)>=2018
;
SQL结束执行时间：20190504013035
SQL开始执行时间：20190504013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190504013035
SQL开始执行时间：20190504013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190504013035
SQL开始执行时间：20190504013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190504013036
SQL开始执行时间：20190504013036

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190504013036
SQL开始执行时间：20190504013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190504013036

20190505013035开始执行2019-05-04数据加载日志:
SQL开始执行时间：20190505013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-04'
  and year(ddate)>=2018
;
SQL结束执行时间：20190505013035
SQL开始执行时间：20190505013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190505013035
SQL开始执行时间：20190505013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190505013035
SQL开始执行时间：20190505013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190505013035
SQL开始执行时间：20190505013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190505013036
SQL开始执行时间：20190505013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190505013036

20190506013039开始执行2019-05-05数据加载日志:
SQL开始执行时间：20190506013039


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-05'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506013040
SQL开始执行时间：20190506013040

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506013040
SQL开始执行时间：20190506013040
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190506013040
SQL开始执行时间：20190506013040

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190506013048
SQL开始执行时间：20190506013048

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506013048
SQL开始执行时间：20190506013048


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190506013048

20190506092418开始执行2019-05-01数据加载日志:
SQL开始执行时间：20190506092418


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506092418
SQL开始执行时间：20190506092418

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506092418
SQL开始执行时间：20190506092418
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190506092418
SQL开始执行时间：20190506092418

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190506092511
SQL开始执行时间：20190506092511

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506092511
SQL开始执行时间：20190506092511


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190506092511

20190506152636开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190506152636


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506152637
SQL开始执行时间：20190506152637

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506152637
SQL开始执行时间：20190506152637
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190506152637
SQL开始执行时间：20190506152637

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190506152637
SQL开始执行时间：20190506152637

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506152638
SQL开始执行时间：20190506152638


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,a.true_itemcode
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select item_code,level_three from edw.map_item group by item_code) f
    on a.true_itemcode = f.item_code

;
SQL结束执行时间：20190506152639

20190506153540开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190506153540


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506153542
SQL开始执行时间：20190506153542

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506153542
SQL开始执行时间：20190506153542
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190506153542
SQL开始执行时间：20190506153542

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;

20190506154036开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190506154036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
;
SQL结束执行时间：20190506154037
SQL开始执行时间：20190506154037

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190506154037
SQL开始执行时间：20190506154037
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190506154037
SQL开始执行时间：20190506154037

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190506154037
SQL开始执行时间：20190506154037

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190506154038
SQL开始执行时间：20190506154038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190506154039

20190507013034开始执行2019-05-06数据加载日志:
SQL开始执行时间：20190507013034


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-06'
  and year(ddate)>=2018
;
SQL结束执行时间：20190507013035
SQL开始执行时间：20190507013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190507013035
SQL开始执行时间：20190507013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190507013035
SQL开始执行时间：20190507013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190507013039
SQL开始执行时间：20190507013039

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190507013039
SQL开始执行时间：20190507013039


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190507013039

20190508013035开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190508013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190508013035
SQL开始执行时间：20190508013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190508013035
SQL开始执行时间：20190508013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190508013035
SQL开始执行时间：20190508013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190508013040
SQL开始执行时间：20190508013040

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190508013040
SQL开始执行时间：20190508013040


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190508013041

20190509175508开始执行2019-05-07数据加载日志:
SQL开始执行时间：20190509175508


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-07'
  and year(ddate)>=2018
;
SQL结束执行时间：20190509175508
SQL开始执行时间：20190509175508

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190509175508
SQL开始执行时间：20190509175508
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190509175508
SQL开始执行时间：20190509175508

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190509175527
SQL开始执行时间：20190509175527

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190509175528
SQL开始执行时间：20190509175528


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190509175528

20190510013038开始执行2019-05-09数据加载日志:
SQL开始执行时间：20190510013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-09'
  and year(ddate)>=2018
;
SQL结束执行时间：20190510013038
SQL开始执行时间：20190510013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190510013038
SQL开始执行时间：20190510013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190510013038
SQL开始执行时间：20190510013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190510013044
SQL开始执行时间：20190510013044

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190510013044
SQL开始执行时间：20190510013044


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190510013044

20190511013039开始执行2019-05-10数据加载日志:
SQL开始执行时间：20190511013039


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-10'
  and year(ddate)>=2018
;
SQL结束执行时间：20190511013039
SQL开始执行时间：20190511013039

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190511013039
SQL开始执行时间：20190511013039
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190511013039
SQL开始执行时间：20190511013039

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190511013042
SQL开始执行时间：20190511013042

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190511013042
SQL开始执行时间：20190511013042


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190511013042

20190512013035开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190512013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190512013035
SQL开始执行时间：20190512013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190512013035
SQL开始执行时间：20190512013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190512013035
SQL开始执行时间：20190512013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190512013035
SQL开始执行时间：20190512013035

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190512013035
SQL开始执行时间：20190512013035


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190512013035

20190513013036开始执行2019-05-12数据加载日志:
SQL开始执行时间：20190513013036


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-12'
  and year(ddate)>=2018
;
SQL结束执行时间：20190513013036
SQL开始执行时间：20190513013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190513013036
SQL开始执行时间：20190513013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190513013036
SQL开始执行时间：20190513013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190513013036
SQL开始执行时间：20190513013036

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190513013036
SQL开始执行时间：20190513013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190513013036

20190513102924开始执行2019-05-11数据加载日志:
SQL开始执行时间：20190513102924


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-11'
  and year(ddate)>=2018
;
SQL结束执行时间：20190513102924
SQL开始执行时间：20190513102924

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190513102924
SQL开始执行时间：20190513102924
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190513102924
SQL开始执行时间：20190513102924

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190513102953
SQL开始执行时间：20190513102953

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190513102953
SQL开始执行时间：20190513102953


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190513102953

20190514013040开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514013040


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190514013040
SQL开始执行时间：20190514013040

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190514013040
SQL开始执行时间：20190514013040
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190514013040
SQL开始执行时间：20190514013040

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190514013047
SQL开始执行时间：20190514013047

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190514013047
SQL开始执行时间：20190514013047


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190514013047

20190514131752开始执行2019-05-13数据加载日志:
SQL开始执行时间：20190514131752


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-13'
  and year(ddate)>=2018
;
SQL结束执行时间：20190514131752
SQL开始执行时间：20190514131752

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190514131752
SQL开始执行时间：20190514131752
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190514131752
SQL开始执行时间：20190514131752

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190514131758
SQL开始执行时间：20190514131758

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190514131758
SQL开始执行时间：20190514131758


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190514131759

20190515013037开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515013037


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190515013038
SQL开始执行时间：20190515013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190515013038
SQL开始执行时间：20190515013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190515013038
SQL开始执行时间：20190515013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190515013041
SQL开始执行时间：20190515013041

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190515013041
SQL开始执行时间：20190515013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190515013041

20190515133427开始执行2019-05-14数据加载日志:
SQL开始执行时间：20190515133427


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-14'
  and year(ddate)>=2018
;
SQL结束执行时间：20190515133427
SQL开始执行时间：20190515133427

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190515133427
SQL开始执行时间：20190515133427
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190515133427
SQL开始执行时间：20190515133427

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190515133436
SQL开始执行时间：20190515133436

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190515133436
SQL开始执行时间：20190515133436


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190515133437

20190516013038开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190516013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190516013038
SQL开始执行时间：20190516013038

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190516013038
SQL开始执行时间：20190516013038
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190516013038
SQL开始执行时间：20190516013038

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190516013041
SQL开始执行时间：20190516013041

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190516013041
SQL开始执行时间：20190516013041


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190516013041

20190517013039开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517013039


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517013039
SQL开始执行时间：20190517013039

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517013039
SQL开始执行时间：20190517013039
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190517013039
SQL开始执行时间：20190517013039

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190517013047
SQL开始执行时间：20190517013047

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190517013047
SQL开始执行时间：20190517013047


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190517013047

20190517083003开始执行2019-05-16数据加载日志:
SQL开始执行时间：20190517083003


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-16'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517083003
SQL开始执行时间：20190517083003

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517083003
SQL开始执行时间：20190517083003
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190517083003
SQL开始执行时间：20190517083003

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190517083012
SQL开始执行时间：20190517083012

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190517083012
SQL开始执行时间：20190517083012


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190517083012

20190517105638开始执行2019-05-15数据加载日志:
SQL开始执行时间：20190517105638


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-15'
  and year(ddate)>=2018
;
SQL结束执行时间：20190517105638
SQL开始执行时间：20190517105638

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190517105638
SQL开始执行时间：20190517105638
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190517105638
SQL开始执行时间：20190517105638

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190517105647
SQL开始执行时间：20190517105647

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190517105647
SQL开始执行时间：20190517105647


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190517105647

20190518013039开始执行2019-05-17数据加载日志:
SQL开始执行时间：20190518013039


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-17'
  and year(ddate)>=2018
;
SQL结束执行时间：20190518013039
SQL开始执行时间：20190518013039

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190518013039
SQL开始执行时间：20190518013039
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190518013039
SQL开始执行时间：20190518013039

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190518013049
SQL开始执行时间：20190518013049

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190518013050
SQL开始执行时间：20190518013050


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190518013050

20190519013035开始执行2019-05-18数据加载日志:
SQL开始执行时间：20190519013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-18'
  and year(ddate)>=2018
;
SQL结束执行时间：20190519013036
SQL开始执行时间：20190519013036

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190519013036
SQL开始执行时间：20190519013036
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190519013036
SQL开始执行时间：20190519013036

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190519013036
SQL开始执行时间：20190519013036

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190519013036
SQL开始执行时间：20190519013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190519013036

20190520013035开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520013035


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190520013035
SQL开始执行时间：20190520013035

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190520013035
SQL开始执行时间：20190520013035
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190520013035
SQL开始执行时间：20190520013035

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190520013036
SQL开始执行时间：20190520013036

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190520013036
SQL开始执行时间：20190520013036


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190520013036

20190520091938开始执行2019-05-19数据加载日志:
SQL开始执行时间：20190520091938


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-19'
  and year(ddate)>=2018
;
SQL结束执行时间：20190520091939
SQL开始执行时间：20190520091939

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190520091939
SQL开始执行时间：20190520091939
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190520091939
SQL开始执行时间：20190520091939

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190520091956
SQL开始执行时间：20190520091956

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190520091956
SQL开始执行时间：20190520091956


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190520091956

20190521081909开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190521081909


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190521081909
SQL开始执行时间：20190521081909

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190521081909
SQL开始执行时间：20190521081909
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190521081909
SQL开始执行时间：20190521081909

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190521081916
SQL开始执行时间：20190521081916

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190521081917
SQL开始执行时间：20190521081917


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190521081917

20190522013040开始执行2019-05-21数据加载日志:
SQL开始执行时间：20190522013040


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-21'
  and year(ddate)>=2018
;
SQL结束执行时间：20190522013040
SQL开始执行时间：20190522013040

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190522013040
SQL开始执行时间：20190522013040
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190522013040
SQL开始执行时间：20190522013040

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190522013046
SQL开始执行时间：20190522013046

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190522013046
SQL开始执行时间：20190522013046


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190522013047

20190522095505开始执行2019-05-20数据加载日志:
SQL开始执行时间：20190522095505


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-20'
  and year(ddate)>=2018
;
SQL结束执行时间：20190522095505
SQL开始执行时间：20190522095505

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190522095505
SQL开始执行时间：20190522095505
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190522095505
SQL开始执行时间：20190522095505

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190522095517
SQL开始执行时间：20190522095517

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190522095517
SQL开始执行时间：20190522095517


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190522095517

20190523013038开始执行2019-05-22数据加载日志:
SQL开始执行时间：20190523013038


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-22'
  and year(ddate)>=2018
;
SQL结束执行时间：20190523013039
SQL开始执行时间：20190523013039

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190523013039
SQL开始执行时间：20190523013039
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190523013039
SQL开始执行时间：20190523013039

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190523013043
SQL开始执行时间：20190523013043

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190523013043
SQL开始执行时间：20190523013043


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190523013043

20190524013041开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524013041


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
;
SQL结束执行时间：20190524013041
SQL开始执行时间：20190524013041

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524013041
SQL开始执行时间：20190524013041
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190524013041
SQL开始执行时间：20190524013041

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190524013047
SQL开始执行时间：20190524013047

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524013047
SQL开始执行时间：20190524013047


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524013047

20190524133016开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190524133016


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190524133016
SQL开始执行时间：20190524133016

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524133016
SQL开始执行时间：20190524133016
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190524133016
SQL开始执行时间：20190524133016

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190524133016
SQL开始执行时间：20190524133016

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524133016
SQL开始执行时间：20190524133016


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524133016
SQL开始执行时间：20190524133016


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190524133016

20190524133812开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190524133812


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190524133813
SQL开始执行时间：20190524133813

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524133813
SQL开始执行时间：20190524133813
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190524133813
SQL开始执行时间：20190524133813

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190524133813
SQL开始执行时间：20190524133813

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524133813
SQL开始执行时间：20190524133813


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524133814
SQL开始执行时间：20190524133814


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190524133823

20190524135437开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524135437


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190524135438
SQL开始执行时间：20190524135438

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524135438
SQL开始执行时间：20190524135438
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190524135438
SQL开始执行时间：20190524135438

delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;

20190524140455开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524140455


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190524140456
SQL开始执行时间：20190524140456

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524140456
SQL开始执行时间：20190524140456
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190524140456
SQL开始执行时间：20190524140456

CREATE INDEX index_outdepot_order_pre_db ON edw.outdepot_order_pre(db)
;

20190524140520开始执行2019-05-23数据加载日志:
SQL开始执行时间：20190524140520


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190524140521
SQL开始执行时间：20190524140521

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524140521
SQL开始执行时间：20190524140521
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190524140521
SQL开始执行时间：20190524140521

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190524140521
SQL开始执行时间：20190524140521
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190524140522
SQL开始执行时间：20190524140522
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190524140522
SQL开始执行时间：20190524140522

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524140522
SQL开始执行时间：20190524140522


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524140523
SQL开始执行时间：20190524140523


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190524140529

20190524141423开始执行1900-01-01数据加载日志:
SQL开始执行时间：20190524141423


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '1900-01-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190524141424
SQL开始执行时间：20190524141424

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190524141424
SQL开始执行时间：20190524141424
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190524141424
SQL开始执行时间：20190524141424

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190524141425
SQL开始执行时间：20190524141425
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190524141425
SQL开始执行时间：20190524141425
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190524141425
SQL开始执行时间：20190524141425

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190524141426
SQL开始执行时间：20190524141426


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190524141427
SQL开始执行时间：20190524141427


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190524141435

20190525013046开始执行2019-05-24数据加载日志:
SQL开始执行时间：20190525013046


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-24'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190525013046
SQL开始执行时间：20190525013046

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190525013046
SQL开始执行时间：20190525013046
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190525013046
SQL开始执行时间：20190525013046

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190525013046
SQL开始执行时间：20190525013046
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190525013046
SQL开始执行时间：20190525013046
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190525013055
SQL开始执行时间：20190525013055

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190525013055
SQL开始执行时间：20190525013055


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190525013055
SQL开始执行时间：20190525013055


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190525013120

20190526013043开始执行2019-05-25数据加载日志:
SQL开始执行时间：20190526013043


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-25'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190526013043
SQL开始执行时间：20190526013043

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190526013043
SQL开始执行时间：20190526013043
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190526013043
SQL开始执行时间：20190526013043

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190526013043
SQL开始执行时间：20190526013043
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190526013044
SQL开始执行时间：20190526013044
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190526013044
SQL开始执行时间：20190526013044

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190526013044
SQL开始执行时间：20190526013044


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190526013044
SQL开始执行时间：20190526013044


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190526013109

20190527013055开始执行2019-05-26数据加载日志:
SQL开始执行时间：20190527013055


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-26'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190527013055
SQL开始执行时间：20190527013055

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190527013055
SQL开始执行时间：20190527013055
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190527013055
SQL开始执行时间：20190527013055

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190527013055
SQL开始执行时间：20190527013055
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190527013055
SQL开始执行时间：20190527013055
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190527013055
SQL开始执行时间：20190527013055

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190527013056
SQL开始执行时间：20190527013056


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190527013056
SQL开始执行时间：20190527013056


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190527013120

20190528013048开始执行2019-05-27数据加载日志:
SQL开始执行时间：20190528013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-27'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190528013048
SQL开始执行时间：20190528013048

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190528013048
SQL开始执行时间：20190528013048
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190528013048
SQL开始执行时间：20190528013048

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190528013048
SQL开始执行时间：20190528013048
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190528013048
SQL开始执行时间：20190528013048
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190528013055
SQL开始执行时间：20190528013055

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190528013055
SQL开始执行时间：20190528013055


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190528013055
SQL开始执行时间：20190528013055


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190528013121

20190529013050开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529013050


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190529013050
SQL开始执行时间：20190529013050

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529013050
SQL开始执行时间：20190529013050
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190529013050
SQL开始执行时间：20190529013050

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190529013050
SQL开始执行时间：20190529013050
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190529013050
SQL开始执行时间：20190529013050
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190529013056
SQL开始执行时间：20190529013056

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190529013056
SQL开始执行时间：20190529013056


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190529013056
SQL开始执行时间：20190529013056


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190529013123

20190529093353开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529093353


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190529093354
SQL开始执行时间：20190529093354

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529093354
SQL开始执行时间：20190529093354
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190529093354
SQL开始执行时间：20190529093354

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190529093354
SQL开始执行时间：20190529093354
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190529093354
SQL开始执行时间：20190529093354
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190529093429
SQL开始执行时间：20190529093429

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190529093429
SQL开始执行时间：20190529093429


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190529093429
SQL开始执行时间：20190529093429


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190529093451

20190529100533开始执行2019-05-28数据加载日志:
SQL开始执行时间：20190529100533


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-28'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190529100534
SQL开始执行时间：20190529100534

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190529100534
SQL开始执行时间：20190529100534
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190529100534
SQL开始执行时间：20190529100534

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190529100534
SQL开始执行时间：20190529100534
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190529100534
SQL开始执行时间：20190529100534
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190529100620
SQL开始执行时间：20190529100620

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190529100620
SQL开始执行时间：20190529100620


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190529100620
SQL开始执行时间：20190529100620


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190529100654

20190530013046开始执行2019-05-29数据加载日志:
SQL开始执行时间：20190530013046


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-29'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190530013047
SQL开始执行时间：20190530013047

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190530013047
SQL开始执行时间：20190530013047
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190530013047
SQL开始执行时间：20190530013047

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190530013047
SQL开始执行时间：20190530013047
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190530013047
SQL开始执行时间：20190530013047
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190530013051
SQL开始执行时间：20190530013051

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190530013051
SQL开始执行时间：20190530013051


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190530013051
SQL开始执行时间：20190530013051


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190530013117

20190531013048开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-30'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190531013048
SQL开始执行时间：20190531013048

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190531013048
SQL开始执行时间：20190531013048
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190531013048
SQL开始执行时间：20190531013048

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190531013048
SQL开始执行时间：20190531013048
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190531013048
SQL开始执行时间：20190531013048
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190531013052
SQL开始执行时间：20190531013052

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190531013053
SQL开始执行时间：20190531013053


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190531013053
SQL开始执行时间：20190531013053


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190531013119

20190531100620开始执行2019-05-30数据加载日志:
SQL开始执行时间：20190531100620


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-30'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190531100620
SQL开始执行时间：20190531100620

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190531100620
SQL开始执行时间：20190531100620
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190531100620
SQL开始执行时间：20190531100620

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190531100621
SQL开始执行时间：20190531100621
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190531100621
SQL开始执行时间：20190531100621
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190531100639
SQL开始执行时间：20190531100639

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190531100639
SQL开始执行时间：20190531100639


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190531100639
SQL开始执行时间：20190531100639


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190531100700

20190601013046开始执行2019-05-31数据加载日志:
SQL开始执行时间：20190601013046


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-05-31'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190601013046
SQL开始执行时间：20190601013046

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190601013046
SQL开始执行时间：20190601013046
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190601013046
SQL开始执行时间：20190601013046

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190601013046
SQL开始执行时间：20190601013046
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190601013046
SQL开始执行时间：20190601013046
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190601013050
SQL开始执行时间：20190601013050

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190601013050
SQL开始执行时间：20190601013050


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190601013050
SQL开始执行时间：20190601013050


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190601013117

20190602013043开始执行2019-06-01数据加载日志:
SQL开始执行时间：20190602013043


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190602013043
SQL开始执行时间：20190602013043

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190602013043
SQL开始执行时间：20190602013043
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190602013043
SQL开始执行时间：20190602013043

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190602013043
SQL开始执行时间：20190602013043
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190602013043
SQL开始执行时间：20190602013043
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190602013044
SQL开始执行时间：20190602013044

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190602013044
SQL开始执行时间：20190602013044


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190602013044
SQL开始执行时间：20190602013044


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190602013109

20190603013046开始执行2019-06-02数据加载日志:
SQL开始执行时间：20190603013046


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-02'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190603013046
SQL开始执行时间：20190603013046

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190603013046
SQL开始执行时间：20190603013046
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190603013046
SQL开始执行时间：20190603013046

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190603013046
SQL开始执行时间：20190603013046
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190603013046
SQL开始执行时间：20190603013046
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190603013047
SQL开始执行时间：20190603013047

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190603013047
SQL开始执行时间：20190603013047


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190603013047
SQL开始执行时间：20190603013047


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190603013113

20190604013047开始执行2019-06-03数据加载日志:
SQL开始执行时间：20190604013047


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-03'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190604013047
SQL开始执行时间：20190604013047

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190604013047
SQL开始执行时间：20190604013047
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190604013047
SQL开始执行时间：20190604013047

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190604013047
SQL开始执行时间：20190604013047
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190604013047
SQL开始执行时间：20190604013047
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190604013052
SQL开始执行时间：20190604013052

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190604013053
SQL开始执行时间：20190604013053


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190604013053
SQL开始执行时间：20190604013053


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190604013121

20190605013048开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190605013048
SQL开始执行时间：20190605013048

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605013048
SQL开始执行时间：20190605013048
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190605013048
SQL开始执行时间：20190605013048

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190605013048
SQL开始执行时间：20190605013048
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190605013048
SQL开始执行时间：20190605013048
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190605013054
SQL开始执行时间：20190605013054

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190605013055
SQL开始执行时间：20190605013055


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190605013055
SQL开始执行时间：20190605013055


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190605013124

20190605113018开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605113018


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190605113018
SQL开始执行时间：20190605113018

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605113018
SQL开始执行时间：20190605113018
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190605113018
SQL开始执行时间：20190605113018

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190605113018
SQL开始执行时间：20190605113018
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190605113019
SQL开始执行时间：20190605113019
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190605113156
SQL开始执行时间：20190605113156

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190605113156
SQL开始执行时间：20190605113156


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;

20190605122538开始执行2019-06-04数据加载日志:
SQL开始执行时间：20190605122538


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190605122539
SQL开始执行时间：20190605122539

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190605122539
SQL开始执行时间：20190605122539
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190605122539
SQL开始执行时间：20190605122539

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190605122539
SQL开始执行时间：20190605122539
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190605122539
SQL开始执行时间：20190605122539
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190605122716
SQL开始执行时间：20190605122716

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190605122716
SQL开始执行时间：20190605122716


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190605122716
SQL开始执行时间：20190605122716


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190605122739

20190606013048开始执行2019-06-05数据加载日志:
SQL开始执行时间：20190606013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-05'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190606013048
SQL开始执行时间：20190606013048

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190606013048
SQL开始执行时间：20190606013048
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190606013048
SQL开始执行时间：20190606013048

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190606013048
SQL开始执行时间：20190606013048
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190606013048
SQL开始执行时间：20190606013048
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190606013054
SQL开始执行时间：20190606013054

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190606013055
SQL开始执行时间：20190606013055


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190606013055
SQL开始执行时间：20190606013055


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190606013123

20190607013048开始执行2019-06-06数据加载日志:
SQL开始执行时间：20190607013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-06'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190607013048
SQL开始执行时间：20190607013048

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190607013048
SQL开始执行时间：20190607013048
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190607013048
SQL开始执行时间：20190607013048

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190607013048
SQL开始执行时间：20190607013048
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190607013048
SQL开始执行时间：20190607013048
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190607013054
SQL开始执行时间：20190607013054

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190607013054
SQL开始执行时间：20190607013054


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190607013054
SQL开始执行时间：20190607013054


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190607013123

20190608013044开始执行2019-06-07数据加载日志:
SQL开始执行时间：20190608013044


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-07'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190608013044
SQL开始执行时间：20190608013044

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190608013044
SQL开始执行时间：20190608013044
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190608013044
SQL开始执行时间：20190608013044

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190608013044
SQL开始执行时间：20190608013044
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190608013044
SQL开始执行时间：20190608013044
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190608013045
SQL开始执行时间：20190608013045

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190608013045
SQL开始执行时间：20190608013045


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190608013045
SQL开始执行时间：20190608013045


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190608013113

20190609013059开始执行2019-06-08数据加载日志:
SQL开始执行时间：20190609013059


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-08'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190609013059
SQL开始执行时间：20190609013059

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190609013059
SQL开始执行时间：20190609013059
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190609013059
SQL开始执行时间：20190609013059

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190609013059
SQL开始执行时间：20190609013059
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190609013059
SQL开始执行时间：20190609013059
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190609013100
SQL开始执行时间：20190609013100

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190609013100
SQL开始执行时间：20190609013100


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190609013100
SQL开始执行时间：20190609013100


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190609013127

20190610013057开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190610013057
SQL开始执行时间：20190610013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610013057
SQL开始执行时间：20190610013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190610013057
SQL开始执行时间：20190610013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190610013057
SQL开始执行时间：20190610013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190610013057
SQL开始执行时间：20190610013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190610013058
SQL开始执行时间：20190610013058

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190610013058
SQL开始执行时间：20190610013058


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190610013058
SQL开始执行时间：20190610013058


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190610013127

20190610160909开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610160909


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190610160909
SQL开始执行时间：20190610160909

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610160909
SQL开始执行时间：20190610160909
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190610160909
SQL开始执行时间：20190610160909

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190610160910
SQL开始执行时间：20190610160910
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190610160910
SQL开始执行时间：20190610160910
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190610160931
SQL开始执行时间：20190610160931

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190610160931
SQL开始执行时间：20190610160931


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190610160932
SQL开始执行时间：20190610160932


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190610160955

20190610162512开始执行2019-06-09数据加载日志:
SQL开始执行时间：20190610162512


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190610162512
SQL开始执行时间：20190610162512

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190610162512
SQL开始执行时间：20190610162512
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190610162512
SQL开始执行时间：20190610162512

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190610162512
SQL开始执行时间：20190610162512
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190610162512
SQL开始执行时间：20190610162512
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190610162534
SQL开始执行时间：20190610162534

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190610162534
SQL开始执行时间：20190610162534


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190610162534
SQL开始执行时间：20190610162534


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190610162558

20190611013047开始执行2019-06-10数据加载日志:
SQL开始执行时间：20190611013047


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-10'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190611013047
SQL开始执行时间：20190611013047

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190611013047
SQL开始执行时间：20190611013047
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190611013047
SQL开始执行时间：20190611013047

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190611013047
SQL开始执行时间：20190611013047
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190611013047
SQL开始执行时间：20190611013047
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190611013051
SQL开始执行时间：20190611013051

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190611013051
SQL开始执行时间：20190611013051


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190611013051
SQL开始执行时间：20190611013051


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190611013119

20190612013048开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-11'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190612013048
SQL开始执行时间：20190612013048

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190612013048
SQL开始执行时间：20190612013048
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190612013048
SQL开始执行时间：20190612013048

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190612013048
SQL开始执行时间：20190612013048
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190612013048
SQL开始执行时间：20190612013048
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190612013054
SQL开始执行时间：20190612013054

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190612013055
SQL开始执行时间：20190612013055


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190612013055
SQL开始执行时间：20190612013055


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190612013124

20190612105931开始执行2019-06-11数据加载日志:
SQL开始执行时间：20190612105931


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-11'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190612105931
SQL开始执行时间：20190612105931

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190612105931
SQL开始执行时间：20190612105931
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190612105931
SQL开始执行时间：20190612105931

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190612105931
SQL开始执行时间：20190612105931
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190612105931
SQL开始执行时间：20190612105931
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190612105940
SQL开始执行时间：20190612105940

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190612105940
SQL开始执行时间：20190612105940


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190612105940
SQL开始执行时间：20190612105940


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190612110005

20190613013100开始执行2019-06-12数据加载日志:
SQL开始执行时间：20190613013100


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-12'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190613013100
SQL开始执行时间：20190613013100

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190613013100
SQL开始执行时间：20190613013100
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190613013100
SQL开始执行时间：20190613013100

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190613013100
SQL开始执行时间：20190613013100
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190613013100
SQL开始执行时间：20190613013100
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190613013105
SQL开始执行时间：20190613013105

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190613013105
SQL开始执行时间：20190613013105


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190613013105
SQL开始执行时间：20190613013105


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190613013131

20190614013050开始执行2019-06-13数据加载日志:
SQL开始执行时间：20190614013050


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-13'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190614013050
SQL开始执行时间：20190614013050

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190614013050
SQL开始执行时间：20190614013050
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190614013050
SQL开始执行时间：20190614013050

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190614013050
SQL开始执行时间：20190614013050
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190614013050
SQL开始执行时间：20190614013050
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190614013055
SQL开始执行时间：20190614013055

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190614013055
SQL开始执行时间：20190614013055


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190614013055
SQL开始执行时间：20190614013055


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190614013125

20190615013054开始执行2019-06-14数据加载日志:
SQL开始执行时间：20190615013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-14'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190615013054
SQL开始执行时间：20190615013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190615013054
SQL开始执行时间：20190615013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190615013054
SQL开始执行时间：20190615013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190615013054
SQL开始执行时间：20190615013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190615013054
SQL开始执行时间：20190615013054
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190615013103
SQL开始执行时间：20190615013103

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190615013104
SQL开始执行时间：20190615013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190615013104
SQL开始执行时间：20190615013104


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190615013134

20190616013048开始执行2019-06-15数据加载日志:
SQL开始执行时间：20190616013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-15'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190616013049
SQL开始执行时间：20190616013049

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190616013049
SQL开始执行时间：20190616013049
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190616013049
SQL开始执行时间：20190616013049

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190616013049
SQL开始执行时间：20190616013049
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190616013049
SQL开始执行时间：20190616013049
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190616013050
SQL开始执行时间：20190616013050

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190616013050
SQL开始执行时间：20190616013050


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190616013050
SQL开始执行时间：20190616013050


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190616013120

20190617013045开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617013045


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190617013045
SQL开始执行时间：20190617013045

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190617013045
SQL开始执行时间：20190617013045
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190617013045
SQL开始执行时间：20190617013045

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190617013045
SQL开始执行时间：20190617013045
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190617013045
SQL开始执行时间：20190617013045
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190617013046
SQL开始执行时间：20190617013046

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190617013046
SQL开始执行时间：20190617013046


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190617013046
SQL开始执行时间：20190617013046


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190617013116

20190617155550开始执行2019-06-16数据加载日志:
SQL开始执行时间：20190617155550


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190617155551
SQL开始执行时间：20190617155551

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190617155551
SQL开始执行时间：20190617155551
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190617155551
SQL开始执行时间：20190617155551

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190617155551
SQL开始执行时间：20190617155551
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190617155551
SQL开始执行时间：20190617155551
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190617155603
SQL开始执行时间：20190617155603

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190617155603
SQL开始执行时间：20190617155603


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190617155603
SQL开始执行时间：20190617155603


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190617155629

20190618013051开始执行2019-06-17数据加载日志:
SQL开始执行时间：20190618013051


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-17'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190618013051
SQL开始执行时间：20190618013051

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190618013051
SQL开始执行时间：20190618013051
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190618013051
SQL开始执行时间：20190618013051

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190618013051
SQL开始执行时间：20190618013051
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190618013051
SQL开始执行时间：20190618013051
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190618013058
SQL开始执行时间：20190618013058

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190618013059
SQL开始执行时间：20190618013059


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190618013059
SQL开始执行时间：20190618013059


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190618013127

20190619013051开始执行2019-06-18数据加载日志:
SQL开始执行时间：20190619013051


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-18'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190619013051
SQL开始执行时间：20190619013051

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190619013051
SQL开始执行时间：20190619013051
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190619013051
SQL开始执行时间：20190619013051

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190619013051
SQL开始执行时间：20190619013051
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190619013051
SQL开始执行时间：20190619013051
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190619013055
SQL开始执行时间：20190619013055

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190619013056
SQL开始执行时间：20190619013056


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190619013056
SQL开始执行时间：20190619013056


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190619013125

20190620013053开始执行2019-06-19数据加载日志:
SQL开始执行时间：20190620013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-19'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190620013053
SQL开始执行时间：20190620013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190620013053
SQL开始执行时间：20190620013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190620013053
SQL开始执行时间：20190620013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190620013053
SQL开始执行时间：20190620013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190620013053
SQL开始执行时间：20190620013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190620013058
SQL开始执行时间：20190620013058

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190620013059
SQL开始执行时间：20190620013059


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190620013059
SQL开始执行时间：20190620013059


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190620013132

20190621013054开始执行2019-06-20数据加载日志:
SQL开始执行时间：20190621013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-20'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190621013054
SQL开始执行时间：20190621013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190621013054
SQL开始执行时间：20190621013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190621013054
SQL开始执行时间：20190621013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190621013054
SQL开始执行时间：20190621013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190621013054
SQL开始执行时间：20190621013054
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190621013101
SQL开始执行时间：20190621013101

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190621013101
SQL开始执行时间：20190621013101


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190621013101
SQL开始执行时间：20190621013101


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190621013134

20190622013050开始执行2019-06-21数据加载日志:
SQL开始执行时间：20190622013050


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-21'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190622013050
SQL开始执行时间：20190622013050

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190622013050
SQL开始执行时间：20190622013050
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190622013050
SQL开始执行时间：20190622013050

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190622013050
SQL开始执行时间：20190622013050
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190622013050
SQL开始执行时间：20190622013050
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190622013101
SQL开始执行时间：20190622013101

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190622013102
SQL开始执行时间：20190622013102


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190622013102
SQL开始执行时间：20190622013102


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190622013135

20190623013048开始执行2019-06-22数据加载日志:
SQL开始执行时间：20190623013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-22'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190623013049
SQL开始执行时间：20190623013049

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190623013049
SQL开始执行时间：20190623013049
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190623013049
SQL开始执行时间：20190623013049

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190623013049
SQL开始执行时间：20190623013049
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190623013049
SQL开始执行时间：20190623013049
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190623013049
SQL开始执行时间：20190623013049

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190623013049
SQL开始执行时间：20190623013049


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190623013049
SQL开始执行时间：20190623013049


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190623013123

20190624013105开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624013105


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190624013105
SQL开始执行时间：20190624013105

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624013105
SQL开始执行时间：20190624013105
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190624013105
SQL开始执行时间：20190624013105

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190624013105
SQL开始执行时间：20190624013105
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190624013105
SQL开始执行时间：20190624013105
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190624013106
SQL开始执行时间：20190624013106

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190624013106
SQL开始执行时间：20190624013106


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190624013106
SQL开始执行时间：20190624013106


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190624013138

20190624084615开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624084615


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190624084615
SQL开始执行时间：20190624084615

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624084615
SQL开始执行时间：20190624084615
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190624084615
SQL开始执行时间：20190624084615

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190624084615
SQL开始执行时间：20190624084615
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190624084616
SQL开始执行时间：20190624084616
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190624084643
SQL开始执行时间：20190624084643

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190624084643
SQL开始执行时间：20190624084643


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190624084643
SQL开始执行时间：20190624084643


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190624084713

20190624091915开始执行2019-06-23数据加载日志:
SQL开始执行时间：20190624091915


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190624091915
SQL开始执行时间：20190624091915

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190624091915
SQL开始执行时间：20190624091915
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190624091915
SQL开始执行时间：20190624091915

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190624091915
SQL开始执行时间：20190624091915
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190624091915
SQL开始执行时间：20190624091915
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190624091942
SQL开始执行时间：20190624091942

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190624091942
SQL开始执行时间：20190624091942


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190624091942
SQL开始执行时间：20190624091942


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190624092020

20190625013053开始执行2019-06-24数据加载日志:
SQL开始执行时间：20190625013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-24'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190625013053
SQL开始执行时间：20190625013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190625013053
SQL开始执行时间：20190625013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190625013053
SQL开始执行时间：20190625013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190625013053
SQL开始执行时间：20190625013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190625013053
SQL开始执行时间：20190625013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190625013100
SQL开始执行时间：20190625013100

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190625013100
SQL开始执行时间：20190625013100


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190625013100
SQL开始执行时间：20190625013100


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190625013136

20190626013053开始执行2019-06-25数据加载日志:
SQL开始执行时间：20190626013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-25'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190626013053
SQL开始执行时间：20190626013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190626013053
SQL开始执行时间：20190626013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190626013053
SQL开始执行时间：20190626013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190626013053
SQL开始执行时间：20190626013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190626013053
SQL开始执行时间：20190626013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190626013057
SQL开始执行时间：20190626013057

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190626013058
SQL开始执行时间：20190626013058


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190626013058
SQL开始执行时间：20190626013058


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190626013139

20190627013057开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-26'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190627013057
SQL开始执行时间：20190627013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190627013057
SQL开始执行时间：20190627013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190627013057
SQL开始执行时间：20190627013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190627013057
SQL开始执行时间：20190627013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190627013057
SQL开始执行时间：20190627013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190627013109
SQL开始执行时间：20190627013109

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190627013109
SQL开始执行时间：20190627013109


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190627013109
SQL开始执行时间：20190627013109


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190627013147

20190627091832开始执行2019-06-26数据加载日志:
SQL开始执行时间：20190627091832


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-26'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190627091832
SQL开始执行时间：20190627091832

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190627091832
SQL开始执行时间：20190627091832
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190627091832
SQL开始执行时间：20190627091832

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190627091832
SQL开始执行时间：20190627091832
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190627091832
SQL开始执行时间：20190627091832
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190627091905
SQL开始执行时间：20190627091905

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190627091905
SQL开始执行时间：20190627091905


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190627091905
SQL开始执行时间：20190627091905


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190627091954

20190628013057开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190628013057
SQL开始执行时间：20190628013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628013057
SQL开始执行时间：20190628013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190628013057
SQL开始执行时间：20190628013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190628013057
SQL开始执行时间：20190628013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190628013057
SQL开始执行时间：20190628013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190628013108
SQL开始执行时间：20190628013108

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190628013109
SQL开始执行时间：20190628013109


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190628013109
SQL开始执行时间：20190628013109


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190628013148

20190628134201开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628134201


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190628134201
SQL开始执行时间：20190628134201

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628134201
SQL开始执行时间：20190628134201
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190628134201
SQL开始执行时间：20190628134201

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190628134201
SQL开始执行时间：20190628134201
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190628134201
SQL开始执行时间：20190628134201
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190628134222
SQL开始执行时间：20190628134222

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190628134222
SQL开始执行时间：20190628134222


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190628134222
SQL开始执行时间：20190628134222


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190628134313

20190628135810开始执行2019-06-27数据加载日志:
SQL开始执行时间：20190628135810


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-27'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190628135810
SQL开始执行时间：20190628135810

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190628135810
SQL开始执行时间：20190628135810
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190628135810
SQL开始执行时间：20190628135810

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190628135810
SQL开始执行时间：20190628135810
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190628135811
SQL开始执行时间：20190628135811
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190628135832
SQL开始执行时间：20190628135832

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190628135832
SQL开始执行时间：20190628135832


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190628135833
SQL开始执行时间：20190628135833


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190628135910

20190629013051开始执行2019-06-28数据加载日志:
SQL开始执行时间：20190629013051


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-28'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190629013051
SQL开始执行时间：20190629013051

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190629013051
SQL开始执行时间：20190629013051
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190629013051
SQL开始执行时间：20190629013051

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190629013051
SQL开始执行时间：20190629013051
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190629013051
SQL开始执行时间：20190629013051
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190629013055
SQL开始执行时间：20190629013055

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190629013055
SQL开始执行时间：20190629013055


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190629013055
SQL开始执行时间：20190629013055


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190629013135

20190630013051开始执行2019-06-29数据加载日志:
SQL开始执行时间：20190630013051


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-29'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190630013051
SQL开始执行时间：20190630013051

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190630013051
SQL开始执行时间：20190630013051
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190630013051
SQL开始执行时间：20190630013051

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190630013051
SQL开始执行时间：20190630013051
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190630013051
SQL开始执行时间：20190630013051
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190630013051
SQL开始执行时间：20190630013051

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190630013051
SQL开始执行时间：20190630013051


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190630013051
SQL开始执行时间：20190630013051


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190630013131

20190701013048开始执行2019-06-30数据加载日志:
SQL开始执行时间：20190701013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-06-30'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190701013048
SQL开始执行时间：20190701013048

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190701013048
SQL开始执行时间：20190701013048
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190701013048
SQL开始执行时间：20190701013048

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190701013048
SQL开始执行时间：20190701013048
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190701013048
SQL开始执行时间：20190701013048
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190701013048
SQL开始执行时间：20190701013048

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190701013049
SQL开始执行时间：20190701013049


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190701013049
SQL开始执行时间：20190701013049


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190701013128

20190702013051开始执行2019-07-01数据加载日志:
SQL开始执行时间：20190702013051


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) > '2019-07-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190702013052
SQL开始执行时间：20190702013052

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702013052
SQL开始执行时间：20190702013052
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190702013052
SQL开始执行时间：20190702013052

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190702013052
SQL开始执行时间：20190702013052
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190702013052
SQL开始执行时间：20190702013052
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190702013057
SQL开始执行时间：20190702013057

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190702013058
SQL开始执行时间：20190702013058


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190702013058
SQL开始执行时间：20190702013058


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190702013137

20190702165143开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190702165143


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190702165143
SQL开始执行时间：20190702165143

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190702165143
SQL开始执行时间：20190702165143
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190702165143
SQL开始执行时间：20190702165143

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190702165143
SQL开始执行时间：20190702165143
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190702165143
SQL开始执行时间：20190702165143
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190702165201
SQL开始执行时间：20190702165201

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190702165201
SQL开始执行时间：20190702165201


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190702165201
SQL开始执行时间：20190702165201


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190702165240

20190703013051开始执行2019-07-02数据加载日志:
SQL开始执行时间：20190703013051


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-02'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190703013051
SQL开始执行时间：20190703013051

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190703013051
SQL开始执行时间：20190703013051
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190703013051
SQL开始执行时间：20190703013051

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190703013051
SQL开始执行时间：20190703013051
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190703013051
SQL开始执行时间：20190703013051
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190703013114
SQL开始执行时间：20190703013114

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190703013114
SQL开始执行时间：20190703013114


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190703013114
SQL开始执行时间：20190703013114


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190703013153

20190703112142开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190703112142


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-03'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190703112142
SQL开始执行时间：20190703112142

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190703112142
SQL开始执行时间：20190703112142
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190703112142
SQL开始执行时间：20190703112142

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190703112142
SQL开始执行时间：20190703112142
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190703112142
SQL开始执行时间：20190703112142
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190703112153
SQL开始执行时间：20190703112153

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190703112153
SQL开始执行时间：20190703112153


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190703112153
SQL开始执行时间：20190703112153


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190703112232

20190704013050开始执行2019-07-03数据加载日志:
SQL开始执行时间：20190704013050


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-03'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190704013050
SQL开始执行时间：20190704013050

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704013050
SQL开始执行时间：20190704013050
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190704013050
SQL开始执行时间：20190704013050

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190704013050
SQL开始执行时间：20190704013050
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190704013050
SQL开始执行时间：20190704013050
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190704013104
SQL开始执行时间：20190704013104

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190704013104
SQL开始执行时间：20190704013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190704013104
SQL开始执行时间：20190704013104


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190704013144

20190704104403开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190704104403


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190704104403
SQL开始执行时间：20190704104403

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190704104403
SQL开始执行时间：20190704104403
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190704104403
SQL开始执行时间：20190704104403

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190704104403
SQL开始执行时间：20190704104403
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190704104403
SQL开始执行时间：20190704104403
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190704104411
SQL开始执行时间：20190704104411

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190704104411
SQL开始执行时间：20190704104411


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190704104411
SQL开始执行时间：20190704104411


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190704104452

20190705013053开始执行2019-07-04数据加载日志:
SQL开始执行时间：20190705013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190705013053
SQL开始执行时间：20190705013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190705013053
SQL开始执行时间：20190705013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190705013053
SQL开始执行时间：20190705013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190705013053
SQL开始执行时间：20190705013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190705013053
SQL开始执行时间：20190705013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190705013106
SQL开始执行时间：20190705013106

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190705013107
SQL开始执行时间：20190705013107


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190705013107
SQL开始执行时间：20190705013107


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190705013147

20190705101535开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190705101535


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-05'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190705101536
SQL开始执行时间：20190705101536

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190705101536
SQL开始执行时间：20190705101536
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190705101536
SQL开始执行时间：20190705101536

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190705101536
SQL开始执行时间：20190705101536
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190705101536
SQL开始执行时间：20190705101536
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190705101541
SQL开始执行时间：20190705101541

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190705101541
SQL开始执行时间：20190705101541


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190705101541
SQL开始执行时间：20190705101541


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190705101622

20190706013054开始执行2019-07-05数据加载日志:
SQL开始执行时间：20190706013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-05'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190706013054
SQL开始执行时间：20190706013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190706013054
SQL开始执行时间：20190706013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190706013054
SQL开始执行时间：20190706013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190706013054
SQL开始执行时间：20190706013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190706013054
SQL开始执行时间：20190706013054
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190706013106
SQL开始执行时间：20190706013106

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190706013106
SQL开始执行时间：20190706013106


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190706013106
SQL开始执行时间：20190706013106


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190706013148

20190707013052开始执行2019-07-06数据加载日志:
SQL开始执行时间：20190707013052


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-06'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190707013052
SQL开始执行时间：20190707013052

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190707013052
SQL开始执行时间：20190707013052
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190707013052
SQL开始执行时间：20190707013052

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190707013052
SQL开始执行时间：20190707013052
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190707013052
SQL开始执行时间：20190707013052
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190707013100
SQL开始执行时间：20190707013100

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190707013100
SQL开始执行时间：20190707013100


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190707013100
SQL开始执行时间：20190707013100


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190707013141

20190708013048开始执行2019-07-07数据加载日志:
SQL开始执行时间：20190708013048


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-07'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190708013049
SQL开始执行时间：20190708013049

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190708013049
SQL开始执行时间：20190708013049
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190708013049
SQL开始执行时间：20190708013049

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190708013049
SQL开始执行时间：20190708013049
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190708013049
SQL开始执行时间：20190708013049
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190708013049
SQL开始执行时间：20190708013049

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190708013049
SQL开始执行时间：20190708013049


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190708013049
SQL开始执行时间：20190708013049


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190708013130

20190708091241开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190708091241


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-08'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190708091242
SQL开始执行时间：20190708091242

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190708091242
SQL开始执行时间：20190708091242
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190708091242
SQL开始执行时间：20190708091242

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190708091242
SQL开始执行时间：20190708091242
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190708091242
SQL开始执行时间：20190708091242
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190708091254
SQL开始执行时间：20190708091254

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190708091254
SQL开始执行时间：20190708091254


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190708091254
SQL开始执行时间：20190708091254


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190708091335

20190709013056开始执行2019-07-08数据加载日志:
SQL开始执行时间：20190709013056


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-08'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190709013056
SQL开始执行时间：20190709013056

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190709013056
SQL开始执行时间：20190709013056
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190709013056
SQL开始执行时间：20190709013056

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190709013056
SQL开始执行时间：20190709013056
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190709013056
SQL开始执行时间：20190709013056
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190709013112
SQL开始执行时间：20190709013112

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190709013112
SQL开始执行时间：20190709013112


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190709013112
SQL开始执行时间：20190709013112


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190709013154

20190709103505开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190709103505


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190709103505
SQL开始执行时间：20190709103505

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190709103505
SQL开始执行时间：20190709103505
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190709103505
SQL开始执行时间：20190709103505

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190709103505
SQL开始执行时间：20190709103505
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190709103505
SQL开始执行时间：20190709103505
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190709103509
SQL开始执行时间：20190709103509

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190709103510
SQL开始执行时间：20190709103510


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190709103510
SQL开始执行时间：20190709103510


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190709103552

20190710013055开始执行2019-07-09数据加载日志:
SQL开始执行时间：20190710013055


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190710013055
SQL开始执行时间：20190710013055

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190710013055
SQL开始执行时间：20190710013055
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190710013055
SQL开始执行时间：20190710013055

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190710013055
SQL开始执行时间：20190710013055
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190710013055
SQL开始执行时间：20190710013055
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190710013103
SQL开始执行时间：20190710013103

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190710013103
SQL开始执行时间：20190710013103


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190710013103
SQL开始执行时间：20190710013103


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190710013144

20190710085936开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190710085936


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-10'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190710085936
SQL开始执行时间：20190710085936

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190710085936
SQL开始执行时间：20190710085936
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190710085936
SQL开始执行时间：20190710085936

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190710085936
SQL开始执行时间：20190710085936
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190710085936
SQL开始执行时间：20190710085936
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190710085943
SQL开始执行时间：20190710085943

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190710085944
SQL开始执行时间：20190710085944


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190710085944
SQL开始执行时间：20190710085944


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190710090026

20190711013057开始执行2019-07-10数据加载日志:
SQL开始执行时间：20190711013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-10'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190711013057
SQL开始执行时间：20190711013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190711013057
SQL开始执行时间：20190711013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190711013057
SQL开始执行时间：20190711013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190711013057
SQL开始执行时间：20190711013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190711013057
SQL开始执行时间：20190711013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190711013109
SQL开始执行时间：20190711013109

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190711013110
SQL开始执行时间：20190711013110


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190711013110
SQL开始执行时间：20190711013110


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190711013151

20190711090922开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190711090922


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-11'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190711090922
SQL开始执行时间：20190711090922

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190711090922
SQL开始执行时间：20190711090922
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190711090922
SQL开始执行时间：20190711090922

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190711090922
SQL开始执行时间：20190711090922
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190711090922
SQL开始执行时间：20190711090922
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190711090930
SQL开始执行时间：20190711090930

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190711090931
SQL开始执行时间：20190711090931


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190711090931
SQL开始执行时间：20190711090931


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190711091012

20190712013053开始执行2019-07-11数据加载日志:
SQL开始执行时间：20190712013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-11'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190712013053
SQL开始执行时间：20190712013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190712013053
SQL开始执行时间：20190712013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190712013053
SQL开始执行时间：20190712013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190712013053
SQL开始执行时间：20190712013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190712013053
SQL开始执行时间：20190712013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190712013106
SQL开始执行时间：20190712013106

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190712013107
SQL开始执行时间：20190712013107


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190712013107
SQL开始执行时间：20190712013107


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190712013148

20190713013053开始执行2019-07-12数据加载日志:
SQL开始执行时间：20190713013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-12'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190713013053
SQL开始执行时间：20190713013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190713013053
SQL开始执行时间：20190713013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190713013053
SQL开始执行时间：20190713013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190713013053
SQL开始执行时间：20190713013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190713013053
SQL开始执行时间：20190713013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190713013104
SQL开始执行时间：20190713013104

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190713013104
SQL开始执行时间：20190713013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190713013105
SQL开始执行时间：20190713013105


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190713013147

20190714013053开始执行2019-07-13数据加载日志:
SQL开始执行时间：20190714013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-13'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190714013053
SQL开始执行时间：20190714013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190714013053
SQL开始执行时间：20190714013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190714013053
SQL开始执行时间：20190714013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190714013053
SQL开始执行时间：20190714013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190714013053
SQL开始执行时间：20190714013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190714013059
SQL开始执行时间：20190714013059

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190714013100
SQL开始执行时间：20190714013100


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190714013100
SQL开始执行时间：20190714013100


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190714013142

20190715013053开始执行2019-07-14数据加载日志:
SQL开始执行时间：20190715013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-14'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190715013053
SQL开始执行时间：20190715013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715013053
SQL开始执行时间：20190715013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190715013053
SQL开始执行时间：20190715013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190715013053
SQL开始执行时间：20190715013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190715013053
SQL开始执行时间：20190715013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190715013054
SQL开始执行时间：20190715013054

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190715013054
SQL开始执行时间：20190715013054


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190715013054
SQL开始执行时间：20190715013054


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190715013136

20190715131304开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190715131304


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190715131305
SQL开始执行时间：20190715131305

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190715131305
SQL开始执行时间：20190715131305
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190715131305
SQL开始执行时间：20190715131305

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190715131305
SQL开始执行时间：20190715131305
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190715131305
SQL开始执行时间：20190715131305
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190715131339
SQL开始执行时间：20190715131339

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190715131339
SQL开始执行时间：20190715131339


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190715131339
SQL开始执行时间：20190715131339


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190715131421

20190716013926开始执行2019-07-15数据加载日志:
SQL开始执行时间：20190716013926


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-15'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190716013926
SQL开始执行时间：20190716013926

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716013926
SQL开始执行时间：20190716013926
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190716013926
SQL开始执行时间：20190716013926

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190716013926
SQL开始执行时间：20190716013926
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190716013926
SQL开始执行时间：20190716013926
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190716014006
SQL开始执行时间：20190716014006

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716014006
SQL开始执行时间：20190716014006


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190716014006
SQL开始执行时间：20190716014006


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190716014048

20190716155958开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716155958


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190716155959
SQL开始执行时间：20190716155959

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716155959
SQL开始执行时间：20190716155959
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190716155959
SQL开始执行时间：20190716155959

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190716155959
SQL开始执行时间：20190716155959
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190716155959
SQL开始执行时间：20190716155959
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190716160038
SQL开始执行时间：20190716160038

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716160038
SQL开始执行时间：20190716160038


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190716160038
SQL开始执行时间：20190716160038


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190716160121

20190716161322开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716161322


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190716161322
SQL开始执行时间：20190716161322

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190716161322
SQL开始执行时间：20190716161322
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190716161322
SQL开始执行时间：20190716161322

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190716161322
SQL开始执行时间：20190716161322
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190716161322
SQL开始执行时间：20190716161322
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190716161401
SQL开始执行时间：20190716161401

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190716161402
SQL开始执行时间：20190716161402


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190716161402
SQL开始执行时间：20190716161402


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190716161443

20190716171836开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190716171836


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
  and state = '有效'
;

20190717013054开始执行2019-07-16数据加载日志:
SQL开始执行时间：20190717013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190717013054
SQL开始执行时间：20190717013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717013054
SQL开始执行时间：20190717013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190717013054
SQL开始执行时间：20190717013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190717013054
SQL开始执行时间：20190717013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190717013055
SQL开始执行时间：20190717013055
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190717013137
SQL开始执行时间：20190717013137

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190717013137
SQL开始执行时间：20190717013137


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190717013137
SQL开始执行时间：20190717013137


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190717013219

20190717090003开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190717090003


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190717090003
SQL开始执行时间：20190717090003

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190717090003
SQL开始执行时间：20190717090003
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190717090003
SQL开始执行时间：20190717090003

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190717090003
SQL开始执行时间：20190717090003
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190717090003
SQL开始执行时间：20190717090003
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190717090046
SQL开始执行时间：20190717090046

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190717090046
SQL开始执行时间：20190717090046


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190717090046
SQL开始执行时间：20190717090046


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190717090128

20190718013058开始执行2019-07-17数据加载日志:
SQL开始执行时间：20190718013058


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-17'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190718013059
SQL开始执行时间：20190718013059

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718013059
SQL开始执行时间：20190718013059
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190718013059
SQL开始执行时间：20190718013059

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190718013059
SQL开始执行时间：20190718013059
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190718013059
SQL开始执行时间：20190718013059
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190718013145
SQL开始执行时间：20190718013145

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190718013146
SQL开始执行时间：20190718013146


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190718013146
SQL开始执行时间：20190718013146


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190718013228

20190718092039开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190718092039


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190718092039
SQL开始执行时间：20190718092039

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190718092039
SQL开始执行时间：20190718092039
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190718092039
SQL开始执行时间：20190718092039

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190718092039
SQL开始执行时间：20190718092039
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190718092039
SQL开始执行时间：20190718092039
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190718092047
SQL开始执行时间：20190718092047

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190718092047
SQL开始执行时间：20190718092047


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190718092047
SQL开始执行时间：20190718092047


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190718092130

20190719013054开始执行2019-07-18数据加载日志:
SQL开始执行时间：20190719013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-18'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190719013054
SQL开始执行时间：20190719013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190719013054
SQL开始执行时间：20190719013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190719013054
SQL开始执行时间：20190719013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190719013054
SQL开始执行时间：20190719013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190719013054
SQL开始执行时间：20190719013054
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190719013104
SQL开始执行时间：20190719013104

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190719013104
SQL开始执行时间：20190719013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190719013104
SQL开始执行时间：20190719013104


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190719013145

20190720013053开始执行2019-07-19数据加载日志:
SQL开始执行时间：20190720013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-19'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190720013053
SQL开始执行时间：20190720013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190720013053
SQL开始执行时间：20190720013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190720013053
SQL开始执行时间：20190720013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190720013053
SQL开始执行时间：20190720013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190720013053
SQL开始执行时间：20190720013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190720013101
SQL开始执行时间：20190720013101

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190720013102
SQL开始执行时间：20190720013102


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190720013102
SQL开始执行时间：20190720013102


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190720013143

20190721013050开始执行2019-07-20数据加载日志:
SQL开始执行时间：20190721013050


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-20'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190721013050
SQL开始执行时间：20190721013050

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190721013050
SQL开始执行时间：20190721013050
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190721013050
SQL开始执行时间：20190721013050

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190721013050
SQL开始执行时间：20190721013050
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190721013050
SQL开始执行时间：20190721013050
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190721013057
SQL开始执行时间：20190721013057

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190721013057
SQL开始执行时间：20190721013057


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190721013057
SQL开始执行时间：20190721013057


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190721013139

20190722013050开始执行2019-07-21数据加载日志:
SQL开始执行时间：20190722013050


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-21'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190722013050
SQL开始执行时间：20190722013050

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190722013050
SQL开始执行时间：20190722013050
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190722013050
SQL开始执行时间：20190722013050

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190722013050
SQL开始执行时间：20190722013050
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190722013050
SQL开始执行时间：20190722013050
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190722013051
SQL开始执行时间：20190722013051

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190722013051
SQL开始执行时间：20190722013051


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190722013051
SQL开始执行时间：20190722013051


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190722013133

20190723013053开始执行2019-07-22数据加载日志:
SQL开始执行时间：20190723013053


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-22'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190723013053
SQL开始执行时间：20190723013053

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190723013053
SQL开始执行时间：20190723013053
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190723013053
SQL开始执行时间：20190723013053

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190723013053
SQL开始执行时间：20190723013053
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190723013053
SQL开始执行时间：20190723013053
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190723013059
SQL开始执行时间：20190723013059

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190723013100
SQL开始执行时间：20190723013100


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190723013100
SQL开始执行时间：20190723013100


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190723013142

20190723164805开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190723164805


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190723164805
SQL开始执行时间：20190723164805

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190723164805
SQL开始执行时间：20190723164805
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190723164805
SQL开始执行时间：20190723164805

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190723164805
SQL开始执行时间：20190723164805
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190723164805
SQL开始执行时间：20190723164805
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190723164819
SQL开始执行时间：20190723164819

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190723164820
SQL开始执行时间：20190723164820


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190723164820
SQL开始执行时间：20190723164820


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190723164902

20190724013054开始执行2019-07-23数据加载日志:
SQL开始执行时间：20190724013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190724013054
SQL开始执行时间：20190724013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190724013054
SQL开始执行时间：20190724013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190724013054
SQL开始执行时间：20190724013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190724013054
SQL开始执行时间：20190724013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190724013054
SQL开始执行时间：20190724013054
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190724013113
SQL开始执行时间：20190724013113

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190724013113
SQL开始执行时间：20190724013113


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190724013113
SQL开始执行时间：20190724013113


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190724013156

20190725013054开始执行2019-07-24数据加载日志:
SQL开始执行时间：20190725013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-24'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190725013054
SQL开始执行时间：20190725013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190725013054
SQL开始执行时间：20190725013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190725013054
SQL开始执行时间：20190725013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190725013054
SQL开始执行时间：20190725013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190725013054
SQL开始执行时间：20190725013054
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190725013104
SQL开始执行时间：20190725013104

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190725013104
SQL开始执行时间：20190725013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190725013104
SQL开始执行时间：20190725013104


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190725013149

20190726013054开始执行2019-07-25数据加载日志:
SQL开始执行时间：20190726013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-25'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190726013054
SQL开始执行时间：20190726013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726013054
SQL开始执行时间：20190726013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190726013054
SQL开始执行时间：20190726013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190726013054
SQL开始执行时间：20190726013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190726013054
SQL开始执行时间：20190726013054
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190726013103
SQL开始执行时间：20190726013103

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726013104
SQL开始执行时间：20190726013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190726013104
SQL开始执行时间：20190726013104


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190726013147

20190726085714开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726085714


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190726085714
SQL开始执行时间：20190726085714

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726085714
SQL开始执行时间：20190726085714
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190726085714
SQL开始执行时间：20190726085714

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190726085714
SQL开始执行时间：20190726085714
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190726085714
SQL开始执行时间：20190726085714
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190726085724
SQL开始执行时间：20190726085724

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726085724
SQL开始执行时间：20190726085724


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190726085724
SQL开始执行时间：20190726085724


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190726085809

20190726132911开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190726132911


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190726132911
SQL开始执行时间：20190726132911

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190726132911
SQL开始执行时间：20190726132911
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190726132911
SQL开始执行时间：20190726132911

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190726132911
SQL开始执行时间：20190726132911
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190726132911
SQL开始执行时间：20190726132911
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190726132922
SQL开始执行时间：20190726132922

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190726132922
SQL开始执行时间：20190726132922


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190726132922
SQL开始执行时间：20190726132922


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190726133007

20190727013056开始执行2019-07-26数据加载日志:
SQL开始执行时间：20190727013056


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-26'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190727013056
SQL开始执行时间：20190727013056

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190727013056
SQL开始执行时间：20190727013056
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190727013056
SQL开始执行时间：20190727013056

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190727013057
SQL开始执行时间：20190727013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190727013057
SQL开始执行时间：20190727013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190727013111
SQL开始执行时间：20190727013111

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190727013112
SQL开始执行时间：20190727013112


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190727013112
SQL开始执行时间：20190727013112


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190727013158

20190728013056开始执行2019-07-27数据加载日志:
SQL开始执行时间：20190728013056


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-27'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190728013056
SQL开始执行时间：20190728013056

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190728013056
SQL开始执行时间：20190728013056
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190728013056
SQL开始执行时间：20190728013056

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190728013056
SQL开始执行时间：20190728013056
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190728013056
SQL开始执行时间：20190728013056
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190728013102
SQL开始执行时间：20190728013102

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190728013102
SQL开始执行时间：20190728013102


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190728013102
SQL开始执行时间：20190728013102


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190728013149

20190729013055开始执行2019-07-28数据加载日志:
SQL开始执行时间：20190729013055


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-28'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190729013055
SQL开始执行时间：20190729013055

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729013055
SQL开始执行时间：20190729013055
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190729013055
SQL开始执行时间：20190729013055

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190729013055
SQL开始执行时间：20190729013055
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190729013055
SQL开始执行时间：20190729013055
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190729013055
SQL开始执行时间：20190729013055

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190729013056
SQL开始执行时间：20190729013056


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190729013056
SQL开始执行时间：20190729013056


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190729013142

20190729111110开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190729111110


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190729111110
SQL开始执行时间：20190729111110

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729111110
SQL开始执行时间：20190729111110
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190729111110
SQL开始执行时间：20190729111110

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190729111110
SQL开始执行时间：20190729111110
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190729111110
SQL开始执行时间：20190729111110
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190729111120
SQL开始执行时间：20190729111120

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190729111120
SQL开始执行时间：20190729111120


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190729111120
SQL开始执行时间：20190729111120


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190729111205

20190729133141开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190729133141


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190729133141
SQL开始执行时间：20190729133141

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190729133141
SQL开始执行时间：20190729133141
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190729133141
SQL开始执行时间：20190729133141

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190729133141
SQL开始执行时间：20190729133141
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190729133141
SQL开始执行时间：20190729133141
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190729133151
SQL开始执行时间：20190729133151

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190729133151
SQL开始执行时间：20190729133151


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190729133151
SQL开始执行时间：20190729133151


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190729133236

20190730013057开始执行2019-07-29数据加载日志:
SQL开始执行时间：20190730013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-29'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190730013057
SQL开始执行时间：20190730013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730013057
SQL开始执行时间：20190730013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190730013057
SQL开始执行时间：20190730013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190730013057
SQL开始执行时间：20190730013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190730013057
SQL开始执行时间：20190730013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190730013114
SQL开始执行时间：20190730013114

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190730013114
SQL开始执行时间：20190730013114


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190730013114
SQL开始执行时间：20190730013114


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190730013203

20190730090450开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190730090450


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190730090450
SQL开始执行时间：20190730090450

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730090450
SQL开始执行时间：20190730090450
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190730090450
SQL开始执行时间：20190730090450

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190730090450
SQL开始执行时间：20190730090450
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190730090450
SQL开始执行时间：20190730090450
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190730090506
SQL开始执行时间：20190730090506

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190730090507
SQL开始执行时间：20190730090507


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190730090507
SQL开始执行时间：20190730090507


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190730090553

20190730094353开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190730094353


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190730094354
SQL开始执行时间：20190730094354

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190730094354
SQL开始执行时间：20190730094354
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190730094354
SQL开始执行时间：20190730094354

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190730094354
SQL开始执行时间：20190730094354
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190730094354
SQL开始执行时间：20190730094354
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190730094410
SQL开始执行时间：20190730094410

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190730094410
SQL开始执行时间：20190730094410


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190730094410
SQL开始执行时间：20190730094410


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190730094457

20190731013057开始执行2019-07-30数据加载日志:
SQL开始执行时间：20190731013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-30'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190731013057
SQL开始执行时间：20190731013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731013057
SQL开始执行时间：20190731013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190731013057
SQL开始执行时间：20190731013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190731013057
SQL开始执行时间：20190731013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190731013057
SQL开始执行时间：20190731013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190731013116
SQL开始执行时间：20190731013116

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190731013116
SQL开始执行时间：20190731013116


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190731013116
SQL开始执行时间：20190731013116


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190731013206

20190731103719开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190731103719


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190731103720
SQL开始执行时间：20190731103720

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190731103720
SQL开始执行时间：20190731103720
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190731103720
SQL开始执行时间：20190731103720

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190731103720
SQL开始执行时间：20190731103720
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190731103720
SQL开始执行时间：20190731103720
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190731103738
SQL开始执行时间：20190731103738

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190731103739
SQL开始执行时间：20190731103739


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190731103739
SQL开始执行时间：20190731103739


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190731103828

20190801013101开始执行2019-07-31数据加载日志:
SQL开始执行时间：20190801013101


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-07-31'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190801013101
SQL开始执行时间：20190801013101

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190801013101
SQL开始执行时间：20190801013101
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190801013101
SQL开始执行时间：20190801013101

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190801013101
SQL开始执行时间：20190801013101
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190801013101
SQL开始执行时间：20190801013101
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190801013124
SQL开始执行时间：20190801013124

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190801013124
SQL开始执行时间：20190801013124


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190801013124
SQL开始执行时间：20190801013124


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190801013214

20190802013057开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190802013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190802013057
SQL开始执行时间：20190802013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190802013057
SQL开始执行时间：20190802013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190802013057
SQL开始执行时间：20190802013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190802013057
SQL开始执行时间：20190802013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190802013057
SQL开始执行时间：20190802013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190802013108
SQL开始执行时间：20190802013108

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190802013108
SQL开始执行时间：20190802013108


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190802013108
SQL开始执行时间：20190802013108


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190802013159

20190803013056开始执行2019-08-02数据加载日志:
SQL开始执行时间：20190803013056


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-02'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190803013056
SQL开始执行时间：20190803013056

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190803013056
SQL开始执行时间：20190803013056
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190803013056
SQL开始执行时间：20190803013056

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190803013056
SQL开始执行时间：20190803013056
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190803013056
SQL开始执行时间：20190803013056
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190803013104
SQL开始执行时间：20190803013104

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190803013104
SQL开始执行时间：20190803013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190803013104
SQL开始执行时间：20190803013104


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190803013158

20190804013055开始执行2019-08-03数据加载日志:
SQL开始执行时间：20190804013055


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-03'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190804013055
SQL开始执行时间：20190804013055

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190804013055
SQL开始执行时间：20190804013055
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190804013055
SQL开始执行时间：20190804013055

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190804013055
SQL开始执行时间：20190804013055
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190804013055
SQL开始执行时间：20190804013055
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190804013058
SQL开始执行时间：20190804013058

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190804013058
SQL开始执行时间：20190804013058


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190804013058
SQL开始执行时间：20190804013058


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190804013149

20190805013057开始执行2019-08-04数据加载日志:
SQL开始执行时间：20190805013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190805013057
SQL开始执行时间：20190805013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190805013057
SQL开始执行时间：20190805013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190805013057
SQL开始执行时间：20190805013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190805013057
SQL开始执行时间：20190805013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190805013057
SQL开始执行时间：20190805013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190805013057
SQL开始执行时间：20190805013057

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190805013057
SQL开始执行时间：20190805013057


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190805013057
SQL开始执行时间：20190805013057


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190805013149

20190805132355开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190805132355


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-05'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190805132355
SQL开始执行时间：20190805132355

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190805132355
SQL开始执行时间：20190805132355
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190805132355
SQL开始执行时间：20190805132355

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190805132355
SQL开始执行时间：20190805132355
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190805132355
SQL开始执行时间：20190805132355
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190805132409
SQL开始执行时间：20190805132409

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190805132409
SQL开始执行时间：20190805132409


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190805132409
SQL开始执行时间：20190805132409


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190805132500

20190806013056开始执行2019-08-05数据加载日志:
SQL开始执行时间：20190806013056


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-05'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190806013056
SQL开始执行时间：20190806013056

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190806013056
SQL开始执行时间：20190806013056
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190806013056
SQL开始执行时间：20190806013056

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190806013056
SQL开始执行时间：20190806013056
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190806013056
SQL开始执行时间：20190806013056
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190806013115
SQL开始执行时间：20190806013115

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190806013115
SQL开始执行时间：20190806013115


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190806013115
SQL开始执行时间：20190806013115


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190806013206

20190807013057开始执行2019-08-06数据加载日志:
SQL开始执行时间：20190807013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-06'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190807013058
SQL开始执行时间：20190807013058

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190807013058
SQL开始执行时间：20190807013058
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190807013058
SQL开始执行时间：20190807013058

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190807013058
SQL开始执行时间：20190807013058
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190807013058
SQL开始执行时间：20190807013058
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190807013111
SQL开始执行时间：20190807013111

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190807013111
SQL开始执行时间：20190807013111


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190807013111
SQL开始执行时间：20190807013111


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190807013202

20190807153505开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190807153505


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-07'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190807153505
SQL开始执行时间：20190807153505

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190807153505
SQL开始执行时间：20190807153505
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190807153505
SQL开始执行时间：20190807153505

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190807153505
SQL开始执行时间：20190807153505
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190807153506
SQL开始执行时间：20190807153506
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190807153518
SQL开始执行时间：20190807153518

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190807153519
SQL开始执行时间：20190807153519


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190807153519
SQL开始执行时间：20190807153519


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190807153610

20190808013056开始执行2019-08-07数据加载日志:
SQL开始执行时间：20190808013056


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-07'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190808013056
SQL开始执行时间：20190808013056

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190808013056
SQL开始执行时间：20190808013056
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190808013056
SQL开始执行时间：20190808013056

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190808013056
SQL开始执行时间：20190808013056
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190808013056
SQL开始执行时间：20190808013056
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190808013113
SQL开始执行时间：20190808013113

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190808013113
SQL开始执行时间：20190808013113


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190808013113
SQL开始执行时间：20190808013113


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190808013204

20190809013100开始执行2019-08-08数据加载日志:
SQL开始执行时间：20190809013100


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-08'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190809013100
SQL开始执行时间：20190809013100

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809013100
SQL开始执行时间：20190809013100
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190809013100
SQL开始执行时间：20190809013100

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190809013100
SQL开始执行时间：20190809013100
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190809013100
SQL开始执行时间：20190809013100
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190809013110
SQL开始执行时间：20190809013110

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190809013110
SQL开始执行时间：20190809013110


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190809013111
SQL开始执行时间：20190809013111


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190809013201

20190809111552开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190809111552


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190809111552
SQL开始执行时间：20190809111552

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809111552
SQL开始执行时间：20190809111552
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190809111552
SQL开始执行时间：20190809111552

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190809111552
SQL开始执行时间：20190809111552
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190809111552
SQL开始执行时间：20190809111552
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190809111602
SQL开始执行时间：20190809111602

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190809111603
SQL开始执行时间：20190809111603


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190809111603
SQL开始执行时间：20190809111603


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190809111654

20190809112633开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190809112633


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190809112633
SQL开始执行时间：20190809112633

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190809112633
SQL开始执行时间：20190809112633
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190809112633
SQL开始执行时间：20190809112633

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190809112633
SQL开始执行时间：20190809112633
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190809112633
SQL开始执行时间：20190809112633
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190809112643
SQL开始执行时间：20190809112643

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190809112643
SQL开始执行时间：20190809112643


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190809112643
SQL开始执行时间：20190809112643


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190809112737

20190810013059开始执行2019-08-09数据加载日志:
SQL开始执行时间：20190810013059


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190810013059
SQL开始执行时间：20190810013059

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190810013059
SQL开始执行时间：20190810013059
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190810013059
SQL开始执行时间：20190810013059

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190810013059
SQL开始执行时间：20190810013059
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190810013059
SQL开始执行时间：20190810013059
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190810013114
SQL开始执行时间：20190810013114

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190810013115
SQL开始执行时间：20190810013115


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190810013115
SQL开始执行时间：20190810013115


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190810013209

20190811013058开始执行2019-08-10数据加载日志:
SQL开始执行时间：20190811013058


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-10'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190811013058
SQL开始执行时间：20190811013058

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190811013058
SQL开始执行时间：20190811013058
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190811013058
SQL开始执行时间：20190811013058

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190811013058
SQL开始执行时间：20190811013058
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190811013058
SQL开始执行时间：20190811013058
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190811013103
SQL开始执行时间：20190811013103

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190811013104
SQL开始执行时间：20190811013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190811013104
SQL开始执行时间：20190811013104


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190811013156

20190812013058开始执行2019-08-11数据加载日志:
SQL开始执行时间：20190812013058


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-11'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190812013058
SQL开始执行时间：20190812013058

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190812013058
SQL开始执行时间：20190812013058
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190812013058
SQL开始执行时间：20190812013058

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190812013058
SQL开始执行时间：20190812013058
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190812013058
SQL开始执行时间：20190812013058
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190812013058
SQL开始执行时间：20190812013058

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190812013058
SQL开始执行时间：20190812013058


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190812013058
SQL开始执行时间：20190812013058


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190812013153

20190812090144开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190812090144


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-12'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190812090144
SQL开始执行时间：20190812090144

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190812090144
SQL开始执行时间：20190812090144
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190812090144
SQL开始执行时间：20190812090144

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190812090144
SQL开始执行时间：20190812090144
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190812090144
SQL开始执行时间：20190812090144
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190812090159
SQL开始执行时间：20190812090159

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190812090159
SQL开始执行时间：20190812090159


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190812090159
SQL开始执行时间：20190812090159


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190812090252

20190813013101开始执行2019-08-12数据加载日志:
SQL开始执行时间：20190813013101


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-12'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190813013102
SQL开始执行时间：20190813013102

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813013102
SQL开始执行时间：20190813013102
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190813013102
SQL开始执行时间：20190813013102

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190813013102
SQL开始执行时间：20190813013102
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190813013102
SQL开始执行时间：20190813013102
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190813013122
SQL开始执行时间：20190813013122

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190813013122
SQL开始执行时间：20190813013122


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190813013122
SQL开始执行时间：20190813013122


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190813013214

20190813111951开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190813111951


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190813111951
SQL开始执行时间：20190813111951

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190813111951
SQL开始执行时间：20190813111951
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190813111951
SQL开始执行时间：20190813111951

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190813111951
SQL开始执行时间：20190813111951
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190813111951
SQL开始执行时间：20190813111951
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190813112011
SQL开始执行时间：20190813112011

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190813112011
SQL开始执行时间：20190813112011


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190813112011
SQL开始执行时间：20190813112011


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190813112103

20190814013059开始执行2019-08-13数据加载日志:
SQL开始执行时间：20190814013059


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-13'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190814013100
SQL开始执行时间：20190814013100

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814013100
SQL开始执行时间：20190814013100
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190814013100
SQL开始执行时间：20190814013100

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190814013100
SQL开始执行时间：20190814013100
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190814013100
SQL开始执行时间：20190814013100
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190814013123
SQL开始执行时间：20190814013123

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190814013123
SQL开始执行时间：20190814013123


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190814013123
SQL开始执行时间：20190814013123


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190814013217

20190814092706开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190814092706


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-14'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190814092706
SQL开始执行时间：20190814092706

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814092706
SQL开始执行时间：20190814092706
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190814092706
SQL开始执行时间：20190814092706

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190814092706
SQL开始执行时间：20190814092706
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190814092706
SQL开始执行时间：20190814092706
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190814092729
SQL开始执行时间：20190814092729

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190814092729
SQL开始执行时间：20190814092729


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190814092729
SQL开始执行时间：20190814092729


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190814092823

20190814125639开始执行2019-08-01数据加载日志:
SQL开始执行时间：20190814125639


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190814125639
SQL开始执行时间：20190814125639

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190814125639
SQL开始执行时间：20190814125639
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190814125639
SQL开始执行时间：20190814125639

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190814125640
SQL开始执行时间：20190814125640
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190814125640
SQL开始执行时间：20190814125640
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190814130703
SQL开始执行时间：20190814130703

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190814130703
SQL开始执行时间：20190814130703


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190814130703
SQL开始执行时间：20190814130703


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190814130757

20190815013059开始执行2019-08-14数据加载日志:
SQL开始执行时间：20190815013059


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-14'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190815013100
SQL开始执行时间：20190815013100

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190815013100
SQL开始执行时间：20190815013100
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190815013100
SQL开始执行时间：20190815013100

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190815013101
SQL开始执行时间：20190815013101
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190815013101
SQL开始执行时间：20190815013101
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190815014133
SQL开始执行时间：20190815014133

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190815014134
SQL开始执行时间：20190815014134


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190815014134
SQL开始执行时间：20190815014134


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190815014229

20190816013057开始执行2019-08-15数据加载日志:
SQL开始执行时间：20190816013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-15'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190816013057
SQL开始执行时间：20190816013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190816013057
SQL开始执行时间：20190816013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190816013057
SQL开始执行时间：20190816013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190816013057
SQL开始执行时间：20190816013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190816013057
SQL开始执行时间：20190816013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190816013106
SQL开始执行时间：20190816013106

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190816013107
SQL开始执行时间：20190816013107


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190816013107
SQL开始执行时间：20190816013107


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190816013201

20190817013101开始执行2019-08-16数据加载日志:
SQL开始执行时间：20190817013101


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190817013102
SQL开始执行时间：20190817013102

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190817013102
SQL开始执行时间：20190817013102
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190817013102
SQL开始执行时间：20190817013102

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190817013102
SQL开始执行时间：20190817013102
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190817013102
SQL开始执行时间：20190817013102
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190817013115
SQL开始执行时间：20190817013115

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190817013116
SQL开始执行时间：20190817013116


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190817013116
SQL开始执行时间：20190817013116


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190817013211

20190818013055开始执行2019-08-17数据加载日志:
SQL开始执行时间：20190818013055


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-17'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190818013055
SQL开始执行时间：20190818013055

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190818013055
SQL开始执行时间：20190818013055
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190818013055
SQL开始执行时间：20190818013055

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190818013055
SQL开始执行时间：20190818013055
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190818013055
SQL开始执行时间：20190818013055
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190818013104
SQL开始执行时间：20190818013104

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190818013105
SQL开始执行时间：20190818013105


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190818013105
SQL开始执行时间：20190818013105


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190818013200

20190819013054开始执行2019-08-18数据加载日志:
SQL开始执行时间：20190819013054


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-18'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190819013054
SQL开始执行时间：20190819013054

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190819013054
SQL开始执行时间：20190819013054
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190819013054
SQL开始执行时间：20190819013054

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190819013054
SQL开始执行时间：20190819013054
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190819013054
SQL开始执行时间：20190819013054
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190819013054
SQL开始执行时间：20190819013054

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190819013055
SQL开始执行时间：20190819013055


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190819013055
SQL开始执行时间：20190819013055


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190819013150

20190819142637开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190819142637


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190819142638
SQL开始执行时间：20190819142638

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190819142638
SQL开始执行时间：20190819142638
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190819142638
SQL开始执行时间：20190819142638

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190819142638
SQL开始执行时间：20190819142638
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190819142638
SQL开始执行时间：20190819142638
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190819142656
SQL开始执行时间：20190819142656

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190819142656
SQL开始执行时间：20190819142656


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190819142656
SQL开始执行时间：20190819142656


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190819142751

20190820013102开始执行2019-08-19数据加载日志:
SQL开始执行时间：20190820013102


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-19'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190820013103
SQL开始执行时间：20190820013103

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190820013103
SQL开始执行时间：20190820013103
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190820013103
SQL开始执行时间：20190820013103

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190820013103
SQL开始执行时间：20190820013103
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190820013103
SQL开始执行时间：20190820013103
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190820013125
SQL开始执行时间：20190820013125

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190820013125
SQL开始执行时间：20190820013125


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190820013125
SQL开始执行时间：20190820013125


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190820013221

20190821013058开始执行2019-08-20数据加载日志:
SQL开始执行时间：20190821013058


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-20'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190821013059
SQL开始执行时间：20190821013059

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190821013059
SQL开始执行时间：20190821013059
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190821013059
SQL开始执行时间：20190821013059

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190821013059
SQL开始执行时间：20190821013059
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190821013059
SQL开始执行时间：20190821013059
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190821013107
SQL开始执行时间：20190821013107

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190821013107
SQL开始执行时间：20190821013107


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190821013107
SQL开始执行时间：20190821013107


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190821013203

20190821100526开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190821100526


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-21'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190821100526
SQL开始执行时间：20190821100526

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190821100526
SQL开始执行时间：20190821100526
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190821100526
SQL开始执行时间：20190821100526

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190821100526
SQL开始执行时间：20190821100526
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190821100526
SQL开始执行时间：20190821100526
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190821100534
SQL开始执行时间：20190821100534

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190821100535
SQL开始执行时间：20190821100535


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190821100535
SQL开始执行时间：20190821100535


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190821100631

20190822013058开始执行2019-08-21数据加载日志:
SQL开始执行时间：20190822013058


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-21'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190822013058
SQL开始执行时间：20190822013058

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190822013058
SQL开始执行时间：20190822013058
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190822013058
SQL开始执行时间：20190822013058

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190822013058
SQL开始执行时间：20190822013058
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190822013058
SQL开始执行时间：20190822013058
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190822013110
SQL开始执行时间：20190822013110

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190822013110
SQL开始执行时间：20190822013110


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190822013110
SQL开始执行时间：20190822013110


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190822013206

20190822091027开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190822091027


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-22'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190822091027
SQL开始执行时间：20190822091027

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190822091027
SQL开始执行时间：20190822091027
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190822091027
SQL开始执行时间：20190822091027

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190822091027
SQL开始执行时间：20190822091027
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190822091027
SQL开始执行时间：20190822091027
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190822091039
SQL开始执行时间：20190822091039

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190822091039
SQL开始执行时间：20190822091039


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190822091039
SQL开始执行时间：20190822091039


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190822091136

20190823013058开始执行2019-08-22数据加载日志:
SQL开始执行时间：20190823013058


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-22'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190823013058
SQL开始执行时间：20190823013058

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190823013058
SQL开始执行时间：20190823013058
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190823013058
SQL开始执行时间：20190823013058

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190823013058
SQL开始执行时间：20190823013058
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190823013058
SQL开始执行时间：20190823013058
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190823013112
SQL开始执行时间：20190823013112

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190823013112
SQL开始执行时间：20190823013112


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190823013112
SQL开始执行时间：20190823013112


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190823013208

20190823092118开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190823092118


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190823092118
SQL开始执行时间：20190823092118

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190823092118
SQL开始执行时间：20190823092118
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190823092118
SQL开始执行时间：20190823092118

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190823092118
SQL开始执行时间：20190823092118
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190823092118
SQL开始执行时间：20190823092118
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190823092124
SQL开始执行时间：20190823092124

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190823092124
SQL开始执行时间：20190823092124


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190823092124
SQL开始执行时间：20190823092124


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190823092220

20190824013103开始执行2019-08-23数据加载日志:
SQL开始执行时间：20190824013103


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190824013103
SQL开始执行时间：20190824013103

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190824013103
SQL开始执行时间：20190824013103
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190824013104
SQL开始执行时间：20190824013104

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190824013104
SQL开始执行时间：20190824013104
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190824013104
SQL开始执行时间：20190824013104
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190824013114
SQL开始执行时间：20190824013114

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190824013114
SQL开始执行时间：20190824013114


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190824013115
SQL开始执行时间：20190824013115


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190824013215

20190825013057开始执行2019-08-24数据加载日志:
SQL开始执行时间：20190825013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-24'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190825013057
SQL开始执行时间：20190825013057

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190825013057
SQL开始执行时间：20190825013057
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190825013057
SQL开始执行时间：20190825013057

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190825013057
SQL开始执行时间：20190825013057
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190825013057
SQL开始执行时间：20190825013057
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190825013102
SQL开始执行时间：20190825013102

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190825013103
SQL开始执行时间：20190825013103


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190825013103
SQL开始执行时间：20190825013103


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190825013203

20190826013059开始执行2019-08-25数据加载日志:
SQL开始执行时间：20190826013059


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-25'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190826013059
SQL开始执行时间：20190826013059

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190826013059
SQL开始执行时间：20190826013059
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190826013059
SQL开始执行时间：20190826013059

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190826013059
SQL开始执行时间：20190826013059
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190826013059
SQL开始执行时间：20190826013059
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190826013059
SQL开始执行时间：20190826013059

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190826013059
SQL开始执行时间：20190826013059


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190826013059
SQL开始执行时间：20190826013059


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190826013159

20190826093040开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190826093040


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-26'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190826093041
SQL开始执行时间：20190826093041

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190826093041
SQL开始执行时间：20190826093041
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190826093041
SQL开始执行时间：20190826093041

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190826093041
SQL开始执行时间：20190826093041
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190826093041
SQL开始执行时间：20190826093041
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190826093048
SQL开始执行时间：20190826093048

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190826093048
SQL开始执行时间：20190826093048


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190826093048
SQL开始执行时间：20190826093048


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190826093148

20190827013103开始执行2019-08-26数据加载日志:
SQL开始执行时间：20190827013103


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-26'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190827013103
SQL开始执行时间：20190827013103

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827013103
SQL开始执行时间：20190827013103
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190827013103
SQL开始执行时间：20190827013103

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190827013103
SQL开始执行时间：20190827013103
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190827013103
SQL开始执行时间：20190827013103
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190827013118
SQL开始执行时间：20190827013118

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190827013118
SQL开始执行时间：20190827013118


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190827013118
SQL开始执行时间：20190827013118


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190827013220

20190827092621开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190827092621


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190827092621
SQL开始执行时间：20190827092621

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190827092621
SQL开始执行时间：20190827092621
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190827092621
SQL开始执行时间：20190827092621

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190827092621
SQL开始执行时间：20190827092621
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190827092621
SQL开始执行时间：20190827092621
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190827092628
SQL开始执行时间：20190827092628

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190827092629
SQL开始执行时间：20190827092629


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190827092629
SQL开始执行时间：20190827092629


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190827092730

20190828013102开始执行2019-08-27数据加载日志:
SQL开始执行时间：20190828013102


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-27'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190828013102
SQL开始执行时间：20190828013102

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828013102
SQL开始执行时间：20190828013102
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190828013102
SQL开始执行时间：20190828013102

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190828013102
SQL开始执行时间：20190828013102
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190828013102
SQL开始执行时间：20190828013102
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190828013114
SQL开始执行时间：20190828013114

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190828013114
SQL开始执行时间：20190828013114


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190828013114
SQL开始执行时间：20190828013114


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190828013216

20190828093235开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190828093235


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190828093235
SQL开始执行时间：20190828093235

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190828093235
SQL开始执行时间：20190828093235
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190828093235
SQL开始执行时间：20190828093235

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190828093235
SQL开始执行时间：20190828093235
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190828093235
SQL开始执行时间：20190828093235
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190828093247
SQL开始执行时间：20190828093247

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190828093248
SQL开始执行时间：20190828093248


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190828093248
SQL开始执行时间：20190828093248


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190828093349

20190829013101开始执行2019-08-28数据加载日志:
SQL开始执行时间：20190829013101


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-28'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190829013101
SQL开始执行时间：20190829013101

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190829013101
SQL开始执行时间：20190829013101
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190829013101
SQL开始执行时间：20190829013101

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190829013101
SQL开始执行时间：20190829013101
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190829013101
SQL开始执行时间：20190829013101
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190829013114
SQL开始执行时间：20190829013114

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190829013114
SQL开始执行时间：20190829013114


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190829013115
SQL开始执行时间：20190829013115


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190829013218

20190830013104开始执行2019-08-29数据加载日志:
SQL开始执行时间：20190830013104


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-29'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190830013104
SQL开始执行时间：20190830013104

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190830013104
SQL开始执行时间：20190830013104
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190830013104
SQL开始执行时间：20190830013104

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190830013104
SQL开始执行时间：20190830013104
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190830013104
SQL开始执行时间：20190830013104
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190830013117
SQL开始执行时间：20190830013117

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190830013117
SQL开始执行时间：20190830013117


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190830013117
SQL开始执行时间：20190830013117


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190830013230

20190831013121开始执行2019-08-30数据加载日志:
SQL开始执行时间：20190831013121


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-30'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190831013121
SQL开始执行时间：20190831013121

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190831013121
SQL开始执行时间：20190831013121
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190831013121
SQL开始执行时间：20190831013121

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190831013121
SQL开始执行时间：20190831013121
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190831013121
SQL开始执行时间：20190831013121
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190831013141
SQL开始执行时间：20190831013141

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190831013141
SQL开始执行时间：20190831013141


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190831013141
SQL开始执行时间：20190831013141


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190831013254

20190901013057开始执行2019-08-31数据加载日志:
SQL开始执行时间：20190901013057


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-08-31'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190901013058
SQL开始执行时间：20190901013058

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190901013058
SQL开始执行时间：20190901013058
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190901013058
SQL开始执行时间：20190901013058

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190901013058
SQL开始执行时间：20190901013058
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190901013058
SQL开始执行时间：20190901013058
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190901013110
SQL开始执行时间：20190901013110

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190901013110
SQL开始执行时间：20190901013110


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190901013110
SQL开始执行时间：20190901013110


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190901013222

20190902013112开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902013112


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190902013112
SQL开始执行时间：20190902013112

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902013112
SQL开始执行时间：20190902013112
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190902013112
SQL开始执行时间：20190902013112

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190902013112
SQL开始执行时间：20190902013112
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190902013112
SQL开始执行时间：20190902013112
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190902013113
SQL开始执行时间：20190902013113

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190902013113
SQL开始执行时间：20190902013113


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190902013113
SQL开始执行时间：20190902013113


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190902013225

20190902150925开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902150925


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190902150925
SQL开始执行时间：20190902150925

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902150925
SQL开始执行时间：20190902150925
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190902150925
SQL开始执行时间：20190902150925

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190902150925
SQL开始执行时间：20190902150925
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190902150925
SQL开始执行时间：20190902150925
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190902150925
SQL开始执行时间：20190902150925

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190902150926
SQL开始执行时间：20190902150926


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190902150926
SQL开始执行时间：20190902150926


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;

20190902151300开始执行2019-09-01数据加载日志:
SQL开始执行时间：20190902151300


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-01'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190902151300
SQL开始执行时间：20190902151300

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190902151300
SQL开始执行时间：20190902151300
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190902151300
SQL开始执行时间：20190902151300

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190902151300
SQL开始执行时间：20190902151300
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190902151300
SQL开始执行时间：20190902151300
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190902151301
SQL开始执行时间：20190902151301

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190902151301
SQL开始执行时间：20190902151301


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190902151301
SQL开始执行时间：20190902151301


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190902151418

20190903013117开始执行2019-09-02数据加载日志:
SQL开始执行时间：20190903013117


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-02'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190903013117
SQL开始执行时间：20190903013117

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190903013117
SQL开始执行时间：20190903013117
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190903013117
SQL开始执行时间：20190903013117

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190903013117
SQL开始执行时间：20190903013117
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190903013117
SQL开始执行时间：20190903013117
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190903013125
SQL开始执行时间：20190903013125

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190903013125
SQL开始执行时间：20190903013125


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190903013125
SQL开始执行时间：20190903013125


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190903013304

20190904013102开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904013102


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190904013102
SQL开始执行时间：20190904013102

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904013102
SQL开始执行时间：20190904013102
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190904013102
SQL开始执行时间：20190904013102

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190904013102
SQL开始执行时间：20190904013102
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190904013102
SQL开始执行时间：20190904013102
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190904013110
SQL开始执行时间：20190904013110

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904013111
SQL开始执行时间：20190904013111


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904013111
SQL开始执行时间：20190904013111


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190904013224

20190904182900开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190904182900


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190904182900
SQL开始执行时间：20190904182900

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904182900
SQL开始执行时间：20190904182900
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190904182900
SQL开始执行时间：20190904182900

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190904182900
SQL开始执行时间：20190904182900
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190904182900
SQL开始执行时间：20190904182900
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190904182931
SQL开始执行时间：20190904182931

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904182931
SQL开始执行时间：20190904182931


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904182931
SQL开始执行时间：20190904182931


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190904183043

20190904194725开始执行2019-09-03数据加载日志:
SQL开始执行时间：20190904194725


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-03'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190904194725
SQL开始执行时间：20190904194725

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190904194725
SQL开始执行时间：20190904194725
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190904194725
SQL开始执行时间：20190904194725

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190904194725
SQL开始执行时间：20190904194725
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190904194725
SQL开始执行时间：20190904194725
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190904194756
SQL开始执行时间：20190904194756

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190904194756
SQL开始执行时间：20190904194756


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190904194756
SQL开始执行时间：20190904194756


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190904194910

20190905013105开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905013105


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190905013105
SQL开始执行时间：20190905013105

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905013105
SQL开始执行时间：20190905013105
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190905013105
SQL开始执行时间：20190905013105

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190905013105
SQL开始执行时间：20190905013105
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190905013105
SQL开始执行时间：20190905013105
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190905013140
SQL开始执行时间：20190905013140

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905013141
SQL开始执行时间：20190905013141


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190905013141
SQL开始执行时间：20190905013141


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190905013257

20190905103624开始执行2019-09-04数据加载日志:
SQL开始执行时间：20190905103624


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-04'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190905103625
SQL开始执行时间：20190905103625

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905103625
SQL开始执行时间：20190905103625
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190905103625
SQL开始执行时间：20190905103625

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190905103625
SQL开始执行时间：20190905103625
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190905103625
SQL开始执行时间：20190905103625
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190905103701
SQL开始执行时间：20190905103701

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905103701
SQL开始执行时间：20190905103701


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190905103702
SQL开始执行时间：20190905103702


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190905103818

20190905110712开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190905110712


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190905110713
SQL开始执行时间：20190905110713

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190905110713
SQL开始执行时间：20190905110713
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190905110713
SQL开始执行时间：20190905110713

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190905110713
SQL开始执行时间：20190905110713
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190905110713
SQL开始执行时间：20190905110713
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190905110727
SQL开始执行时间：20190905110727

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190905110727
SQL开始执行时间：20190905110727


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190905110727
SQL开始执行时间：20190905110727


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190905110844

20190906013102开始执行2019-09-05数据加载日志:
SQL开始执行时间：20190906013102


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-05'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190906013103
SQL开始执行时间：20190906013103

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190906013103
SQL开始执行时间：20190906013103
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190906013103
SQL开始执行时间：20190906013103

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190906013103
SQL开始执行时间：20190906013103
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190906013103
SQL开始执行时间：20190906013103
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190906013123
SQL开始执行时间：20190906013123

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190906013123
SQL开始执行时间：20190906013123


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190906013123
SQL开始执行时间：20190906013123


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190906013239

20190907013104开始执行2019-09-06数据加载日志:
SQL开始执行时间：20190907013104


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-06'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190907013105
SQL开始执行时间：20190907013105

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190907013105
SQL开始执行时间：20190907013105
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190907013105
SQL开始执行时间：20190907013105

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190907013105
SQL开始执行时间：20190907013105
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190907013105
SQL开始执行时间：20190907013105
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190907013118
SQL开始执行时间：20190907013118

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190907013118
SQL开始执行时间：20190907013118


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190907013118
SQL开始执行时间：20190907013118


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190907013235

20190908013100开始执行2019-09-07数据加载日志:
SQL开始执行时间：20190908013100


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-07'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190908013100
SQL开始执行时间：20190908013100

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190908013100
SQL开始执行时间：20190908013100
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190908013100
SQL开始执行时间：20190908013100

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190908013100
SQL开始执行时间：20190908013100
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190908013100
SQL开始执行时间：20190908013100
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190908013108
SQL开始执行时间：20190908013108

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190908013108
SQL开始执行时间：20190908013108


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190908013108
SQL开始执行时间：20190908013108


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190908013225

20190909013103开始执行2019-09-08数据加载日志:
SQL开始执行时间：20190909013103


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-08'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190909013103
SQL开始执行时间：20190909013103

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909013103
SQL开始执行时间：20190909013103
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190909013103
SQL开始执行时间：20190909013103

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190909013103
SQL开始执行时间：20190909013103
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190909013103
SQL开始执行时间：20190909013103
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190909013104
SQL开始执行时间：20190909013104

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190909013104
SQL开始执行时间：20190909013104


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190909013105
SQL开始执行时间：20190909013105


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190909013220

20190909090650开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190909090650


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190909090650
SQL开始执行时间：20190909090650

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190909090650
SQL开始执行时间：20190909090650
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190909090650
SQL开始执行时间：20190909090650

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190909090651
SQL开始执行时间：20190909090651
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190909090651
SQL开始执行时间：20190909090651
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190909090710
SQL开始执行时间：20190909090710

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190909090710
SQL开始执行时间：20190909090710


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190909090711
SQL开始执行时间：20190909090711


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190909090827

20190910013105开始执行2019-09-09数据加载日志:
SQL开始执行时间：20190910013105


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-09'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190910013105
SQL开始执行时间：20190910013105

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910013105
SQL开始执行时间：20190910013105
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190910013105
SQL开始执行时间：20190910013105

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190910013105
SQL开始执行时间：20190910013105
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190910013105
SQL开始执行时间：20190910013105
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190910013130
SQL开始执行时间：20190910013130

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190910013130
SQL开始执行时间：20190910013130


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190910013130
SQL开始执行时间：20190910013130


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190910013247

20190910101613开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190910101613


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190910101613
SQL开始执行时间：20190910101613

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190910101613
SQL开始执行时间：20190910101613
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190910101613
SQL开始执行时间：20190910101613

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190910101613
SQL开始执行时间：20190910101613
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190910101613
SQL开始执行时间：20190910101613
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190910101620
SQL开始执行时间：20190910101620

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190910101621
SQL开始执行时间：20190910101621


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190910101621
SQL开始执行时间：20190910101621


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190910101737

20190911013105开始执行2019-09-10数据加载日志:
SQL开始执行时间：20190911013105


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-10'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190911013105
SQL开始执行时间：20190911013105

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190911013105
SQL开始执行时间：20190911013105
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190911013105
SQL开始执行时间：20190911013105

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190911013106
SQL开始执行时间：20190911013106
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190911013106
SQL开始执行时间：20190911013106
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190911013118
SQL开始执行时间：20190911013118

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190911013118
SQL开始执行时间：20190911013118


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190911013119
SQL开始执行时间：20190911013119


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190911013235

20190912013105开始执行2019-09-11数据加载日志:
SQL开始执行时间：20190912013105


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-11'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190912013105
SQL开始执行时间：20190912013105

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190912013105
SQL开始执行时间：20190912013105
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190912013105
SQL开始执行时间：20190912013105

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190912013105
SQL开始执行时间：20190912013105
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190912013105
SQL开始执行时间：20190912013105
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190912013117
SQL开始执行时间：20190912013117

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190912013117
SQL开始执行时间：20190912013117


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190912013117
SQL开始执行时间：20190912013117


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190912013237

20190913013107开始执行2019-09-12数据加载日志:
SQL开始执行时间：20190913013107


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-12'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190913013107
SQL开始执行时间：20190913013107

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190913013107
SQL开始执行时间：20190913013107
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190913013107
SQL开始执行时间：20190913013107

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190913013107
SQL开始执行时间：20190913013107
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190913013107
SQL开始执行时间：20190913013107
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190913013121
SQL开始执行时间：20190913013121

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190913013121
SQL开始执行时间：20190913013121


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190913013121
SQL开始执行时间：20190913013121


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190913013242

20190914031759开始执行2019-09-13数据加载日志:
SQL开始执行时间：20190914031759


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-13'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190914031759
SQL开始执行时间：20190914031759

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190914031759
SQL开始执行时间：20190914031759
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190914031759
SQL开始执行时间：20190914031759

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190914031759
SQL开始执行时间：20190914031759
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190914031759
SQL开始执行时间：20190914031759
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190914031807
SQL开始执行时间：20190914031807

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190914031807
SQL开始执行时间：20190914031807


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190914031807
SQL开始执行时间：20190914031807


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190914031928

20190915013104开始执行2019-09-14数据加载日志:
SQL开始执行时间：20190915013104


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-14'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190915013104
SQL开始执行时间：20190915013104

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190915013104
SQL开始执行时间：20190915013104
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190915013104
SQL开始执行时间：20190915013104

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190915013104
SQL开始执行时间：20190915013104
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190915013104
SQL开始执行时间：20190915013104
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190915013106
SQL开始执行时间：20190915013106

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190915013106
SQL开始执行时间：20190915013106


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190915013107
SQL开始执行时间：20190915013107


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190915013228

20190916013102开始执行2019-09-15数据加载日志:
SQL开始执行时间：20190916013102


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-15'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190916013102
SQL开始执行时间：20190916013102

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916013102
SQL开始执行时间：20190916013102
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190916013102
SQL开始执行时间：20190916013102

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190916013102
SQL开始执行时间：20190916013102
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190916013102
SQL开始执行时间：20190916013102
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190916013104
SQL开始执行时间：20190916013104

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916013105
SQL开始执行时间：20190916013105


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916013105
SQL开始执行时间：20190916013105


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190916013226

20190916084736开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916084736


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190916084736
SQL开始执行时间：20190916084736

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916084736
SQL开始执行时间：20190916084736
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190916084736
SQL开始执行时间：20190916084736

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190916084736
SQL开始执行时间：20190916084736
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190916084737
SQL开始执行时间：20190916084737
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190916084804
SQL开始执行时间：20190916084804

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916084805
SQL开始执行时间：20190916084805


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916084805
SQL开始执行时间：20190916084805


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190916084926

20190916093140开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916093140


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190916093141
SQL开始执行时间：20190916093141

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916093141
SQL开始执行时间：20190916093141
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190916093141
SQL开始执行时间：20190916093141

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190916093141
SQL开始执行时间：20190916093141
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190916093141
SQL开始执行时间：20190916093141
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190916093208
SQL开始执行时间：20190916093208

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916093209
SQL开始执行时间：20190916093209


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916093209
SQL开始执行时间：20190916093209


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190916093330

20190916095859开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190916095859


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190916095859
SQL开始执行时间：20190916095859

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190916095859
SQL开始执行时间：20190916095859
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190916095859
SQL开始执行时间：20190916095859

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190916095859
SQL开始执行时间：20190916095859
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190916095859
SQL开始执行时间：20190916095859
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190916095927
SQL开始执行时间：20190916095927

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190916095927
SQL开始执行时间：20190916095927


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190916095927
SQL开始执行时间：20190916095927


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190916100048

20190917013111开始执行2019-09-16数据加载日志:
SQL开始执行时间：20190917013111


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-16'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190917013111
SQL开始执行时间：20190917013111

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190917013111
SQL开始执行时间：20190917013111
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190917013111
SQL开始执行时间：20190917013111

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190917013111
SQL开始执行时间：20190917013111
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190917013111
SQL开始执行时间：20190917013111
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190917013147
SQL开始执行时间：20190917013147

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190917013147
SQL开始执行时间：20190917013147


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190917013148
SQL开始执行时间：20190917013148


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190917013311

20190917092452开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190917092452


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-17'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190917092452
SQL开始执行时间：20190917092452

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190917092452
SQL开始执行时间：20190917092452
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190917092452
SQL开始执行时间：20190917092452

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190917092452
SQL开始执行时间：20190917092452
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190917092452
SQL开始执行时间：20190917092452
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190917092502
SQL开始执行时间：20190917092502

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190917092503
SQL开始执行时间：20190917092503


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190917092503
SQL开始执行时间：20190917092503


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190917092625

20190918013108开始执行2019-09-17数据加载日志:
SQL开始执行时间：20190918013108


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-17'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190918013108
SQL开始执行时间：20190918013108

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918013108
SQL开始执行时间：20190918013108
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190918013108
SQL开始执行时间：20190918013108

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190918013108
SQL开始执行时间：20190918013108
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190918013108
SQL开始执行时间：20190918013108
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190918013125
SQL开始执行时间：20190918013125

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190918013125
SQL开始执行时间：20190918013125


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190918013125
SQL开始执行时间：20190918013125


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190918013249

20190918094208开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190918094208


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-18'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190918094209
SQL开始执行时间：20190918094209

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190918094209
SQL开始执行时间：20190918094209
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190918094209
SQL开始执行时间：20190918094209

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190918094209
SQL开始执行时间：20190918094209
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190918094209
SQL开始执行时间：20190918094209
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190918094225
SQL开始执行时间：20190918094225

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190918094226
SQL开始执行时间：20190918094226


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190918094226
SQL开始执行时间：20190918094226


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190918094349

20190919013107开始执行2019-09-18数据加载日志:
SQL开始执行时间：20190919013107


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-18'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190919013107
SQL开始执行时间：20190919013107

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190919013107
SQL开始执行时间：20190919013107
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190919013107
SQL开始执行时间：20190919013107

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190919013107
SQL开始执行时间：20190919013107
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190919013107
SQL开始执行时间：20190919013107
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190919013128
SQL开始执行时间：20190919013128

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190919013128
SQL开始执行时间：20190919013128


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190919013128
SQL开始执行时间：20190919013128


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190919013252

20190920013107开始执行2019-09-19数据加载日志:
SQL开始执行时间：20190920013107


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-19'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190920013107
SQL开始执行时间：20190920013107

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190920013107
SQL开始执行时间：20190920013107
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190920013107
SQL开始执行时间：20190920013107

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190920013108
SQL开始执行时间：20190920013108
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190920013108
SQL开始执行时间：20190920013108
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190920013120
SQL开始执行时间：20190920013120

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190920013120
SQL开始执行时间：20190920013120


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190920013120
SQL开始执行时间：20190920013120


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190920013245

20190921013112开始执行2019-09-20数据加载日志:
SQL开始执行时间：20190921013112


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-20'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190921013112
SQL开始执行时间：20190921013112

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190921013112
SQL开始执行时间：20190921013112
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190921013112
SQL开始执行时间：20190921013112

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190921013112
SQL开始执行时间：20190921013112
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190921013112
SQL开始执行时间：20190921013112
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190921013124
SQL开始执行时间：20190921013124

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190921013125
SQL开始执行时间：20190921013125


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190921013125
SQL开始执行时间：20190921013125


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190921013252

20190922013103开始执行2019-09-21数据加载日志:
SQL开始执行时间：20190922013104


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-21'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190922013104
SQL开始执行时间：20190922013104

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190922013104
SQL开始执行时间：20190922013104
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190922013104
SQL开始执行时间：20190922013104

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190922013104
SQL开始执行时间：20190922013104
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190922013104
SQL开始执行时间：20190922013104
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190922013110
SQL开始执行时间：20190922013110

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190922013110
SQL开始执行时间：20190922013110


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190922013111
SQL开始执行时间：20190922013111


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190922013239

20190923013105开始执行2019-09-22数据加载日志:
SQL开始执行时间：20190923013105


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-22'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190923013105
SQL开始执行时间：20190923013105

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923013105
SQL开始执行时间：20190923013105
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190923013105
SQL开始执行时间：20190923013105

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190923013105
SQL开始执行时间：20190923013105
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190923013105
SQL开始执行时间：20190923013105
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190923013106
SQL开始执行时间：20190923013106

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190923013106
SQL开始执行时间：20190923013106


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190923013106
SQL开始执行时间：20190923013106


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190923013236

20190923113115开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190923113115


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190923113115
SQL开始执行时间：20190923113115

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190923113115
SQL开始执行时间：20190923113115
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190923113115
SQL开始执行时间：20190923113115

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190923113115
SQL开始执行时间：20190923113115
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190923113115
SQL开始执行时间：20190923113115
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190923113128
SQL开始执行时间：20190923113128

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190923113128
SQL开始执行时间：20190923113128


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190923113128
SQL开始执行时间：20190923113128


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190923113302

20190924013114开始执行2019-09-23数据加载日志:
SQL开始执行时间：20190924013114


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-23'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190924013114
SQL开始执行时间：20190924013114

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924013114
SQL开始执行时间：20190924013114
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190924013114
SQL开始执行时间：20190924013114

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190924013114
SQL开始执行时间：20190924013114
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190924013114
SQL开始执行时间：20190924013114
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190924013135
SQL开始执行时间：20190924013135

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190924013135
SQL开始执行时间：20190924013135


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190924013135
SQL开始执行时间：20190924013135


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190924013311

20190924094430开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190924094430


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190924094430
SQL开始执行时间：20190924094430

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924094430
SQL开始执行时间：20190924094430
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190924094430
SQL开始执行时间：20190924094430

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190924094430
SQL开始执行时间：20190924094430
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190924094430
SQL开始执行时间：20190924094430
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190924094439
SQL开始执行时间：20190924094439

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190924094440
SQL开始执行时间：20190924094440


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190924094440
SQL开始执行时间：20190924094440


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190924094612

20190924113708开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190924113708


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190924113709
SQL开始执行时间：20190924113709

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190924113709
SQL开始执行时间：20190924113709
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190924113709
SQL开始执行时间：20190924113709

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190924113709
SQL开始执行时间：20190924113709
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190924113709
SQL开始执行时间：20190924113709
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190924113718
SQL开始执行时间：20190924113718

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190924113718
SQL开始执行时间：20190924113718


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190924113718
SQL开始执行时间：20190924113718


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190924113850

20190925013114开始执行2019-09-24数据加载日志:
SQL开始执行时间：20190925013114


create temporary table pdm.outdepot_order_pre as 
select a.*
      ,b.type as ccustype
  from edw.outdepot_order a
  left join edw.map_customer b
    on a.true_ccuscode = b.bi_cuscode
 where left(a.sys_time,10) >= '2019-09-24'
  and year(ddate)>=2018
  and state = '有效'
;
SQL结束执行时间：20190925013114
SQL开始执行时间：20190925013114

delete from pdm.outdepot_order_pre where left(true_ccuscode,2) = 'GL'
;
SQL结束执行时间：20190925013114
SQL开始执行时间：20190925013114
delete from pdm.outdepot_order_pre where left(bi_cinvcode,2) = 'JC'
;
SQL结束执行时间：20190925013114
SQL开始执行时间：20190925013114

CREATE INDEX index_outdepot_order_pre_db ON pdm.outdepot_order_pre(db)
;
SQL结束执行时间：20190925013114
SQL开始执行时间：20190925013114
CREATE INDEX index_outdepot_order_pre_autoid ON pdm.outdepot_order_pre(autoid)
;
SQL结束执行时间：20190925013114
SQL开始执行时间：20190925013114
delete from pdm.outdepot_order where concat(db,autoid) in (select concat(db,autoid) from  pdm.outdepot_order_pre)
;
SQL结束执行时间：20190925013133
SQL开始执行时间：20190925013133

create temporary table pdm.outdepot_order_item as
select e.bi_cinvcode
      ,e.business_class
      ,e.cinvbrand
      ,e.item_code
      ,f.plan_class
      ,f.key_project
   from (select bi_cinvcode,item_code,business_class,cinvbrand from edw.map_inventory group by bi_cinvcode) e
   left join (select ccuscode,true_item_code,plan_class,key_project from edw.x_sales_budget_18 group by ccuscode,true_item_code) f
    on e.item_code = f.true_item_code

;
SQL结束执行时间：20190925013133
SQL开始执行时间：20190925013133


insert into pdm.outdepot_order
select a.id
      ,a.autoid
      ,a.db
      ,case when a.db = 'UFDATA_111_2018' then '博圣' 
            when a.db = 'UFDATA_118_2018' then '卓恩'
            when a.db = 'UFDATA_123_2018' then '恩允'
            when a.db = 'UFDATA_168_2018' then '杭州贝生'
            when a.db = 'UFDATA_168_2019' then '杭州贝生'
            when a.db = 'UFDATA_169_2018' then '云鼎'
            when a.db = 'UFDATA_222_2018' then '宝荣'
            when a.db = 'UFDATA_222_2019' then '宝荣'
            when a.db = 'UFDATA_333_2018' then '宁波贝生'
            when a.db = 'UFDATA_588_2018' then '奥博特'
            when a.db = 'UFDATA_588_2019' then '奥博特'
            when a.db = 'UFDATA_666_2018' then '启代'
            when a.db = 'UFDATA_889_2018' then '美博特'
            when a.db = 'UFDATA_889_2019' then '美博特'
            when a.db = 'UFDATA_555_2018' then '贝安云'
            end
      ,a.ccode
      ,a.ddate
      ,a.cwhcode
      ,c.cwhname
      ,a.cdepcode
      ,d.cdepname
      ,a.cpersoncode
      ,b.sales_region
      ,b.province
      ,b.city
      ,a.ccustype
      ,a.true_ccuscode as ccuscode
      ,a.true_ccusname as ccusname
      ,a.true_finnal_ccuscode as finnal_ccuscode
      ,a.true_finnal_ccusname2 as finnal_ccusname
      ,e.business_class
      ,a.cdefine22
      ,a.bi_cinvcode as cinvcode
      ,a.bi_cinvname as cinvname
      ,md5(a.iunitcost)
      ,a.iquantity
      ,md5(a.iprice)
      ,a.inum_person
      ,f.item_code
      ,e.plan_class
      ,e.key_project
      ,f.level_three
      ,null
      ,e.cinvbrand
      ,a.cstcode
      ,a.fsettleqty
      ,localtimestamp()
  from pdm.outdepot_order_pre a
  left join edw.map_customer b
    on a.true_finnal_ccuscode = b.bi_cuscode 
  left join (select cwhcode,db,cwhname from ufdata.warehouse group by cwhcode,db) c
    on a.cwhcode = c.cwhcode
   and a.db = c.db
  left join (select cdepcode,db,cdepname from ufdata.department group by cdepcode,db) d
    on a.cdepcode = d.cdepcode
   and a.db = d.db
  left join (select bi_cinvcode,plan_class,key_project,business_class,cinvbrand from pdm.outdepot_order_item group by bi_cinvcode) e
    on a.bi_cinvcode = e.bi_cinvcode
  left join (select * from edw.map_inventory group by bi_cinvcode) f
    on a.bi_cinvcode = f.bi_cinvcode

;
SQL结束执行时间：20190925013133
SQL开始执行时间：20190925013133


delete from pdm.outdepot_order where concat(db,id) in (select concat(db,id) from edw.outdepot_order where state = '无效') 
;
SQL结束执行时间：20190925013312
