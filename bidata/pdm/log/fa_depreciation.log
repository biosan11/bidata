
20190805152917开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805152917

use pdm
;
SQL结束执行时间：20190805152917
SQL开始执行时间：20190805152917

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805152917
SQL开始执行时间：20190805152917
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805152917
SQL开始执行时间：20190805152917

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31')
;

20190805153027开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805153027

use pdm
;
SQL结束执行时间：20190805153027
SQL开始执行时间：20190805153027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153027
SQL开始执行时间：20190805153027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153027
SQL开始执行时间：20190805153027

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31')
;

20190805153142开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805153142

use pdm
;
SQL结束执行时间：20190805153142
SQL开始执行时间：20190805153142

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153142
SQL开始执行时间：20190805153142
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153142
SQL开始执行时间：20190805153142

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805153142
SQL开始执行时间：20190805153142
insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153142

20190805153201开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805153201

use pdm
;
SQL结束执行时间：20190805153201
SQL开始执行时间：20190805153201

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153201
SQL开始执行时间：20190805153201
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153201
SQL开始执行时间：20190805153201

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805153201
SQL开始执行时间：20190805153201
insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153201

20190805153342开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805153342

use pdm
;
SQL结束执行时间：20190805153342
SQL开始执行时间：20190805153342

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153342
SQL开始执行时间：20190805153342
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153342
SQL开始执行时间：20190805153342

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805153342
SQL开始执行时间：20190805153342
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153342

20190805153342开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805153342

use pdm
;
SQL结束执行时间：20190805153342
SQL开始执行时间：20190805153342

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153342
SQL开始执行时间：20190805153342
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153343
SQL开始执行时间：20190805153343

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805153343
SQL开始执行时间：20190805153343
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153343

20190805153342开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805153343

use pdm
;
SQL结束执行时间：20190805153343
SQL开始执行时间：20190805153343

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153343
SQL开始执行时间：20190805153343
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153343
SQL开始执行时间：20190805153343

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805153343
SQL开始执行时间：20190805153343
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153343

20190805153358开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805153358

use pdm
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153358

20190805153358开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805153358

use pdm
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153358

20190805153358开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805153358

use pdm
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805153358
SQL开始执行时间：20190805153358
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153358

20190805153442开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805153442

use pdm
;
SQL结束执行时间：20190805153442
SQL开始执行时间：20190805153442

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153442
SQL开始执行时间：20190805153442
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153442
SQL开始执行时间：20190805153442

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805153442
SQL开始执行时间：20190805153442
insert into  pdm.fa_depreciation
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153442

20190805153442开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805153442

use pdm
;
SQL结束执行时间：20190805153442
SQL开始执行时间：20190805153442

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153442
SQL开始执行时间：20190805153442
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
insert into  pdm.fa_depreciation
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153443

20190805153442开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805153443

use pdm
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
insert into  pdm.fa_depreciation
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153443

20190805153442开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805153443

use pdm
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
insert into  pdm.fa_depreciation
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153443

20190805153442开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805153443

use pdm
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
insert into  pdm.fa_depreciation
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153443

20190805153442开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805153443

use pdm
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153443

20190805153442开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805153443

use pdm
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153443

20190805153442开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805153443

use pdm
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805153443
SQL开始执行时间：20190805153443
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153443

20190805153636开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805153636

use pdm
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
insert into  pdm.fa_depreciation
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153636

20190805153636开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805153636

use pdm
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
insert into  pdm.fa_depreciation
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153636

20190805153636开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805153636

use pdm
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
insert into  pdm.fa_depreciation
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153636

20190805153636开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805153636

use pdm
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
insert into  pdm.fa_depreciation
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153636

20190805153636开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805153636

use pdm
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
insert into  pdm.fa_depreciation
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153636

20190805153636开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805153636

use pdm
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153636

20190805153636开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805153636

use pdm
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153636
SQL开始执行时间：20190805153636
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153637
SQL开始执行时间：20190805153637

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805153637
SQL开始执行时间：20190805153637
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153637

20190805153636开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805153637

use pdm
;
SQL结束执行时间：20190805153637
SQL开始执行时间：20190805153637

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153637
SQL开始执行时间：20190805153637
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153637
SQL开始执行时间：20190805153637

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805153637
SQL开始执行时间：20190805153637
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153637

20190805153713开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805153713

use pdm
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
insert into  pdm.fa_depreciation
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153713

20190805153713开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805153713

use pdm
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
insert into  pdm.fa_depreciation
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153713

20190805153713开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805153713

use pdm
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
insert into  pdm.fa_depreciation
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153713

20190805153713开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805153713

use pdm
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
insert into  pdm.fa_depreciation
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153713

20190805153713开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805153713

use pdm
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
insert into  pdm.fa_depreciation
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153713

20190805153713开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805153713

use pdm
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153713

20190805153713开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805153713

use pdm
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153713

20190805153713开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805153713

use pdm
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805153713
SQL开始执行时间：20190805153713
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153713

20190805153734开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805153734

use pdm
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734
insert into  pdm.fa_depreciation
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153734

20190805153734开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805153734

use pdm
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734
insert into  pdm.fa_depreciation
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153734

20190805153734开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805153734

use pdm
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805153734
SQL开始执行时间：20190805153734
insert into  pdm.fa_depreciation
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153735

20190805153734开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805153735

use pdm
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
insert into  pdm.fa_depreciation
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153735

20190805153734开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805153735

use pdm
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
insert into  pdm.fa_depreciation
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153735

20190805153734开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805153735

use pdm
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153735

20190805153734开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805153735

use pdm
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153735

20190805153734开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805153735

use pdm
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805153735
SQL开始执行时间：20190805153735
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805153735

20190805154223开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805154223

use pdm
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
insert into  pdm.fa_depreciation
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154223

20190805154223开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805154223

use pdm
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
insert into  pdm.fa_depreciation
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154223

20190805154223开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805154223

use pdm
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
insert into  pdm.fa_depreciation
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154223

20190805154223开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805154223

use pdm
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
insert into  pdm.fa_depreciation
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154223

20190805154223开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805154223

use pdm
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
insert into  pdm.fa_depreciation
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154223

20190805154223开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805154223

use pdm
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154223
SQL开始执行时间：20190805154223

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154224

20190805154223开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805154224

use pdm
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154224

20190805154223开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805154224

use pdm
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154224

20190805154223开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805154224

use pdm
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154224

20190805154223开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805154224

use pdm
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154224

20190805154223开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805154224

use pdm
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805154224
SQL开始执行时间：20190805154224
insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154224

20190805154334开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805154334

use pdm
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
insert into  pdm.fa_depreciation
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154334

20190805154334开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805154334

use pdm
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
insert into  pdm.fa_depreciation
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154334

20190805154334开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805154334

use pdm
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
insert into  pdm.fa_depreciation
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154334

20190805154334开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805154334

use pdm
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
insert into  pdm.fa_depreciation
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154334

20190805154334开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805154334

use pdm
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
insert into  pdm.fa_depreciation
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154334

20190805154334开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805154334

use pdm
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154334

20190805154334开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805154334

use pdm
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154334
SQL开始执行时间：20190805154334

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154335

20190805154334开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805154335

use pdm
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154335

20190805154334开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805154335

use pdm
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154335

20190805154334开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805154335

use pdm
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154335

20190805154334开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805154335

use pdm
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805154335
SQL开始执行时间：20190805154335
insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154335

20190805154626开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805154626

use pdm
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
insert into  pdm.fa_depreciation
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154626

20190805154626开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805154626

use pdm
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
insert into  pdm.fa_depreciation
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154626

20190805154626开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805154626

use pdm
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
insert into  pdm.fa_depreciation
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154626

20190805154626开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805154626

use pdm
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
insert into  pdm.fa_depreciation
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154626

20190805154626开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805154626

use pdm
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626
insert into  pdm.fa_depreciation
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154626

20190805154626开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805154626

use pdm
;
SQL结束执行时间：20190805154626
SQL开始执行时间：20190805154626

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154627

20190805154626开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805154627

use pdm
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154627

20190805154626开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805154627

use pdm
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154627

20190805154626开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805154627

use pdm
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154627

20190805154626开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805154627

use pdm
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154627

20190805154626开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805154627

use pdm
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154627

20190805154626开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805154627

use pdm
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154627

20190805154626开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805154627

use pdm
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154627
SQL开始执行时间：20190805154627

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805154628
SQL开始执行时间：20190805154628
insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154628

20190805154639开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805154639

use pdm
;
SQL结束执行时间：20190805154639
SQL开始执行时间：20190805154639

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154639
SQL开始执行时间：20190805154639
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154639
SQL开始执行时间：20190805154639

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154640

20190805154639开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805154640

use pdm
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154640

20190805154639开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805154640

use pdm
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154640

20190805154639开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805154640

use pdm
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154640

20190805154639开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805154640

use pdm
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154640

20190805154639开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805154640

use pdm
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154640

20190805154639开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805154640

use pdm
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154640

20190805154639开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805154640

use pdm
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154640

20190805154639开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805154640

use pdm
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154640
SQL开始执行时间：20190805154640
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154641

20190805154639开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805154641

use pdm
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154641

20190805154639开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805154641

use pdm
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154641

20190805154639开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805154641

use pdm
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154641

20190805154639开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805154641

use pdm
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805154641
SQL开始执行时间：20190805154641
insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154641

20190805154841开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805154841

use pdm
;
SQL结束执行时间：20190805154841
SQL开始执行时间：20190805154841

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805154841
SQL开始执行时间：20190805154841
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805154841
SQL开始执行时间：20190805154841

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805154841
SQL开始执行时间：20190805154841
insert into  pdm.fa_depreciation
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805154841

20190805163236开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805163236

use pdm
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163236

20190805163236开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805163236

use pdm
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163236

20190805163236开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805163236

use pdm
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163236

20190805163236开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805163236

use pdm
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163236

20190805163236开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805163236

use pdm
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163236

20190805163236开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805163236

use pdm
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163236

20190805163236开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805163236

use pdm
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163236
SQL开始执行时间：20190805163236
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163237

20190805163236开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805163237

use pdm
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163237

20190805163236开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805163237

use pdm
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163237

20190805163236开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805163237

use pdm
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163237

20190805163236开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805163237

use pdm
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163237

20190805163236开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805163237

use pdm
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163237

20190805163236开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805163237

use pdm
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805163237
SQL开始执行时间：20190805163237
insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163237

20190805163345开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805163345

use pdm
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345
insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163345

20190805163345开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805163345

use pdm
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345
insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163345

20190805163345开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805163345

use pdm
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345
insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163345

20190805163345开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805163345

use pdm
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163345
SQL开始执行时间：20190805163345
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163345开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805163346

use pdm
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805163346
SQL开始执行时间：20190805163346
insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163346

20190805163850开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805163850

use pdm
;
SQL结束执行时间：20190805163850
SQL开始执行时间：20190805163850

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163850
SQL开始执行时间：20190805163850
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851



insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163851

20190805163850开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805163851

use pdm
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851



insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163851

20190805163850开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805163851

use pdm
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851



insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163851

20190805163850开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805163851

use pdm
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851



insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163851

20190805163850开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805163851

use pdm
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851



insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163851

20190805163850开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805163851

use pdm
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805163851
SQL开始执行时间：20190805163851



insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163851

20190805163914开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805163914

use pdm
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914



insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163914

20190805163914开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805163914

use pdm
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914



insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163914

20190805163914开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805163914

use pdm
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163914
SQL开始执行时间：20190805163914

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915



insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163915

20190805163914开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805163915

use pdm
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163915
SQL开始执行时间：20190805163915
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163916
SQL开始执行时间：20190805163916

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805163916
SQL开始执行时间：20190805163916
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805163916
SQL开始执行时间：20190805163916



insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163916

20190805163914开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805163916

use pdm
;
SQL结束执行时间：20190805163916
SQL开始执行时间：20190805163916

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805163916
SQL开始执行时间：20190805163916
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805163916
SQL开始执行时间：20190805163916

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805163916
SQL开始执行时间：20190805163916
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805163916
SQL开始执行时间：20190805163916



insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805163916

20190805165858开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805165858

use pdm
;
SQL结束执行时间：20190805165858
SQL开始执行时间：20190805165858

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165858
SQL开始执行时间：20190805165858
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165858
SQL开始执行时间：20190805165858

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805165858
SQL开始执行时间：20190805165858
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805165858
SQL开始执行时间：20190805165858



insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165858

20190805165858开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805165858

use pdm
;
SQL结束执行时间：20190805165858
SQL开始执行时间：20190805165858

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165858
SQL开始执行时间：20190805165858
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859



insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165859

20190805165858开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805165859

use pdm
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165859
SQL开始执行时间：20190805165859
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900



insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165900

20190805165858开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805165900

use pdm
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900



insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165900

20190805165858开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805165900

use pdm
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805165900
SQL开始执行时间：20190805165900



insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805165900

20190805170027开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027



insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170027

20190805170027开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027



insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170027

20190805170027开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027



insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170027

20190805170027开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027



insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170027

20190805170027开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027



insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170027

20190805170027开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027



insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170027

20190805170027开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027



insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170027

20190805170027开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027



insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170027

20190805170027开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805170027

use pdm
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170027
SQL开始执行时间：20190805170027
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028



insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170028

20190805170027开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805170028

use pdm
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028



insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170028

20190805170027开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805170028

use pdm
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028



insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170028

20190805170027开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805170028

use pdm
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028



insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170028

20190805170027开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805170028

use pdm
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805170028
SQL开始执行时间：20190805170028



insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170028

20190805170214开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805170214

use pdm
;
SQL结束执行时间：20190805170214
SQL开始执行时间：20190805170214

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170214
SQL开始执行时间：20190805170214
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170214
SQL开始执行时间：20190805170214

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805170214
SQL开始执行时间：20190805170214
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805170214
SQL开始执行时间：20190805170214



insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170214

20190805170351开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805170351

use pdm
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351



insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170351

20190805170351开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805170351

use pdm
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351



insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170351

20190805170351开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805170351

use pdm
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351



insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170351

20190805170351开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805170351

use pdm
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351



insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170351

20190805170351开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805170351

use pdm
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351



insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170351

20190805170351开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805170351

use pdm
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351



insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170351

20190805170351开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805170351

use pdm
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170351
SQL开始执行时间：20190805170351

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352



insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170352

20190805170351开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805170352

use pdm
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352



insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170352

20190805170351开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805170352

use pdm
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352



insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170352

20190805170351开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805170352

use pdm
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352



insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170352

20190805170351开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805170352

use pdm
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352



insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170352

20190805170351开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805170352

use pdm
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352



insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170352

20190805170351开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805170352

use pdm
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805170352
SQL开始执行时间：20190805170352



insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170352

20190805170455开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805170455

use pdm
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455



insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170455

20190805170455开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805170455

use pdm
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455



insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170455

20190805170455开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805170455

use pdm
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455



insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170455

20190805170455开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805170455

use pdm
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170455
SQL开始执行时间：20190805170455
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456



insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170456

20190805170455开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805170456

use pdm
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456



insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170456

20190805170455开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805170456

use pdm
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456



insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170456

20190805170455开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805170456

use pdm
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456



insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170456

20190805170455开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805170456

use pdm
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456



insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170456

20190805170455开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805170456

use pdm
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456



insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170456

20190805170455开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805170456

use pdm
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456



insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170456

20190805170455开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805170456

use pdm
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456



insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170456

20190805170455开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805170456

use pdm
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170456
SQL开始执行时间：20190805170456

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805170457
SQL开始执行时间：20190805170457
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805170457
SQL开始执行时间：20190805170457



insert into  pdm.fa_depreciation
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170457

20190805170455开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805170457

use pdm
;
SQL结束执行时间：20190805170457
SQL开始执行时间：20190805170457

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170457
SQL开始执行时间：20190805170457
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170457
SQL开始执行时间：20190805170457

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805170457
SQL开始执行时间：20190805170457
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805170457
SQL开始执行时间：20190805170457



insert into  pdm.fa_depreciation
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170457

20190805170521开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805170521

use pdm
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521



insert into  pdm.fa_depreciation
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170521

20190805170521开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805170521

use pdm
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521



insert into  pdm.fa_depreciation
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170521

20190805170521开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805170521

use pdm
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521



insert into  pdm.fa_depreciation
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170521

20190805170521开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805170521

use pdm
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521



insert into  pdm.fa_depreciation
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170521

20190805170521开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805170521

use pdm
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170521
SQL开始执行时间：20190805170521
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522



insert into  pdm.fa_depreciation
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170522

20190805170521开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805170522

use pdm
;
SQL结束执行时间：20190805170522
SQL开始执行时间：20190805170522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523



insert into  pdm.fa_depreciation
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170523

20190805170521开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805170523

use pdm
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523



insert into  pdm.fa_depreciation
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170523

20190805170521开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805170523

use pdm
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523



insert into  pdm.fa_depreciation
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170523

20190805170521开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805170523

use pdm
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523



insert into  pdm.fa_depreciation
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170523

20190805170521开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805170523

use pdm
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523



insert into  pdm.fa_depreciation
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170523

20190805170521开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805170523

use pdm
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523



insert into  pdm.fa_depreciation
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170523

20190805170521开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805170523

use pdm
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523



insert into  pdm.fa_depreciation
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170523

20190805170521开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805170523

use pdm
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805170523
SQL开始执行时间：20190805170523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805170524
SQL开始执行时间：20190805170524

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805170524
SQL开始执行时间：20190805170524
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805170524
SQL开始执行时间：20190805170524



insert into  pdm.fa_depreciation
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805170524

20190805171516开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805171516

use pdm
;
SQL结束执行时间：20190805171516
SQL开始执行时间：20190805171516

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171516
SQL开始执行时间：20190805171516
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else then b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(date(year(b.date_),month(b.date_),'01'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805171516开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517



create table pdm.fa_depreciation_pre as 
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805171517

use pdm
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171517
SQL开始执行时间：20190805171517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805171518

use pdm
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805171518

use pdm
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805171518

use pdm
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805171518

use pdm
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805171518

use pdm
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805171518

use pdm
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805171518

use pdm
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805171516开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805171518

use pdm
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805171518
SQL开始执行时间：20190805171518



create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;

20190805172515开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805172515

use pdm
;
SQL结束执行时间：20190805172515
SQL开始执行时间：20190805172515

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172515
SQL开始执行时间：20190805172515
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172515
SQL开始执行时间：20190805172515

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805172515
SQL开始执行时间：20190805172515
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190805172515
SQL开始执行时间：20190805172515



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172515
SQL开始执行时间：20190805172515
create table pdm.fa_depreciation_pre as 
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172516

20190805172515开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805172516

use pdm
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516
create table pdm.fa_depreciation_pre as 
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172516

20190805172515开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805172516

use pdm
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516
create table pdm.fa_depreciation_pre as 
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172516
SQL开始执行时间：20190805172516


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172517

20190805172515开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805172517

use pdm
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
create table pdm.fa_depreciation_pre as 
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172517

20190805172515开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805172517

use pdm
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
create table pdm.fa_depreciation_pre as 
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172517

20190805172515开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805172517

use pdm
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517
create table pdm.fa_depreciation_pre as 
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172517
SQL开始执行时间：20190805172517


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172518

20190805172515开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805172518

use pdm
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518
create table pdm.fa_depreciation_pre as 
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172518

20190805172515开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805172518

use pdm
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518
create table pdm.fa_depreciation_pre as 
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172518
SQL开始执行时间：20190805172518

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172519

20190805172515开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805172519

use pdm
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
create table pdm.fa_depreciation_pre as 
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172519

20190805172515开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805172519

use pdm
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
create table pdm.fa_depreciation_pre as 
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172519

20190805172515开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805172519

use pdm
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519
create table pdm.fa_depreciation_pre as 
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172519
SQL开始执行时间：20190805172519


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172520

20190805172515开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805172520

use pdm
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
create table pdm.fa_depreciation_pre as 
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172520

20190805172515开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805172520

use pdm
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
create table pdm.fa_depreciation_pre as 
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172520

20190805172515开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805172520

use pdm
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172520
SQL开始执行时间：20190805172520
create table pdm.fa_depreciation_pre as 
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172521

20190805172515开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805172521

use pdm
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521
create table pdm.fa_depreciation_pre as 
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172521

20190805172515开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805172521

use pdm
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521
create table pdm.fa_depreciation_pre as 
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172521
SQL开始执行时间：20190805172521


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172522

20190805172515开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805172522

use pdm
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522
create table pdm.fa_depreciation_pre as 
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172522

20190805172515开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805172522

use pdm
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522
create table pdm.fa_depreciation_pre as 
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172522
SQL开始执行时间：20190805172522


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172523

20190805172515开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805172523

use pdm
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523
create table pdm.fa_depreciation_pre as 
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172523

20190805172515开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805172523

use pdm
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172523

20190805172515开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805172523

use pdm
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805172523
SQL开始执行时间：20190805172523
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805172524
SQL开始执行时间：20190805172524



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172524
SQL开始执行时间：20190805172524
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172524
SQL开始执行时间：20190805172524


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(str_to_date(CONCAT(year(b.date_),'-',month(b.date_),'-01'),'%Y-%m-%d'),INTERVAL 1 day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172524
SQL开始执行时间：20190805172524

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172524

20190805172922开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805172922

use pdm
;
SQL结束执行时间：20190805172922
SQL开始执行时间：20190805172922

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172922
SQL开始执行时间：20190805172922
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923
create table pdm.fa_depreciation_pre as 
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172923

20190805172922开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805172923

use pdm
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923
create table pdm.fa_depreciation_pre as 
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172923

20190805172922开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805172923

use pdm
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923
create table pdm.fa_depreciation_pre as 
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172923
SQL开始执行时间：20190805172923


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172924

20190805172922开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805172924

use pdm
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
create table pdm.fa_depreciation_pre as 
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172924

20190805172922开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805172924

use pdm
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
create table pdm.fa_depreciation_pre as 
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172924

20190805172922开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805172924

use pdm
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924
create table pdm.fa_depreciation_pre as 
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172924
SQL开始执行时间：20190805172924


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172925

20190805172922开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805172925

use pdm
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925
create table pdm.fa_depreciation_pre as 
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172925

20190805172922开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805172925

use pdm
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925
create table pdm.fa_depreciation_pre as 
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172925

20190805172922开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805172925

use pdm
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805172925
SQL开始执行时间：20190805172925



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926
create table pdm.fa_depreciation_pre as 
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172926

20190805172922开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805172926

use pdm
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926
create table pdm.fa_depreciation_pre as 
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172926

20190805172922开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805172926

use pdm
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926
create table pdm.fa_depreciation_pre as 
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172926
SQL开始执行时间：20190805172926


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172927

20190805172922开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805172927

use pdm
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
create table pdm.fa_depreciation_pre as 
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172927

20190805172922开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805172927

use pdm
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
create table pdm.fa_depreciation_pre as 
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172927

20190805172922开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805172927

use pdm
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927
create table pdm.fa_depreciation_pre as 
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172927
SQL开始执行时间：20190805172927


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172928

20190805172922开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805172928

use pdm
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928
create table pdm.fa_depreciation_pre as 
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172928

20190805172922开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805172928

use pdm
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928
create table pdm.fa_depreciation_pre as 
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172928
SQL开始执行时间：20190805172928


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172929

20190805172922开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805172929

use pdm
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929
create table pdm.fa_depreciation_pre as 
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172929

20190805172922开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805172929

use pdm
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929
create table pdm.fa_depreciation_pre as 
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172929

20190805172922开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805172929

use pdm
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172929
SQL开始执行时间：20190805172929
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930
create table pdm.fa_depreciation_pre as 
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172930

20190805172922开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805172930

use pdm
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172930

20190805172922开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805172930

use pdm
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172930
SQL开始执行时间：20190805172930
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805172931
SQL开始执行时间：20190805172931


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation_pre b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805172931
SQL开始执行时间：20190805172931

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805172931

20190805173106开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805173106

use pdm
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create table pdm.fa_depreciation_pre as 
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805173106

use pdm
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create table pdm.fa_depreciation_pre as 
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805173106

use pdm
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create table pdm.fa_depreciation_pre as 
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805173106

use pdm
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create table pdm.fa_depreciation_pre as 
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805173106

use pdm
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create table pdm.fa_depreciation_pre as 
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805173106

use pdm
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106
create table pdm.fa_depreciation_pre as 
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805173106

use pdm
;
SQL结束执行时间：20190805173106
SQL开始执行时间：20190805173106

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create table pdm.fa_depreciation_pre as 
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805173107

use pdm
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create table pdm.fa_depreciation_pre as 
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805173107

use pdm
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create table pdm.fa_depreciation_pre as 
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805173107

use pdm
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create table pdm.fa_depreciation_pre as 
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805173107

use pdm
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create table pdm.fa_depreciation_pre as 
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805173107

use pdm
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create table pdm.fa_depreciation_pre as 
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805173107

use pdm
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173107
SQL开始执行时间：20190805173107
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create table pdm.fa_depreciation_pre as 
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805173108

use pdm
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create table pdm.fa_depreciation_pre as 
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805173108

use pdm
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create table pdm.fa_depreciation_pre as 
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805173108

use pdm
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create table pdm.fa_depreciation_pre as 
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805173108

use pdm
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create table pdm.fa_depreciation_pre as 
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805173108

use pdm
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create table pdm.fa_depreciation_pre as 
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805173108

use pdm
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173108
SQL开始执行时间：20190805173108
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109
create table pdm.fa_depreciation_pre as 
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805173109

use pdm
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173106开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805173109

use pdm
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173109
SQL开始执行时间：20190805173109


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbl end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;

20190805173308开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805173308

use pdm
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
create table pdm.fa_depreciation_pre as 
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173308

20190805173308开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805173308

use pdm
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
create table pdm.fa_depreciation_pre as 
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173308

20190805173308开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805173308

use pdm
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
create table pdm.fa_depreciation_pre as 
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173308

20190805173308开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805173308

use pdm
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173308
SQL开始执行时间：20190805173308
create table pdm.fa_depreciation_pre as 
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173309

20190805173308开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805173309

use pdm
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309
create table pdm.fa_depreciation_pre as 
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173309

20190805173308开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805173309

use pdm
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173309
SQL开始执行时间：20190805173309
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310
create table pdm.fa_depreciation_pre as 
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173310

20190805173308开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805173310

use pdm
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310
create table pdm.fa_depreciation_pre as 
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173310
SQL开始执行时间：20190805173310


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173311
SQL开始执行时间：20190805173311

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173311

20190805173308开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805173311

use pdm
;
SQL结束执行时间：20190805173311
SQL开始执行时间：20190805173311

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173311
SQL开始执行时间：20190805173311
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173311
SQL开始执行时间：20190805173311

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805173311
SQL开始执行时间：20190805173311
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805173311
SQL开始执行时间：20190805173311



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173311
SQL开始执行时间：20190805173311
create table pdm.fa_depreciation_pre as 
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173311
SQL开始执行时间：20190805173311


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173312
SQL开始执行时间：20190805173312

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173312

20190805173308开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805173312

use pdm
;
SQL结束执行时间：20190805173312
SQL开始执行时间：20190805173312

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173312
SQL开始执行时间：20190805173312
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173312
SQL开始执行时间：20190805173312

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805173312
SQL开始执行时间：20190805173312
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805173312
SQL开始执行时间：20190805173312



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173312
SQL开始执行时间：20190805173312
create table pdm.fa_depreciation_pre as 
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173312
SQL开始执行时间：20190805173312


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173313
SQL开始执行时间：20190805173313

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173313

20190805173308开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805173313

use pdm
;
SQL结束执行时间：20190805173313
SQL开始执行时间：20190805173313

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173313
SQL开始执行时间：20190805173313
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173313
SQL开始执行时间：20190805173313

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805173313
SQL开始执行时间：20190805173313
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805173313
SQL开始执行时间：20190805173313



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173313
SQL开始执行时间：20190805173313
create table pdm.fa_depreciation_pre as 
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173313
SQL开始执行时间：20190805173313


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173314
SQL开始执行时间：20190805173314

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173314

20190805173308开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805173314

use pdm
;
SQL结束执行时间：20190805173314
SQL开始执行时间：20190805173314

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173314
SQL开始执行时间：20190805173314
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173314
SQL开始执行时间：20190805173314

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805173314
SQL开始执行时间：20190805173314
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805173314
SQL开始执行时间：20190805173314



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173314
SQL开始执行时间：20190805173314
create table pdm.fa_depreciation_pre as 
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173314
SQL开始执行时间：20190805173314


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173316
SQL开始执行时间：20190805173316

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173316

20190805173308开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805173316

use pdm
;
SQL结束执行时间：20190805173316
SQL开始执行时间：20190805173316

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173316
SQL开始执行时间：20190805173316
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173316
SQL开始执行时间：20190805173316

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805173316
SQL开始执行时间：20190805173316
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805173316
SQL开始执行时间：20190805173316



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173316
SQL开始执行时间：20190805173316
create table pdm.fa_depreciation_pre as 
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173316
SQL开始执行时间：20190805173316


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173317
SQL开始执行时间：20190805173317

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173317

20190805173308开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805173317

use pdm
;
SQL结束执行时间：20190805173317
SQL开始执行时间：20190805173317

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173317
SQL开始执行时间：20190805173317
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173317
SQL开始执行时间：20190805173317

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805173317
SQL开始执行时间：20190805173317
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805173317
SQL开始执行时间：20190805173317



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173317
SQL开始执行时间：20190805173317
create table pdm.fa_depreciation_pre as 
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173317
SQL开始执行时间：20190805173317


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173319
SQL开始执行时间：20190805173319

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173319

20190805173308开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805173319

use pdm
;
SQL结束执行时间：20190805173319
SQL开始执行时间：20190805173319

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173319
SQL开始执行时间：20190805173319
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173319
SQL开始执行时间：20190805173319

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805173319
SQL开始执行时间：20190805173319
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805173319
SQL开始执行时间：20190805173319



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173319
SQL开始执行时间：20190805173319
create table pdm.fa_depreciation_pre as 
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173319
SQL开始执行时间：20190805173319


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173321
SQL开始执行时间：20190805173321

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173321

20190805173308开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805173321

use pdm
;
SQL结束执行时间：20190805173321
SQL开始执行时间：20190805173321

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173321
SQL开始执行时间：20190805173321
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173321
SQL开始执行时间：20190805173321

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805173321
SQL开始执行时间：20190805173321
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805173321
SQL开始执行时间：20190805173321



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173321
SQL开始执行时间：20190805173321
create table pdm.fa_depreciation_pre as 
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173321
SQL开始执行时间：20190805173321


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173322
SQL开始执行时间：20190805173322

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173323

20190805173308开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805173323

use pdm
;
SQL结束执行时间：20190805173323
SQL开始执行时间：20190805173323

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173323
SQL开始执行时间：20190805173323
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173323
SQL开始执行时间：20190805173323

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805173323
SQL开始执行时间：20190805173323
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805173323
SQL开始执行时间：20190805173323



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173323
SQL开始执行时间：20190805173323
create table pdm.fa_depreciation_pre as 
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173323
SQL开始执行时间：20190805173323


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173325
SQL开始执行时间：20190805173325

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173325

20190805173308开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805173325

use pdm
;
SQL结束执行时间：20190805173325
SQL开始执行时间：20190805173325

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173325
SQL开始执行时间：20190805173325
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173325
SQL开始执行时间：20190805173325

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805173325
SQL开始执行时间：20190805173325
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805173325
SQL开始执行时间：20190805173325



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173325
SQL开始执行时间：20190805173325
create table pdm.fa_depreciation_pre as 
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173325
SQL开始执行时间：20190805173325


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173327
SQL开始执行时间：20190805173327

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173327

20190805173308开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805173327

use pdm
;
SQL结束执行时间：20190805173327
SQL开始执行时间：20190805173327

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173327
SQL开始执行时间：20190805173327
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173327
SQL开始执行时间：20190805173327

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805173327
SQL开始执行时间：20190805173327
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805173327
SQL开始执行时间：20190805173327



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173327
SQL开始执行时间：20190805173327
create table pdm.fa_depreciation_pre as 
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173327
SQL开始执行时间：20190805173327


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173329
SQL开始执行时间：20190805173329

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173329

20190805173308开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805173329

use pdm
;
SQL结束执行时间：20190805173329
SQL开始执行时间：20190805173329

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173329
SQL开始执行时间：20190805173329
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173329
SQL开始执行时间：20190805173329

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805173329
SQL开始执行时间：20190805173329
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805173329
SQL开始执行时间：20190805173329



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173329
SQL开始执行时间：20190805173329
create table pdm.fa_depreciation_pre as 
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173329
SQL开始执行时间：20190805173329


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173332
SQL开始执行时间：20190805173332

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173332

20190805173308开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805173332

use pdm
;
SQL结束执行时间：20190805173332
SQL开始执行时间：20190805173332

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173332
SQL开始执行时间：20190805173332
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173332
SQL开始执行时间：20190805173332

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805173332
SQL开始执行时间：20190805173332
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805173332
SQL开始执行时间：20190805173332



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173332
SQL开始执行时间：20190805173332
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173332
SQL开始执行时间：20190805173332


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173335
SQL开始执行时间：20190805173335

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173335

20190805173308开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805173335

use pdm
;
SQL结束执行时间：20190805173335
SQL开始执行时间：20190805173335

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805173335
SQL开始执行时间：20190805173335
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805173335
SQL开始执行时间：20190805173335

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805173335
SQL开始执行时间：20190805173335
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805173335
SQL开始执行时间：20190805173335



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173335
SQL开始执行时间：20190805173335
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805173335
SQL开始执行时间：20190805173335


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805173338
SQL开始执行时间：20190805173338

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805173338

20190805174324开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805174324

use pdm
;
SQL结束执行时间：20190805174324
SQL开始执行时间：20190805174324

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174324
SQL开始执行时间：20190805174324
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174325
SQL开始执行时间：20190805174325

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805174325
SQL开始执行时间：20190805174325
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190805174325
SQL开始执行时间：20190805174325



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174325
SQL开始执行时间：20190805174325
create table pdm.fa_depreciation_pre as 
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174325
SQL开始执行时间：20190805174325


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174327
SQL开始执行时间：20190805174327

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174327

20190805174324开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805174327

use pdm
;
SQL结束执行时间：20190805174327
SQL开始执行时间：20190805174327

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174327
SQL开始执行时间：20190805174327
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174327
SQL开始执行时间：20190805174327

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805174327
SQL开始执行时间：20190805174327
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190805174327
SQL开始执行时间：20190805174327



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174327
SQL开始执行时间：20190805174327
create table pdm.fa_depreciation_pre as 
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174327
SQL开始执行时间：20190805174327


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174330
SQL开始执行时间：20190805174330

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174330

20190805174324开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805174330

use pdm
;
SQL结束执行时间：20190805174330
SQL开始执行时间：20190805174330

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174330
SQL开始执行时间：20190805174330
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174330
SQL开始执行时间：20190805174330

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805174330
SQL开始执行时间：20190805174330
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190805174330
SQL开始执行时间：20190805174330



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174330
SQL开始执行时间：20190805174330
create table pdm.fa_depreciation_pre as 
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174330
SQL开始执行时间：20190805174330


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174332
SQL开始执行时间：20190805174332

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174332

20190805174324开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805174332

use pdm
;
SQL结束执行时间：20190805174332
SQL开始执行时间：20190805174332

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174332
SQL开始执行时间：20190805174332
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174332
SQL开始执行时间：20190805174332

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805174332
SQL开始执行时间：20190805174332
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190805174332
SQL开始执行时间：20190805174332



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174332
SQL开始执行时间：20190805174332
create table pdm.fa_depreciation_pre as 
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174332
SQL开始执行时间：20190805174332


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174335
SQL开始执行时间：20190805174335

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174335

20190805174324开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805174335

use pdm
;
SQL结束执行时间：20190805174335
SQL开始执行时间：20190805174335

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174335
SQL开始执行时间：20190805174335
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174335
SQL开始执行时间：20190805174335

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805174335
SQL开始执行时间：20190805174335
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190805174335
SQL开始执行时间：20190805174335



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174335
SQL开始执行时间：20190805174335
create table pdm.fa_depreciation_pre as 
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174335
SQL开始执行时间：20190805174335


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174337
SQL开始执行时间：20190805174337

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174337

20190805174324开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805174337

use pdm
;
SQL结束执行时间：20190805174337
SQL开始执行时间：20190805174337

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174337
SQL开始执行时间：20190805174337
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174337
SQL开始执行时间：20190805174337

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805174337
SQL开始执行时间：20190805174337
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190805174337
SQL开始执行时间：20190805174337



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174337
SQL开始执行时间：20190805174337
create table pdm.fa_depreciation_pre as 
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174337
SQL开始执行时间：20190805174337


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174340
SQL开始执行时间：20190805174340

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174340

20190805174324开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805174340

use pdm
;
SQL结束执行时间：20190805174340
SQL开始执行时间：20190805174340

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174340
SQL开始执行时间：20190805174340
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174340
SQL开始执行时间：20190805174340

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805174340
SQL开始执行时间：20190805174340
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805174340
SQL开始执行时间：20190805174340



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174340
SQL开始执行时间：20190805174340
create table pdm.fa_depreciation_pre as 
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174340
SQL开始执行时间：20190805174340


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174343
SQL开始执行时间：20190805174343

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174343

20190805174324开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805174343

use pdm
;
SQL结束执行时间：20190805174343
SQL开始执行时间：20190805174343

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174343
SQL开始执行时间：20190805174343
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174343
SQL开始执行时间：20190805174343

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805174343
SQL开始执行时间：20190805174343
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805174343
SQL开始执行时间：20190805174343



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174343
SQL开始执行时间：20190805174343
create table pdm.fa_depreciation_pre as 
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174343
SQL开始执行时间：20190805174343


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174345
SQL开始执行时间：20190805174345

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174345

20190805174324开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805174345

use pdm
;
SQL结束执行时间：20190805174345
SQL开始执行时间：20190805174345

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174345
SQL开始执行时间：20190805174345
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174345
SQL开始执行时间：20190805174345

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805174345
SQL开始执行时间：20190805174345
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805174345
SQL开始执行时间：20190805174345



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174345
SQL开始执行时间：20190805174345
create table pdm.fa_depreciation_pre as 
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174345
SQL开始执行时间：20190805174345


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174348
SQL开始执行时间：20190805174348

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174348

20190805174324开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805174348

use pdm
;
SQL结束执行时间：20190805174348
SQL开始执行时间：20190805174348

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174348
SQL开始执行时间：20190805174348
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174348
SQL开始执行时间：20190805174348

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805174348
SQL开始执行时间：20190805174348
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805174348
SQL开始执行时间：20190805174348



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174348
SQL开始执行时间：20190805174348
create table pdm.fa_depreciation_pre as 
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174348
SQL开始执行时间：20190805174348


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174350
SQL开始执行时间：20190805174350

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174350

20190805174324开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805174350

use pdm
;
SQL结束执行时间：20190805174350
SQL开始执行时间：20190805174350

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174350
SQL开始执行时间：20190805174350
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174350
SQL开始执行时间：20190805174350

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805174350
SQL开始执行时间：20190805174350
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805174350
SQL开始执行时间：20190805174350



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174350
SQL开始执行时间：20190805174350
create table pdm.fa_depreciation_pre as 
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174350
SQL开始执行时间：20190805174350


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174353
SQL开始执行时间：20190805174353

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174353

20190805174324开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805174353

use pdm
;
SQL结束执行时间：20190805174353
SQL开始执行时间：20190805174353

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174353
SQL开始执行时间：20190805174353
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174353
SQL开始执行时间：20190805174353

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805174353
SQL开始执行时间：20190805174353
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805174353
SQL开始执行时间：20190805174353



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174353
SQL开始执行时间：20190805174353
create table pdm.fa_depreciation_pre as 
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174353
SQL开始执行时间：20190805174353


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174356
SQL开始执行时间：20190805174356

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174356

20190805174324开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805174356

use pdm
;
SQL结束执行时间：20190805174356
SQL开始执行时间：20190805174356

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174356
SQL开始执行时间：20190805174356
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174356
SQL开始执行时间：20190805174356

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805174356
SQL开始执行时间：20190805174356
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805174356
SQL开始执行时间：20190805174356



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174356
SQL开始执行时间：20190805174356
create table pdm.fa_depreciation_pre as 
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174356
SQL开始执行时间：20190805174356


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174359
SQL开始执行时间：20190805174359

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174359

20190805174324开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805174359

use pdm
;
SQL结束执行时间：20190805174359
SQL开始执行时间：20190805174359

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174359
SQL开始执行时间：20190805174359
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174359
SQL开始执行时间：20190805174359

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805174359
SQL开始执行时间：20190805174359
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805174359
SQL开始执行时间：20190805174359



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174359
SQL开始执行时间：20190805174359
create table pdm.fa_depreciation_pre as 
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174359
SQL开始执行时间：20190805174359


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174401
SQL开始执行时间：20190805174401

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174401

20190805174324开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805174401

use pdm
;
SQL结束执行时间：20190805174401
SQL开始执行时间：20190805174401

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174401
SQL开始执行时间：20190805174401
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174401
SQL开始执行时间：20190805174401

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805174401
SQL开始执行时间：20190805174401
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805174401
SQL开始执行时间：20190805174401



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174401
SQL开始执行时间：20190805174401
create table pdm.fa_depreciation_pre as 
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174402
SQL开始执行时间：20190805174402


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174404
SQL开始执行时间：20190805174404

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174404

20190805174324开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805174404

use pdm
;
SQL结束执行时间：20190805174404
SQL开始执行时间：20190805174404

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174404
SQL开始执行时间：20190805174404
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174404
SQL开始执行时间：20190805174404

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805174404
SQL开始执行时间：20190805174404
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805174404
SQL开始执行时间：20190805174404



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174404
SQL开始执行时间：20190805174404
create table pdm.fa_depreciation_pre as 
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174404
SQL开始执行时间：20190805174404


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174407
SQL开始执行时间：20190805174407

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174407

20190805174324开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805174407

use pdm
;
SQL结束执行时间：20190805174407
SQL开始执行时间：20190805174407

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174407
SQL开始执行时间：20190805174407
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174407
SQL开始执行时间：20190805174407

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805174407
SQL开始执行时间：20190805174407
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805174407
SQL开始执行时间：20190805174407



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174407
SQL开始执行时间：20190805174407
create table pdm.fa_depreciation_pre as 
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174407
SQL开始执行时间：20190805174407


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174410
SQL开始执行时间：20190805174410

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174410

20190805174324开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805174410

use pdm
;
SQL结束执行时间：20190805174410
SQL开始执行时间：20190805174410

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174410
SQL开始执行时间：20190805174410
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174410
SQL开始执行时间：20190805174410

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805174410
SQL开始执行时间：20190805174410
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805174410
SQL开始执行时间：20190805174410



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174410
SQL开始执行时间：20190805174410
create table pdm.fa_depreciation_pre as 
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174410
SQL开始执行时间：20190805174410


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174413
SQL开始执行时间：20190805174413

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174413

20190805174324开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805174413

use pdm
;
SQL结束执行时间：20190805174413
SQL开始执行时间：20190805174413

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174413
SQL开始执行时间：20190805174413
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174413
SQL开始执行时间：20190805174413

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805174413
SQL开始执行时间：20190805174413
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805174413
SQL开始执行时间：20190805174413



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174413
SQL开始执行时间：20190805174413
create table pdm.fa_depreciation_pre as 
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174413
SQL开始执行时间：20190805174413


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174415
SQL开始执行时间：20190805174415

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174416

20190805174324开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805174416

use pdm
;
SQL结束执行时间：20190805174416
SQL开始执行时间：20190805174416

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174416
SQL开始执行时间：20190805174416
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174416
SQL开始执行时间：20190805174416

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805174416
SQL开始执行时间：20190805174416
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805174416
SQL开始执行时间：20190805174416



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174416
SQL开始执行时间：20190805174416
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174416
SQL开始执行时间：20190805174416


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174418
SQL开始执行时间：20190805174418

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174418

20190805174324开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805174418

use pdm
;
SQL结束执行时间：20190805174418
SQL开始执行时间：20190805174418

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174418
SQL开始执行时间：20190805174418
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174418
SQL开始执行时间：20190805174418

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805174418
SQL开始执行时间：20190805174418
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805174418
SQL开始执行时间：20190805174418



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174418
SQL开始执行时间：20190805174418
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174419
SQL开始执行时间：20190805174419


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on a.date_ = DATE_SUB(b.date_,INTERVAL day(b.date_) day)
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174421
SQL开始执行时间：20190805174421

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174421

20190805174717开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190805174717

use pdm
;
SQL结束执行时间：20190805174717
SQL开始执行时间：20190805174717

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174717
SQL开始执行时间：20190805174717
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174717
SQL开始执行时间：20190805174717

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190805174717
SQL开始执行时间：20190805174717
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190805174717
SQL开始执行时间：20190805174717



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174717
SQL开始执行时间：20190805174717
create table pdm.fa_depreciation_pre as 
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174717
SQL开始执行时间：20190805174717


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174718

20190805174717开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190805174718

use pdm
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718
create table pdm.fa_depreciation_pre as 
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174718

20190805174717开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190805174718

use pdm
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718
create table pdm.fa_depreciation_pre as 
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174718
SQL开始执行时间：20190805174718


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174719

20190805174717开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190805174719

use pdm
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719
create table pdm.fa_depreciation_pre as 
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174719

20190805174717开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190805174719

use pdm
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719
create table pdm.fa_depreciation_pre as 
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174719
SQL开始执行时间：20190805174719


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174720

20190805174717开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190805174720

use pdm
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720
create table pdm.fa_depreciation_pre as 
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174720

20190805174717开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190805174720

use pdm
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720
create table pdm.fa_depreciation_pre as 
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174720
SQL开始执行时间：20190805174720


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174721

20190805174717开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190805174721

use pdm
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721
create table pdm.fa_depreciation_pre as 
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174721

20190805174717开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190805174721

use pdm
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721
create table pdm.fa_depreciation_pre as 
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174721
SQL开始执行时间：20190805174721


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174722

20190805174717开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190805174722

use pdm
;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722
create table pdm.fa_depreciation_pre as 
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174722

20190805174717开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190805174722

use pdm
;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174722
SQL开始执行时间：20190805174722
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723
create table pdm.fa_depreciation_pre as 
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174723

20190805174717开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190805174723

use pdm
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723
create table pdm.fa_depreciation_pre as 
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174723
SQL开始执行时间：20190805174723


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174724

20190805174717开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190805174724

use pdm
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724
create table pdm.fa_depreciation_pre as 
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174724

20190805174717开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190805174724

use pdm
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724
create table pdm.fa_depreciation_pre as 
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174724
SQL开始执行时间：20190805174724


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174725

20190805174717开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190805174725

use pdm
;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725
create table pdm.fa_depreciation_pre as 
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174725
SQL开始执行时间：20190805174725

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174726

20190805174717开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190805174726

use pdm
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726
create table pdm.fa_depreciation_pre as 
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174726

20190805174717开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190805174726

use pdm
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726
create table pdm.fa_depreciation_pre as 
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174726
SQL开始执行时间：20190805174726


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174727
SQL开始执行时间：20190805174727

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174727

20190805174717开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190805174727

use pdm
;
SQL结束执行时间：20190805174727
SQL开始执行时间：20190805174727

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174727
SQL开始执行时间：20190805174727
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174727
SQL开始执行时间：20190805174727

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190805174727
SQL开始执行时间：20190805174727
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190805174727
SQL开始执行时间：20190805174727



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174727
SQL开始执行时间：20190805174727
create table pdm.fa_depreciation_pre as 
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174727
SQL开始执行时间：20190805174727


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174728
SQL开始执行时间：20190805174728

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174728

20190805174717开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190805174728

use pdm
;
SQL结束执行时间：20190805174728
SQL开始执行时间：20190805174728

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174728
SQL开始执行时间：20190805174728
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174728
SQL开始执行时间：20190805174728

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190805174728
SQL开始执行时间：20190805174728
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190805174728
SQL开始执行时间：20190805174728



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174728
SQL开始执行时间：20190805174728
create table pdm.fa_depreciation_pre as 
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174728
SQL开始执行时间：20190805174728


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174729
SQL开始执行时间：20190805174729

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174729

20190805174717开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190805174729

use pdm
;
SQL结束执行时间：20190805174729
SQL开始执行时间：20190805174729

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174729
SQL开始执行时间：20190805174729
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174729
SQL开始执行时间：20190805174729

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190805174729
SQL开始执行时间：20190805174729
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190805174729
SQL开始执行时间：20190805174729



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174729
SQL开始执行时间：20190805174729
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174729
SQL开始执行时间：20190805174729


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174730
SQL开始执行时间：20190805174730

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174730

20190805174717开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190805174730

use pdm
;
SQL结束执行时间：20190805174730
SQL开始执行时间：20190805174730

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190805174730
SQL开始执行时间：20190805174730
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190805174730
SQL开始执行时间：20190805174730

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190805174730
SQL开始执行时间：20190805174730
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190805174730
SQL开始执行时间：20190805174730



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174730
SQL开始执行时间：20190805174730
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190805174730
SQL开始执行时间：20190805174730


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190805174732
SQL开始执行时间：20190805174732

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190805174732

20190807003034开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190807003034

use pdm
;
SQL结束执行时间：20190807003034
SQL开始执行时间：20190807003034

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807003034
SQL开始执行时间：20190807003034
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807003034
SQL开始执行时间：20190807003034

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190807003034
SQL开始执行时间：20190807003034
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190807003035
SQL开始执行时间：20190807003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807003035
SQL开始执行时间：20190807003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807003035
SQL开始执行时间：20190807003035


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then a.dblinputdeprtotal else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807003036
SQL开始执行时间：20190807003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807003036

20190807090416开始执行2018-1-31数据加载日志:
SQL开始执行时间：20190807090416

use pdm
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-1-31') and 
(dtransdate < '2018-1-31'  or  dtransdate is null) and 
(ddisposedate < '2018-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416

delete from pdm.fa_depreciation where left(date_,7) = left('2018-1-31',7)
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-1-31')
  and MONTH(date_) = MONTH('2018-1-31')
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416
create table pdm.fa_depreciation_pre as 
select 
     '2018-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090416

20190807090416开始执行2018-2-28数据加载日志:
SQL开始执行时间：20190807090416

use pdm
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-2-28') and 
(dtransdate < '2018-2-28'  or  dtransdate is null) and 
(ddisposedate < '2018-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416

delete from pdm.fa_depreciation where left(date_,7) = left('2018-2-28',7)
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-2-28')
  and MONTH(date_) = MONTH('2018-2-28')
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416
create table pdm.fa_depreciation_pre as 
select 
     '2018-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090416
SQL开始执行时间：20190807090416


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090417

20190807090416开始执行2018-3-31数据加载日志:
SQL开始执行时间：20190807090417

use pdm
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-3-31') and 
(dtransdate < '2018-3-31'  or  dtransdate is null) and 
(ddisposedate < '2018-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417

delete from pdm.fa_depreciation where left(date_,7) = left('2018-3-31',7)
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-3-31')
  and MONTH(date_) = MONTH('2018-3-31')
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417
create table pdm.fa_depreciation_pre as 
select 
     '2018-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090417

20190807090416开始执行2018-4-30数据加载日志:
SQL开始执行时间：20190807090417

use pdm
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-4-30') and 
(dtransdate < '2018-4-30'  or  dtransdate is null) and 
(ddisposedate < '2018-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417

delete from pdm.fa_depreciation where left(date_,7) = left('2018-4-30',7)
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-4-30')
  and MONTH(date_) = MONTH('2018-4-30')
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417
create table pdm.fa_depreciation_pre as 
select 
     '2018-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090417
SQL开始执行时间：20190807090417


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090418

20190807090416开始执行2018-5-31数据加载日志:
SQL开始执行时间：20190807090418

use pdm
;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-5-31') and 
(dtransdate < '2018-5-31'  or  dtransdate is null) and 
(ddisposedate < '2018-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418

delete from pdm.fa_depreciation where left(date_,7) = left('2018-5-31',7)
;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-5-31')
  and MONTH(date_) = MONTH('2018-5-31')
;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418
create table pdm.fa_depreciation_pre as 
select 
     '2018-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090418

20190807090416开始执行2018-6-30数据加载日志:
SQL开始执行时间：20190807090418

use pdm
;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090418
SQL开始执行时间：20190807090418
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-6-30') and 
(dtransdate < '2018-6-30'  or  dtransdate is null) and 
(ddisposedate < '2018-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419

delete from pdm.fa_depreciation where left(date_,7) = left('2018-6-30',7)
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-6-30')
  and MONTH(date_) = MONTH('2018-6-30')
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419
create table pdm.fa_depreciation_pre as 
select 
     '2018-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090419

20190807090416开始执行2018-7-31数据加载日志:
SQL开始执行时间：20190807090419

use pdm
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-7-31') and 
(dtransdate < '2018-7-31'  or  dtransdate is null) and 
(ddisposedate < '2018-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419

delete from pdm.fa_depreciation where left(date_,7) = left('2018-7-31',7)
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-7-31')
  and MONTH(date_) = MONTH('2018-7-31')
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419
create table pdm.fa_depreciation_pre as 
select 
     '2018-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090419
SQL开始执行时间：20190807090419


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090420

20190807090416开始执行2018-8-31数据加载日志:
SQL开始执行时间：20190807090420

use pdm
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-8-31') and 
(dtransdate < '2018-8-31'  or  dtransdate is null) and 
(ddisposedate < '2018-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420

delete from pdm.fa_depreciation where left(date_,7) = left('2018-8-31',7)
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-8-31')
  and MONTH(date_) = MONTH('2018-8-31')
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420
create table pdm.fa_depreciation_pre as 
select 
     '2018-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090420

20190807090416开始执行2018-9-30数据加载日志:
SQL开始执行时间：20190807090420

use pdm
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-9-30') and 
(dtransdate < '2018-9-30'  or  dtransdate is null) and 
(ddisposedate < '2018-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420

delete from pdm.fa_depreciation where left(date_,7) = left('2018-9-30',7)
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-9-30')
  and MONTH(date_) = MONTH('2018-9-30')
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420
create table pdm.fa_depreciation_pre as 
select 
     '2018-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090420
SQL开始执行时间：20190807090420


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090421

20190807090416开始执行2018-10-31数据加载日志:
SQL开始执行时间：20190807090421

use pdm
;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-10-31') and 
(dtransdate < '2018-10-31'  or  dtransdate is null) and 
(ddisposedate < '2018-10-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421

delete from pdm.fa_depreciation where left(date_,7) = left('2018-10-31',7)
;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-10-31')
  and MONTH(date_) = MONTH('2018-10-31')
;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421
create table pdm.fa_depreciation_pre as 
select 
     '2018-10-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-10-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-10-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090421

20190807090416开始执行2018-11-30数据加载日志:
SQL开始执行时间：20190807090421

use pdm
;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090421
SQL开始执行时间：20190807090421
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-11-30') and 
(dtransdate < '2018-11-30'  or  dtransdate is null) and 
(ddisposedate < '2018-11-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422

delete from pdm.fa_depreciation where left(date_,7) = left('2018-11-30',7)
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-11-30')
  and MONTH(date_) = MONTH('2018-11-30')
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422
create table pdm.fa_depreciation_pre as 
select 
     '2018-11-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-11-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-11-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090422

20190807090416开始执行2018-12-31数据加载日志:
SQL开始执行时间：20190807090422

use pdm
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2018-12-31') and 
(dtransdate < '2018-12-31'  or  dtransdate is null) and 
(ddisposedate < '2018-12-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422

delete from pdm.fa_depreciation where left(date_,7) = left('2018-12-31',7)
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2018-12-31')
  and MONTH(date_) = MONTH('2018-12-31')
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422
create table pdm.fa_depreciation_pre as 
select 
     '2018-12-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2018-12-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2018-12-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090422
SQL开始执行时间：20190807090422


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090423

20190807090416开始执行2019-1-31数据加载日志:
SQL开始执行时间：20190807090423

use pdm
;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-1-31') and 
(dtransdate < '2019-1-31'  or  dtransdate is null) and 
(ddisposedate < '2019-1-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423

delete from pdm.fa_depreciation where left(date_,7) = left('2019-1-31',7)
;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-1-31')
  and MONTH(date_) = MONTH('2019-1-31')
;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423
create table pdm.fa_depreciation_pre as 
select 
     '2019-1-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-1-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-1-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090423

20190807090416开始执行2019-2-28数据加载日志:
SQL开始执行时间：20190807090423

use pdm
;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-2-28') and 
(dtransdate < '2019-2-28'  or  dtransdate is null) and 
(ddisposedate < '2019-2-28'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090423
SQL开始执行时间：20190807090423

delete from pdm.fa_depreciation where left(date_,7) = left('2019-2-28',7)
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-2-28')
  and MONTH(date_) = MONTH('2019-2-28')
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424
create table pdm.fa_depreciation_pre as 
select 
     '2019-2-28' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-2-28') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-2-28')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090424

20190807090416开始执行2019-3-31数据加载日志:
SQL开始执行时间：20190807090424

use pdm
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-3-31') and 
(dtransdate < '2019-3-31'  or  dtransdate is null) and 
(ddisposedate < '2019-3-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424

delete from pdm.fa_depreciation where left(date_,7) = left('2019-3-31',7)
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-3-31')
  and MONTH(date_) = MONTH('2019-3-31')
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424
create table pdm.fa_depreciation_pre as 
select 
     '2019-3-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-3-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-3-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090424
SQL开始执行时间：20190807090424


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090425

20190807090416开始执行2019-4-30数据加载日志:
SQL开始执行时间：20190807090425

use pdm
;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-4-30') and 
(dtransdate < '2019-4-30'  or  dtransdate is null) and 
(ddisposedate < '2019-4-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425

delete from pdm.fa_depreciation where left(date_,7) = left('2019-4-30',7)
;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-4-30')
  and MONTH(date_) = MONTH('2019-4-30')
;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425
create table pdm.fa_depreciation_pre as 
select 
     '2019-4-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-4-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-4-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090425

20190807090416开始执行2019-5-31数据加载日志:
SQL开始执行时间：20190807090425

use pdm
;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090425
SQL开始执行时间：20190807090425
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-5-31') and 
(dtransdate < '2019-5-31'  or  dtransdate is null) and 
(ddisposedate < '2019-5-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426

delete from pdm.fa_depreciation where left(date_,7) = left('2019-5-31',7)
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-5-31')
  and MONTH(date_) = MONTH('2019-5-31')
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426
create table pdm.fa_depreciation_pre as 
select 
     '2019-5-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-5-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-5-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090426

20190807090416开始执行2019-6-30数据加载日志:
SQL开始执行时间：20190807090426

use pdm
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-6-30') and 
(dtransdate < '2019-6-30'  or  dtransdate is null) and 
(ddisposedate < '2019-6-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426

delete from pdm.fa_depreciation where left(date_,7) = left('2019-6-30',7)
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-6-30')
  and MONTH(date_) = MONTH('2019-6-30')
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426
create table pdm.fa_depreciation_pre as 
select 
     '2019-6-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-6-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-6-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090426
SQL开始执行时间：20190807090426


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090427
SQL开始执行时间：20190807090427

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090427

20190807090416开始执行2019-7-31数据加载日志:
SQL开始执行时间：20190807090427

use pdm
;
SQL结束执行时间：20190807090427
SQL开始执行时间：20190807090427

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090427
SQL开始执行时间：20190807090427
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-7-31') and 
(dtransdate < '2019-7-31'  or  dtransdate is null) and 
(ddisposedate < '2019-7-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090427
SQL开始执行时间：20190807090427

delete from pdm.fa_depreciation where left(date_,7) = left('2019-7-31',7)
;
SQL结束执行时间：20190807090427
SQL开始执行时间：20190807090427
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-7-31')
  and MONTH(date_) = MONTH('2019-7-31')
;
SQL结束执行时间：20190807090427
SQL开始执行时间：20190807090427



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090427
SQL开始执行时间：20190807090427
create table pdm.fa_depreciation_pre as 
select 
     '2019-7-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-7-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-7-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090427
SQL开始执行时间：20190807090427


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090428
SQL开始执行时间：20190807090428

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090428

20190807090416开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190807090428

use pdm
;
SQL结束执行时间：20190807090428
SQL开始执行时间：20190807090428

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190807090428
SQL开始执行时间：20190807090428
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190807090428
SQL开始执行时间：20190807090428

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190807090428
SQL开始执行时间：20190807090428
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190807090428
SQL开始执行时间：20190807090428



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090428
SQL开始执行时间：20190807090428
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190807090428
SQL开始执行时间：20190807090428


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190807090429
SQL开始执行时间：20190807090429

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190807090429

20190808003037开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190808003037

use pdm
;
SQL结束执行时间：20190808003037
SQL开始执行时间：20190808003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190808003037
SQL开始执行时间：20190808003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190808003037
SQL开始执行时间：20190808003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190808003037
SQL开始执行时间：20190808003037
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190808003038
SQL开始执行时间：20190808003038



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190808003038
SQL开始执行时间：20190808003038
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190808003038
SQL开始执行时间：20190808003038


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190808003039
SQL开始执行时间：20190808003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190808003039

20190809003034开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190809003034

use pdm
;
SQL结束执行时间：20190809003034
SQL开始执行时间：20190809003034

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190809003034
SQL开始执行时间：20190809003034
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190809003034
SQL开始执行时间：20190809003034

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190809003034
SQL开始执行时间：20190809003034
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190809003034
SQL开始执行时间：20190809003034



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190809003034
SQL开始执行时间：20190809003034
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190809003035
SQL开始执行时间：20190809003035


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190809003036
SQL开始执行时间：20190809003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190809003036

20190810003037开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190810003037

use pdm
;
SQL结束执行时间：20190810003037
SQL开始执行时间：20190810003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190810003037
SQL开始执行时间：20190810003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190810003037
SQL开始执行时间：20190810003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190810003038
SQL开始执行时间：20190810003038
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190810003038
SQL开始执行时间：20190810003038



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190810003038
SQL开始执行时间：20190810003038
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190810003038
SQL开始执行时间：20190810003038


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190810003039
SQL开始执行时间：20190810003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190810003039

20190811003037开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190811003037

use pdm
;
SQL结束执行时间：20190811003037
SQL开始执行时间：20190811003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190811003037
SQL开始执行时间：20190811003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190811003037
SQL开始执行时间：20190811003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190811003037
SQL开始执行时间：20190811003037
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190811003038
SQL开始执行时间：20190811003038



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190811003038
SQL开始执行时间：20190811003038
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190811003038
SQL开始执行时间：20190811003038


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190811003039
SQL开始执行时间：20190811003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190811003039

20190812003039开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190812003039

use pdm
;
SQL结束执行时间：20190812003039
SQL开始执行时间：20190812003039

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190812003039
SQL开始执行时间：20190812003039
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190812003039
SQL开始执行时间：20190812003039

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190812003039
SQL开始执行时间：20190812003039
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190812003039
SQL开始执行时间：20190812003039



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190812003039
SQL开始执行时间：20190812003039
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190812003039
SQL开始执行时间：20190812003039


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190812003040
SQL开始执行时间：20190812003040

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190812003040

20190813003036开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190813003036

use pdm
;
SQL结束执行时间：20190813003036
SQL开始执行时间：20190813003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190813003036
SQL开始执行时间：20190813003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190813003036
SQL开始执行时间：20190813003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190813003036
SQL开始执行时间：20190813003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190813003036
SQL开始执行时间：20190813003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190813003036
SQL开始执行时间：20190813003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190813003036
SQL开始执行时间：20190813003036


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190813003037
SQL开始执行时间：20190813003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190813003037

20190814003035开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190814003035

use pdm
;
SQL结束执行时间：20190814003035
SQL开始执行时间：20190814003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190814003035
SQL开始执行时间：20190814003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190814003035
SQL开始执行时间：20190814003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190814003035
SQL开始执行时间：20190814003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190814003035
SQL开始执行时间：20190814003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190814003035
SQL开始执行时间：20190814003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190814003035
SQL开始执行时间：20190814003035


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190814003036
SQL开始执行时间：20190814003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190814003036

20190815003035开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190815003035

use pdm
;
SQL结束执行时间：20190815003035
SQL开始执行时间：20190815003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190815003035
SQL开始执行时间：20190815003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190815003035
SQL开始执行时间：20190815003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190815003035
SQL开始执行时间：20190815003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190815003036
SQL开始执行时间：20190815003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190815003036
SQL开始执行时间：20190815003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190815003036
SQL开始执行时间：20190815003036


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190815003037
SQL开始执行时间：20190815003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190815003037

20190816003035开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190816003035

use pdm
;
SQL结束执行时间：20190816003035
SQL开始执行时间：20190816003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190816003035
SQL开始执行时间：20190816003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190816003035
SQL开始执行时间：20190816003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190816003035
SQL开始执行时间：20190816003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190816003035
SQL开始执行时间：20190816003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190816003035
SQL开始执行时间：20190816003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190816003035
SQL开始执行时间：20190816003035


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190816003036
SQL开始执行时间：20190816003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190816003036

20190817003036开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190817003036

use pdm
;
SQL结束执行时间：20190817003036
SQL开始执行时间：20190817003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190817003036
SQL开始执行时间：20190817003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190817003036
SQL开始执行时间：20190817003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190817003036
SQL开始执行时间：20190817003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190817003036
SQL开始执行时间：20190817003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190817003036
SQL开始执行时间：20190817003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190817003036
SQL开始执行时间：20190817003036


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190817003037
SQL开始执行时间：20190817003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190817003037

20190818003036开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190818003036

use pdm
;
SQL结束执行时间：20190818003036
SQL开始执行时间：20190818003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190818003036
SQL开始执行时间：20190818003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190818003036
SQL开始执行时间：20190818003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190818003036
SQL开始执行时间：20190818003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190818003036
SQL开始执行时间：20190818003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190818003036
SQL开始执行时间：20190818003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190818003036
SQL开始执行时间：20190818003036


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190818003037
SQL开始执行时间：20190818003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190818003037

20190819003035开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190819003035

use pdm
;
SQL结束执行时间：20190819003035
SQL开始执行时间：20190819003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190819003035
SQL开始执行时间：20190819003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190819003035
SQL开始执行时间：20190819003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190819003036
SQL开始执行时间：20190819003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190819003036
SQL开始执行时间：20190819003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190819003036
SQL开始执行时间：20190819003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190819003036
SQL开始执行时间：20190819003036


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190819003037
SQL开始执行时间：20190819003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190819003037

20190820003037开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190820003037

use pdm
;
SQL结束执行时间：20190820003037
SQL开始执行时间：20190820003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190820003037
SQL开始执行时间：20190820003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190820003037
SQL开始执行时间：20190820003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190820003037
SQL开始执行时间：20190820003037
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190820003038
SQL开始执行时间：20190820003038



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190820003038
SQL开始执行时间：20190820003038
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190820003038
SQL开始执行时间：20190820003038


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190820003039
SQL开始执行时间：20190820003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190820003039

20190821003039开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190821003039

use pdm
;
SQL结束执行时间：20190821003039
SQL开始执行时间：20190821003039

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190821003039
SQL开始执行时间：20190821003039
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190821003039
SQL开始执行时间：20190821003039

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190821003039
SQL开始执行时间：20190821003039
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190821003039
SQL开始执行时间：20190821003039



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190821003039
SQL开始执行时间：20190821003039
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190821003040
SQL开始执行时间：20190821003040


insert into  pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190821003041
SQL开始执行时间：20190821003041

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190821003041

20190822003035开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190822003035

use pdm
;
SQL结束执行时间：20190822003035
SQL开始执行时间：20190822003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190822003035
SQL开始执行时间：20190822003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190822003035
SQL开始执行时间：20190822003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190822003035
SQL开始执行时间：20190822003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190822003036
SQL开始执行时间：20190822003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190822003036
SQL开始执行时间：20190822003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190822003036
SQL开始执行时间：20190822003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190822003037
SQL开始执行时间：20190822003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190822003037

20190823003035开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190823003035

use pdm
;
SQL结束执行时间：20190823003035
SQL开始执行时间：20190823003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190823003035
SQL开始执行时间：20190823003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190823003035
SQL开始执行时间：20190823003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190823003036
SQL开始执行时间：20190823003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190823003036
SQL开始执行时间：20190823003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190823003036
SQL开始执行时间：20190823003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190823003036
SQL开始执行时间：20190823003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190823003037
SQL开始执行时间：20190823003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190823003037

20190824003037开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190824003037

use pdm
;
SQL结束执行时间：20190824003037
SQL开始执行时间：20190824003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190824003037
SQL开始执行时间：20190824003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190824003037
SQL开始执行时间：20190824003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190824003038
SQL开始执行时间：20190824003038
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190824003038
SQL开始执行时间：20190824003038



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190824003038
SQL开始执行时间：20190824003038
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190824003038
SQL开始执行时间：20190824003038


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190824003039
SQL开始执行时间：20190824003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190824003039

20190825003034开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190825003034

use pdm
;
SQL结束执行时间：20190825003034
SQL开始执行时间：20190825003034

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190825003034
SQL开始执行时间：20190825003034
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190825003034
SQL开始执行时间：20190825003034

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190825003034
SQL开始执行时间：20190825003034
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190825003034
SQL开始执行时间：20190825003034



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190825003034
SQL开始执行时间：20190825003034
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190825003034
SQL开始执行时间：20190825003034


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190825003035
SQL开始执行时间：20190825003035

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190825003035

20190826003035开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190826003035

use pdm
;
SQL结束执行时间：20190826003035
SQL开始执行时间：20190826003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190826003035
SQL开始执行时间：20190826003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190826003035
SQL开始执行时间：20190826003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190826003035
SQL开始执行时间：20190826003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190826003035
SQL开始执行时间：20190826003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190826003035
SQL开始执行时间：20190826003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190826003035
SQL开始执行时间：20190826003035


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190826003036
SQL开始执行时间：20190826003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190826003036

20190828084556开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190828084556

use pdm
;
SQL结束执行时间：20190828084556
SQL开始执行时间：20190828084556

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190828084556
SQL开始执行时间：20190828084556
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190828084556
SQL开始执行时间：20190828084556

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190828084556
SQL开始执行时间：20190828084556
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190828084556
SQL开始执行时间：20190828084556



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190828084556
SQL开始执行时间：20190828084556
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190828084556
SQL开始执行时间：20190828084556


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190828084557
SQL开始执行时间：20190828084557

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190828084557

20190829003036开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190829003036

use pdm
;
SQL结束执行时间：20190829003036
SQL开始执行时间：20190829003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190829003036
SQL开始执行时间：20190829003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190829003036
SQL开始执行时间：20190829003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190829003036
SQL开始执行时间：20190829003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190829003036
SQL开始执行时间：20190829003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190829003036
SQL开始执行时间：20190829003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190829003036
SQL开始执行时间：20190829003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190829003037
SQL开始执行时间：20190829003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190829003037

20190830003037开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190830003037

use pdm
;
SQL结束执行时间：20190830003037
SQL开始执行时间：20190830003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190830003037
SQL开始执行时间：20190830003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190830003037
SQL开始执行时间：20190830003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190830003037
SQL开始执行时间：20190830003037
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190830003037
SQL开始执行时间：20190830003037



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190830003037
SQL开始执行时间：20190830003037
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190830003037
SQL开始执行时间：20190830003037


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190830003039
SQL开始执行时间：20190830003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190830003039

20190831003035开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190831003035

use pdm
;
SQL结束执行时间：20190831003035
SQL开始执行时间：20190831003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190831003035
SQL开始执行时间：20190831003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190831003035
SQL开始执行时间：20190831003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190831003035
SQL开始执行时间：20190831003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190831003035
SQL开始执行时间：20190831003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190831003035
SQL开始执行时间：20190831003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190831003036
SQL开始执行时间：20190831003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190831003037
SQL开始执行时间：20190831003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190831003037

20190901003037开始执行2019-8-31数据加载日志:
SQL开始执行时间：20190901003037

use pdm
;
SQL结束执行时间：20190901003037
SQL开始执行时间：20190901003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190901003037
SQL开始执行时间：20190901003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-8-31') and 
(dtransdate < '2019-8-31'  or  dtransdate is null) and 
(ddisposedate < '2019-8-31'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190901003037
SQL开始执行时间：20190901003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-8-31',7)
;
SQL结束执行时间：20190901003037
SQL开始执行时间：20190901003037
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-8-31')
  and MONTH(date_) = MONTH('2019-8-31')
;
SQL结束执行时间：20190901003037
SQL开始执行时间：20190901003037



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190901003037
SQL开始执行时间：20190901003037
create table pdm.fa_depreciation_pre as 
select 
     '2019-8-31' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-8-31') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-8-31')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190901003038
SQL开始执行时间：20190901003038


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190901003039
SQL开始执行时间：20190901003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190901003039

20190902003040开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190902003040

use pdm
;
SQL结束执行时间：20190902003040
SQL开始执行时间：20190902003040

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190902003040
SQL开始执行时间：20190902003040
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190902003040
SQL开始执行时间：20190902003040

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190902003040
SQL开始执行时间：20190902003040
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190902003041
SQL开始执行时间：20190902003041



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190902003041
SQL开始执行时间：20190902003041
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190902003041
SQL开始执行时间：20190902003041


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190902003042
SQL开始执行时间：20190902003042

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190902003042

20190903003036开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190903003036

use pdm
;
SQL结束执行时间：20190903003036
SQL开始执行时间：20190903003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190903003036
SQL开始执行时间：20190903003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190903003036
SQL开始执行时间：20190903003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190903003036
SQL开始执行时间：20190903003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190903003036
SQL开始执行时间：20190903003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190903003036
SQL开始执行时间：20190903003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190903003036
SQL开始执行时间：20190903003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190903003038
SQL开始执行时间：20190903003038

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190903003038

20190904103540开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190904103540

use pdm
;
SQL结束执行时间：20190904103540
SQL开始执行时间：20190904103540

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190904103540
SQL开始执行时间：20190904103540
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190904103540
SQL开始执行时间：20190904103540

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190904103540
SQL开始执行时间：20190904103540
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190904103540
SQL开始执行时间：20190904103540



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190904103540
SQL开始执行时间：20190904103540
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190904103540
SQL开始执行时间：20190904103540


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190904103542
SQL开始执行时间：20190904103542

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190904103542

20190905003033开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190905003033

use pdm
;
SQL结束执行时间：20190905003033
SQL开始执行时间：20190905003033

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190905003033
SQL开始执行时间：20190905003033
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190905003033
SQL开始执行时间：20190905003033

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190905003033
SQL开始执行时间：20190905003033
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190905003034
SQL开始执行时间：20190905003034



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190905003034
SQL开始执行时间：20190905003034
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190905003034
SQL开始执行时间：20190905003034


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190905003035
SQL开始执行时间：20190905003035

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190905003035

20190906003036开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190906003036

use pdm
;
SQL结束执行时间：20190906003036
SQL开始执行时间：20190906003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190906003036
SQL开始执行时间：20190906003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190906003036
SQL开始执行时间：20190906003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190906003036
SQL开始执行时间：20190906003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190906003036
SQL开始执行时间：20190906003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190906003036
SQL开始执行时间：20190906003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190906003037
SQL开始执行时间：20190906003037


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190906003038
SQL开始执行时间：20190906003038

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190906003038

20190907003035开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190907003035

use pdm
;
SQL结束执行时间：20190907003035
SQL开始执行时间：20190907003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190907003035
SQL开始执行时间：20190907003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190907003035
SQL开始执行时间：20190907003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190907003035
SQL开始执行时间：20190907003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190907003035
SQL开始执行时间：20190907003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190907003035
SQL开始执行时间：20190907003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190907003035
SQL开始执行时间：20190907003035


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190907003037
SQL开始执行时间：20190907003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190907003037

20190908003034开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190908003034

use pdm
;
SQL结束执行时间：20190908003034
SQL开始执行时间：20190908003034

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190908003034
SQL开始执行时间：20190908003034
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190908003034
SQL开始执行时间：20190908003034

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190908003034
SQL开始执行时间：20190908003034
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190908003034
SQL开始执行时间：20190908003034



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190908003034
SQL开始执行时间：20190908003034
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190908003034
SQL开始执行时间：20190908003034


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190908003036
SQL开始执行时间：20190908003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190908003036

20190909003034开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190909003034

use pdm
;
SQL结束执行时间：20190909003034
SQL开始执行时间：20190909003034

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190909003034
SQL开始执行时间：20190909003034
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190909003034
SQL开始执行时间：20190909003034

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190909003035
SQL开始执行时间：20190909003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190909003035
SQL开始执行时间：20190909003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190909003035
SQL开始执行时间：20190909003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190909003035
SQL开始执行时间：20190909003035


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190909003036
SQL开始执行时间：20190909003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190909003036

20190910003035开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190910003035

use pdm
;
SQL结束执行时间：20190910003035
SQL开始执行时间：20190910003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190910003035
SQL开始执行时间：20190910003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190910003035
SQL开始执行时间：20190910003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190910003035
SQL开始执行时间：20190910003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190910003035
SQL开始执行时间：20190910003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190910003035
SQL开始执行时间：20190910003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190910003036
SQL开始执行时间：20190910003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190910003037
SQL开始执行时间：20190910003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190910003037

20190911003034开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190911003034

use pdm
;
SQL结束执行时间：20190911003034
SQL开始执行时间：20190911003034

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190911003034
SQL开始执行时间：20190911003034
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190911003034
SQL开始执行时间：20190911003034

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190911003034
SQL开始执行时间：20190911003034
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190911003034
SQL开始执行时间：20190911003034



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190911003034
SQL开始执行时间：20190911003034
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190911003034
SQL开始执行时间：20190911003034


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190911003036
SQL开始执行时间：20190911003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190911003036

20190912003036开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190912003036

use pdm
;
SQL结束执行时间：20190912003036
SQL开始执行时间：20190912003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190912003036
SQL开始执行时间：20190912003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190912003037
SQL开始执行时间：20190912003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190912003037
SQL开始执行时间：20190912003037
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190912003037
SQL开始执行时间：20190912003037



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190912003037
SQL开始执行时间：20190912003037
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190912003037
SQL开始执行时间：20190912003037


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190912003038
SQL开始执行时间：20190912003038

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190912003038

20190913003035开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190913003035

use pdm
;
SQL结束执行时间：20190913003035
SQL开始执行时间：20190913003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190913003035
SQL开始执行时间：20190913003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190913003035
SQL开始执行时间：20190913003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190913003035
SQL开始执行时间：20190913003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190913003035
SQL开始执行时间：20190913003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190913003035
SQL开始执行时间：20190913003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190913003035
SQL开始执行时间：20190913003035


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190913003037
SQL开始执行时间：20190913003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190913003037

20190914003104开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190914003104

use pdm
;
SQL结束执行时间：20190914003104
SQL开始执行时间：20190914003104

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190914003104
SQL开始执行时间：20190914003104
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190914003104
SQL开始执行时间：20190914003104

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190914003104
SQL开始执行时间：20190914003104
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190914003104
SQL开始执行时间：20190914003104



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190914003104
SQL开始执行时间：20190914003104
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190914003104
SQL开始执行时间：20190914003104


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190914003106
SQL开始执行时间：20190914003106

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190914003106

20190915003040开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190915003040

use pdm
;
SQL结束执行时间：20190915003040
SQL开始执行时间：20190915003040

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190915003040
SQL开始执行时间：20190915003040
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190915003040
SQL开始执行时间：20190915003040

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190915003040
SQL开始执行时间：20190915003040
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190915003041
SQL开始执行时间：20190915003041



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190915003041
SQL开始执行时间：20190915003041
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190915003041
SQL开始执行时间：20190915003041


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190915003042
SQL开始执行时间：20190915003042

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190915003042

20190916003036开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190916003036

use pdm
;
SQL结束执行时间：20190916003036
SQL开始执行时间：20190916003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190916003036
SQL开始执行时间：20190916003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190916003036
SQL开始执行时间：20190916003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190916003036
SQL开始执行时间：20190916003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190916003036
SQL开始执行时间：20190916003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190916003036
SQL开始执行时间：20190916003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190916003036
SQL开始执行时间：20190916003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190916003038
SQL开始执行时间：20190916003038

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190916003038

20190917003034开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190917003034

use pdm
;
SQL结束执行时间：20190917003034
SQL开始执行时间：20190917003034

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190917003034
SQL开始执行时间：20190917003034
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190917003034
SQL开始执行时间：20190917003034

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190917003035
SQL开始执行时间：20190917003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190917003035
SQL开始执行时间：20190917003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190917003035
SQL开始执行时间：20190917003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190917003035
SQL开始执行时间：20190917003035


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190917003036
SQL开始执行时间：20190917003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190917003036

20190918003035开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190918003035

use pdm
;
SQL结束执行时间：20190918003035
SQL开始执行时间：20190918003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190918003035
SQL开始执行时间：20190918003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190918003035
SQL开始执行时间：20190918003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190918003035
SQL开始执行时间：20190918003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190918003035
SQL开始执行时间：20190918003035



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190918003035
SQL开始执行时间：20190918003035
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190918003036
SQL开始执行时间：20190918003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190918003037
SQL开始执行时间：20190918003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190918003037

20190919003034开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190919003034

use pdm
;
SQL结束执行时间：20190919003034
SQL开始执行时间：20190919003034

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190919003034
SQL开始执行时间：20190919003034
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190919003034
SQL开始执行时间：20190919003034

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190919003034
SQL开始执行时间：20190919003034
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190919003034
SQL开始执行时间：20190919003034



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190919003034
SQL开始执行时间：20190919003034
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190919003034
SQL开始执行时间：20190919003034


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190919003036
SQL开始执行时间：20190919003036

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190919003036

20190920003037开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190920003037

use pdm
;
SQL结束执行时间：20190920003037
SQL开始执行时间：20190920003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190920003037
SQL开始执行时间：20190920003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190920003037
SQL开始执行时间：20190920003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190920003037
SQL开始执行时间：20190920003037
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190920003038
SQL开始执行时间：20190920003038



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190920003038
SQL开始执行时间：20190920003038
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190920003038
SQL开始执行时间：20190920003038


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190920003039
SQL开始执行时间：20190920003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190920003039

20190921003035开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190921003035

use pdm
;
SQL结束执行时间：20190921003035
SQL开始执行时间：20190921003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190921003035
SQL开始执行时间：20190921003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190921003036
SQL开始执行时间：20190921003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190921003036
SQL开始执行时间：20190921003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190921003036
SQL开始执行时间：20190921003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190921003036
SQL开始执行时间：20190921003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190921003036
SQL开始执行时间：20190921003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190921003038
SQL开始执行时间：20190921003038

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190921003038

20190922003036开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190922003036

use pdm
;
SQL结束执行时间：20190922003036
SQL开始执行时间：20190922003036

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190922003036
SQL开始执行时间：20190922003036
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190922003036
SQL开始执行时间：20190922003036

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190922003036
SQL开始执行时间：20190922003036
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190922003036
SQL开始执行时间：20190922003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190922003036
SQL开始执行时间：20190922003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190922003036
SQL开始执行时间：20190922003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190922003038
SQL开始执行时间：20190922003038

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190922003038

20190923003035开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190923003035

use pdm
;
SQL结束执行时间：20190923003035
SQL开始执行时间：20190923003035

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190923003035
SQL开始执行时间：20190923003035
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190923003035
SQL开始执行时间：20190923003035

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190923003035
SQL开始执行时间：20190923003035
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190923003036
SQL开始执行时间：20190923003036



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190923003036
SQL开始执行时间：20190923003036
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190923003036
SQL开始执行时间：20190923003036


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190923003037
SQL开始执行时间：20190923003037

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190923003037

20190924003037开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190924003037

use pdm
;
SQL结束执行时间：20190924003037
SQL开始执行时间：20190924003037

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190924003037
SQL开始执行时间：20190924003037
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190924003037
SQL开始执行时间：20190924003037

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190924003037
SQL开始执行时间：20190924003037
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190924003038
SQL开始执行时间：20190924003038



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190924003038
SQL开始执行时间：20190924003038
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190924003038
SQL开始执行时间：20190924003038


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190924003039
SQL开始执行时间：20190924003039

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190924003039

20190925003055开始执行2019-9-30数据加载日志:
SQL开始执行时间：20190925003055

use pdm
;
SQL结束执行时间：20190925003055
SQL开始执行时间：20190925003055

drop temporary table if exists pdm.fa_tem01
;
SQL结束执行时间：20190925003055
SQL开始执行时间：20190925003055
create temporary table if not exists pdm.fa_tem01
select
    a.sdeptnum
    ,a.db
    ,a.scardid
    ,a.scardnum
    ,a.sassetnum
    ,a.sassetname
    ,a.stypenum
    ,a.ssite
    ,a.llife
    ,a.lusedmonths
    ,a.dstartdate
    ,a.dinputdate
    ,a.dtransdate
    ,a.ddisposedate
    ,a.dblValue
    ,a.dblBV
from ufdata.fa_cards as a left join 
(
select 
    db
    ,max(scardid) as scardid 
from ufdata.fa_cards 
where (
(dinputdate <= '2019-9-30') and 
(dtransdate < '2019-9-30'  or  dtransdate is null) and 
(ddisposedate < '2019-9-30'  or  ddisposedate is null)
)
group by db,scardnum
) as b 
on a.db = b.db and a.scardid = b.scardid 
where b.scardid is not null

;
SQL结束执行时间：20190925003055
SQL开始执行时间：20190925003055

delete from pdm.fa_depreciation where left(date_,7) = left('2019-9-30',7)
;
SQL结束执行时间：20190925003055
SQL开始执行时间：20190925003055
DELETE 
FROM
	pdm.fa_depreciation 
WHERE YEAR ( date_ ) = YEAR ('2019-9-30')
  and MONTH(date_) = MONTH('2019-9-30')
;
SQL结束执行时间：20190925003055
SQL开始执行时间：20190925003055



drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190925003055
SQL开始执行时间：20190925003055
create table pdm.fa_depreciation_pre as 
select 
     '2019-9-30' as date_
    ,a.* 
    ,b.dblinputvalue
    ,b.dblmonthvalue
    ,b.dblperiodvalue
    ,b.dblinputdeprtotal
    ,b.linputlife
    ,b.linputdeprmonths
    ,case month('2019-9-30') 
    when 1 then dblDeprT1
        when 2 then dblDeprT2
        when 3 then dblDeprT3
        when 4 then dblDeprT4
        when 5 then dblDeprT5
        when 6 then dblDeprT6
        when 7 then dblDeprT7
        when 8 then dblDeprT8
        when 9 then dblDeprT9
        when 10 then dblDeprT10
        when 11 then dblDeprT11
        when 12 then dblDeprT12
    else 0 
  end as dbl
from pdm.fa_tem01 as a 
left join ufdata.fa_deprtransactions as b 
on a.db = b.db and a.scardnum = b.scardnum 
where b.iyear = year('2019-9-30')
and (
(a.db in ("UFDATA_111_2018","UFDATA_118_2018","UFDATA_123_2018") and a.stypenum = "07") or
(a.db in ("UFDATA_333_2018","UFDATA_588_2019") and a.stypenum = "01"))
;
SQL结束执行时间：20190925003055
SQL开始执行时间：20190925003055


insert into pdm.fa_depreciation
select a.*
      ,case when b.db is null then 0 else b.dbldeprt end
  from pdm.fa_depreciation_pre a
  left join pdm.fa_depreciation b
    on DATE_SUB(a.date_,INTERVAL day(a.date_) day) = b.date_
   and a.db = b.db
   and a.scardnum = b.scardnum

;
SQL结束执行时间：20190925003057
SQL开始执行时间：20190925003057

drop table if exists pdm.fa_depreciation_pre
;
SQL结束执行时间：20190925003057
