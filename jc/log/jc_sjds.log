
20181229113916å¼€å§‹æ‰§è¡Œ2018-12-29 11:39:16.700824æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20181229113916

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"´æÔÚÊı¾İ¶ªÊ§£¬ÇëÈ·ÈÏ",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20181229113916
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20181229113916


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"´æÔÚÊı¾İ¶ªÊ§£¬ÇëÈ·ÈÏ",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20181229113916
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20181229113916

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"´æÔÚÊı¾İ¶ªÊ§£¬ÇëÈ·ÈÏ",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20181229113916
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20181229113916

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"´æÔÚÊı¾İ¶ªÊ§£¬ÇëÈ·ÈÏ",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20181229113916

20190102104208å¼€å§‹æ‰§è¡Œ2019-01-02 10:42:08.484600æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104208

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104208


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104208

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104208
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104208

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104208

20190102104437å¼€å§‹æ‰§è¡Œ2019-01-02 10:44:37.249748æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104437

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104437
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104437


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104437
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104437

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104437
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104437

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104437

20190102104626å¼€å§‹æ‰§è¡Œ2019-01-02 10:46:26.687355æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104626

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104626
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104626


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104626
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104626

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104626
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190102104626

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190102104626

20190104070000å¼€å§‹æ‰§è¡Œ2019-01-04 07:00:00.977534æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190104070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190104070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190104070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190104070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190104070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190104070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190104070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190104070001

20190105070000å¼€å§‹æ‰§è¡Œ2019-01-05 07:00:00.717568æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190105070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190105070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190105070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190105070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190105070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190105070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190105070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190105070001

20190106070000å¼€å§‹æ‰§è¡Œ2019-01-06 07:00:00.562707æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190106070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190106070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190106070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190106070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190106070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190106070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190106070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190106070001

20190107070000å¼€å§‹æ‰§è¡Œ2019-01-07 07:00:00.602411æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190107070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190107070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190107070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190107070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190107070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190107070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190107070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190107070001

20190108070000å¼€å§‹æ‰§è¡Œ2019-01-08 07:00:00.503055æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190108070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190108070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190108070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190108070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190108070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190108070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190108070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190108070001

20190109070000å¼€å§‹æ‰§è¡Œ2019-01-09 07:00:00.518477æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190109070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id 
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190109070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190109070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid 
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190109070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190109070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190109070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190109070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190109070001

20190110070000å¼€å§‹æ‰§è¡Œ2019-01-10 07:00:00.730326æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190110070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190110070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190110070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190110070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190110070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190110070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190110070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190110070001

20190111070000å¼€å§‹æ‰§è¡Œ2019-01-11 07:00:00.807400æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190111070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190111070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190111070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190111070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190111070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190111070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190111070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190111070001

20190112070000å¼€å§‹æ‰§è¡Œ2019-01-12 07:00:00.534490æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190112070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190112070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190112070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190112070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190112070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190112070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190112070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190112070001

20190113070000å¼€å§‹æ‰§è¡Œ2019-01-13 07:00:00.784467æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190113070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190113070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190113070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190113070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190113070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190113070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190113070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190113070001

20190114070000å¼€å§‹æ‰§è¡Œ2019-01-14 07:00:00.614044æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190114070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190114070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190114070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190114070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190114070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190114070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190114070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190114070001

20190115070000å¼€å§‹æ‰§è¡Œ2019-01-15 07:00:00.872255æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190115070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190115070001

20190116070000å¼€å§‹æ‰§è¡Œ2019-01-16 07:00:00.459848æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190116070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190116070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190116070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190116070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190116070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190116070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190116070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190116070001

20190117070000å¼€å§‹æ‰§è¡Œ2019-01-17 07:00:00.674440æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190117070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190117070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190117070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190117070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190117070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190117070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190117070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190117070001

20190118070000å¼€å§‹æ‰§è¡Œ2019-01-18 07:00:00.910441æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190118070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190118070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190118070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190118070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190118070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190118070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190118070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190118070001

20190119070000å¼€å§‹æ‰§è¡Œ2019-01-19 07:00:00.837136æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190119070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190119070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190119070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190119070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190119070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190119070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190119070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190119070001

20190120070000å¼€å§‹æ‰§è¡Œ2019-01-20 07:00:00.564162æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190120070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190120070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190120070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190120070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190120070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190120070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190120070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190120070000

20190121070000å¼€å§‹æ‰§è¡Œ2019-01-21 07:00:00.819962æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190121070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190121070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190121070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190121070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190121070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190121070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190121070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190121070001

20190122070000å¼€å§‹æ‰§è¡Œ2019-01-22 07:00:00.680327æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190122070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190122070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190122070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190122070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190122070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190122070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190122070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190122070001

20190123070000å¼€å§‹æ‰§è¡Œ2019-01-23 07:00:00.619200æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190123070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190123070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190123070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190123070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190123070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190123070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190123070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190123070001

20190124070000å¼€å§‹æ‰§è¡Œ2019-01-24 07:00:00.601304æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190124070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190124070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190124070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190124070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190124070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190124070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190124070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190124070001

20190126070000å¼€å§‹æ‰§è¡Œ2019-01-26 07:00:00.467830æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190126070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190126070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190126070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190126070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190126070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190126070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190126070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190126070000

20190127070000å¼€å§‹æ‰§è¡Œ2019-01-27 07:00:00.431733æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190127070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190127070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190127070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190127070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190127070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190127070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190127070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190127070000

20190128070000å¼€å§‹æ‰§è¡Œ2019-01-28 07:00:00.527292æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190128070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190128070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190128070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190128070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190128070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190128070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190128070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190128070001

20190129070000å¼€å§‹æ‰§è¡Œ2019-01-29 07:00:00.645905æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190129070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190129070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190129070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190129070107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190129070107

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190129070107
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190129070107

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190129070107

20190130070000å¼€å§‹æ‰§è¡Œ2019-01-30 07:00:00.776866æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190130070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190130070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190130070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190130070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190130070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190130070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190130070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190130070001

20190131070000å¼€å§‹æ‰§è¡Œ2019-01-31 07:00:00.779091æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190131070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190131070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190131070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190131070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190131070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190131070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190131070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190131070001

20190201070000å¼€å§‹æ‰§è¡Œ2019-02-01 07:00:00.608375æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190201070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190201070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190201070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190201070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190201070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190201070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190201070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190201070001

20190202070000å¼€å§‹æ‰§è¡Œ2019-02-02 07:00:00.726216æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190202070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190202070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190202070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190202070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190202070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190202070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190202070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190202070001

20190203070000å¼€å§‹æ‰§è¡Œ2019-02-03 07:00:00.483995æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190203070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190203070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190203070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190203070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190203070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190203070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190203070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190203070000

20190204070000å¼€å§‹æ‰§è¡Œ2019-02-04 07:00:00.978789æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190204070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190204070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190204070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190204070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190204070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190204070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190204070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190204070001

20190205070000å¼€å§‹æ‰§è¡Œ2019-02-05 07:00:00.322925æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190205070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190205070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190205070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190205070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190205070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190205070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190205070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190205070000

20190206070000å¼€å§‹æ‰§è¡Œ2019-02-06 07:00:00.398309æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190206070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190206070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190206070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190206070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190206070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190206070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190206070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190206070000

20190207070000å¼€å§‹æ‰§è¡Œ2019-02-07 07:00:00.572610æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190207070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190207070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190207070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190207070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190207070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190207070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190207070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190207070001

20190208070000å¼€å§‹æ‰§è¡Œ2019-02-08 07:00:00.588135æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190208070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190208070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190208070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190208070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190208070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190208070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190208070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190208070001

20190209070000å¼€å§‹æ‰§è¡Œ2019-02-09 07:00:00.487989æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190209070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190209070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190209070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190209070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190209070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190209070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190209070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190209070001

20190210070000å¼€å§‹æ‰§è¡Œ2019-02-10 07:00:00.967397æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190210070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190210070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190210070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190210070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190210070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190210070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190210070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190210070001

20190211070000å¼€å§‹æ‰§è¡Œ2019-02-11 07:00:00.912729æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190211070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190211070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190211070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190211070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190211070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018) a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190211070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190211070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190211070001

20190212070000å¼€å§‹æ‰§è¡Œ2019-02-12 07:00:00.526203æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190212070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190212070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190212070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190212070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190212070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190212070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190212070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190212070001

20190213070000å¼€å§‹æ‰§è¡Œ2019-02-13 07:00:00.931497æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190213070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190213070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190213070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190213070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190213070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190213070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190213070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190213070001

20190214070000å¼€å§‹æ‰§è¡Œ2019-02-14 07:00:00.776861æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190214070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190214070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190214070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190214070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190214070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190214070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190214070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190214070001

20190215070000å¼€å§‹æ‰§è¡Œ2019-02-15 07:00:00.277416æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190215070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190215070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190215070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190215070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190215070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190215070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190215070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190215070000

20190216070000å¼€å§‹æ‰§è¡Œ2019-02-16 07:00:00.614940æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190216070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190216070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190216070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190216070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190216070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190216070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190216070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190216070001

20190217070000å¼€å§‹æ‰§è¡Œ2019-02-17 07:00:00.598013æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190217070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190217070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190217070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190217070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190217070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190217070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190217070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190217070001

20190218070000å¼€å§‹æ‰§è¡Œ2019-02-18 07:00:00.599372æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190218070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190218070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190218070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190218070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190218070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190218070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190218070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190218070001

20190219070000å¼€å§‹æ‰§è¡Œ2019-02-19 07:00:00.289199æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190219070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190219070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190219070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190219070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190219070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190219070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190219070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190219070000

20190220070000å¼€å§‹æ‰§è¡Œ2019-02-20 07:00:00.526636æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190220070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190220070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190220070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190220070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190220070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190220070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190220070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190220070001

20190221070000å¼€å§‹æ‰§è¡Œ2019-02-21 07:00:00.747112æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190221070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190221070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190221070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190221070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190221070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190221070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190221070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190221070001

20190222070000å¼€å§‹æ‰§è¡Œ2019-02-22 07:00:00.946453æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190222070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190222070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190222070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190222070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190222070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190222070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190222070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190222070001

20190223070000å¼€å§‹æ‰§è¡Œ2019-02-23 07:00:00.351811æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190223070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190223070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190223070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190223070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190223070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190223070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190223070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190223070000

20190224070000å¼€å§‹æ‰§è¡Œ2019-02-24 07:00:00.696582æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190224070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190224070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190224070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190224070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190224070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190224070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190224070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190224070001

20190225070000å¼€å§‹æ‰§è¡Œ2019-02-25 07:00:00.647741æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190225070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190225070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190225070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190225070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190225070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190225070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190225070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190225070001

20190226070000å¼€å§‹æ‰§è¡Œ2019-02-26 07:00:00.720477æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190226070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190226070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190226070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190226070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190226070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190226070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190226070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190226070001

20190227070000å¼€å§‹æ‰§è¡Œ2019-02-27 07:00:00.646562æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190227070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190227070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190227070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190227070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190227070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190227070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190227070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190227070001

20190228070000å¼€å§‹æ‰§è¡Œ2019-02-28 07:00:00.716838æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190228070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190228070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190228070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190228070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190228070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190228070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190228070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190228070001

20190301070000å¼€å§‹æ‰§è¡Œ2019-03-01 07:00:00.618439æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190301070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190301070001

20190302070000å¼€å§‹æ‰§è¡Œ2019-03-02 07:00:00.426857æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190302070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190302070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190302070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190302070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190302070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190302070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190302070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190302070000

20190303070000å¼€å§‹æ‰§è¡Œ2019-03-03 07:00:00.437592æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190303070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190303070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190303070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190303070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190303070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190303070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190303070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190303070000

20190304070000å¼€å§‹æ‰§è¡Œ2019-03-04 07:00:00.493850æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190304070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190304070000

20190305070000å¼€å§‹æ‰§è¡Œ2019-03-05 07:00:00.626657æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190305070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190305070001

20190306070000å¼€å§‹æ‰§è¡Œ2019-03-06 07:00:00.608149æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190306070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190306070001

20190307070000å¼€å§‹æ‰§è¡Œ2019-03-07 07:00:00.686591æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190307070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190307070001

20190308070000å¼€å§‹æ‰§è¡Œ2019-03-08 07:00:00.797122æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190308070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190308070001

20190309070000å¼€å§‹æ‰§è¡Œ2019-03-09 07:00:00.687172æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190309070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190309070001

20190310070000å¼€å§‹æ‰§è¡Œ2019-03-10 07:00:00.814025æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190310070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190310070001

20190311070000å¼€å§‹æ‰§è¡Œ2019-03-11 07:00:00.384379æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190311070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190311070000

20190312070000å¼€å§‹æ‰§è¡Œ2019-03-12 07:00:00.622355æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190312070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190312070001

20190313070000å¼€å§‹æ‰§è¡Œ2019-03-13 07:00:00.457620æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190313070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190313070000

20190314070000å¼€å§‹æ‰§è¡Œ2019-03-14 07:00:00.569143æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190314070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190314070001

20190315070000å¼€å§‹æ‰§è¡Œ2019-03-15 07:00:00.692911æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190315070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190315070001

20190316070000å¼€å§‹æ‰§è¡Œ2019-03-16 07:00:00.394171æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190316070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190316070000

20190317070000å¼€å§‹æ‰§è¡Œ2019-03-17 07:00:00.673299æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190317070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190317070001

20190318070000å¼€å§‹æ‰§è¡Œ2019-03-18 07:00:00.489405æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190318070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190318070001

20190319070000å¼€å§‹æ‰§è¡Œ2019-03-19 07:00:00.434767æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;

20190319090440å¼€å§‹æ‰§è¡Œ2019-03-19 09:04:40.184838æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090440

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;

20190319090543å¼€å§‹æ‰§è¡Œ2019-03-19 09:05:43.230979æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090543

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;

20190319090652å¼€å§‹æ‰§è¡Œ2019-03-19 09:06:52.238470æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090652

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090652
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090652


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090652
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090652

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090652
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090652

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090652
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090652

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090652
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090652

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090652
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090652

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090652
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090652

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090653
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190319090653

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190319090653

20190320070000å¼€å§‹æ‰§è¡Œ2019-03-20 07:00:00.579196æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190320070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190320070001

20190321070000å¼€å§‹æ‰§è¡Œ2019-03-21 07:00:00.707147æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190321070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190321070001

20190322070000å¼€å§‹æ‰§è¡Œ2019-03-22 07:00:00.860245æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190322070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190322070001

20190323070000å¼€å§‹æ‰§è¡Œ2019-03-23 07:00:00.394948æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070000

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190323070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190323070001

20190324070000å¼€å§‹æ‰§è¡Œ2019-03-24 07:00:00.316188æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070000

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190324070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190324070001

20190325070000å¼€å§‹æ‰§è¡Œ2019-03-25 07:00:00.792156æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190325070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190325070001

20190326070000å¼€å§‹æ‰§è¡Œ2019-03-26 07:00:00.847116æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190326070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190326070001

20190327070000å¼€å§‹æ‰§è¡Œ2019-03-27 07:00:00.691088æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190327070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190327070001

20190328070000å¼€å§‹æ‰§è¡Œ2019-03-28 07:00:00.532651æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190328070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190328070001

20190329070000å¼€å§‹æ‰§è¡Œ2019-03-29 07:00:00.490606æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190329070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190329070001

20190330070000å¼€å§‹æ‰§è¡Œ2019-03-30 07:00:00.607657æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190330070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190330070001

20190331070000å¼€å§‹æ‰§è¡Œ2019-03-31 07:00:00.824719æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190331070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190331070001

20190401070000å¼€å§‹æ‰§è¡Œ2019-04-01 07:00:00.727498æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401070001

20190401095525å¼€å§‹æ‰§è¡Œ2019-04-01 09:55:25.980409æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095525

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095526
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095526


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095526
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095526

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095526
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095526

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095527
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095527

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095527
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095527

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095527
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095527

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095527
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095527

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095527
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190401095527

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190401095527

20190402070000å¼€å§‹æ‰§è¡Œ2019-04-02 07:00:00.824190æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190402070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190402070001

20190403070000å¼€å§‹æ‰§è¡Œ2019-04-03 07:00:00.588556æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190403070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190403070001

20190404070000å¼€å§‹æ‰§è¡Œ2019-04-04 07:00:00.924302æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190404070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190404070001

20190405070000å¼€å§‹æ‰§è¡Œ2019-04-05 07:00:00.576624æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190405070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190405070001

20190406070000å¼€å§‹æ‰§è¡Œ2019-04-06 07:00:00.636672æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190406070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190406070001

20190407070000å¼€å§‹æ‰§è¡Œ2019-04-07 07:00:00.499596æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190407070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190407070001

20190408070000å¼€å§‹æ‰§è¡Œ2019-04-08 07:00:00.446261æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190408070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190408070001

20190409070000å¼€å§‹æ‰§è¡Œ2019-04-09 07:00:00.393119æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070000

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190409070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190409070001

20190410070000å¼€å§‹æ‰§è¡Œ2019-04-10 07:00:00.867506æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190410070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190410070001

20190411070000å¼€å§‹æ‰§è¡Œ2019-04-11 07:00:00.391974æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070000

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190411070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190411070001

20190412070000å¼€å§‹æ‰§è¡Œ2019-04-12 07:00:00.547985æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190412070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190412070001

20190413070000å¼€å§‹æ‰§è¡Œ2019-04-13 07:00:00.765904æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190413070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190413070001

20190414070001å¼€å§‹æ‰§è¡Œ2019-04-14 07:00:01.041392æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190414070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190414070002

20190415070000å¼€å§‹æ‰§è¡Œ2019-04-15 07:00:00.710182æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190415070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190415070001

20190416070000å¼€å§‹æ‰§è¡Œ2019-04-16 07:00:00.792916æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190416070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190416070001

20190417070000å¼€å§‹æ‰§è¡Œ2019-04-17 07:00:00.879140æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190417070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190417070001

20190418070000å¼€å§‹æ‰§è¡Œ2019-04-18 07:00:00.746460æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190418070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190418070001

20190419070000å¼€å§‹æ‰§è¡Œ2019-04-19 07:00:00.599659æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190419070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190419070001

20190420070000å¼€å§‹æ‰§è¡Œ2019-04-20 07:00:00.673346æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190420070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190420070001

20190421070000å¼€å§‹æ‰§è¡Œ2019-04-21 07:00:00.465576æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190421070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190421070001

20190422070000å¼€å§‹æ‰§è¡Œ2019-04-22 07:00:00.495311æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190422070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190422070001

20190423070000å¼€å§‹æ‰§è¡Œ2019-04-23 07:00:00.723758æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190423070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190423070001

20190424070000å¼€å§‹æ‰§è¡Œ2019-04-24 07:00:00.541602æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190424070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190424070001

20190425070000å¼€å§‹æ‰§è¡Œ2019-04-25 07:00:00.551386æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190425070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190425070001

20190426070000å¼€å§‹æ‰§è¡Œ2019-04-26 07:00:00.727364æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190426070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190426070001

20190427070000å¼€å§‹æ‰§è¡Œ2019-04-27 07:00:00.775617æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190427070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190427070001

20190428070000å¼€å§‹æ‰§è¡Œ2019-04-28 07:00:00.958304æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190428070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190428070002

20190429070000å¼€å§‹æ‰§è¡Œ2019-04-29 07:00:00.377930æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190429070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190429070001

20190430070000å¼€å§‹æ‰§è¡Œ2019-04-30 07:00:00.788359æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190430070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190430070001

20190501070000å¼€å§‹æ‰§è¡Œ2019-05-01 07:00:00.709622æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190501070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190501070001

20190502070000å¼€å§‹æ‰§è¡Œ2019-05-02 07:00:00.604782æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190502070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190502070001

20190503070000å¼€å§‹æ‰§è¡Œ2019-05-03 07:00:00.732798æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190503070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190503070001

20190504070000å¼€å§‹æ‰§è¡Œ2019-05-04 07:00:00.512493æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190504070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190504070001

20190505070000å¼€å§‹æ‰§è¡Œ2019-05-05 07:00:00.599632æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190505070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190505070001

20190506070000å¼€å§‹æ‰§è¡Œ2019-05-06 07:00:00.675187æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190506070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190506070001

20190507070001å¼€å§‹æ‰§è¡Œ2019-05-07 07:00:01.054297æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070002

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190507070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190507070002

20190508070000å¼€å§‹æ‰§è¡Œ2019-05-08 07:00:00.928224æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190508070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190508070002

20190510070000å¼€å§‹æ‰§è¡Œ2019-05-10 07:00:00.505050æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190510070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190510070001

20190511070000å¼€å§‹æ‰§è¡Œ2019-05-11 07:00:00.303571æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070000

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190511070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190511070001

20190512070000å¼€å§‹æ‰§è¡Œ2019-05-12 07:00:00.749970æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190512070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190512070001

20190513070000å¼€å§‹æ‰§è¡Œ2019-05-13 07:00:00.699631æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190513070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190513070001

20190514070000å¼€å§‹æ‰§è¡Œ2019-05-14 07:00:00.884667æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190514070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190514070002

20190515070000å¼€å§‹æ‰§è¡Œ2019-05-15 07:00:00.937331æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190515070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190515070002

20190516070000å¼€å§‹æ‰§è¡Œ2019-05-16 07:00:00.806024æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190516070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190516070001

20190517070000å¼€å§‹æ‰§è¡Œ2019-05-17 07:00:00.746023æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190517070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190517070001

20190518070000å¼€å§‹æ‰§è¡Œ2019-05-18 07:00:00.506313æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190518070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190518070001

20190519070000å¼€å§‹æ‰§è¡Œ2019-05-19 07:00:00.482095æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190519070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190519070001

20190520070000å¼€å§‹æ‰§è¡Œ2019-05-20 07:00:00.980409æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070001


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190520070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190520070002

20190521070000å¼€å§‹æ‰§è¡Œ2019-05-21 07:00:00.487325æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190521070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190521070001

20190522070000å¼€å§‹æ‰§è¡Œ2019-05-22 07:00:00.761301æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190522070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190522070001

20190523070000å¼€å§‹æ‰§è¡Œ2019-05-23 07:00:00.783133æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190523070001

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190523070001

20190524070000å¼€å§‹æ‰§è¡Œ2019-05-24 07:00:00.758737æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;

20190524083737å¼€å§‹æ‰§è¡Œ2019-05-24 08:37:37.470993æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083737

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083737
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083737


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083737
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083737

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083737
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083737

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083738
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083738

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083738
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083738

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083738
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083738

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083738
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083738

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083738
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190524083738

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190524083738

20190525070000å¼€å§‹æ‰§è¡Œ2019-05-25 07:00:00.826599æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070002

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190525070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190525070002

20190526070000å¼€å§‹æ‰§è¡Œ2019-05-26 07:00:00.618080æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070002

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190526070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190526070002

20190527070000å¼€å§‹æ‰§è¡Œ2019-05-27 07:00:00.806698æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018) a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070002

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190527070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190527070002

20190528070000å¼€å§‹æ‰§è¡Œ2019-05-28 07:00:00.738042æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070002

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190528070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190528070002

20190529070000å¼€å§‹æ‰§è¡Œ2019-05-29 07:00:00.575981æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070002

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190529070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190529070002

20190530070000å¼€å§‹æ‰§è¡Œ2019-05-30 07:00:00.821433æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070002

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190530070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190530070002

20190531070000å¼€å§‹æ‰§è¡Œ2019-05-31 07:00:00.698019æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070000

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070000


INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070001

INSERT INTO edw.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070001

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070002

INSERT INTO edw.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070002

INSERT INTO edw.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190531070002

INSERT INTO edw.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190531070002

20190601070000å¼€å§‹æ‰§è¡Œ2019-06-01 07:00:00.614552æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190601070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190601070002

20190602070000å¼€å§‹æ‰§è¡Œ2019-06-02 07:00:00.687434æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190602070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190602070002

20190603070000å¼€å§‹æ‰§è¡Œ2019-06-03 07:00:00.720316æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190603070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190603070002

20190604070000å¼€å§‹æ‰§è¡Œ2019-06-04 07:00:00.674518æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190604070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190604070002

20190605070000å¼€å§‹æ‰§è¡Œ2019-06-05 07:00:00.710036æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190605070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190605070002

20190606070000å¼€å§‹æ‰§è¡Œ2019-06-06 07:00:00.454149æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190606070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190606070002

20190607070000å¼€å§‹æ‰§è¡Œ2019-06-07 07:00:00.653707æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190607070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190607070002

20190608070000å¼€å§‹æ‰§è¡Œ2019-06-08 07:00:00.657241æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190608070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190608070002

20190609070000å¼€å§‹æ‰§è¡Œ2019-06-09 07:00:00.772043æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190609070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190609070002

20190610070000å¼€å§‹æ‰§è¡Œ2019-06-10 07:00:00.701645æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190610070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190610070002

20190611070000å¼€å§‹æ‰§è¡Œ2019-06-11 07:00:00.707679æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190611070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190611070002

20190612070000å¼€å§‹æ‰§è¡Œ2019-06-12 07:00:00.623957æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190612070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190612070002

20190613070000å¼€å§‹æ‰§è¡Œ2019-06-13 07:00:00.884355æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070001


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190613070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190613070002

20190614070000å¼€å§‹æ‰§è¡Œ2019-06-14 07:00:00.575823æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190614070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190614070002

20190615070000å¼€å§‹æ‰§è¡Œ2019-06-15 07:00:00.610737æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190615070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190615070002

20190616070000å¼€å§‹æ‰§è¡Œ2019-06-16 07:00:00.681203æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190616070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190616070002

20190617070000å¼€å§‹æ‰§è¡Œ2019-06-17 07:00:00.797393æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190617070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190617070002

20190618070000å¼€å§‹æ‰§è¡Œ2019-06-18 07:00:00.614555æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190618070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190618070002

20190619070000å¼€å§‹æ‰§è¡Œ2019-06-19 07:00:00.528652æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190619070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190619070002

20190620070000å¼€å§‹æ‰§è¡Œ2019-06-20 07:00:00.866137æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070001


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190620070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190620070002

20190621070000å¼€å§‹æ‰§è¡Œ2019-06-21 07:00:00.920323æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070001


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190621070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190621070002

20190622070000å¼€å§‹æ‰§è¡Œ2019-06-22 07:00:00.900889æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070001


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190622070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190622070002

20190623070000å¼€å§‹æ‰§è¡Œ2019-06-23 07:00:00.877692æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070001


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190623070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190623070002

20190624070000å¼€å§‹æ‰§è¡Œ2019-06-24 07:00:00.668694æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624070002

20190624085104å¼€å§‹æ‰§è¡Œ2019-06-24 08:51:04.953713æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085104

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085105


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085105

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085105

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085105

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085105
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085105

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085106

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085106

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085106
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190624085106

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190624085106

20190625070000å¼€å§‹æ‰§è¡Œ2019-06-25 07:00:00.730614æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190625070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190625070002

20190626070000å¼€å§‹æ‰§è¡Œ2019-06-26 07:00:00.580617æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190626070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190626070002

20190627070000å¼€å§‹æ‰§è¡Œ2019-06-27 07:00:00.610877æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190627070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190627070002

20190628070000å¼€å§‹æ‰§è¡Œ2019-06-28 07:00:00.785861æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190628070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190628070002

20190629070000å¼€å§‹æ‰§è¡Œ2019-06-29 07:00:00.909434æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070001


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190629070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190629070002

20190630070000å¼€å§‹æ‰§è¡Œ2019-06-30 07:00:00.667224æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190630070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190630070002

20190701070000å¼€å§‹æ‰§è¡Œ2019-07-01 07:00:00.903179æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070001


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190701070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190701070002

20190702070000å¼€å§‹æ‰§è¡Œ2019-07-02 07:00:00.386503æ•°æ®åŠ è½½æ—¥å¿—:
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.rdrecord32 a
		LEFT JOIN edw.outdepot_order b ON a.id = b.id and a.db = b.db
	WHERE
		b.id IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070000


INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp1",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		ufdata.salebillvouch a
		LEFT JOIN edw.invoice_order b ON a.sbvid = b.sbvid and a.db = b.db
	WHERE
		b.sbvid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070000
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070000

INSERT INTO tracking.jc_abnormal_alarm SELECT
"invoice_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.invoice_order where left(true_ccuscode,2) <> 'GL' and (true_ccuscode <> 'DL1101002' and cinvcode <> 'QT00004') and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.invoice_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070001

INSERT INTO tracking.jc_abnormal_alarm SELECT
"outdepot_order_temp2",
NULL,
NULL,
NULL,
NULL,
NULL,
NULL,
"å­˜åœ¨æ•°æ®ä¸¢å¤±ï¼Œè¯·ç¡®è®¤",
1,
CURDATE( ) 
FROM
	(
	SELECT
		count( * ) AS num 
	FROM
		(select autoid,db from edw.outdepot_order where left(true_ccuscode,2) <> 'GL' and left(bi_cinvcode,2) <> 'JC' and year(ddate)>=2018 and state = 'æœ‰æ•ˆ') a
		LEFT JOIN pdm.outdepot_order b ON a.autoid = b.autoid and a.db = b.db
	WHERE
		b.autoid IS NULL 
	) a 
WHERE
	a.num > 0
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
ccuscode,
ccusname,
null,
null,
null,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
curdate( ) 
from
	edw.invoice_order 
where
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.invoice_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.invoice_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
ccuscode,
ccusname,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.ar_detail",
db,
cDwCode,
null,
NULL,
NULL,
NULL,
"å®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.ar_detail 
WHERE
	true_ccusname = "è¯·æ ¸æŸ¥" or true_ccuscode = "è¯·æ ¸æŸ¥"
union all
select 
"edw.outdepot_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.outdepot_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
union all
select 
"edw.dispatch_order",
db,
true_ccuscode,
true_ccusname,
NULL,
NULL,
NULL,
"æœ€ç»ˆå®¢æˆ·æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM
	edw.dispatch_order 
WHERE
	true_finnal_ccusname2 = "è¯·æ ¸æŸ¥" or true_finnal_ccuscode = 'è¯·æ ¸æŸ¥'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070001
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070001

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.ar_detail",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.ar_detail 
WHERE true_cinvname = "è¯·æ ¸æŸ¥" OR true_cinvname = "UNDECIDED" or true_cinvcode = 'è¯·æ ¸æŸ¥'
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"äº§å“æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE bi_cinvname = "è¯·æ ¸æŸ¥" OR bi_cinvname = "UNDECIDED" or bi_cinvcode = 'è¯·æ ¸æŸ¥'

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070002

INSERT INTO tracking.jc_abnormal_alarm 
SELECT
"edw.invoice_order",
db,
NULL,
NULL,
cinvcode,
cinvname,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.invoice_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.outdepot_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"
union all
SELECT
"edw.dispatch_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"é¡¹ç›®æ¸…æ´—é—®é¢˜",
1,
CURDATE( ) 
FROM edw.dispatch_order 
WHERE true_itemcode = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070002

INSERT INTO tracking.jc_abnormal_alarm SELECT
"pdm.invoice_order",
'all',
null,
null,
NULL,
NULL,
a.isum,
"18å¹´é‡‘é¢å‡ºç°å·®å¼‚",
3,
CURDATE( ) 
FROM(
select sum(isum) as isum 
from pdm.invoice_order 
WHERE left(ddate,4) = '2018') a
where round(a.isum,0) <> '906990596'
;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070002
SQLå¼€å§‹æ‰§è¡Œæ—¶é—´ï¼š20190702070002

INSERT INTO tracking.jc_abnormal_alarm
SELECT
"pdm.outdepot_order",
db,
NULL,
NULL,
cinvcode,
null,
NULL,
"pdmå±‚å‘è´§æ•°æ®æ•°æ®å­˜åœ¨é—®é¢˜",
3,
CURDATE( ) 
FROM pdm.outdepot_order 
WHERE iquantity = "è¯·æ ¸æŸ¥"

;
SQLç»“æŸæ‰§è¡Œæ—¶é—´ï¼š20190702070002
